<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>smalljerry aka dsjerry</title>
  
  <subtitle>smalljerry</subtitle>
  <link href="https://smalljerry.cn/atom.xml" rel="self"/>
  
  <link href="https://smalljerry.cn/"/>
  <updated>2025-06-12T15:25:05.912Z</updated>
  <id>https://smalljerry.cn/</id>
  
  <author>
    <name>dsjerry</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>APIé£æ ¼æŒ‡å—</title>
    <link href="https://smalljerry.cn/2025/06/12/API%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/"/>
    <id>https://smalljerry.cn/2025/06/12/API%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/</id>
    <published>2025-06-12T14:51:37.000Z</published>
    <updated>2025-06-12T15:25:05.912Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸª· æˆ‘æ˜¯è·èŠ±ï¼Œæˆ‘æƒ³å¼€äº†</p><span id="more"></span><hr><p>æœ€è¿‘åœ¨å­¦ NestJSï¼Œ<br>æœ‰æ—¶å€™æ€»ä¼šæƒ³åˆ°ï¼šè¿™æ ·ä¸åˆç†ï¼Œé‚£åˆä¸å¥½çœ‹ï¼Œä»è€Œåœ¨é’»ç‰›è§’å°–ã€‚ä¸å¦‚ä»è§„èŒƒå…¥æ‰‹ï¼Œæ¯•ç«Ÿè¿™æ˜¯å¤§å®¶å…¬è®¤çš„ï¼ˆåˆç†ï¼‰</p><h1 id="RESTful"><a href="#RESTful" class="headerlink" title="RESTful"></a>RESTful</h1><h2 id="1-èµ„æºï¼ˆResourcesï¼‰"><a href="#1-èµ„æºï¼ˆResourcesï¼‰" class="headerlink" title="1. èµ„æºï¼ˆResourcesï¼‰"></a>1. èµ„æºï¼ˆResourcesï¼‰</h2><ul><li>ä½¿ç”¨åè¯ï¼ˆå¤æ•°å½¢å¼ï¼‰è¡¨ç¤ºèµ„æº</li><li>ç¤ºä¾‹ï¼š<code>/users</code>, <code>/articles</code>, <code>/products</code></li></ul><h2 id="2-HTTP-æ–¹æ³•"><a href="#2-HTTP-æ–¹æ³•" class="headerlink" title="2. HTTP æ–¹æ³•"></a>2. HTTP æ–¹æ³•</h2><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th><th>å¹‚ç­‰æ€§</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>GET</td><td>è·å–èµ„æº</td><td>æ˜¯</td><td><code>GET /users</code></td></tr><tr><td>POST</td><td>åˆ›å»ºæ–°èµ„æº</td><td>å¦</td><td><code>POST /users</code></td></tr><tr><td>PUT</td><td>æ›´æ–°æ•´ä¸ªèµ„æºï¼ˆå…¨é‡æ›¿æ¢ï¼‰</td><td>æ˜¯</td><td><code>PUT /users/1</code></td></tr><tr><td>PATCH</td><td>éƒ¨åˆ†æ›´æ–°èµ„æº</td><td>å¦</td><td><code>PATCH /users/1</code></td></tr><tr><td>DELETE</td><td>åˆ é™¤èµ„æº</td><td>æ˜¯</td><td><code>DELETE /users/1</code></td></tr></tbody></table><h2 id="3-çŠ¶æ€ç "><a href="#3-çŠ¶æ€ç " class="headerlink" title="3. çŠ¶æ€ç "></a>3. çŠ¶æ€ç </h2><ul><li><code>200 OK</code> - æˆåŠŸ</li><li><code>201 Created</code> - åˆ›å»ºæˆåŠŸ</li><li><code>204 No Content</code> - æˆåŠŸä½†æ— è¿”å›å†…å®¹</li><li><code>400 Bad Request</code> - è¯·æ±‚é”™è¯¯</li><li><code>401 Unauthorized</code> - æœªè®¤è¯</li><li><code>403 Forbidden</code> - æ— æƒé™</li><li><code>404 Not Found</code> - èµ„æºä¸å­˜åœ¨</li><li><code>500 Internal Server Error</code> - æœåŠ¡å™¨é”™è¯¯</li></ul><h2 id="4-URL-è®¾è®¡"><a href="#4-URL-è®¾è®¡" class="headerlink" title="4. URL è®¾è®¡"></a>4. URL è®¾è®¡</h2><ul><li>ä½¿ç”¨å°å†™å­—æ¯å’Œè¿å­—ç¬¦ <code>-</code></li><li>ä½¿ç”¨ <code>/</code> è¡¨ç¤ºå±‚çº§å…³ç³»</li><li>ç¤ºä¾‹ï¼š<code>/users/123/orders</code></li></ul><h2 id="5-æŸ¥è¯¢å‚æ•°"><a href="#5-æŸ¥è¯¢å‚æ•°" class="headerlink" title="5. æŸ¥è¯¢å‚æ•°"></a>5. æŸ¥è¯¢å‚æ•°</h2><ul><li>ç”¨äºè¿‡æ»¤ã€æ’åºã€åˆ†é¡µç­‰</li><li>ç¤ºä¾‹ï¼š<ul><li>è¿‡æ»¤ï¼š<code>/users?role=admin</code></li><li>åˆ†é¡µï¼š<code>/users?page=2&amp;limit=10</code></li><li>æ’åºï¼š<code>/users?sort=-created_at,name</code></li></ul></li></ul><h2 id="6-ç‰ˆæœ¬æ§åˆ¶"><a href="#6-ç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="6. ç‰ˆæœ¬æ§åˆ¶"></a>6. ç‰ˆæœ¬æ§åˆ¶</h2><ul><li>URL ä¸­åŒ…å«ç‰ˆæœ¬å·ï¼š<code>/api/v1/users</code></li><li>æˆ–ä½¿ç”¨è¯·æ±‚å¤´ï¼š<code>Accept: application/vnd.myapp.v1+json</code></li></ul><h2 id="7-å“åº”æ ¼å¼"><a href="#7-å“åº”æ ¼å¼" class="headerlink" title="7. å“åº”æ ¼å¼"></a>7. å“åº”æ ¼å¼</h2><ul><li>ä½¿ç”¨ JSON æ ¼å¼</li><li>åŒ…å«å…ƒæ•°æ®ï¼ˆå¦‚åˆ†é¡µä¿¡æ¯ï¼‰</li><li>ç¤ºä¾‹ï¼š<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>...<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pagination&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;total&quot;</span><span class="punctuation">:</span> <span class="number">100</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;page&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;limit&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="8-é”™è¯¯å¤„ç†"><a href="#8-é”™è¯¯å¤„ç†" class="headerlink" title="8. é”™è¯¯å¤„ç†"></a>8. é”™è¯¯å¤„ç†</h2><ul><li>åŒ…å«é”™è¯¯ç å’Œæè¿°ä¿¡æ¯</li><li>ç¤ºä¾‹ï¼š<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;error&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="string">&quot;invalid_input&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Name is required&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;details&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;field&quot;</span><span class="punctuation">:</span> <span class="string">&quot;name&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;issue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;required&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="9-å®‰å…¨"><a href="#9-å®‰å…¨" class="headerlink" title="9. å®‰å…¨"></a>9. å®‰å…¨</h2><ul><li>ä½¿ç”¨ HTTPS</li><li>ä½¿ç”¨é€‚å½“çš„è®¤è¯æœºåˆ¶ï¼ˆå¦‚ JWTã€OAuth2.0ï¼‰</li><li>å®ç°é€Ÿç‡é™åˆ¶</li></ul><h2 id="10-æœ€ä½³å®è·µ"><a href="#10-æœ€ä½³å®è·µ" class="headerlink" title="10. æœ€ä½³å®è·µ"></a>10. æœ€ä½³å®è·µ</h2><ul><li>ä½¿ç”¨åè¯è€ŒéåŠ¨è¯</li><li>ä¿æŒ URL ç®€æ´</li><li>ä½¿ç”¨é€‚å½“çš„ HTTP çŠ¶æ€ç </li><li>æä¾›æ¸…æ™°çš„æ–‡æ¡£</li><li>å®ç° HATEOASï¼ˆå¯é€‰ï¼‰</li></ul><h2 id="11-å¸¸è§ç«¯ç‚¹ç¤ºä¾‹"><a href="#11-å¸¸è§ç«¯ç‚¹ç¤ºä¾‹" class="headerlink" title="11. å¸¸è§ç«¯ç‚¹ç¤ºä¾‹"></a>11. å¸¸è§ç«¯ç‚¹ç¤ºä¾‹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET    /users           # è·å–ç”¨æˆ·åˆ—è¡¨</span><br><span class="line">POST   /users           # åˆ›å»ºç”¨æˆ·</span><br><span class="line">GET    /users/&#123;id&#125;      # è·å–å•ä¸ªç”¨æˆ·</span><br><span class="line">PUT    /users/&#123;id&#125;      # æ›´æ–°ç”¨æˆ·ï¼ˆå…¨é‡ï¼‰</span><br><span class="line">PATCH  /users/&#123;id&#125;      # æ›´æ–°ç”¨æˆ·ï¼ˆéƒ¨åˆ†ï¼‰</span><br><span class="line">DELETE /users/&#123;id&#125;      # åˆ é™¤ç”¨æˆ·</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸª· æˆ‘æ˜¯è·èŠ±ï¼Œæˆ‘æƒ³å¼€äº†&lt;/p&gt;</summary>
    
    
    
    <category term="åç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="API" scheme="https://smalljerry.cn/tags/API/"/>
    
    <category term="å¼€å‘è§„èŒƒ" scheme="https://smalljerry.cn/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"/>
    
  </entry>
  
  <entry>
    <title>Vantç»„ä»¶ç¤ºä¾‹</title>
    <link href="https://smalljerry.cn/2025/03/03/Vant%E7%BB%84%E4%BB%B6%E7%A4%BA%E4%BE%8B/"/>
    <id>https://smalljerry.cn/2025/03/03/Vant%E7%BB%84%E4%BB%B6%E7%A4%BA%E4%BE%8B/</id>
    <published>2025-03-03T14:51:34.000Z</published>
    <updated>2025-03-03T15:18:41.290Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸ“¦ å¤åˆ¶å°±èƒ½ä½¿ç”¨ï¼Ÿ</p><span id="more"></span><p>Vant4ï¼Œ<a href="https://vant-ui.github.io/vant/#/zh-CN">å®˜æ–¹æ–‡æ¡£</a></p><h1 id="æ¸²æŸ“ç»„ä»¶"><a href="#æ¸²æŸ“ç»„ä»¶" class="headerlink" title="æ¸²æŸ“ç»„ä»¶"></a>æ¸²æŸ“ç»„ä»¶</h1><h2 id="åµŒå¥—çš„collapse"><a href="#åµŒå¥—çš„collapse" class="headerlink" title="åµŒå¥—çš„collapse"></a>åµŒå¥—çš„collapse</h2><p>åµŒå¥—çš„æŠ˜å é¢æ¿ï¼Œå»ºè®®åå­—ï¼š<code>NestedCollapse.vue</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;van-collapse class=&quot;nested-collapse&quot; v-model=&quot;activeNames&quot; accordion&gt;</span><br><span class="line">    &lt;van-collapse-item v-for=&quot;item in items&quot; :key=&quot;item.id&quot; :name=&quot;item.id&quot;&gt;</span><br><span class="line">      &lt;template #right-icon&gt;</span><br><span class="line">        &lt;van-icon</span><br><span class="line">          v-if=&quot;item.childList?.length&quot;</span><br><span class="line">          :name=&quot;activeNames == item.id ? &#x27;arrow-up&#x27; : &#x27;arrow-down&#x27;&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template #title&gt;</span><br><span class="line">        &lt;div class=&quot;title&quot; @click.stop=&quot;onItemClick(item)&quot;&gt;</span><br><span class="line">          &#123;&#123; item.name &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;nested-collapse</span><br><span class="line">        v-if=&quot;item.childList?.length&quot;</span><br><span class="line">        :items=&quot;item.childList&quot;</span><br><span class="line">        @click=&quot;(item) =&gt; onItemClick(item)&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/van-collapse-item&gt;</span><br><span class="line">  &lt;/van-collapse&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">/**</span><br><span class="line"> * åµŒå¥—æŠ˜å é¢æ¿ï¼Œæ¯å±‚ä¼ é€’childList</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">interface Item &#123;</span><br><span class="line">  id: string | number;</span><br><span class="line">  name: string;</span><br><span class="line">  childList?: Item[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ‰‹é£ç´æ¨¡å¼ï¼ˆaccordionï¼‰ç»‘å®šæ™®é€šç±»å‹å³å¯ï¼Œå¦åˆ™éœ€è¦ç»‘å®šæ•°ç»„</span><br><span class="line">const props = defineProps&lt;&#123;</span><br><span class="line">  items: Item[];</span><br><span class="line">&#125;&gt;();</span><br><span class="line"></span><br><span class="line">const emit = defineEmits&lt;&#123;</span><br><span class="line">  (e: &quot;click&quot;, item: Item): void;</span><br><span class="line">&#125;&gt;();</span><br><span class="line"></span><br><span class="line">const activeNames = ref(&quot;&quot;);</span><br><span class="line"></span><br><span class="line">function onItemClick(item: Item) &#123;</span><br><span class="line">  emit(&quot;click&quot;, item);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.nested-collapse &#123;</span><br><span class="line">  --van-cell-horizontal-padding: 4px;</span><br><span class="line">  --van-cell-group-background: transparent;</span><br><span class="line">  --van-cell-background: transparent;</span><br><span class="line"></span><br><span class="line">  :deep(.van-collapse-item__content) &#123;</span><br><span class="line">    --van-collapse-item-content-background: transparent;</span><br><span class="line">    padding-left: 16px;</span><br><span class="line">  &#125;</span><br><span class="line">  // ç•™å‡ºç‚¹ç©ºä½</span><br><span class="line">  // ç‚¹å‡»æ ‡é¢˜æ—¶é˜»æ­¢äº†ç»„ä»¶çš„é»˜è®¤äº‹ä»¶ï¼Œå¦‚æœå®½åº¦ä¸º100%ä¼šå¯¼è‡´å³è¾¹çš„ç®­å¤´æ— æ³•ç‚¹å‡»</span><br><span class="line">  .title &#123;</span><br><span class="line">    width: 96%;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h2 id="å•è¡Œæ—¥æœŸé€‰æ‹©"><a href="#å•è¡Œæ—¥æœŸé€‰æ‹©" class="headerlink" title="å•è¡Œæ—¥æœŸé€‰æ‹©"></a>å•è¡Œæ—¥æœŸé€‰æ‹©</h2><p>å½“å¤©é€‰ä¸­ä¸ºä¸»é¢˜è‰²ä½œä¸ºèƒŒæ™¯è‰²ï¼Œé€‰ä¸­å…¶ä»–æ—¥æœŸä¸»é¢˜è‰²ä¸ºè¾¹æ¡†ï¼Œå»ºè®®åç§°ï¼š<code>InlineDatePicker.vue</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;calendar&quot;&gt;</span><br><span class="line">    &lt;!-- å‘¨æ ‡é¢˜ --&gt;</span><br><span class="line">    &lt;div v-if=&quot;!inSameRound&quot; class=&quot;weekdays&quot;&gt;</span><br><span class="line">      &lt;div v-for=&quot;(day, index) in weekdays&quot; :key=&quot;index&quot; class=&quot;weekday&quot;&gt;</span><br><span class="line">        &#123;&#123; day &#125;&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- æ—¥æœŸ --&gt;</span><br><span class="line">    &lt;div class=&quot;dates&quot;&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        v-for=&quot;(date, index) in dates&quot;</span><br><span class="line">        :key=&quot;index&quot;</span><br><span class="line">        class=&quot;date&quot;</span><br><span class="line">        :class=&quot;&#123; today: date.isToday, active: isSelected(date) &#125;&quot;</span><br><span class="line">        @click=&quot;selectDate(date)&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;span v-if=&quot;inSameRound&quot;&gt;&#123;&#123; date.day &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;span v-if=&quot;date.date&quot;&gt;&#123;&#123; date.date &#125;&#125;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">interface Props &#123;</span><br><span class="line">  inSameRound?: boolean; // æ˜ŸæœŸå’Œæ—¥æœŸåœ¨ä¸€ä¸ªåœ†å½¢å†…</span><br><span class="line">&#125;</span><br><span class="line">interface Emits &#123;</span><br><span class="line">  (e: &quot;select&quot;, date: DateType): void;</span><br><span class="line">&#125;</span><br><span class="line">interface DateType &#123;</span><br><span class="line">  day: string; // å‘¨</span><br><span class="line">  date: number; // æ—¥</span><br><span class="line">  fullDate: string;</span><br><span class="line">  isToday: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;Props&gt;();</span><br><span class="line">const emit = defineEmits&lt;Emits&gt;();</span><br><span class="line"></span><br><span class="line">const weekdays = ref([&quot;æ—¥&quot;, &quot;ä¸€&quot;, &quot;äºŒ&quot;, &quot;ä¸‰&quot;, &quot;å››&quot;, &quot;äº”&quot;, &quot;å…­&quot;]);</span><br><span class="line">const today = new Date();</span><br><span class="line"></span><br><span class="line">const selectedDate = ref&lt;DateType | null&gt;(null);</span><br><span class="line">const isSelected = (date: DateType) =&gt; &#123;</span><br><span class="line">  return selectedDate.value?.fullDate === date.fullDate;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// ç”Ÿæˆå½“å‰å‘¨çš„æ—¥æœŸæ•°æ®</span><br><span class="line">const dates = computed(() =&gt; &#123;</span><br><span class="line">  const startOfWeek = new Date(today);</span><br><span class="line">  startOfWeek.setDate(today.getDate() - today.getDay());</span><br><span class="line"></span><br><span class="line">  return Array.from(&#123; length: 7 &#125;).map((_, index) =&gt; &#123;</span><br><span class="line">    const currentDate = new Date(startOfWeek);</span><br><span class="line">    currentDate.setDate(startOfWeek.getDate() + index);</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      day: weekdays.value[index],</span><br><span class="line">      date: currentDate.getDate(),</span><br><span class="line">      isToday: currentDate.toDateString() === today.toDateString(),</span><br><span class="line">      fullDate: currentDate.toLocaleDateString(),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function selectDate(date: DateType) &#123;</span><br><span class="line">  selectedDate.value = date;</span><br><span class="line">  emit(&quot;select&quot;, date);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.calendar &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.weekdays,</span><br><span class="line">.dates &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-around;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.weekday,</span><br><span class="line">.date &#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.date &#123;</span><br><span class="line">  $date-size: 30px;</span><br><span class="line"></span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  align-items: center;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  width: $date-size;</span><br><span class="line">  max-width: $date-size;</span><br><span class="line">  height: $date-size;</span><br><span class="line">  margin-top: 5px;</span><br><span class="line">  border-radius: 100%;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.date.today &#123;</span><br><span class="line">  color: white;</span><br><span class="line">  background-color: var(--van-primary-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.date.active &#123;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  border: 1px solid var(--van-primary-color);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸ“¦ å¤åˆ¶å°±èƒ½ä½¿ç”¨ï¼Ÿ&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="vue" scheme="https://smalljerry.cn/tags/vue/"/>
    
    <category term="ç»„ä»¶" scheme="https://smalljerry.cn/tags/%E7%BB%84%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>éƒ¨ç½²æ‰‹å†Œ</title>
    <link href="https://smalljerry.cn/2025/02/15/%E9%83%A8%E7%BD%B2%E6%89%8B%E5%86%8C/"/>
    <id>https://smalljerry.cn/2025/02/15/%E9%83%A8%E7%BD%B2%E6%89%8B%E5%86%8C/</id>
    <published>2025-02-15T08:50:12.000Z</published>
    <updated>2025-06-02T03:12:00.650Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸ‘‹ æ°¸è¿œéƒ½è®°ä¸ä½çš„é…ç½®è¿‡ç¨‹</p><span id="more"></span><h1 id="git"><a href="#git" class="headerlink" title="git"></a>git</h1><h2 id="linux-é…ç½®ç™»å½•"><a href="#linux-é…ç½®ç™»å½•" class="headerlink" title="linux é…ç½®ç™»å½•"></a>linux é…ç½®ç™»å½•</h2><blockquote><p>Windows ä¼šç›´æ¥å¼¹å‡ºå¼¹çª—ä»¥è¾“å…¥è´¦å·å¯†ç ï¼ˆå‰ææ˜¯å®‰è£…äº† GUI è½¯ä»¶ï¼‰</p></blockquote><p>ä½¿ç”¨<code>git push</code>æ—¶è¾“å…¥ç”¨æˆ·æ˜å’Œå¯†ç ç™»å½•åï¼Œæç¤ºä¸å†æ”¯æŒæ­¤ç™»å½•æ–¹å¼ï¼š</p><p><img src="https://s21.ax1x.com/2025/03/03/pEG7DfI.png" alt="åºŸå¼ƒæç¤º"></p><p>æ ¹æ®æç¤ºä¸­çš„é“¾æ¥ï¼Œæ‰¾åˆ°<a href="https://github.com/git-ecosystem/git-credential-manager/blob/main/README.md">Git å‡­æ®ç®¡ç†å™¨</a>ï¼ˆGit Credential Managerï¼‰ï¼Œå¤§è‡´å®‰è£…ã€é…ç½®æ­¥éª¤ï¼šï¼ˆUbuntuï¼‰</p><ol><li>å®‰è£….NET tool</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get update &amp;&amp; \</span><br><span class="line">  <span class="built_in">sudo</span> apt-get install -y dotnet-sdk-8.0</span><br></pre></td></tr></table></figure><ol start="2"><li>å®‰è£…ç®¡ç†å·¥å…·</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet tool install -g git-credential-manager</span><br></pre></td></tr></table></figure><p>æˆåŠŸå®‰è£…åä¼šæç¤ºå°†å…¶è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼š</p><p><img src="https://s21.ax1x.com/2025/03/03/pEG766f.png" alt="é…ç½®ç¯å¢ƒå˜é‡"></p><ol start="3"><li>é…ç½®</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git-credential-manager configure</span><br></pre></td></tr></table></figure><p>è®¾ç½®<code>GCM_CREDENTIAL_STORE</code>ç¯å¢ƒå˜é‡ï¼Œè¿™é‡Œä½¿ç”¨<code>gpg</code>ï¼Œå¹¶ä¸”éœ€è¦é¢å¤–å®‰è£…<code>pass</code>ï¼ˆæ­¤å¤–è¿˜æœ‰åˆ«çš„è®¾ç½®å½¢å¼ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GCM_CREDENTIAL_STORE=<span class="string">&quot;gpg&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install pass</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ– store</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># initåé¢çš„åç§°éšæ„</span></span><br><span class="line">pass init github-gpg-id</span><br></pre></td></tr></table></figure><p>æ¨é€ä»£ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2025/03/03/pEG72nS.png" alt="é€‰æ‹©gpg"></p><h1 id="NGINX"><a href="#NGINX" class="headerlink" title="NGINX"></a>NGINX</h1><p>ğŸ‘‰ <a href="https://smalljerry.cn/2020/11/06/Nginx%E5%AE%89%E8%A3%85/">Nginx å®‰è£…</a></p><h2 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h2><blockquote><p>å¸¸è§æ“ä½œå°±æ˜¯ä½¿ç”¨ä»£ç†ç»“å±€è·¨åŸŸé—®é¢˜</p></blockquote><h3 id="ç«¯å£åˆ°å­åŸŸå"><a href="#ç«¯å£åˆ°å­åŸŸå" class="headerlink" title="ç«¯å£åˆ°å­åŸŸå"></a>ç«¯å£åˆ°å­åŸŸå</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> your_subdomain.yourdomain.com;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:8080;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç«¯å£åˆ°è·¯å¾„"><a href="#ç«¯å£åˆ°è·¯å¾„" class="headerlink" title="ç«¯å£åˆ°è·¯å¾„"></a>ç«¯å£åˆ°è·¯å¾„</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> /your-subpath/ &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://localhost:8080;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹ï¼šè§£å†³å‰ç«¯è·¨åŸŸ"><a href="#ç¤ºä¾‹ï¼šè§£å†³å‰ç«¯è·¨åŸŸ" class="headerlink" title="ç¤ºä¾‹ï¼šè§£å†³å‰ç«¯è·¨åŸŸ"></a>ç¤ºä¾‹ï¼šè§£å†³å‰ç«¯è·¨åŸŸ</h3><blockquote><p>é€šè¿‡ä»£ç†è¯·æ±‚ä»¥è§£å†³<code>å‰ç«¯è·¨åŸŸ</code>é—®é¢˜ï¼ŒåŸå› æ˜¯ç”±æµè§ˆå™¨çš„åŒæºç­–ç•¥å¯¼è‡´ï¼ˆSame-Origin Policyï¼‰</p></blockquote><p>å‰ç«¯è·¨åŸŸäº§ç”Ÿçš„åŸå› ï¼šæµè§ˆå™¨é€šè¿‡ JavaScript å‘é€ç½‘ç»œè¯·æ±‚æ—¶ï¼Œè¯·æ±‚çš„æ¥å£ä¸å½“å‰é¡µé¢çš„ URL ä¸åœ¨åŒä¸€ä¸ªåŸŸåã€åè®®å’Œç«¯å£ä¹‹ä¸‹ï¼Œæµè§ˆå™¨å°±ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªè·¨åŸŸè¯·æ±‚ï¼Œä»è€Œæ ¹æ®åŒæºç­–ç•¥é˜»æ­¢è¿™ä¸ªè¯·æ±‚ï¼ˆé™¤éæœåŠ¡å™¨åœ¨å“åº”å¤´æ˜ç¡®å£°æ˜å…è®¸è·¨åŸŸï¼‰</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> localhost;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">root</span>   /usr/share/nginx/html;</span><br><span class="line">        <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‰ç«¯è¯·æ±‚ /api çš„ä»£ç†é…ç½®</span></span><br><span class="line">    <span class="section">location</span> /api/ &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://api.example.com/;  <span class="comment"># å°†è¯·æ±‚è½¬å‘åˆ°åç«¯æœåŠ¡</span></span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>location</code>é…ç½®çš„æ˜¯<code>/api/</code>è€Œä¸æ˜¯<code>/api</code>ï¼ŒäºŒè€…åŒºåˆ«ï¼š</p><ul><li><code>/api/</code>ï¼šåŒ¹é…å½“å‰è§„åˆ™ä¹‹åçš„æ‰€æœ‰è·¯å¾„</li><li><code>/api</code>ï¼šåŒ¹é…ä»¥è¿™ä¸ªå¼€å¤´çš„æ‰€æœ‰è·¯å¾„</li></ul><p><code>proxy_pass</code>åŒæ ·éœ€è¦ä»¥/ç»“å°¾ï¼ŒäºŒè€…åŒºåˆ«ï¼š</p><ul><li>æœ‰<code>/</code>ç»“å°¾ï¼šè¯·æ±‚ä¸­çš„/api å°†ä¼šè¢«å»æ‰ï¼Œå…¶ä½™éƒ¨åˆ†æ‹¼æ¥ä¸Šå»<ul><li>å¦‚ï¼š<code>http://api.example.com/login</code></li></ul></li><li>æ— <code>/</code>ç»“å°¾ï¼š/api ä¼šç»§ç»­æ‹¼æ¥åˆ°è¯·æ±‚çš„æ¥å£ä¸­<ul><li>å¦‚ï¼š<code>http://api.example.com/api/login</code></li></ul></li></ul><h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h2 id="VSCode-å®¹å™¨å¼€å‘"><a href="#VSCode-å®¹å™¨å¼€å‘" class="headerlink" title="VSCode å®¹å™¨å¼€å‘"></a>VSCode å®¹å™¨å¼€å‘</h2><p>âš™ï¸ éœ€è¦å®‰è£… vscode æ’ä»¶<code>Dev Containers</code></p><p>ğŸ”— å®¹å™¨å†…å¤–æ–‡ä»¶ä¼šè‡ªåŠ¨åŒæ­¥</p><p>ä½¿ç”¨åœºæ™¯ï¼šç»Ÿä¸€çš„å¼€å‘ç¯å¢ƒï¼Œæˆ–è€…æ˜¯ç‰¹æ®Šçš„å¼€å‘ç¯å¢ƒï¼Œä»¥ä¸‹ç¤ºä¾‹åŸºäº<code>python2</code>ã€<code>node14</code>çš„ä¸å¸¸è§å¼€å‘ç¯å¢ƒï¼ˆå¯¹äº 2025 å¹´æ¥è¯´ï¼‰</p><h3 id="åˆ›å»ºé…ç½®æ–‡ä»¶"><a href="#åˆ›å»ºé…ç½®æ–‡ä»¶" class="headerlink" title="åˆ›å»ºé…ç½®æ–‡ä»¶"></a>åˆ›å»ºé…ç½®æ–‡ä»¶</h3><p>åœ¨æ ¹ç›®å½•åˆ›å»º<code>.devcontainer</code>æ–‡ä»¶å¤¹ï¼Œæ·»åŠ ä»¥ä¸‹æ–‡ä»¶ï¼š</p><p><strong><code>Dockerfile</code></strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨å®˜æ–¹ Python 2 é•œåƒä½œä¸ºåŸºç¡€</span></span><br><span class="line"><span class="keyword">FROM</span> python:<span class="number">2.7</span>-slim</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… Node.js 14</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y curl</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> curl -fsSL https://deb.nodesource.com/setup_14.x | bash -</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y nodejs</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…å¸¸ç”¨å·¥å…·ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y git vim</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /workspace</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… Python ä¾èµ–ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> requirements.txt .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… Node.js ä¾èµ–ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package.json .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm install</span></span><br></pre></td></tr></table></figure><ul><li>å’Œç»ˆç«¯ä¸€æ ·ï¼Œå‘½ä»¤å’Œä½¿ç”¨<code>\</code>æ¥æ¢è¡Œ</li></ul><p><strong><code>devcontainer.json</code></strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Python 2 + Node.js 14&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;dockerfile&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Dockerfile&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;extensions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;ms-python.python&quot;</span><span class="punctuation">,</span> <span class="comment">// Python æ‰©å±•</span></span><br><span class="line">    <span class="string">&quot;dbaeumer.vscode-eslint&quot;</span><span class="punctuation">,</span> <span class="comment">// ESLint æ‰©å±•</span></span><br><span class="line">    <span class="string">&quot;esbenp.prettier-vscode&quot;</span> <span class="comment">// Prettier æ‰©å±•</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;forwardPorts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">3000</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">// è½¬å‘ç«¯å£ï¼ˆNode.js åº”ç”¨ï¼‰ï¼Œå¯æŒ‡å®šå¤šä¸ªï¼Œæ¯”å¦‚å®¹å™¨é‡Œé¢è¿˜æœ‰æœåŠ¡ç«¯çš„ç«¯å£</span></span><br><span class="line">  <span class="attr">&quot;postCreateCommand&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npm install&quot;</span><span class="punctuation">,</span> <span class="comment">// å®¹å™¨åˆ›å»ºåè¿è¡Œå‘½ä»¤</span></span><br><span class="line">  <span class="attr">&quot;workspaceMount&quot;</span><span class="punctuation">:</span> <span class="string">&quot;source=$&#123;localWorkspaceFolder&#125;,target=/workspace,type=bind&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;workspaceFolder&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/workspace&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p>åœ¨ VSCode ä¸­è¾“å…¥å¿«æ·é”®<code>Ctrl/Cmd + Shift + P</code>ï¼Œæˆ–è€…ç‚¹å‡»å·¦ä¸‹è§’çš„è“è‰²ç®­å¤´ï¼ˆæˆ–è€…å…¶ä»–ä¸»é¢˜è‰²ï¼‰ï¼Œé€‰æ‹©<strong>Reopen in container</strong>ï¼ˆåœ¨å®¹å™¨ä¸­é‡æ–°æ‰“å¼€ï¼‰</p><p>æ­¤è¿‡ç¨‹ä¸­ä¼šï¼š</p><ul><li><p>åˆ›å»ºä¸€ä¸ªé•œåƒï¼Œé•œåƒåç§°ä»¥<code>vsc</code>å¼€å¤´</p></li><li><p>åŸºäºé•œåƒè¿è¡Œä¸€ä¸ªå®¹å™¨</p></li><li><p>è¿è¡ŒæˆåŠŸåï¼Œvscode åœ°ä¸‹çš„é¢æ¿ä¸­çš„ PORTï¼ˆç«¯å£ï¼‰ é€‰é¡¹é¢æ¿å°±ä¼šæ˜¾ç¤ºå‡ºåœ¨<code>forwardPorts</code>ä¸­é…ç½®çš„è½¬å‘ç«¯å£</p></li></ul><blockquote><p>å¦‚æœå¯åŠ¨å¤±è´¥ï¼Œå¹¶ä¸”æ˜¯ç”±äºæ‹‰å»ä¸åˆ°é•œåƒï¼Œå¯ä»¥å…ˆæ‹‰å»æ‰€éœ€è¦çš„é•œåƒï¼Œå†å¯åŠ¨ã€‚å¦‚<code>docker pull python:2.7-slim</code></p></blockquote><h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><h2 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h2><p><strong>Ubuntu</strong></p><p>ä¾èµ–Javaè¿è¡Œï¼Œéœ€è¦å…ˆå®‰è£…Java</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install openjdk-17-jdk</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‹ç¼©åŒ…å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dlcdn.apache.org/maven/maven-3/3.9.6/binaries/apache-maven-3.9.6-bin.tar.gz</span><br></pre></td></tr></table></figure><p>è§£å‹ã€å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-maven-3.9.6-bin.tar.gz -C /opt/</span><br></pre></td></tr></table></figure><p>é…ç½®è½¯è¿æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s /opt/apache-maven-3.9.6 /opt/maven</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘ç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”æ·»åŠ å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile.d/maven.sh</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ ä»¥ä¸‹å†…å®¹</span></span><br><span class="line"><span class="built_in">export</span> MAVEN_HOME=/opt/maven</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;MAVEN_HOME&#125;</span>/bin:<span class="variable">$&#123;PATH&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile.d/maven.sh</span><br></pre></td></tr></table></figure><p>éªŒè¯å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -v</span><br></pre></td></tr></table></figure><h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h2 id="Docker-1"><a href="#Docker-1" class="headerlink" title="Docker"></a>Docker</h2><p>æ‹‰å– -&gt; åˆ›å»º -&gt; è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:8.0</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name mysql-8 \</span><br><span class="line">  -p 3306:3306 \</span><br><span class="line">  -e MYSQL_ROOT_PASSWORD=123456 \</span><br><span class="line">  -v mysql-data:/var/lib/mysql \</span><br><span class="line">  mysql:8.0</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it mysql-8 bash</span><br></pre></td></tr></table></figure><p>è¿›å…¥å®¹å™¨ååˆ›å»ºå¯è¿œç¨‹è¿æ¥çš„ç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p123456</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><h1 id="ç›¸å…³æ¦‚å¿µ"><a href="#ç›¸å…³æ¦‚å¿µ" class="headerlink" title="ç›¸å…³æ¦‚å¿µ"></a>ç›¸å…³æ¦‚å¿µ</h1><h2 id="è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰"><a href="#è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰" class="headerlink" title="è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰"></a>è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰</h2><blockquote><p>è·¨åŸŸèµ„æºå…±äº« å’Œ æµè§ˆå™¨çš„åŒæºç­–ç•¥ äº§ç”Ÿçš„è·¨åŸŸé—®é¢˜å±äºä¸¤ä¸ªä¸åŒèŒƒç•´</p></blockquote><p>é€šè¿‡ Nginx çš„é…ç½®å¯è§£å†³å‰ç«¯çš„è·¨åŸŸé—®é¢˜ï¼Œä½†æ˜¯è·¨åŸŸèµ„æºå…±äº«åˆ™<strong>éœ€è¦åç«¯</strong>è§£å†³ï¼š</p><ul><li>CORS å±äºæœåŠ¡ç«¯çš„è§£å†³æ–¹æ¡ˆ</li><li>CORS å…è®¸ç›®æ ‡æœåŠ¡å™¨å£°æ˜å“ªäº›å¤–éƒ¨åŸŸåå¯ä»¥è®¿é—®å…¶èµ„æº</li></ul><p>åç«¯åœ¨å“åº”å¤´ï¼Œéœ€è¦çš„æ˜¯æ·»åŠ å¦‚<code>Access-Control-Allow-*</code>ä¹‹ç±»çš„å£°æ˜</p><p>é»˜è®¤æƒ…å†µä¸‹æµè§ˆå™¨ä¼šæ ¹æ®åŒæºç­–ç•¥æ¥é˜»æ­¢éåŒæºè¯·æ±‚ï¼Œå¦‚æœ ç›®æ ‡æœåŠ¡å™¨æ”¯æŒ CORSï¼ŒæœåŠ¡ç«¯å¯ä»¥åœ¨å“åº”å¤´æ·»åŠ é€‚å½“çš„ CORS å¤´æ¥å‘Šè¯‰æµè§ˆå™¨å…è®¸ç‰¹å®šçš„è·¨åŸŸè¯·æ±‚ã€‚</p><p>CORS å·¥ä½œåŸç†ï¼š</p><ul><li><p>é¢„æ£€è¯·æ±‚ï¼ˆPreflight Requestï¼‰</p><ul><li>å¯¹äºæŸäº›è·¨åŸŸè¯·æ±‚ï¼ˆPUTã€DELETE æˆ–å¸¦æœ‰è‡ªå®šä¹‰å¤´çš„è¯·æ±‚ï¼‰ï¼Œæµè§ˆå™¨ä¼šå…ˆå‘é€ä¸€ä¸ª OPTIONS è¯·æ±‚ï¼ˆé¢„æ£€è¯·æ±‚ï¼‰æ¥è¯¢é—®æœåŠ¡å™¨æ˜¯å¦å…è®¸è·¨åŸŸè¯·æ±‚ã€‚</li></ul></li><li><p>CORS å“åº”å¤´</p><ul><li>æœåŠ¡ç«¯åœ¨å“åº”å¤´ä¸­åŠ å…¥å¦‚ Access-Control-Allo-Originã€Access-Control-Allow-Methods æ¥å…è®¸æµè§ˆå™¨è·¨åŸŸè®¿é—®</li></ul></li><li><p>ç®€å•è¯·æ±‚</p><ul><li>GETã€POSTï¼ˆå¹¶ä¸”æ²¡æœ‰ç‰¹æ®Šå¤´çš„è¯·æ±‚ï¼‰ç­‰ç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ä¸ä¼šå‘é€é¢„æ£€è¯·æ±‚ã€‚å¦‚æœæœåŠ¡ç«¯çš„å“åº”å¤´ä¸­æœ‰ç›¸å…³çš„ CORS å¤´é…ç½®ï¼Œæµè§ˆå™¨ä¼šå…è®¸è¿™ä¸ªè¯·æ±‚</li></ul></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸ‘‹ æ°¸è¿œéƒ½è®°ä¸ä½çš„é…ç½®è¿‡ç¨‹&lt;/p&gt;</summary>
    
    
    
    <category term="éƒ¨ç½²è¿ç»´" scheme="https://smalljerry.cn/categories/%E9%83%A8%E7%BD%B2%E8%BF%90%E7%BB%B4/"/>
    
    
  </entry>
  
  <entry>
    <title>nestjså­¦ä¹ æ—¥è®°</title>
    <link href="https://smalljerry.cn/2025/02/15/nestjs/"/>
    <id>https://smalljerry.cn/2025/02/15/nestjs/</id>
    <published>2025-02-15T02:13:54.000Z</published>
    <updated>2025-03-30T09:29:56.274Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸ—¨ï¸ é—®ä¸€ä¸‹DeepSeekä»Šå¤©è¦å­¦ä»€ä¹ˆ</p><span id="more"></span><h1 id="å®‰è£…ä¸è¿è¡Œ"><a href="#å®‰è£…ä¸è¿è¡Œ" class="headerlink" title="å®‰è£…ä¸è¿è¡Œ"></a>å®‰è£…ä¸è¿è¡Œ</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g @nestjs/cli</span><br></pre></td></tr></table></figure><p>ï¼ˆtypescriptï¼‰å®‰è£…<em>express</em>çš„å£°æ˜æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @types/express</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼ˆç”Ÿäº§ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure><ul><li>ç”Ÿäº§æ¨¡å¼å¯åŠ¨ï¼Œé€‚ç”¨äºéƒ¨ç½²ç¯å¢ƒã€æµ‹è¯•ç”Ÿäº§ç¯å¢ƒçš„å¯åŠ¨æµç¨‹ï¼ˆæ˜¯è¿è¡Œç”Ÿäº§ç¯å¢ƒä»£ç ï¼‰</li><li>ä¸ç›‘å¬æ–‡ä»¶å˜åŒ–</li></ul><p>è¿è¡Œï¼ˆå¼€å‘ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start:dev</span><br></pre></td></tr></table></figure><ul><li>çƒ­æ›´æ–°</li><li>è¯¦ç»†çš„æ—¥å¿—è¾“å‡º</li><li>å¯åŠ¨æ…¢</li></ul><p>åŠ å¿«æ„å»ºé€Ÿåº¦ï¼ˆä½¿ç”¨<em>swc</em>ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start -- -b swc</span><br></pre></td></tr></table></figure><p>æ„å»ºç”Ÿäº§ç¯å¢ƒä»£ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><ul><li>å°†tsä»£ç ç¼–è¯‘ä¸ºjsä»£ç </li><li>åç»­éƒ¨ç½²</li></ul><h1 id="æœ¯è¯­è¡¨"><a href="#æœ¯è¯­è¡¨" class="headerlink" title="æœ¯è¯­è¡¨"></a>æœ¯è¯­è¡¨</h1><ul><li><p>è£…é¥°å™¨ï¼ˆDecoratorï¼‰ï¼šä¸€ç§å‡½æ•°ï¼Œä½¿ç”¨æ—¶éœ€è¦ä»¥<code>@</code>å¼€å¤´æ”¾åœ¨éœ€è¦è£…é¥°çš„ä»£ç ä¸Šæ–¹ï¼Œæ—¨åœ¨ä¸ä¿®æ”¹ä»£ç çš„å‰æä¸‹ç»™ä»£ç æ‹“å±•åŠŸèƒ½</p></li><li><p>JWT</p></li></ul><h1 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h1><ul><li>ä¸ºä»€ä¹ˆè¯´æ˜¯é›†æˆ<em>express</em>ï¼Œå› ä¸ºä¾‹å¦‚è¯·æ±‚ã€ç›¸åº”å¯¹è±¡æ˜¯ç›¸é€šçš„</li></ul><h1 id="å­¦ä¹ æ—¥è®°"><a href="#å­¦ä¹ æ—¥è®°" class="headerlink" title="å­¦ä¹ æ—¥è®°"></a>å­¦ä¹ æ—¥è®°</h1><h2 id="D1"><a href="#D1" class="headerlink" title="D1"></a>D1</h2><ol><li>åˆ›å»ºä¸€ä¸ªæ¨¡å—</li><li>è¿æ¥æ•°æ®åº“</li><li>æ·»åŠ Swaggeræ–‡æ¡£</li><li>é”™è¯¯å¤„ç†</li></ol><h3 id="åŸºç¡€æ¨¡å—"><a href="#åŸºç¡€æ¨¡å—" class="headerlink" title="åŸºç¡€æ¨¡å—"></a>åŸºç¡€æ¨¡å—</h3><p>åˆ›å»ºä¸€ä¸ª<code>user</code>æ¨¡å—ï¼ˆç”Ÿæˆæ¨¡å—å¿…é¡»æ–‡ä»¶å’Œå¯é€‰çš„<code>.spec.ts</code>çš„æµ‹è¯•æ–‡ä»¶ï¼‰ï¼Œå¯ä½¿ç”¨<code>nest g --help</code>æŸ¥çœ‹æ›´å¤šå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nest g resource user</span><br></pre></td></tr></table></figure><ul><li>ä¸€èˆ¬é€‰æ‹©<code>REST API</code></li><li>åˆ›å»ºçš„æ¨¡å—ä¼šè‡ªåŠ¨æ›´æ–°<code>app.module.ts</code>æ–‡ä»¶</li><li>æ­¤å‘½ä»¤ä¸ä¼šåˆ›å»º<code>dto</code>æ–‡ä»¶ï¼ˆç”¨æ¥è§„èŒƒå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„æ•°æ®æ ¼å¼ï¼‰ï¼Œéœ€æ‰‹åŠ¨åˆ›å»º</li><li>æ–‡ä»¶ä¸€èˆ¬è¢«æ”¾åœ¨å¦‚<code>user/dto/create-user.dto.ts</code>è¿™é‡Œ</li></ul><p><img src="https://s21.ax1x.com/2025/03/03/pEG7a0e.png" alt="ç›®å½•ç»“æ„"></p><p>ç¼–è¾‘åçš„ä»£ç ç¤ºä¾‹ï¼š</p><p><code>user.controller.ts</code>ï¼ˆæ§åˆ¶å™¨ï¼‰æ¥æ”¶è¯·æ±‚ï¼Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ç”±<code>use.service.ts</code>æ–‡ä»¶æä¾›</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Controller</span>, <span class="title class_">Get</span>, <span class="title class_">Post</span>, <span class="title class_">Body</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./user.service&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CreateUserDto</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./dto/create-user.dto&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“å‰æ¥å£ï¼Œå¦‚ localhost:3000/user</span></span><br><span class="line"><span class="comment">// æ­¤è£…é¥°å™¨æ˜¯æ§åˆ¶å™¨å¿…é¡»çš„</span></span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> <span class="attr">userService</span>: <span class="title class_">UserService</span></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Get</span>()</span><br><span class="line">  <span class="title function_">getUsers</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">userService</span>.<span class="title function_">getUsers</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡ŒBodyè£…é¥°å™¨çš„ä½œç”¨æ˜¯ä» httpè¯·æ±‚ä½“ ä¸­æå–æ•°æ®ï¼Œå¹¶ä¸”ç»‘å®šåˆ°æ–¹æ³•çš„å‚æ•°ä¸Š</span></span><br><span class="line">  <span class="comment">// å¹¶ä¸”å¯è®²æ•°æ®ç±»å‹è‡ªåŠ¨è½¬æ¢ä¸º dto ä¸­çš„ç±»å‹</span></span><br><span class="line">  <span class="meta">@Post</span>()</span><br><span class="line">  <span class="title function_">createUser</span>(<span class="params"><span class="meta">@Body</span>() <span class="attr">createUserDto</span>: <span class="title class_">CreateUserDto</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">userService</span>.<span class="title function_">createUser</span>(createUserDto)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>use.service.ts</code>ï¼ˆæä¾›å™¨ã€æœåŠ¡ï¼‰å¤„ç†æ›´ä¸ºå¤æ‚çš„ä¸šåŠ¡éœ€æ±‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Injectable</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CreateUserDto</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./dto/create-user.dto&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤è£…é¥°å™¨æ˜¯æœåŠ¡å¿…é¡»çš„</span></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> users = [</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;å°ç™½&#x27;</span>, <span class="attr">age</span>: <span class="number">19</span> &#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getUsers</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">users</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">createUser</span>(<span class="params"><span class="attr">createUserDto</span>: <span class="title class_">CreateUserDto</span></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> newUser = &#123; <span class="attr">id</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>(), ...createUserDto &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">users</span>.<span class="title function_">push</span>(newUser)</span><br><span class="line">        <span class="keyword">return</span> newUser</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>create-user.dto.ts</code>ï¼ˆData Transfer Objectã€æ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰å¯å•ç‹¬ä½œä¸ºä¸€ä¸ªæ™®é€šdtoæ¥ä½¿ç”¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">CreateUserDto</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç»“åˆ<code>class-validator</code>ï¼ˆéœ€è¦é¢å¤–å®‰è£…ï¼‰æ¥å®ç°æ›´é«˜æ•ˆçš„éªŒè¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install class-validator class-transformer</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IsString</span>, <span class="title class_">IsEmail</span>, <span class="title class_">MinLength</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;class-validator&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">CreateUserDto</span> &#123;</span><br><span class="line">    <span class="meta">@IsString</span>()</span><br><span class="line">    <span class="meta">@MinLength</span>(<span class="number">2</span>)</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@IsEmail</span>()</span><br><span class="line">    <span class="attr">email</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿æ¥æ•°æ®åº“"><a href="#è¿æ¥æ•°æ®åº“" class="headerlink" title="è¿æ¥æ•°æ®åº“"></a>è¿æ¥æ•°æ®åº“</h3><p>ä½¿ç”¨<code>typeorm</code>è¿æ¥æ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @nestjs/typeorm</span><br></pre></td></tr></table></figure><p>åœ¨<code>app.module.ts</code>ä¸­å…¨å±€é…ç½®</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TypeOrmModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/typeorm&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [</span><br><span class="line">    <span class="title class_">UserModule</span>,</span><br><span class="line">    <span class="title class_">AuthModule</span>,</span><br><span class="line">    <span class="comment">// forRoot ç”¨äºè®¾ç½®æ¨¡å—çš„å…¨å±€é…ç½®é€‰é¡¹</span></span><br><span class="line">    <span class="title class_">TypeOrmModule</span>.<span class="title function_">forRoot</span>(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">      <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">      <span class="attr">port</span>: <span class="number">3306</span>,</span><br><span class="line">      <span class="attr">username</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">      <span class="attr">password</span>: <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">      <span class="attr">database</span>: <span class="string">&#x27;nestjs&#x27;</span>,</span><br><span class="line">      <span class="attr">entities</span>: [<span class="title class_">User</span>],</span><br><span class="line">      <span class="attr">synchronize</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">controllers</span>: [<span class="title class_">AppController</span>],</span><br><span class="line">  <span class="attr">providers</span>: [<span class="title class_">AppService</span>],</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>entities</code>åˆ›å»ºä¸€ä¸ªç”¨æˆ·è¡¨ï¼Œä¸€èˆ¬åœ¨å½“å‰æ¨¡å—ä¸‹åˆ›å»ºï¼Œå¦‚<code>user/entities/user.entity.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Entity</span>, <span class="title class_">Column</span>, <span class="title class_">PrimaryGeneratedColumn</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;typeorm&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="meta">@PrimaryGeneratedColumn</span>()</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Column</span>()</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Column</span>()</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Column</span>()</span><br><span class="line">  <span class="attr">passwd</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Column</span>(&#123; <span class="attr">default</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  <span class="attr">isActive</span>: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Column</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;timestamp&#x27;</span>, <span class="attr">default</span>: <span class="function">() =&gt;</span> <span class="string">&#x27;CURRENT_TIMESTAMP&#x27;</span> &#125;)</span><br><span class="line">  <span class="attr">createTime</span>: <span class="title class_">Date</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éšååœ¨<code>user.modules.ts</code>ä¸­å¯¼å…¥ï¼Œä¸€æ—¦å¯¼å…¥å°±ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®è¡¨ï¼ˆtypeormé…ç½®æ—¶ï¼Œ<code>synchronize</code>è®¾ä¸º<code>true</code>ï¼‰</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">User</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./entities/user.entity&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [<span class="title class_">TypeOrmModule</span>.<span class="title function_">forFeature</span>([<span class="title class_">User</span>])],</span><br><span class="line">  <span class="attr">controllers</span>: [<span class="title class_">UserController</span>],</span><br><span class="line">  <span class="attr">providers</span>: [<span class="title class_">UserService</span>],</span><br><span class="line">  <span class="attr">exports</span>: [<span class="title class_">UserService</span>],</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ¥å£åˆ›å»ºä¸€æ¡æ•°æ®ï¼ˆæ§åˆ¶å™¨ -&gt; æœåŠ¡ï¼‰ï¼Œåœ¨<code>users.service.ts</code>ä¸­é€šè¿‡<code>Repository</code>æ¥æ‰§è¡Œï¼Œå®ƒæä¾›äº†å¾ˆå¤šæ“ä½œæ•°æ®åº“çš„æ–¹æ³•ï¼ˆfind, createç­‰ï¼‰ã€‚æœ‰äº†è¿™ä¸ªï¼Œåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ä¸éœ€è¦å†™SQL</p><blockquote><p>ä»¥ä¸‹ä»£ç ä¸­ï¼Œå®é™…èµ·åˆ°ä½œç”¨çš„æ˜¯<code>InjectRepository</code>ï¼Œ<code>Repository</code>åœ¨æ­¤åªèµ·åˆ°ç±»å‹çš„ä½œç”¨</p></blockquote><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Injectable</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">InjectRepository</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/typeorm&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Repository</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;typeorm&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CreateUserDto</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./dto/create-user.dto&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">User</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./entities/user.entity&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">        <span class="meta">@InjectRepository</span>(User)</span></span><br><span class="line"><span class="params">        <span class="keyword">private</span> <span class="attr">userRepository</span>: <span class="title class_">Repository</span>&lt;<span class="title class_">User</span>&gt;,</span></span><br><span class="line"><span class="params">    </span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getUsers</span>(): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>[]&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">userRepository</span>.<span class="title function_">find</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">createUser</span>(<span class="attr">createUserDto</span>: <span class="title class_">CreateUserDto</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> user = <span class="variable language_">this</span>.<span class="property">userRepository</span>.<span class="title function_">create</span>(createUserDto);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">userRepository</span>.<span class="title function_">save</span>(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">findOne</span>(<span class="params"><span class="attr">username</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> user = <span class="variable language_">this</span>.<span class="property">userRepository</span>.<span class="title function_">findOne</span>(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: username &#125; &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ Swaggeræ–‡æ¡£"><a href="#æ·»åŠ Swaggeræ–‡æ¡£" class="headerlink" title="æ·»åŠ Swaggeræ–‡æ¡£"></a>æ·»åŠ Swaggeræ–‡æ¡£</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @nestjs/swagger</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>main.ts</code>ä»¥é…ç½®swaggerï¼Œè®¿é—®æ–‡æ¡£<code>http://localhost:3000/api</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">SwaggerModule</span>, <span class="title class_">DocumentBuilder</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/swagger&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">bootstrap</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> app = <span class="keyword">await</span> <span class="title class_">NestFactory</span>.<span class="title function_">create</span>(<span class="title class_">AppModule</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> config = <span class="keyword">new</span> <span class="title class_">DocumentBuilder</span>()</span><br><span class="line">    .<span class="title function_">setTitle</span>(<span class="string">&#x27;NestJSå­¦ä¹ &#x27;</span>)</span><br><span class="line">    .<span class="title function_">setDescription</span>(<span class="string">&#x27;NestJSå­¦ä¹ APIæ–‡æ¡£&#x27;</span>)</span><br><span class="line">    .<span class="title function_">setVersion</span>(<span class="string">&#x27;1.0&#x27;</span>)</span><br><span class="line">    .<span class="title function_">build</span>();</span><br><span class="line">  <span class="keyword">const</span> <span class="variable language_">document</span> = <span class="title class_">SwaggerModule</span>.<span class="title function_">createDocument</span>(app, config);</span><br><span class="line">  <span class="title class_">SwaggerModule</span>.<span class="title function_">setup</span>(<span class="string">&#x27;api&#x27;</span>, app, <span class="variable language_">document</span>);    <span class="comment">// api æŒ‡å®šæ–‡æ¡£çš„è®¿é—®è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> app.<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>main.ts</code>æ–‡ä»¶ä¸­ç›¸å½“äºåˆå§‹åŒ–swaggerï¼Œå…·ä½“çš„æ¥å£æè¿°å¯ä»¥ä½¿ç”¨swaggeræä¾›çš„è£…é¥°å™¨åœ¨å…·ä½“çš„æ¥å£ä¸­ä½¿ç”¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ApiTags</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/swagger&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApiTags</span>(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> <span class="attr">userService</span>: <span class="title class_">UserService</span></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Get</span>()</span><br><span class="line">  <span class="title function_">getUsers</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">userService</span>.<span class="title function_">getUsers</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h3><p>åˆ›å»ºæ–‡ä»¶<code>src/filters/http-exception.filter.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ExceptionFilter</span>, <span class="title class_">Catch</span>, <span class="title class_">ArgumentsHost</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Response</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Catch</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">HttpExceptionFilter</span> <span class="keyword">implements</span> <span class="title class_">ExceptionFilter</span> &#123;</span><br><span class="line">  <span class="keyword">catch</span>(<span class="attr">exception</span>: <span class="title class_">Error</span>, <span class="attr">host</span>: <span class="title class_">ArgumentsHost</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> ctx = host.<span class="title function_">switchToHttp</span>();</span><br><span class="line">    <span class="keyword">const</span> response = ctx.<span class="property">getResponse</span>&lt;<span class="title class_">Response</span>&gt;();</span><br><span class="line"></span><br><span class="line">    response.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;Internal Server Error&#x27;</span>,</span><br><span class="line">      <span class="attr">error</span>: exception.<span class="property">message</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>main.ts</code>ä»¥å…¨å±€æ³¨å†Œè¿‡æ»¤å™¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">useGlobalFilters</span>(<span class="keyword">new</span> <span class="title class_">HttpExceptionFilter</span>());</span><br></pre></td></tr></table></figure><h2 id="D2"><a href="#D2" class="headerlink" title="D2"></a>D2</h2><ol><li>ç”¨æˆ·è®¤è¯ï¼ˆJWTï¼‰</li><li>ä¸­é—´ä»¶å®æˆ˜ï¼ˆæ—¥å¿—çº§è”ï¼‰</li><li>ç¯å¢ƒé…ç½®</li><li>å•å…ƒæµ‹è¯•å…¥é—¨</li><li>éƒ¨ç½²ä¼˜åŒ–ï¼ˆç”Ÿäº§ç¯å¢ƒé…ç½®ï¼‰</li></ol><h3 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install @nestjs/jwt @nestjs/passport passport passport-jwt bcrypt</span><br><span class="line">npm install @types/passport-jwt @types/bcrypt --save-dev</span><br></pre></td></tr></table></figure><p>åˆ›å»ºè®¤è¯æ¨¡å—</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nest g resource auth</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2025/03/03/pEG70kd.png" alt="æˆåŠŸåˆ›å»º"></p><p>å®ç°ç”¨æˆ·æ³¨å†Œï¼ˆéœ€è¦åˆ›å»ºå’Œæ•°æ®åº“å¯¹åº”çš„entityï¼‰ï¼Œå¦‚ï¼š</p><p><code>src/user/entities/user.entity.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">username</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">password</span>: <span class="built_in">string</span> <span class="comment">// å®é™…ä¿å­˜ä¸ºå“ˆå¸Œå€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>auth.service.ts</code>å®ç°ç™»å½•ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ï¼ˆè·å–ç”¨æˆ·æ•°æ®ï¼Œå®ç°æˆåŠŸç™»å½•tokenè¿”å›ï¼‰</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Injectable</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">JwtService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/jwt&#x27;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> bcrypt <span class="keyword">from</span> <span class="string">&#x27;bcrypt&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../user/user.service&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AuthService</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="attr">userService</span>: <span class="title class_">UserService</span>,</span></span><br><span class="line"><span class="params">        <span class="keyword">private</span> <span class="attr">jwtService</span>: <span class="title class_">JwtService</span></span></span><br><span class="line"><span class="params">    </span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">validateUser</span>(<span class="attr">username</span>: <span class="built_in">string</span>, <span class="attr">pass</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">userService</span>.<span class="title function_">findOne</span>(username)</span><br><span class="line">        <span class="keyword">if</span> (user &amp;&amp; (<span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(pass, user.<span class="property">passwd</span>))) &#123;</span><br><span class="line">            <span class="comment">// è¿”å›é™¤å¯†ç å¤–çš„å…¶ä»–æ•°æ®ï¼ˆå®ç”¨çš„æ“ä½œï¼‰</span></span><br><span class="line">            <span class="keyword">const</span> &#123; passwd, ...result&#125; = user</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params"><span class="attr">user</span>: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> payload = &#123; <span class="attr">username</span>: user.<span class="property">username</span>, <span class="attr">sub</span>: user.<span class="property">id</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">access_token</span>: <span class="variable language_">this</span>.<span class="property">jwtService</span>.<span class="title function_">sign</span>(payload)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>auth.controller.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Controller</span>, <span class="title class_">Body</span>, <span class="title class_">Post</span>, <span class="title class_">UnauthorizedException</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AuthService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./auth.service&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">&#x27;auth&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AuthController</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> <span class="attr">authService</span>: <span class="title class_">AuthService</span></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// dtoä¹Ÿä¸ä¸€å®šéœ€è¦å†™åœ¨å•ç‹¬çš„æ–‡ä»¶ï¼Œè¡Œå†…ä¹Ÿå¯ä»¥</span></span><br><span class="line">  <span class="meta">@Post</span>(<span class="string">&#x27;login&#x27;</span>)</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params"><span class="meta">@Body</span>() <span class="attr">loginDto</span>: &#123; username: <span class="built_in">string</span>; password: <span class="built_in">string</span> &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">authService</span>.<span class="title function_">validateUser</span>(loginDto.<span class="property">username</span>, loginDto.<span class="property">password</span>)</span><br><span class="line">    <span class="keyword">if</span> (!user) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnauthorizedException</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">authService</span>.<span class="title function_">login</span>(user)    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>auth.module.ts</code>æ–‡ä»¶é…ç½®JWTæ¨¡å—</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">JwtModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/jwt&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [</span><br><span class="line">    <span class="title class_">JwtModule</span>.<span class="title function_">register</span>(&#123;</span><br><span class="line">      <span class="attr">secret</span>: <span class="string">&#x27;your_secret_key&#x27;</span>,</span><br><span class="line">      <span class="attr">signOptions</span>: &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;1h&#x27;</span> &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">providers</span>: [<span class="title class_">AuthService</span>],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AuthModule</span> &#123;&#125;</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬ä¹Ÿæ˜¯ä½¿ç”¨ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">JwtModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/jwt&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ConfigModule</span>, <span class="title class_">ConfigService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/config&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [</span><br><span class="line">    <span class="title class_">JwtModule</span>.<span class="title function_">registerAsync</span>(&#123;</span><br><span class="line">      <span class="attr">imports</span>: [<span class="title class_">ConfigModule</span>],</span><br><span class="line">      <span class="attr">inject</span>: [<span class="title class_">ConfigService</span>],</span><br><span class="line">      <span class="attr">useFactory</span>: <span class="function">(<span class="params"><span class="attr">config</span>: <span class="title class_">ConfigService</span></span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">secret</span>: config.<span class="title function_">get</span>(<span class="string">&quot;JWT_SECRET&quot;</span>),</span><br><span class="line">        <span class="attr">signOptions</span>: &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;1h&#x27;</span> &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">providers</span>: [<span class="title class_">AuthService</span>],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AuthModule</span> &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h3><p>ä¸­é—´ä»¶ä¸€èˆ¬ä¼šä¿å­˜åˆ°å¦‚ï¼š</p><p><code>src/middleware/logger.middleware.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Injectable</span>, <span class="title class_">NestMiddleware</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Request</span>, <span class="title class_">Response</span>, <span class="title class_">NextFunction</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">LoggerMiddleware</span> <span class="keyword">implements</span> <span class="title class_">NestMiddleware</span> &#123;</span><br><span class="line">  <span class="title function_">use</span>(<span class="params"><span class="attr">req</span>: <span class="title class_">Request</span>, <span class="attr">res</span>: <span class="title class_">Response</span>, <span class="attr">next</span>: <span class="title class_">NextFunction</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toISOString()&#125;</span>] <span class="subst">$&#123;req.method&#125;</span> <span class="subst">$&#123;req.url&#125;</span>`</span>);</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>app.module.ts</code>ä¸­å…¨å±€åº”ç”¨ä¸­é—´ä»¶</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;  <span class="title class_">NestModule</span>, <span class="title class_">MiddlewareConsumer</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LoggerMiddleWare</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./middleware/logger.middleware&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AppModule</span> <span class="keyword">implements</span> <span class="title class_">NestModule</span> &#123;</span><br><span class="line">  <span class="title function_">configure</span>(<span class="params"><span class="attr">consumer</span>: <span class="title class_">MiddlewareConsumer</span></span>) &#123;</span><br><span class="line">    consumer</span><br><span class="line">      .<span class="title function_">apply</span>(<span class="title class_">LoggerMiddleWare</span>)</span><br><span class="line">      .<span class="title function_">forRoutes</span>(<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h3><blockquote><p>é€šè¿‡<code>.env</code>æ–‡ä»¶æ¥åŒºåˆ†ä¸åŒç¯å¢ƒ</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @nestjs/config</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>app.module.ts</code>è¿›è¡Œé…ç½®</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Module</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ConfigModule</span>, <span class="title class_">ConfigService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/config&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TypeOrmModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/typeorm&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppController</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./app.controller&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./app.service&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./user/user.module&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AuthModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./auth/auth.module&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥ä¸‹é…ç½®ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ process.env.xx æ¥è·å–</span></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [</span><br><span class="line">    <span class="title class_">UserModule</span>, </span><br><span class="line">    <span class="title class_">AuthModule</span>, </span><br><span class="line">    <span class="title class_">ConfigModule</span>.<span class="title function_">forRoot</span>(&#123;</span><br><span class="line">      <span class="attr">isGlobal</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">envFilePath</span>: <span class="string">`.env.<span class="subst">$&#123;process.env.NODE_ENV || <span class="string">&#x27;development&#x27;</span>&#125;</span>`</span></span><br><span class="line">    &#125;)ï¼Œ</span><br><span class="line">    <span class="title class_">TypeOrmModule</span>.<span class="title function_">forRootAsync</span>(&#123;</span><br><span class="line">      <span class="attr">imports</span>: [<span class="title class_">ConfigModule</span>],</span><br><span class="line">      <span class="attr">inject</span>: [<span class="title class_">ConfigService</span>],</span><br><span class="line">      <span class="attr">useFactory</span>: <span class="function">(<span class="params"><span class="attr">config</span>: <span class="title class_">ConfigService</span></span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">        <span class="attr">host</span>: config.<span class="title function_">get</span>(<span class="string">&#x27;DB_HOST&#x27;</span>),</span><br><span class="line">        <span class="attr">port</span>: <span class="title class_">Number</span>(config.<span class="title function_">get</span>(<span class="string">&#x27;DB_PORT&#x27;</span>)),</span><br><span class="line">        <span class="attr">username</span>: config.<span class="title function_">get</span>(<span class="string">&#x27;DB_USER&#x27;</span>),</span><br><span class="line">        <span class="attr">password</span>: config.<span class="title function_">get</span>(<span class="string">&#x27;DB_PASSWORD&#x27;</span>),</span><br><span class="line">        <span class="attr">database</span>: config.<span class="title function_">get</span>(<span class="string">&#x27;DB_DATABASE&#x27;</span>),</span><br><span class="line">        <span class="attr">entities</span>: [<span class="title class_">User</span>],</span><br><span class="line">        <span class="attr">synchronize</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">controllers</span>: [<span class="title class_">AppController</span>],</span><br><span class="line">  <span class="attr">providers</span>: [<span class="title class_">AppService</span>],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AppModule</span> &#123;&#125;</span><br></pre></td></tr></table></figure><ul><li>å¤šæ•°æ”¯æŒåŠ¨æ€é…ç½®çš„éƒ½ä¼š<code>useFactory</code>æœ‰è¿™ä¸ªæ–¹æ³•</li></ul><p>æœ¬åœ°åˆ›å»ºä¸¤ä¸ªä¸åŒçš„ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š<code>.env.development</code> å’Œ <code>.env.production</code>ï¼Œå°½é‡ç¡®ä¿æ–‡ä»¶åå’Œ<code>NODE_ENV</code>çš„å€¼å¯¹åº”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># .env.development</span><br><span class="line">NODE_ENV=development</span><br><span class="line">DATABASE_URL=sqlite:./dev.db</span><br><span class="line">JWT_SECRET=development_secret</span><br><span class="line"></span><br><span class="line"># .env.production</span><br><span class="line">NODE_ENV=production</span><br><span class="line">DATABASE_URL=mysql://user:password@localhost:3306/prod_db</span><br><span class="line">JWT_SECRET=production_secret</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™æŒ‡å®šç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;start:dev&quot;: &quot;NODE_ENV=development nest start --watch&quot;</span><br></pre></td></tr></table></figure><h3 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><blockquote><p>å•å…ƒæµ‹è¯•æ–‡ä»¶åœ¨è¿è¡Œ<code>nest g resource xx</code>çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œä¹Ÿå¯æ‰‹åŠ¨åˆ›å»º</p></blockquote><p>ä¾‹å¦‚æµ‹è¯•<code>UserService</code>ï¼Œä¿®æ”¹<code>user.service.spec.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Test</span>, <span class="title class_">TestingModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/testing&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./user.service&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;UserService&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">service</span>: <span class="title class_">UserService</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">module</span>: <span class="title class_">TestingModule</span> = <span class="keyword">await</span> <span class="title class_">Test</span>.<span class="title function_">createTestingModule</span>(&#123;</span><br><span class="line">      <span class="attr">providers</span>: [<span class="title class_">UserService</span>],</span><br><span class="line">    &#125;).<span class="title function_">compile</span>();</span><br><span class="line"></span><br><span class="line">    service = <span class="variable language_">module</span>.<span class="property">get</span>&lt;<span class="title class_">UserService</span>&gt;(<span class="title class_">UserService</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should be defined&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(service).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;show return users&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(service.<span class="title function_">getUsers</span>()).<span class="title function_">toEqual</span>([</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>, <span class="attr">passwd</span>: <span class="string">&#x27;123&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;å°ç™½&#x27;</span>, <span class="attr">age</span>: <span class="number">19</span>, <span class="attr">passwd</span>: <span class="string">&#x27;123&#x27;</span> &#125;</span><br><span class="line">    ])</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿è¡Œæµ‹è¯•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run test</span><br></pre></td></tr></table></figure><h3 id="éƒ¨ç½²ä¼˜åŒ–"><a href="#éƒ¨ç½²ä¼˜åŒ–" class="headerlink" title="éƒ¨ç½²ä¼˜åŒ–"></a>éƒ¨ç½²ä¼˜åŒ–</h3><p>è¿è¡Œ<code>npm run start</code>çš„æ—¶å€™å·²ç»æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥æ‰“åŒ…ä¹‹åå†éƒ¨ç½²ï¼ˆå¯ä½¿ç”¨<em>swc</em>ã€<em>pm2</em>ç­‰è¿›è¡Œæ‰“åŒ…ï¼‰</p><p>å®‰è£…swc</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @swc/cli @swc/core</span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º<code>.swc</code>æ–‡ä»¶ï¼Œå¹¶ä¸”æ·»åŠ æ‰“åŒ…å‘½ä»¤åˆ° npm-scriptï¼Œå¦‚<code>&quot;build&quot;: &quot;swc src -d dist&quot;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;jsc&quot;: &#123;</span><br><span class="line">    &quot;parser&quot;: &#123;</span><br><span class="line">      &quot;syntax&quot;: &quot;typescript&quot;,</span><br><span class="line">      &quot;tsx&quot;: false,</span><br><span class="line">      &quot;decorators&quot;: true,</span><br><span class="line">      &quot;dynamicImport&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;target&quot;: &quot;es2020&quot;,</span><br><span class="line">    &quot;keepClassNames&quot;: true,</span><br><span class="line">    &quot;transform&quot;: &#123;</span><br><span class="line">      &quot;legacyDecorator&quot;: true,</span><br><span class="line">      &quot;decoratorMetadata&quot;: true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;module&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;commonjs&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨dockerè¿›è¡Œå®¹å™¨éƒ¨ç½²ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º<code>Dockerfile</code>æ–‡ä»¶ï¼ˆå¿…é¡»å¤§å†™å¼€å¤´ï¼‰</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ Node.js å®˜æ–¹é•œåƒ</span></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶ package.json å’Œ package-lock.json</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package*.json ./</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…ä¾èµ–</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm install --production</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶æºä»£ç </span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºåº”ç”¨</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm run build</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ²ç«¯å£</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">3000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨åº”ç”¨</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;node&quot;</span>, <span class="string">&quot;dist/main.js&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>æ„å»ºé•œåƒå’Œè¿è¡Œå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ„å»º Docker é•œåƒ</span></span><br><span class="line">docker build -t my-nest-app .</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿è¡Œ Docker å®¹å™¨</span></span><br><span class="line">docker run -p 3000:3000 my-nest-app</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨nginxè¿›è¡Œåå‘ä»£ç†ï¼ˆå¤„ç†è·¨åŸŸçš„å¥½æ–¹æ³•ï¼‰ï¼Œå½“è®¿é—®<code>yourdomain.com/api</code>æ—¶ä»£ç†åˆ°æœ¬åœ°çš„<code>3000</code>ç«¯å£</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> yourdomain.com;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> /api &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://localhost:3000;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D3"><a href="#D3" class="headerlink" title="D3"></a>D3</h2><ol><li>æƒé™å®ˆå«</li><li>æ–‡ä»¶ä¸Šä¼ ä¸é™æ€èµ„æºæ‰˜ç®¡</li><li>WebSocketå®æ—¶é€šä¿¡</li></ol><h3 id="æƒé™å®ˆå«"><a href="#æƒé™å®ˆå«" class="headerlink" title="æƒé™å®ˆå«"></a>æƒé™å®ˆå«</h3><p>åˆ›å»ºè§’è‰²è£…é¥°å™¨ï¼Œæ–°å»ºæ–‡ä»¶<code>src/auth/roles.decorator.ts</code>ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">SetMetadata</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Roles</span> = (<span class="params">...<span class="attr">roles</span>: <span class="built_in">string</span>[]</span>) =&gt; <span class="title class_">SetMetadata</span>(<span class="string">&#x27;roles&#x27;</span>, roles);</span><br></pre></td></tr></table></figure><p>å®ç°å®ˆå«ï¼Œæ–°å»ºæ–‡ä»¶<code>src/auth/roles.guard.ts</code>ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Injectable</span>, <span class="title class_">CanActivate</span>, <span class="title class_">ExecutionContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Reflector</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/core&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">RolesGuard</span> <span class="keyword">implements</span> <span class="title class_">CanActivate</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="attr">reflector</span>: <span class="title class_">Reflector</span></span>) &#123;&#125;</span><br><span class="line">  <span class="title function_">canActivate</span>(<span class="attr">context</span>: <span class="title class_">ExecutionContext</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–æ¥å£æ‰€éœ€çš„è§’è‰²</span></span><br><span class="line">    <span class="keyword">const</span> requiredRoles = <span class="variable language_">this</span>.<span class="property">reflector</span>.<span class="property">get</span>&lt;<span class="built_in">string</span>[]&gt;(</span><br><span class="line">      <span class="string">&#x27;roles&#x27;</span>,</span><br><span class="line">      context.<span class="title function_">getHandler</span>(),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">if</span> (!requiredRoles) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿä»è¯·æ±‚ä¸­è·å–ç”¨æˆ·è§’è‰²ï¼ˆå®é™…åº”ä» JWT è§£æï¼‰</span></span><br><span class="line">    <span class="keyword">const</span> request = context.<span class="title function_">switchToHttp</span>().<span class="title function_">getRequest</span>();</span><br><span class="line">    <span class="keyword">const</span> user = request.<span class="property">user</span>; <span class="comment">// å‡è®¾ user å·²é€šè¿‡ JWT ä¸­é—´ä»¶æ³¨å…¥</span></span><br><span class="line">    <span class="keyword">return</span> requiredRoles.<span class="title function_">some</span>(<span class="function">(<span class="params">role</span>) =&gt;</span> user.<span class="property">roles</span>?.<span class="title function_">includes</span>(role));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨å®ˆå«ï¼Œå¦‚:</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/users/users.controller.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Roles</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../auth/roles.decorator&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">RolesGuard</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../auth/roles.guard&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">&#x27;users&#x27;</span>)</span><br><span class="line"><span class="meta">@UseGuards</span>(<span class="title class_">RolesGuard</span>) <span class="comment">// å…¨å±€åº”ç”¨å®ˆå«ï¼Œæˆ–åœ¨æ¨¡å—ä¸­å…¨å±€æ³¨å†Œ</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">  <span class="meta">@Get</span>(<span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">  <span class="meta">@Roles</span>(<span class="string">&#x27;admin&#x27;</span>) <span class="comment">// ä»…å…è®¸ admin è§’è‰²è®¿é—®</span></span><br><span class="line">  <span class="title function_">getAdminData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">&#x27;Admin data&#x27;</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–‡ä»¶ä¸Šä¼ ä¸é™æ€èµ„æºæ‰˜ç®¡"><a href="#æ–‡ä»¶ä¸Šä¼ ä¸é™æ€èµ„æºæ‰˜ç®¡" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ä¸é™æ€èµ„æºæ‰˜ç®¡"></a>æ–‡ä»¶ä¸Šä¼ ä¸é™æ€èµ„æºæ‰˜ç®¡</h3><h4 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h4><p>éœ€è¦å¤–å®‰è£…ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @nestjs/platform-express multer</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @types/multer --save-dev</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–‡ä»¶ä¸Šä¼ æ§åˆ¶å™¨ï¼š<code>src/files/files.controller.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Controller</span>, <span class="title class_">Post</span>, <span class="title class_">UseInterceptors</span>, <span class="title class_">UploadedFile</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">FileInterceptor</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/platform-express&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; diskStorage &#125; <span class="keyword">from</span> <span class="string">&#x27;multer&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; extname &#125; <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">&#x27;files&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">FilesController</span> &#123;</span><br><span class="line">  <span class="meta">@Post</span>(<span class="string">&#x27;upload&#x27;</span>)</span><br><span class="line">  <span class="meta">@UseInterceptors</span>(<span class="title class_">FileInterceptor</span>(<span class="string">&#x27;file&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">storage</span>: <span class="title function_">diskStorage</span>(&#123;</span><br><span class="line">      <span class="attr">destination</span>: <span class="string">&#x27;./uploads&#x27;</span>,</span><br><span class="line">      <span class="attr">filename</span>: <span class="function">(<span class="params">req, file, callback</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> randomName = <span class="title class_">Array</span>(<span class="number">32</span>).<span class="title function_">fill</span>(<span class="literal">null</span>).<span class="title function_">map</span>(<span class="function">() =&gt;</span> <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">16</span>).<span class="title function_">toString</span>(<span class="number">16</span>)).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="title function_">callback</span>(<span class="literal">null</span>, <span class="string">`<span class="subst">$&#123;randomName&#125;</span><span class="subst">$&#123;extname(file.originalname)&#125;</span>`</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;))</span><br><span class="line">  <span class="title function_">uploadFile</span>(<span class="params"><span class="meta">@UploadedFile</span>() <span class="attr">file</span>: <span class="title class_">Express</span>.<span class="title class_">Multer</span>.<span class="title class_">File</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">`/static/<span class="subst">$&#123;file.filename&#125;</span>`</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>FileInterceptor</code>ï¼šæ–‡ä»¶ä¸Šä¼ æ‹¦æˆªå™¨ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶å­—æ®µåï¼ˆ<code>formData</code>ä¸­çš„é”®åï¼‰</li></ul><p>æ‰˜ç®¡é™æ€æ–‡ä»¶ï¼Œåœ¨<code>main.ts</code>ä¸­é…ç½®</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NestFactory</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/core&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./app.module&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; join &#125; <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">bootstrap</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> app = <span class="keyword">await</span> <span class="title class_">NestFactory</span>.<span class="title function_">create</span>(<span class="title class_">AppModule</span>);</span><br><span class="line">  <span class="comment">// é™æ€æ–‡ä»¶æ‰˜ç®¡, ä¸€èˆ¬ä¼šæŒ‡å®šåˆ°éæºç ç›®å½•</span></span><br><span class="line">  app.<span class="title function_">use</span>(<span class="string">&#x27;/static&#x27;</span>, express.<span class="title function_">static</span>(<span class="title function_">join</span>(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;uploads&#x27;</span>)));</span><br><span class="line">  <span class="keyword">await</span> app.<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">bootstrap</span>();</span><br></pre></td></tr></table></figure><h4 id="é™æ€èµ„æºæ‰˜ç®¡"><a href="#é™æ€èµ„æºæ‰˜ç®¡" class="headerlink" title="é™æ€èµ„æºæ‰˜ç®¡"></a>é™æ€èµ„æºæ‰˜ç®¡</h4><p>é™¤äº†ä¸Šé¢çš„æ–¹å¼å¤–ï¼Œå¸¸ç”¨çš„å¤„ç†æ–¹æ³•è¿˜æœ‰</p><ul><li>ä½¿ç”¨ nginx ä½œä¸ºé™æ€æ–‡ä»¶æœåŠ¡å™¨</li><li>ä½¿ç”¨ CDN æœåŠ¡ï¼ˆé˜¿é‡Œäº‘OOS + CDNã€è…¾è®¯äº‘COS + CDNï¼‰</li><li>nestjs è‡ªå¸¦çš„<code>ServeStaticModule</code>æ¨¡å—</li></ul><p>åœ¨ nginx ä¸­é…ç½®ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> yourdomain.com;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> /static/ &#123;</span><br><span class="line">        <span class="attribute">alias</span> /var/www/static/; <span class="comment"># é™æ€èµ„æºç›®å½•</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://localhost:3000; <span class="comment"># åå‘ä»£ç†åˆ° NestJS åº”ç”¨</span></span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>ServeStaticModule</code>ï¼Œé¢„å…ˆå®‰è£…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @nestjs/serve-static</span><br></pre></td></tr></table></figure><p>åœ¨<code>app.module.ts</code>ä¸­é…ç½®:</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/app.module.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Module</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ServeStaticModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/serve-static&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; join &#125; <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [</span><br><span class="line">    <span class="title class_">ServeStaticModule</span>.<span class="title function_">forRoot</span>(&#123;</span><br><span class="line">      <span class="attr">rootPath</span>: <span class="string">&#x27;/var/www/static&#x27;</span>, <span class="comment">// é™æ€èµ„æºç›®å½•</span></span><br><span class="line">      <span class="attr">serveRoot</span>: <span class="string">&#x27;/static&#x27;</span>, <span class="comment">// è®¿é—®è·¯å¾„</span></span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AppModule</span> &#123;&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸ—¨ï¸ é—®ä¸€ä¸‹DeepSeekä»Šå¤©è¦å­¦ä»€ä¹ˆ&lt;/p&gt;</summary>
    
    
    
    <category term="åç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="js" scheme="https://smalljerry.cn/tags/js/"/>
    
    <category term="mysql" scheme="https://smalljerry.cn/tags/mysql/"/>
    
    <category term="ts" scheme="https://smalljerry.cn/tags/ts/"/>
    
  </entry>
  
  <entry>
    <title>Vue Propsç¯‡</title>
    <link href="https://smalljerry.cn/2023/10/17/Vue-Props%E7%AF%87/"/>
    <id>https://smalljerry.cn/2023/10/17/Vue-Props%E7%AF%87/</id>
    <published>2023-10-17T14:09:45.000Z</published>
    <updated>2025-02-22T02:14:47.345Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸŒ¤ï¸ Vue3</p><span id="more"></span><p>ç›¸æ¯”äºç»„ä»¶å†…çš„çŠ¶æ€ <code>ref</code> å’Œ <code>reactive</code>ï¼Œ<code>props</code> ç”¨æ¥åœ¨ç»„ä»¶ä¹‹é—´ä¼ å€¼ï¼ˆçˆ¶ç»„ä»¶ -&gt; å­ç»„ä»¶ï¼‰</p><h1 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h1><p>â—â— <code>defineProps()</code>å®ä¸­çš„å‚æ•°<strong>ä¸å¯è®¿é—®</strong><code>&lt;script setup&gt;</code>ä¸­å®šä¹‰çš„å…¶ä»–å˜é‡ï¼Œå› ä¸ºåœ¨ç¼–è¯‘æ—¶æ•´ä¸ªè¡¨è¾¾å¼éƒ½ä¼šè¢«ç§»åˆ°å¤–éƒ¨çš„å‡½æ•°ä¸­ã€‚</p><h2 id="æ™®é€š"><a href="#æ™®é€š" class="headerlink" title="æ™®é€š"></a>æ™®é€š</h2><p>ğŸ‡ åœ¨å•æ–‡ä»¶ç»„ä»¶çš„<code>&lt;script setup&gt;</code>ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">// å•çº¯çš„å£°æ˜</span><br><span class="line">const props = defineProps([&quot;foo&quot;]);</span><br><span class="line">console.log(props.foo);</span><br><span class="line"></span><br><span class="line">// å£°æ˜æ—¶æŒ‡å®šå¯¹åº”ç±»å‹çš„ æ„é€ å‡½æ•°</span><br><span class="line">const props2 = defineProps(&#123;</span><br><span class="line">  title: &#123; type: String, required: true &#125;,</span><br><span class="line">  likes: Number,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">props2.title; // string</span><br><span class="line">props2.likes; // number | undefined</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœåªåœ¨æ¨¡æ¿ï¼ˆ<code>&lt;template&gt;</code>ï¼‰ä¸­ä½¿ç”¨ï¼Œå¯ä¸ç”¨å£°æ˜å˜é‡<code>props</code>ï¼Œå¯ç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨<code>foo</code></li></ul><blockquote><p>å¤§å†™<code>String</code>å’Œå°å†™<code>string</code>ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼›å¤§å†™æ˜¯ JavaScript ä¸­çš„<strong>æ„é€ å‡½æ•°</strong>ï¼Œå°å†™ç”¨åœ¨ TypeScriptï¼Œæ˜¯å­—ç¬¦ä¸²ç±»å‹</p></blockquote><hr><p>ğŸ‡ å¦‚æœæ²¡æœ‰ä½¿ç”¨<code>&lt;script setup&gt;</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: [<span class="string">&quot;foo&quot;</span>],</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="comment">// setup() æ¥æ”¶ props ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(props.<span class="property">foo</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ğŸ‡ æˆ–è€…åœ¨<code>JSX</code>è¯­æ³•ä¸­</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">  <span class="attr">props</span>: &#123; <span class="attr">msg</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125; &#125;,</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"><span class="attr">props</span>: &#123; msg: <span class="built_in">string</span> &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&#123;</span>&quot;<span class="attr">error-tips</span>&quot;&#125;&gt;</span>&#123;props.msg&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="TS-ä¸­"><a href="#TS-ä¸­" class="headerlink" title="TS ä¸­"></a>TS ä¸­</h2><p>ğŸª„ ä¸Šé¢ä½¿ç”¨æ„é€ å‡½æ•°å£°æ˜ props çš„å«åš<em>è¿è¡Œæ—¶å£°æ˜</em>ï¼Œæ¥ä¸‹æ¥ç”¨ä½œæ³›å‹ä¼ é€’ç»™<code>&lt;&gt;</code>çš„æ–¹å¼å«åš<em>åŸºäºç±»å‹çš„å£°æ˜</em></p><ul><li>ä¸¤ç§æ–¹å¼ä¸èƒ½åŒæ—¶ä½¿ç”¨</li></ul><hr><p>å°±åƒåˆ›å»ºæ¥å£å¯¹è±¡ä¸€æ ·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">  title: string;</span><br><span class="line">  likes?: number;</span><br><span class="line">&#125;&gt;();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥æå–æˆ<code>interface</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Props</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">likes</span>?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">definedProps&lt;<span class="title class_">Props</span>&gt;();</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ‡ å¤šè¡Œä¹¦å†™æ—¶<code>;</code>å¯çœç•¥ã€‚ç”±äºé™åˆ¶ï¼Œå½“å‰æ¡ä»¶ç±»å‹ä»…å¯æŒ‡å®šå•ä¸ªå±æ€§ï¼Œä¸èƒ½æŒ‡å®šæ•´ä¸ª props å¯¹è±¡</p></blockquote><h1 id="æ ¡éªŒ"><a href="#æ ¡éªŒ" class="headerlink" title="æ ¡éªŒ"></a>æ ¡éªŒ</h1><p>æ™®é€šæ¨¡å¼ä¸­ï¼Œæ£€éªŒä¸æ˜¯å¿…é¡»çš„ï¼Œä¸è¿›è¡Œæ ¡éªŒçš„è¯ç›´æ¥ä¼ é€’<em>å­—ç¬¦ä¸²æ•°ç»„</em>å°±è¡Œï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">defineProps</span>([<span class="string">&quot;name&quot;</span>, <span class="string">&quot;age&quot;</span>, <span class="string">&quot;isShow&quot;</span>]);</span><br></pre></td></tr></table></figure><h2 id="æ™®é€š-1"><a href="#æ™®é€š-1" class="headerlink" title="æ™®é€š"></a>æ™®é€š</h2><ul><li><code>type</code>æŒ‡å®š<code>props</code>ç±»å‹</li><li><code>required</code>ä¸º<code>true</code>æŒ‡å®šä¸ºå¿…ä¼  propsï¼Œ<code>false</code>ä»£è¡¨é»˜è®¤å¯é€‰</li><li><code>default</code>æŒ‡å®šé»˜è®¤å€¼</li></ul><p>ä½¿ç”¨<code>type</code>æŒ‡å®šç±»å‹ï¼Œè¿™äº›ç±»å‹æ—¶åŸç”Ÿ JavaScript çš„æ„é€ å‡½æ•°ï¼š</p><table><thead><tr><th>ğŸŒ¸</th><th>ğŸŒº</th><th>ğŸµï¸</th><th>ğŸª·</th></tr></thead><tbody><tr><td>String</td><td>Number</td><td>Boolean</td><td>Array</td></tr><tr><td>Object</td><td>Date</td><td>Function</td><td>Symbol</td></tr></tbody></table><p>``</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰ç±»æˆ–è€…æ„é€ å‡½æ•°æ¥ç”¨ä½œ props çš„ç±»å‹ï¼ŒVue ä¼šé€šè¿‡<code>instanceof</code>æ¥æ£€æŸ¥ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">firstName, lastName</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">firstName</span> = firstName;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastName</span> = lastName;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">author</span>: <span class="title class_">Person</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>Vue æ ¡éªŒçš„æ—¶å€™ä¼šä½¿ç”¨åˆ°<code>instanceof Person</code></li></ul><hr><p>æ ¡éªŒé€‰é¡¹å‚è€ƒï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="comment">// åŸºç¡€ç±»å‹æ£€æŸ¥</span></span><br><span class="line">  <span class="comment">// ï¼ˆç»™å‡º `null` å’Œ `undefined` å€¼åˆ™ä¼šè·³è¿‡ä»»ä½•ç±»å‹æ£€æŸ¥ï¼‰</span></span><br><span class="line">  <span class="attr">propA</span>: <span class="title class_">Number</span>,</span><br><span class="line">  <span class="comment">// å¤šç§å¯èƒ½çš„ç±»å‹</span></span><br><span class="line">  <span class="attr">propB</span>: [<span class="title class_">String</span>, <span class="title class_">Number</span>],</span><br><span class="line">  <span class="comment">// å¿…ä¼ ï¼Œä¸”ä¸º String ç±»å‹</span></span><br><span class="line">  <span class="attr">propC</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// Number ç±»å‹çš„é»˜è®¤å€¼</span></span><br><span class="line">  <span class="attr">propD</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">default</span>: <span class="number">100</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å¯¹è±¡ç±»å‹çš„é»˜è®¤å€¼</span></span><br><span class="line">  <span class="attr">propE</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Object</span>,</span><br><span class="line">    <span class="comment">// å¯¹è±¡æˆ–æ•°ç»„çš„é»˜è®¤å€¼</span></span><br><span class="line">    <span class="comment">// å¿…é¡»ä»ä¸€ä¸ªå·¥å‚å‡½æ•°è¿”å›ã€‚</span></span><br><span class="line">    <span class="comment">// è¯¥å‡½æ•°æ¥æ”¶ç»„ä»¶æ‰€æ¥æ”¶åˆ°çš„åŸå§‹ prop ä½œä¸ºå‚æ•°ã€‚</span></span><br><span class="line">    <span class="title function_">default</span>(<span class="params">rawProps</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">&quot;hello&quot;</span> &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰ç±»å‹æ ¡éªŒå‡½æ•°</span></span><br><span class="line">  <span class="attr">propF</span>: &#123;</span><br><span class="line">    <span class="title function_">validator</span>(<span class="params">value</span>) &#123;</span><br><span class="line">      <span class="comment">// The value must match one of these strings</span></span><br><span class="line">      <span class="keyword">return</span> [<span class="string">&quot;success&quot;</span>, <span class="string">&quot;warning&quot;</span>, <span class="string">&quot;danger&quot;</span>].<span class="title function_">includes</span>(value);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å‡½æ•°ç±»å‹çš„é»˜è®¤å€¼</span></span><br><span class="line">  <span class="attr">propG</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Function</span>,</span><br><span class="line">    <span class="comment">// ä¸åƒå¯¹è±¡æˆ–æ•°ç»„çš„é»˜è®¤ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ª</span></span><br><span class="line">    <span class="comment">// å·¥å‚å‡½æ•°ã€‚è¿™ä¼šæ˜¯ä¸€ä¸ªç”¨æ¥ä½œä¸ºé»˜è®¤å€¼çš„å‡½æ•°</span></span><br><span class="line">    <span class="title function_">default</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;Default function&quot;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="TS"><a href="#TS" class="headerlink" title="TS"></a>TS</h2><p>ä½¿ç”¨åˆ°äº† TypeScript å°±è¯´æ˜æ˜¯åœ¨æ ¡éªŒäº†ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">defineProps&lt;&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="built_in">string</span>; <span class="comment">// å­—ç¬¦ä¸²ç±»å‹</span></span><br><span class="line">  <span class="attr">bar</span>?: <span class="built_in">number</span>; <span class="comment">// å¯é€‰</span></span><br><span class="line">&#125;&gt;();</span><br></pre></td></tr></table></figure><p>é»˜è®¤å€¼ï¼šéœ€è¦ä½¿ç”¨<code>withDefaults</code>ç¼–è¯‘å®</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Props</span> &#123;</span><br><span class="line">  <span class="attr">msg</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">labels</span>?: <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> props = <span class="title function_">withDefaults</span>(defineProps&lt;<span class="title class_">Props</span>&gt;(), &#123;</span><br><span class="line">  <span class="attr">msg</span>: <span class="string">&quot;hello&quot;</span>,</span><br><span class="line">  <span class="attr">labels</span>: <span class="function">() =&gt;</span> [<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="åœ¨é-lt-script-setup-gt-çš„æƒ…å†µä¸‹"><a href="#åœ¨é-lt-script-setup-gt-çš„æƒ…å†µä¸‹" class="headerlink" title="åœ¨é&lt;script setup&gt;çš„æƒ…å†µä¸‹"></a>åœ¨é<code>&lt;script setup&gt;</code>çš„æƒ…å†µä¸‹</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="title class_">String</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// setupçš„propså‚æ•°ä¼šä»ä¸Šé¢æ¨æ–­ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ä¸ç”¨æŒ‡å®šç±»å‹</span></span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    props.<span class="property">message</span>; <span class="comment">// &lt;-- ç±»å‹ï¼šstring</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="å¤æ‚çš„-props-ç±»å‹"><a href="#å¤æ‚çš„-props-ç±»å‹" class="headerlink" title="å¤æ‚çš„ props ç±»å‹"></a>å¤æ‚çš„ props ç±»å‹</h3><p>ğŸ¤” åˆšæ¥è§¦çš„æ—¶å€™è¿˜æŒºå®¹æ˜“æ··æ·†</p><p>ç®€å•çš„æƒ…å†µï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">interface Book &#123;</span><br><span class="line">  title: string;</span><br><span class="line">  author: string;</span><br><span class="line">  year: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;Book&gt;();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>props å°†ä¼šæœ‰ title,author,year</li></ul><p>å¤æ‚çš„æƒ…å†µï¼Œå®åˆ™æ˜¯<strong>å†åµŒå¥—</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">interface Book &#123;</span><br><span class="line">  title: string;</span><br><span class="line">  author: string;</span><br><span class="line">  year: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;&#123;</span><br><span class="line">  book: Book;</span><br><span class="line">&#125;&gt;();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>ç°åœ¨æ˜¯ props åªæœ‰ book ä¸€ä¸ªï¼Œç„¶å book ä¸‹é¢æ‰æœ‰è¿™ä¸‰ä¸ªå±æ€§</li></ul><h2 id="å³æ™®é€šåˆ-TS"><a href="#å³æ™®é€šåˆ-TS" class="headerlink" title="å³æ™®é€šåˆ TS"></a>å³æ™®é€šåˆ TS</h2><p>æƒ³ç”¨ä¸€å®šçš„ TypeScript ç±»å‹æ£€æŸ¥ï¼Œä½†æ˜¯åˆä¸æƒ³ä¼ é€’èŒƒå¼ï¼ˆ<code>&lt;T&gt;</code>ï¼‰ï¼Œä¼šè¿™æ ·ä½¿ç”¨ã€‚é€šå¸¸åœ¨åœ¨<em>Options API</em>ä¸­å‡ºç°</p><p>éœ€è¦å¯¼å…¥<strong>å·¥å…·ç±»å‹</strong><code>PropType</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">PropType</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">book</span>: <span class="title class_">Object</span> <span class="keyword">as</span> <span class="title class_">PropType</span>&lt;<span class="title class_">Book</span>&gt;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>ğŸ‡ åœ¨<code>&lt;script&gt;</code>ä¸­ä½¿ç”¨çš„æ—¶å€™æ¨è camelCase çš„å‘½åæ–¹å¼ï¼›åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨çš„æ—¶å€™æ¨è kebab-case çš„å½¢å¼</p><p>ä¼ é€’ propsï¼ˆçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å€¼ï¼‰ï¼š</p><ul><li>åŠ¨æ€ç»‘å®šå€¼éœ€è¦åœ¨å±æ€§å‰åŠ ä¸Š<code>v-bind</code>æˆ–è€…ç®€å†™<code>:</code></li><li>ä¸åŠ ä¸Šçš„éƒ½è®¤ä½œæ˜¯ä¼ é€’å­—ç¬¦ä¸²</li></ul><p>çˆ¶ç»„ä»¶ï¼š<code>&lt;Page&gt;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- å¦‚æœ likes åœ¨è¿™ç›´æ¥ä¼ é€’æ•°å­—ï¼Œå¹¶ä¸”æƒ³å¾—åˆ°numberç±»å‹ --&gt;</span><br><span class="line">    &lt;!-- å¯ä»¥åŠ¨æ€ç»‘å®š v-bind=&quot;100&quot; --&gt;</span><br><span class="line">    &lt;MyTitle title=&quot;é™å¤œæ€&quot; :likes=&quot;likes&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">const likes = ref(100);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å­ç»„ä»¶ï¼š<code>&lt;MyTitle&gt;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;&#123;&#123; title &#125;&#125;&lt;/h1&gt;</span><br><span class="line">  &lt;p&gt;&#123;&#123; likes &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">  title: string;</span><br><span class="line">  likes?: number;</span><br><span class="line">&#125;&gt;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="å•å‘æ•°æ®æµ"><a href="#å•å‘æ•°æ®æµ" class="headerlink" title="å•å‘æ•°æ®æµ"></a>å•å‘æ•°æ®æµ</h1><p>æ‰€æœ‰çš„ props éƒ½éµå¾ª<strong>å•å‘ç»‘å®š</strong>åŸåˆ™</p><ul><li>å› çˆ¶ç»„ä»¶å˜åŒ–è€Œå˜åŒ–ï¼Œæ›´æ–°éšä¹‹ä¼ å‘å­ç»„ä»¶ï¼Œæ‰€ä»¥å­ç»„ä»¶ä¸­çš„ props æ˜¯æœ€æ–°çš„</li><li>å­ç»„ä»¶ä¸­ä¸è¦ä¿®æ”¹ propsã€‚è¦æƒ³è·å¾—è¡ç”Ÿå€¼<ul><li>å¯ä»¥ä½¿ç”¨è®¡ç®—å±æ€§</li><li>å¯ä»¥åˆ›å»ºæ–°çš„å˜é‡æ¥æ”¶</li></ul></li></ul><p>å½“ props æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œå¯ä»¥æ”¹å˜å†…éƒ¨çš„å€¼ï¼Œä½†æ˜¯<strong>ä¸æ¨è</strong></p><h1 id="Boolean-ç±»å‹è½¬æ¢"><a href="#Boolean-ç±»å‹è½¬æ¢" class="headerlink" title="Boolean ç±»å‹è½¬æ¢"></a>Boolean ç±»å‹è½¬æ¢</h1><p>æ–¹ä¾¿åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨æ—¶æ›´åŠ ç®€æ´ï¼Œé¿å…ç±»ä¼¼<code>:disabled=&#39;true&#39;</code>çš„å‡ºç°ï¼Œä½¿ç”¨ç®€å•çš„<code>disabled</code>è¡¨ç¤ºå³å¯</p><p>åœ¨<code>&lt;MyComponent&gt;</code>ä¸­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">definedProps</span>(&#123;</span><br><span class="line">  <span class="attr">disabled</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¶ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç­‰åŒäºä¼ å…¥ :disabled=&quot;true&quot; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">disabled</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ç­‰åŒäºä¼ å…¥ :disabled=&quot;false&quot; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MyComponent</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>å½“ props æœ‰å¤šç§ç±»å‹çš„æ—¶å€™ï¼Œè¿™ç§è½¬æ¢ä¾ç„¶é€‚ç”¨ã€‚ä¸è¿‡ä¸<code>String</code>æ­é…æ—¶æœ‰ä¾‹å¤–ã€‚åœ¨æ’åˆ—æ—¶<code>Boolean</code>éœ€è¦æ’åœ¨<code>String</code>çš„å‰é¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// disabled å°†è¢«è½¬æ¢ä¸º true</span></span><br><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">disabled</span>: [<span class="title class_">Boolean</span>, <span class="title class_">Number</span>],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// disabled å°†è¢«è½¬æ¢ä¸º true</span></span><br><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">disabled</span>: [<span class="title class_">Boolean</span>, <span class="title class_">String</span>],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// disabled å°†è¢«è½¬æ¢ä¸º true</span></span><br><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">disabled</span>: [<span class="title class_">Number</span>, <span class="title class_">Boolean</span>],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// disabled å°†è¢«è§£æä¸ºç©ºå­—ç¬¦ä¸² (disabled=&quot;&quot;)</span></span><br><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">disabled</span>: [<span class="title class_">String</span>, <span class="title class_">Boolean</span>],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h1><p>ä½¿ç”¨<code>generic</code>å±æ€§ï¼Œå±æ€§å€¼å’Œå’Œåœ¨ TypeScript ä¸­çš„<code>&lt;T&gt;</code>ä¸€æ ·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot; generic=&quot;T&quot;&gt;</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">  items: T[];</span><br><span class="line">  selected: T;</span><br><span class="line">&#125;&gt;();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>åŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨<code>extends</code>è¿›è¡Œæ³›å‹çº¦æŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot; generic=&quot;T extends string | number, U extends Item&quot;&gt;</span><br><span class="line">import type &#123; Item &#125; from &quot;./types&quot;;</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">  id: T;</span><br><span class="line">  list: U[];</span><br><span class="line">&#125;&gt;();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="provide-å’Œ-inject"><a href="#provide-å’Œ-inject" class="headerlink" title="provide å’Œ inject"></a>provide å’Œ inject</h1><p>ä¸å±€é™äºç›¸é‚»çš„çˆ¶å­ç»„ä»¶ä¼ å€¼ï¼Œå¯ä»¥æ›´æ·±å±‚æ¬¡ä¼ é€’ï¼ˆReact ä¸­çš„<em>context</em>ï¼‰</p><h2 id="provide-æä¾›æ•°æ®"><a href="#provide-æä¾›æ•°æ®" class="headerlink" title="provide()æä¾›æ•°æ®"></a><code>provide()</code>æä¾›æ•°æ®</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref, provide &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">const msg = ref(&quot;hello&quot;);</span><br><span class="line">const setMsg = () =&gt; &#123;</span><br><span class="line">  msg.value = &quot;hi&quot;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">provide(/* æ³¨å…¥å */ &quot;message&quot;, /* å€¼ */ &#123; msg, setMsg &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>ä¸€ä¸ªç»„ä»¶å¯ä»¥å¤šæ¬¡è°ƒç”¨ï¼Œä¼ é€’ä¸åŒçš„æ³¨å…¥å</li><li>å¦‚æœä¼ å…¥çš„æ˜¯ä¸€ä¸ªæ™®é€šå˜é‡ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>readonly()</code>å°†å®ƒåŒ…ä½</li></ul><p>åº”ç”¨å±‚ provideï¼Œå…¨å±€æä¾›æ•°æ®ã€‚ï¼ˆåœ¨ç¼–å†™æ’ä»¶çš„æ—¶å€™ä¼šç”¨åˆ°ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">provide</span>(<span class="comment">/* æ³¨å…¥å */</span> <span class="string">&quot;message&quot;</span>, <span class="comment">/* å€¼ */</span> <span class="string">&quot;hello!&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="inject-è·å–æ•°æ®"><a href="#inject-è·å–æ•°æ®" class="headerlink" title="inject()è·å–æ•°æ®"></a><code>inject()</code>è·å–æ•°æ®</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; inject &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">const &#123; msg, setMsg &#125; = inject(&quot;message&quot;, &quot;è¿™æ˜¯é»˜è®¤å€¼&quot;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸Šæ¸¸ç»„ä»¶å¹¶æ²¡æœ‰æä¾›<code>message</code>è¿™æ ·ä¸€ä¸ªæ•°æ®ï¼Œç»™<code>inject</code>ä¼ é€’çš„ç¬¬äºŒä¸ªå‚æ•°å°†ä¼šæ˜¯ä½œä¸ºå½“å‰è¿”å›çš„é»˜è®¤å€¼</p><p>é»˜å†™æƒ…å†µä¸‹ä¸ºé¿å…äº§ç”Ÿå‰¯ä½œç”¨ï¼Œé»˜è®¤å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œè¿™æ—¶å€™ç¬¬ä¸‰ä¸ªå‚æ•°éœ€è¦è®¾ç½®ä¸º<code>true</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> value = <span class="title function_">inject</span>(<span class="string">&quot;key&quot;</span>, <span class="function">() =&gt;</span> <span class="keyword">new</span> <span class="title class_">ExpensiveClass</span>(), <span class="literal">true</span>);</span><br></pre></td></tr></table></figure><blockquote><p>ç›®å‰ TypeScript æ ‡æ³¨å¥½åƒä½œç”¨ä¸å¤§</p></blockquote><h1 id="çŠ¶æ€ç®¡ç†"><a href="#çŠ¶æ€ç®¡ç†" class="headerlink" title="çŠ¶æ€ç®¡ç†"></a>çŠ¶æ€ç®¡ç†</h1><ol><li>å¤šä¸ªç»„ä»¶å…±äº«çŠ¶æ€ï¼›</li></ol><ul><li>å¯é€šè¿‡ <code>props</code> æ¥è§£å†³ï¼Œä½†æ˜¯ç»„ä»¶åµŒå¥—æ·±äº†åå®¹æ˜“æ··ä¹±</li><li>å¯é€šè¿‡<code>provide</code>å’Œ<code>inject</code></li></ul><ol start="2"><li>ä¸åŒçš„è§†å›¾äº¤äº’å¯ä¿®æ”¹åŒä¸€çŠ¶æ€</li></ol><ul><li>é€šè¿‡æ¨¡æ¿è·å–å¯¹åº”ç»„ä»¶å®ä¾‹ï¼Œç„¶åè§¦å‘ç»„ä»¶å†…å¯¹åº”çš„äº‹ä»¶</li></ul><p>çŠ¶æ€ç®¡ç†ä¸­æœ€ç›´æ¥çš„æ–¹æ³•ï¼Œå°±æ˜¯å°†å¯¹åº”çš„å…±äº«çŠ¶æ€æŠ½ç¦»å‡ºæ¥</p><h2 id="å“åº”å¼-API-åšçŠ¶æ€ç®¡ç†"><a href="#å“åº”å¼-API-åšçŠ¶æ€ç®¡ç†" class="headerlink" title="å“åº”å¼ API åšçŠ¶æ€ç®¡ç†"></a>å“åº”å¼ API åšçŠ¶æ€ç®¡ç†</h2><p>å°†å…±äº«çš„çŠ¶æ€å•ç‹¬æŠ½ç¦»å‡ºæ¥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span>++;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- ComponentA.vue --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; store &#125; from &quot;./store.js&quot;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;From A: &#123;&#123; store.count &#125;&#125;&lt;/template&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- ComponentB.vue --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; store &#125; from &quot;./store.js&quot;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;From B: &#123;&#123; store.count &#125;&#125;&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>æ¯å½“<code>store</code>è¢«æ”¹åŠ¨æ—¶ï¼Œè¿™ä¸¤ä¸ªç»„ä»¶éƒ½ä¼šè‡ªåŠ¨æ›´æ–°è‡ªå·±çš„è§†å›¾</p><p>ä¸å±€é™äº<code>reactive</code>å…¶ä»–çš„å“åº”å¼ API åŒæ ·é€‚ç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¨å±€çŠ¶æ€ï¼Œåˆ›å»ºåœ¨æ¨¡å—ä½œç”¨åŸŸä¸‹</span></span><br><span class="line"><span class="keyword">const</span> globalCount = <span class="title function_">ref</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// å±€éƒ¨çŠ¶æ€ï¼Œæ¯ä¸ªç»„ä»¶éƒ½ä¼šåˆ›å»º</span></span><br><span class="line">  <span class="keyword">const</span> localCount = <span class="title function_">ref</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    globalCount,</span><br><span class="line">    localCount,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><ol><li>ä½¿ç”¨ <code>Pinia</code></li><li>SSR ???</li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸŒ¤ï¸ Vue3&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="vue" scheme="https://smalljerry.cn/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>Vueå“åº”å¼ç¯‡</title>
    <link href="https://smalljerry.cn/2023/10/01/Vue%E7%8A%B6%E6%80%81%E7%AF%87/"/>
    <id>https://smalljerry.cn/2023/10/01/Vue%E7%8A%B6%E6%80%81%E7%AF%87/</id>
    <published>2023-10-01T10:15:16.000Z</published>
    <updated>2025-02-22T02:14:47.345Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸŒ¤ï¸ Vue3</p><span id="more"></span><h1 id="å£°æ˜å˜é‡"><a href="#å£°æ˜å˜é‡" class="headerlink" title="å£°æ˜å˜é‡"></a>å£°æ˜å˜é‡</h1><p><code>ref()</code>å’Œ<code>reactive()</code>éƒ½æ˜¯ç”¨æ¥å£°æ˜å“åº”å¼çš„å˜é‡ï¼ˆä»£ç æ”¹å˜é¡µé¢ä¹Ÿä¼šè·Ÿç€æ”¹å˜ï¼‰ï¼Œä¸¤è€…ä¸åŒåœ¨äºï¼š</p><ul><li>å‰è€…ç”¨äºåŸºæœ¬åŸå§‹å€¼ï¼šstringã€numberã€booleanã€nullã€undefinedã€symbolï¼ˆä¸‹é¢çš„ä¹Ÿèƒ½ç”¨ï¼‰</li><li>åè€…ç”¨äºï¼šå¯¹è±¡ã€æ•°ç»„ã€setã€map</li></ul><p>åœ¨<code>&lt;script setup&gt;</code>ä½¿ç”¨æ—¶ï¼Œé€šè¿‡<code>ref()</code>å£°æ˜çš„å˜é‡å–å€¼çš„æ—¶å€™éœ€è¦ä½¿ç”¨<code>.value</code></p><ul><li>å¦‚æœåœ¨<code>reactive()</code>é‡Œé¢ä¼ è¿›ä¸€ä¸ª<code>ref()</code>ï¼Œä¸éœ€è¦ä½¿ç”¨ï¼Œä¼šè‡ªåŠ¨è§£åŒ…</li><li>ä½†æ˜¯<code>reactive()</code>é‡Œé¢æ˜¯æ•°ç»„æˆ–è€… map çš„æ—¶å€™ï¼Œåˆéœ€è¦æ‰‹åŠ¨<code>.value</code></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> age = <span class="title function_">ref</span>(<span class="number">18</span>);</span><br><span class="line"><span class="keyword">const</span> xm = <span class="title function_">reactive</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;xm&quot;</span>, <span class="attr">gender</span>: <span class="string">&quot;male&quot;</span>, age &#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age.<span class="property">value</span>); <span class="comment">// 18</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(xm.<span class="property">name</span>); <span class="comment">// &#x27;xm&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(xm.<span class="property">age</span>); <span class="comment">// 18</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> books = <span class="title function_">reactive</span>([<span class="title function_">ref</span>(<span class="string">&quot;Vue 3 Guide&quot;</span>)]);</span><br><span class="line"><span class="keyword">const</span> map = <span class="title function_">reactive</span>(<span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="string">&quot;count&quot;</span>, <span class="title function_">ref</span>(<span class="number">0</span>)]]));</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(books[<span class="number">0</span>].<span class="property">value</span>); <span class="comment">// &#x27;Vue 3 Guide&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(map.<span class="title function_">get</span>(<span class="string">&quot;count&quot;</span>).<span class="property">value</span>); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure><p><code>reactive()</code>å£°æ˜çš„å¯¹è±¡é‡æ–°èµ‹å€¼ï¼Œä¼šä¸¢å¤±å“åº”æ€§ï¼›åœ¨è§£æ„çš„æ—¶å€™ï¼Œä¹Ÿä¼šä¸¢å¤±å“åº”æ€§</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸Šé¢çš„ (&#123; count: 0 &#125;) å¼•ç”¨å°†ä¸å†è¢«è¿½è¸ª</span></span><br><span class="line">state = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">1</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; count &#125; = state;</span><br><span class="line"><span class="comment">// ä¸ä¼šå½±å“åŸå§‹çš„ state</span></span><br><span class="line">count++;</span><br></pre></td></tr></table></figure><h2 id="æ¨¡æ¿ä¸­ä½¿ç”¨"><a href="#æ¨¡æ¿ä¸­ä½¿ç”¨" class="headerlink" title="æ¨¡æ¿ä¸­ä½¿ç”¨"></a>æ¨¡æ¿ä¸­ä½¿ç”¨</h2><p>è‡ªåŠ¨è§£åŒ…æ¡ä»¶ï¼š</p><ul><li>é¡¶çº§çš„<code>ref()</code>ä¼šè‡ªåŠ¨è§£åŒ…</li><li>ä¸æ˜¯é¡¶çº§ï¼Œä½†æ˜¯åªæ˜¯å–å€¼ï¼ˆæ— å…¶ä»– js æ“ä½œï¼‰ï¼Œä¹Ÿå¯è‡ªåŠ¨è§£åŒ…</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> object = &#123; <span class="attr">id</span>: <span class="title function_">ref</span>(<span class="number">1</span>) &#125;;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ­£å¸¸è¿ä½œ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; count++ &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¤±è´¥ï¼Œå¾—åˆ° [object Object]1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; object.id + 1 &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ­£å¸¸è¿ä½œï¼Œç›¸å½“äºåœ¨åé¢åŠ ä¸Š.value--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; object.id &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç±»å‹æ ‡æ³¨"><a href="#ç±»å‹æ ‡æ³¨" class="headerlink" title="ç±»å‹æ ‡æ³¨"></a>ç±»å‹æ ‡æ³¨</h2><p>ä¸€èˆ¬æŒ‡å®š<code>&lt;script setup lang=&#39;ts&#39;&gt;</code>ä¸º <em>TypeScript</em> æ—¶æœ‰è‡ªåŠ¨çš„ç±»å‹æ¨æ–­ï¼Œä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®š</p><p>ğŸ¤” æŒ‡å®š<code>ref</code>çš„ç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">year</span>: <span class="title class_">Ref</span>&lt;<span class="built_in">string</span> | <span class="built_in">number</span>&gt; = <span class="title function_">ref</span>(<span class="string">&quot;2020&quot;</span>);</span><br><span class="line"><span class="comment">// æˆ–è€…æ˜¯</span></span><br><span class="line"><span class="keyword">const</span> year = ref&lt;<span class="built_in">string</span> | <span class="built_in">number</span>&gt;(<span class="string">&quot;2020&quot;</span>);</span><br><span class="line"></span><br><span class="line">year.<span class="property">value</span> = <span class="number">2020</span>;</span><br></pre></td></tr></table></figure><p>ğŸ¤” æŒ‡å®š<code>reactive</code>çš„ç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">year</span>?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">book</span>: <span class="title class_">Book</span> = <span class="title function_">reactive</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;Vue 3 æŒ‡å¼•&quot;</span> &#125;);</span><br></pre></td></tr></table></figure><h1 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h1><p>ä½¿ç”¨å¸¦<code>.value</code>çš„ ref è€Œä¸æ˜¯æ™®é€šçš„å˜é‡</p><ul><li>æ¸²æŸ“çš„æ—¶å€™<strong>è¿½è¸ª</strong>æ¸²æŸ“è¿‡ç¨‹ä¸­<strong>ç”¨åˆ°çš„</strong>æ¯ä¸€ä¸ª ref</li><li>ref å˜åŒ–æ—¶ï¼Œè§¦å‘ç»„ä»¶å†…çš„é‡æ–°æ¸²æŸ“å‡½æ•°</li><li>æ™®é€šå˜é‡æ— æ³•è¾¾åˆ°è¿™ä¸ªç›®çš„</li></ul><p>ç±»ä¼¼äºè¿™æ ·</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç ï¼Œä¸æ˜¯çœŸæ­£çš„å®ç°</span></span><br><span class="line"><span class="keyword">const</span> myRef = &#123;</span><br><span class="line">  <span class="attr">_value</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">    <span class="title function_">track</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_value</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">value</span>(<span class="params">newValue</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_value</span> = newValue;</span><br><span class="line">    <span class="title function_">trigger</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸æ˜¯æ¯ä¸€æ¬¡çš„ ref å˜åŠ¨éƒ½è§¦å‘é¡µé¢é‡æ–°æ¸²æŸ“ã€‚Vue ä¼šåœ¨â€œnext tickâ€æ›´æ–°å‘¨æœŸä¸­ç¼“å†²æ‰€æœ‰çŠ¶æ€çš„ä¿®æ”¹ï¼Œä¸ç®¡è¿›è¡Œäº†å¤šå°‘æ¬¡çŠ¶æ€ä¿®æ”¹ï¼Œæ¯ä¸ªç»„ä»¶éƒ½åªä¼šè¢«æ›´æ–°ä¸€æ¬¡ã€‚</p></blockquote><p>è¦ç­‰å¾… DOM æ›´æ–°å®Œæˆå†æ‰§è¡Œï¼Œéœ€è¦ä½¿ç”¨<code>nextTick()</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; ref, nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    count.<span class="property">value</span>++;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// DOM è¿˜æœªæ›´æ–°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;counter&quot;</span>).<span class="property">textContent</span>); <span class="comment">// 0</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// å¯ä»¥ awaitï¼Œä¹Ÿå¯ä»¥ä¼ ä¸€ä¸ªå›è°ƒå‡½æ•°è¿›å»</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> <span class="title function_">nextTick</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// DOM æ­¤æ—¶å·²ç»æ›´æ–°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;counter&quot;</span>).<span class="property">textContent</span>); <span class="comment">// 1</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;counter&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="è®¡ç®—å±æ€§"><a href="#è®¡ç®—å±æ€§" class="headerlink" title="è®¡ç®—å±æ€§"></a>è®¡ç®—å±æ€§</h1><p><code>computed(()=&gt;&#123;&#125;)</code>ï¼Œå¿…é¡»è¦æœ‰è¿”å›å€¼ï¼›ä¸èƒ½æ¥æ”¶å‚æ•°</p><ul><li>å’Œ<code>ref()</code>ä¸€æ ·ï¼Œåœ¨ JS ä¸­ä½¿ç”¨æ—¶éœ€è¦<code>.value</code></li></ul><p>é€šè¿‡ç°æœ‰çš„å˜é‡æ¥è¿›ä¸€æ­¥è®¡ç®—è·å¾—æ–°çš„å€¼ï¼ˆä¸´æ—¶å€¼ï¼‰ï¼›æˆ–è€…å°†æ¡ä»¶åˆ¤æ–­å†™åˆ°è®¡ç®—å±æ€§ä¸­ï¼Œç®€åŒ–æ¨¡æ¿ä¸­<code>&#123;&#123;&#125;&#125;</code>é‡Œé¢çš„å†…å®¹</p><ul><li>å› ä¸ºæ˜¯åœ¨ç°æœ‰åŸºç¡€ä¸Šå¾—æ¥çš„ï¼ˆæ´¾å‡å€¼ï¼‰ï¼Œæ‰€ä»¥ç›´æ¥ä¿®æ”¹å®ƒæ²¡ä»€ä¹ˆä¸€æ ·ï¼Œæ‰€ä»¥ä¸€èˆ¬è®¤ä¸ºè¿™æ˜¯åªè¯»çš„</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; reactive, computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> author = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;John Doe&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">books</span>: [</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;Vue 2 - Advanced Guide&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;Vue 3 - Basic Guide&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;Vue 4 - The Mystery&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// ä¸€ä¸ªè®¡ç®—å±æ€§ ref</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> publishedBooksMessage = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> author.<span class="property">books</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="string">&quot;Yes&quot;</span> : <span class="string">&quot;No&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Has published books:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; publishedBooksMessage &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¼šè‡ªåŠ¨è·Ÿè¸ªå“åº”å¼ä¾èµ–ã€‚å®ƒä¼šæ£€æµ‹åˆ° publishedBooksMessage ä¾èµ–äº author.booksï¼Œæ‰€ä»¥å½“ author.books æ”¹å˜æ—¶ï¼Œä»»ä½•ä¾èµ–äº publishedBooksMessage çš„ç»‘å®šéƒ½ä¼šåŒæ—¶æ›´æ–°ã€‚</p></blockquote><p><strong>TS ç±»å‹æ ‡æ³¨</strong></p><p>ä¸€èˆ¬æƒ…å†µä¸‹ä¼šè‡ªåŠ¨æ¨æ–­ï¼Œæ‰‹åŠ¨æŒ‡å®šï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> double = computed&lt;<span class="built_in">number</span>&gt;(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è‹¥è¿”å›å€¼ä¸æ˜¯ number ç±»å‹åˆ™ä¼šæŠ¥é”™</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>ä¸æ–¹æ³•çš„åŒºåˆ«</strong></p><p>è®¡ç®—å±æ€§ä¼šç¼“å­˜ï¼Œæ¸²æŸ“æ—¶å¦‚æœæ‰€ä¾èµ–çš„å˜é‡æ²¡æœ‰æ”¹å˜ï¼Œè®¡ç®—å±æ€§ä¸ä¼šæ‰§è¡Œï¼ˆä¸æ‰§è¡Œ getter å‡½æ•°ï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæ–¹æ³•åœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œã€‚</p><p><strong>è®¡ç®—å±æ€§æ˜¯åŸºäºå“åº”å¼ä¾èµ–è¢«ç¼“å­˜</strong>ï¼Œä¸‹é¢<code>Date.now()</code>ä¸æ˜¯å“åº”å¼çš„ï¼Œæ‰€ä»¥ä¸ä¼šè¢«ç¼“å­˜</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> now = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> <span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br></pre></td></tr></table></figure><h2 id="å¯å†™è®¡ç®—å±æ€§"><a href="#å¯å†™è®¡ç®—å±æ€§" class="headerlink" title="å¯å†™è®¡ç®—å±æ€§"></a>å¯å†™è®¡ç®—å±æ€§</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> firstName = <span class="title function_">ref</span>(<span class="string">&#x27;John&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> lastName = <span class="title function_">ref</span>(<span class="string">&#x27;Doe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fullName = <span class="title function_">computed</span>(&#123;</span><br><span class="line">  <span class="comment">// getter</span></span><br><span class="line">  <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> firstName.<span class="property">value</span> + <span class="string">&#x27; &#x27;</span> + lastName.<span class="property">value</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// setter</span></span><br><span class="line">  <span class="title function_">set</span>(<span class="params">newValue</span>) &#123;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯è§£æ„èµ‹å€¼è¯­æ³•</span></span><br><span class="line">    [firstName.<span class="property">value</span>, lastName.<span class="property">value</span>] = newValue.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>getter ä¸åº”è¯¥æœ‰å‰¯ä½œç”¨ï¼ˆå˜æ›´ç°æœ‰å€¼ï¼Œè§¦å‘ DOM é‡æ–°æ¸²æŸ“ï¼‰</p></blockquote><h1 id="ç›‘å¬å™¨"><a href="#ç›‘å¬å™¨" class="headerlink" title="ç›‘å¬å™¨"></a>ç›‘å¬å™¨</h1><p><code>watch(ref, (newVal, oldVal)=&gt;&#123;&#125;)</code></p><ul><li>è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå†æ¬¡è°ƒç”¨å¯åœæ­¢å½“å‰ç›‘å¬</li></ul><p>ç›¸æ¯”äº _è®¡ç®—å±æ€§_ï¼Œç›‘å¬å™¨åšçš„æ˜¯ç›‘å¬åˆ°å€¼å˜åŒ–çš„æ—¶å€™åšä¸€äº›å‰¯ä½œç”¨ï¼ˆDOM é¡µé¢æ›´æ–°ï¼‰ã€‚<a href="https://cn.vuejs.org/api/reactivity-core.html#watch">watch api</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, watch &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> x = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> y = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å•ä¸ª ref</span></span><br><span class="line"><span class="title function_">watch</span>(x, <span class="function">(<span class="params">newX</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`x is <span class="subst">$&#123;newX&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// getter å‡½æ•°</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> x.<span class="property">value</span> + y.<span class="property">value</span>,</span><br><span class="line">  <span class="function">(<span class="params">sum</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`sum of x + y is: <span class="subst">$&#123;sum&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šä¸ªæ¥æºç»„æˆçš„æ•°ç»„</span></span><br><span class="line"><span class="title function_">watch</span>([x, <span class="function">() =&gt;</span> y.<span class="property">value</span>], <span class="function">(<span class="params">[newX, newY]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`x is <span class="subst">$&#123;newX&#125;</span> and y is <span class="subst">$&#123;newY&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç›‘å¬<code>reactive</code>å¯¹è±¡çš„æ—¶å€™ï¼Œä¸èƒ½ç›´æ¥ç›‘å¬å®ƒçš„å±æ€§ï¼Œè€Œæ˜¯éœ€è¦ä¸€ä¸ª getter å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯ï¼Œå› ä¸º watch() å¾—åˆ°çš„å‚æ•°æ˜¯ä¸€ä¸ª number</span></span><br><span class="line"><span class="title function_">watch</span>(obj.<span class="property">count</span>, <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`count is: <span class="subst">$&#123;count&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æä¾›ä¸€ä¸ª getter å‡½æ•°</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> obj.<span class="property">count</span>,</span><br><span class="line">  <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`count is: <span class="subst">$&#123;count&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="æ·±åº¦ç›‘å¬"><a href="#æ·±åº¦ç›‘å¬" class="headerlink" title="æ·±åº¦ç›‘å¬"></a>æ·±åº¦ç›‘å¬</h2><p>ç›‘å¬å“åº”å¼å¯¹è±¡çš„æ—¶å€™ï¼Œä¼š<strong>éšå¼åœ°</strong>è¿›è¡Œæ·±åº¦ç›‘å¬</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">watch</span>(obj, <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åœ¨åµŒå¥—çš„å±æ€§å˜æ›´æ—¶è§¦å‘</span></span><br><span class="line">  <span class="comment">// æ³¨æ„ï¼š`newValue` æ­¤å¤„å’Œ `oldValue` æ˜¯ç›¸ç­‰çš„</span></span><br><span class="line">  <span class="comment">// å› ä¸ºå®ƒä»¬æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.<span class="property">count</span>++;</span><br></pre></td></tr></table></figure><p>å¦‚æœåªéœ€è¦ç›‘å¬å¯¹è±¡çš„æ”¹å˜ï¼Œéœ€è¦ç›‘å¬ä¸€ä¸ª getter å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> state.<span class="property">someObject</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ä»…å½“ state.someObject è¢«æ›¿æ¢æ—¶è§¦å‘</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨ getter å‡½æ•°çš„åŸºç¡€ä¸Šï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå¼ºåˆ¶æ·±åº¦ç›‘å¬</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> state.<span class="property">someObject</span>,</span><br><span class="line">  <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼š`newValue` æ­¤å¤„å’Œ `oldValue` æ˜¯ç›¸ç­‰çš„</span></span><br><span class="line">    <span class="comment">// *é™¤é* state.someObject è¢«æ•´ä¸ªæ›¿æ¢äº†</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="å›è°ƒè§¦å‘æ—¶æœº"><a href="#å›è°ƒè§¦å‘æ—¶æœº" class="headerlink" title="å›è°ƒè§¦å‘æ—¶æœº"></a>å›è°ƒè§¦å‘æ—¶æœº</h2><p>æŒ‡å®š<code>flush</code>çš„å€¼ï¼Œæœ‰ï¼š<code>&#39;pre&#39; | &#39;post&#39; | &#39;sync&#39;</code></p><p><strong>é»˜è®¤æƒ…å†µ</strong>ï¼ˆpreï¼‰ä¸­ï¼Œæ˜¯åœ¨ DOM æ›´æ–°å‰è§¦å‘çš„ï¼Œæ‰€ä»¥åœ¨å›è°ƒé‡Œé¢è·å¾—çš„ DOM æ˜¯æ—§çš„</p><p><strong>DOM æ›´æ–°åè§¦å‘</strong>ï¼ˆpostï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; watchEffect, watchPostEffect &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">watch</span>(source, callback, &#123;</span><br><span class="line">  <span class="attr">flush</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">watchEffect</span>(callback, &#123;</span><br><span class="line">  <span class="attr">flush</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">watchPostEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">/* åœ¨ Vue æ›´æ–°åæ‰§è¡Œ. å¯¹åº”çš„æ˜¯ flush: &#x27;post&#x27; */</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>watchSyncEffect()</code>ä¸ºåŒæ­¥è§¦å‘ï¼Œå¯¹åº”çš„<code>watchEffect</code>ä¸º<code>flush: &#39;sync&#39;</code></li></ul><p><strong>ç«‹å³è§¦å‘</strong></p><p><code>watch</code>é»˜è®¤æ˜¯æ‡’æ‰§è¡Œçš„ï¼šä»…å½“æ•°æ®æºå˜åŒ–æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œå›è°ƒã€‚</p><p>å¦‚æœéœ€è¦åœ¨åˆ›å»ºçš„æ—¶å€™ç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  source,</span><br><span class="line">  <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç«‹å³æ‰§è¡Œï¼Œä¸”å½“ `source` æ”¹å˜æ—¶å†æ¬¡æ‰§è¡Œ</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">immediate</span>: <span class="literal">true</span> &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="watchEffect"><a href="#watchEffect" class="headerlink" title="watchEffect"></a>watchEffect</h2><p>å’Œ<code>wacth</code>çš„åŒºåˆ«æ˜¯ä¸ç”¨æŒ‡å®šè¦ç›‘å¬çš„ç›®æ ‡ï¼Œå®ƒä¼šè‡ªåŠ¨è·Ÿè¸ªï¼ˆè·Ÿè¸ªå–å€¼çš„é‚£ä¸ªå˜é‡ï¼‰</p><ul><li>ä¸éœ€è¦æŒ‡å®š<code>immediate: true</code>ä¹Ÿä¼šç«‹å³æ‰§è¡Œ</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> todoId = <span class="title function_">ref</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> data = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  todoId,</span><br><span class="line">  <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(</span><br><span class="line">      <span class="string">`https://jsonplaceholder.typicode.com/todos/<span class="subst">$&#123;todoId.value&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    data.<span class="property">value</span> = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">immediate</span>: <span class="literal">true</span> &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>watchEffect</code>ç®€åŒ–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watchEffect</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(</span><br><span class="line">    <span class="string">`https://jsonplaceholder.typicode.com/todos/<span class="subst">$&#123;todoId.value&#125;</span>`</span></span><br><span class="line">  );</span><br><span class="line">  data.<span class="property">value</span> = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>å¯¹äºéœ€è¦ç›‘å¬å¤šä¸ªä¾èµ–çš„æ—¶å€™éå¸¸æœ‰ç”¨</li></ul><h2 id="åœæ­¢ç›‘å¬å™¨"><a href="#åœæ­¢ç›‘å¬å™¨" class="headerlink" title="åœæ­¢ç›‘å¬å™¨"></a>åœæ­¢ç›‘å¬å™¨</h2><p>åœ¨<code>setup</code>ä¸­<strong>åŒæ­¥è¯­å¥</strong>åˆ›å»ºçš„ç›‘å¬å™¨ï¼Œä¼šéšç€ç»„ä»¶å¸è½½è€Œè‡ªåŠ¨åœæ­¢ã€‚å¦‚æœæ˜¯åœ¨<strong>å¼‚æ­¥è¯­å¥</strong>ä¸­åˆ›å»ºï¼Œéœ€è¦æ‰‹åŠ¨åœæ­¢</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; watchEffect &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// å®ƒä¼šè‡ªåŠ¨åœæ­¢</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// ...è¿™ä¸ªåˆ™ä¸ä¼šï¼</span></span></span><br><span class="line"><span class="language-javascript">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;&#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;, <span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨ç›‘å¬å™¨æ‰§è¡Œåçš„è¿”å›å€¼åœæ­¢ç›‘å¬å™¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> unwatch = <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...å½“è¯¥ä¾¦å¬å™¨ä¸å†éœ€è¦æ—¶</span></span><br><span class="line"><span class="title function_">unwatch</span>();</span><br></pre></td></tr></table></figure><blockquote><p>ä¸€èˆ¬éƒ½æ˜¯åŒæ­¥åˆ›å»ºç›‘å¬å™¨çš„ ğŸ˜ƒ</p></blockquote><h1 id="å…¶ä»–-API"><a href="#å…¶ä»–-API" class="headerlink" title="å…¶ä»– API"></a>å…¶ä»– API</h1><p><code>isRef()</code></p><p>åˆ¤æ–­å˜é‡æ˜¯ä¸æ˜¯<em>ref</em></p><p><code>shallowRef()</code></p><p>ref çš„æµ…å±‚å½¢å¼ï¼Œåªå¯¹ç¬¬ä¸€ä¸ª<code>.</code>ä¿æŒå“åº”å¼ã€‚æ”¹å˜æ·±å±‚æ¬¡çš„<code>.</code>ï¼Œé¡µé¢ä¸ä¼šæ›´æ–°ï¼›åœ¨å¤„ç†å¤§å‹æ•°æ®ç»“æ„çš„æ—¶å€™å¯¹æ€§èƒ½æœ‰å¸®åŠ©</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">shallowRef</span>(&#123; <span class="attr">count</span>: <span class="number">1</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ä¼šè§¦å‘æ›´æ”¹</span></span><br><span class="line">state.<span class="property">value</span>.<span class="property">count</span> = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼šè§¦å‘æ›´æ”¹</span></span><br><span class="line">state.<span class="property">value</span> = &#123; <span class="attr">count</span>: <span class="number">2</span> &#125;;</span><br></pre></td></tr></table></figure><p><code>triggerRef()</code></p><p>å¼ºåˆ¶è§¦å‘ä¸€ä¸ª<code>shalloRef()</code>ã€‚å°±æ˜¯å¼ºåˆ¶åœ°å°†ä¼ è¿›å»çš„æµ…å±‚ ref å˜ä¸ºæ·±å±‚æ¬¡ä¹Ÿæœ‰å“åº”å¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shallow = <span class="title function_">shallowRef</span>(&#123;</span><br><span class="line">  <span class="attr">greet</span>: <span class="string">&quot;Hello, world&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§¦å‘è¯¥å‰¯ä½œç”¨ç¬¬ä¸€æ¬¡åº”è¯¥ä¼šæ‰“å° &quot;Hello, world&quot;</span></span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(shallow.<span class="property">value</span>.<span class="property">greet</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ¬¡å˜æ›´ä¸åº”è§¦å‘å‰¯ä½œç”¨ï¼Œå› ä¸ºè¿™ä¸ª ref æ˜¯æµ…å±‚çš„</span></span><br><span class="line"><span class="comment">// å¦‚æœå…³è”é¡µé¢ï¼Œé¡µé¢ä¸ä¼šæ¸²æŸ“</span></span><br><span class="line">shallow.<span class="property">value</span>.<span class="property">greet</span> = <span class="string">&quot;Hello, universe&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å° &quot;Hello, universe&quot;ï¼ˆwatchEffectç›‘å¬åˆ°äº†å˜åŠ¨ï¼‰</span></span><br><span class="line"><span class="title function_">triggerRef</span>(shallow);</span><br></pre></td></tr></table></figure><p><code>customRef()</code></p><p>æœ‰ <em>Proxy</em> çš„æ„æ€ï¼Œåœ¨è®¾ç½®å€¼å–å€¼ä¹‹é—´è¿›è¡Œè‡ªå®šä¹‰æ“ä½œ</p><ul><li>æ¥æ”¶ä¸€ä¸ªå›è°ƒï¼Œæœ‰ä¸¤ä¸ªå‚æ•°<ul><li><code>track()</code>å‡½æ•°å’Œ<code>trigger()</code>å‡½æ•°</li></ul></li><li>è¿”å›ä¸€ä¸ªå¯¹è±¡<ul><li>åŒ…å«<code>get()</code>æ–¹æ³•å’Œ<code>set()</code>æ–¹æ³•</li></ul></li><li>ä¸€èˆ¬ track åœ¨ get é‡Œé¢è°ƒç”¨ï¼›trigger åœ¨ set é‡Œé¢è°ƒç”¨</li></ul><p>ä¾‹å¦‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; customRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useDebouncedRef</span>(<span class="params">value, delay = <span class="number">200</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timeout;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">customRef</span>(<span class="function">(<span class="params">track, trigger</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">track</span>();</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">set</span>(<span class="params">newValue</span>) &#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          value = newValue;</span><br><span class="line">          <span class="title function_">trigger</span>();</span><br><span class="line">        &#125;, delay);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useDebouncedRef &#125; from &quot;./debouncedRef&quot;;</span><br><span class="line">const text = useDebouncedRef(&quot;hello&quot;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;input v-model=&quot;text&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><hr><p><code>shallowReactive()</code></p><p>å¦‚æœé‡Œé¢ä¼ çš„æ˜¯<code>ref()</code>ï¼Œä¸ä¼šè‡ªåŠ¨è§£åŒ…</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">shallowReactive</span>(&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">nested</span>: &#123;</span><br><span class="line">    <span class="attr">bar</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´æ”¹çŠ¶æ€è‡ªèº«çš„å±æ€§æ˜¯å“åº”å¼çš„</span></span><br><span class="line">state.<span class="property">foo</span>++;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...ä½†ä¸‹å±‚åµŒå¥—å¯¹è±¡ä¸ä¼šè¢«è½¬ä¸ºå“åº”å¼</span></span><br><span class="line"><span class="title function_">isReactive</span>(state.<span class="property">nested</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸æ˜¯å“åº”å¼çš„</span></span><br><span class="line">state.<span class="property">nested</span>.<span class="property">bar</span>++;</span><br></pre></td></tr></table></figure><p><code>readonly()</code></p><p>æ¥å—ä¸€ä¸ªå¯¹è±¡ (ä¸è®ºæ˜¯å“åº”å¼è¿˜æ˜¯æ™®é€šçš„)ï¼Œè¿”å›ä¸€ä¸ªåªè¯»å¯¹è±¡ä»£ç†</p><p><code>shallowReadonly()</code></p><p>åªæ˜¯ç¬¬ä¸€ä¸ª<code>.</code>åªè¯»</p><p><code>toRaw()</code></p><p>è¿”å›ç”± <code>reactive()</code>ã€<code>readonly()</code>ã€<code>shallowReactive()</code> æˆ–è€… <code>shallowReadonly()</code> åˆ›å»ºçš„ä»£ç†å¯¹åº”çš„åŸå§‹å¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> reactiveFoo = <span class="title function_">reactive</span>(foo);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">toRaw</span>(reactiveFoo) === foo); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p><code>markRaw()</code></p><p>å°†å¯¹è±¡æ ‡è®°ä¸ºä¸å¯ä»£ç†ï¼ˆä¸èƒ½è®¾ç½®ä¸ºå“åº”å¼ï¼‰ã€‚è¿”å›å¯¹è±¡æœ¬èº«</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="title function_">markRaw</span>(&#123;&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(<span class="title function_">reactive</span>(foo))); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹Ÿé€‚ç”¨äºåµŒå¥—åœ¨å…¶ä»–å“åº”æ€§å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> bar = <span class="title function_">reactive</span>(&#123; foo &#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(bar.<span class="property">foo</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p><code>effectScope()</code></p><p>åˆ›å»ºä¸€ä¸ª effect ä½œç”¨åŸŸï¼Œæ•è·åˆ›å»ºçš„å‰¯ä½œç”¨ï¼ˆè®¡ç®—å±æ€§å’Œç›‘å¬å™¨ï¼‰ï¼Œç„¶ååŒæ—¶å¤„ç†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> scope = <span class="title function_">effectScope</span>();</span><br><span class="line"></span><br><span class="line">scope.<span class="title function_">run</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> doubled = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> counter.<span class="property">value</span> * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">watch</span>(doubled, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(doubled.<span class="property">value</span>));</span><br><span class="line"></span><br><span class="line">  <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Count: &quot;</span>, doubled.<span class="property">value</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†æ‰å½“å‰ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ effect</span></span><br><span class="line">scope.<span class="title function_">stop</span>();</span><br></pre></td></tr></table></figure><p><code>getCurrentScope()</code></p><p>å¦‚æœæœ‰çš„è¯ï¼Œè¿”å›å½“å‰æ´»è·ƒçš„ effect ä½œç”¨åŸŸã€‚</p><p><code>onScopeDispose()</code></p><p>æ¥æ”¶ä¸€ä¸ªå›è°ƒï¼Œå½“ effect ä½œç”¨åŸŸåœæ­¢çš„æ—¶å€™ä¼šæ‰§è¡Œè¿™ä¸ªå›è°ƒã€‚<code>onUnmounted</code>çš„æ›¿ä»£å“</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸŒ¤ï¸ Vue3&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="vue" scheme="https://smalljerry.cn/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>Piniaå¿«é€Ÿæ‰‹å†Œ</title>
    <link href="https://smalljerry.cn/2023/09/24/Pinia%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C/"/>
    <id>https://smalljerry.cn/2023/09/24/Pinia%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C/</id>
    <published>2023-09-24T11:44:45.000Z</published>
    <updated>2025-02-22T02:14:47.343Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸŒ Vue çŠ¶æ€ç®¡ç†</p><span id="more"></span><h1 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h1><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p><code>Store</code>ï¼šä¸ä¸ç»„ä»¶æ ‘ç»‘å®šï¼Œæ‰¿è½½ç€å…¨å±€çŠ¶æ€ï¼ˆæ•°æ®ï¼‰ã€‚åœ¨<code>Vue</code>ä¸­æœ‰<code>vuex</code>ï¼Œ<code>pinia</code>ï¼›åœ¨<code>React</code>ä¸­ï¼Œæœ‰<code>redux</code>ã€<code>unstate-next</code></p><p>ğŸ¤” å¹¶éæ‰€æœ‰åº”ç”¨éƒ½éœ€è¦å…¨å±€çŠ¶æ€</p><p>ğŸï¸ Store çš„ä½¿ç”¨åœºæ™¯ï¼šåœ¨æ•´ä¸ªåº”ç”¨ä¸­å¯è®¿é—®åˆ°çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼š</p><ul><li>å¯¼èˆªæ çš„ç”¨æˆ·ä¿¡æ¯</li><li>å¤æ‚çš„å¤šæ­¥éª¤è¡¨å•</li></ul><blockquote><p>é¿å…å°†æœ¬å¯ä»¥ä¿å­˜è‡³ç»„ä»¶ä¸­çš„æ•°æ®ä¿å­˜åˆ° Storeï¼Œä¾‹å¦‚ä¸€ä¸ªå…ƒç´ åœ¨é¡µé¢çš„å¯è§æ€§</p></blockquote><p>å¯¹äº<code>pinia</code>ï¼Œæœ‰<strong>state</strong>ã€<strong>getter</strong>ã€<strong>action</strong>ä¸‰ä¸ªæ¦‚å¿µ</p><p>å¯ç†è§£ä¸ºå¯¹åº”ç»„ä»¶çš„</p><ul><li><code>data</code> -&gt; <code>state</code></li><li><code>computed</code> -&gt; <code>getter</code></li><li><code>methods</code> -&gt; <code>action</code></li></ul><p>åœ¨ setup ä¸­çš„å¯¹åº”å…³ç³»æ˜¯</p><ul><li><code>state</code> -&gt; <code>ref()</code></li><li><code>getter</code> -&gt; <code>computed()</code></li><li><code>action</code> -&gt; <code>function()</code></li></ul><p>è¿™ä¸‰ä¸ªæ¦‚å¿µå¯ä»¥è®¤ä¸ºæ˜¯ï¼šå€¼ã€é€šè¿‡å€¼å¾—åˆ°çš„ã€ç”¨æ¥æ”¹å˜å€¼çš„</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>é€šè¿‡ <code>Vite</code> åˆ›å»ºä¸€ä¸ª <code>Vue</code> é¡¹ç›®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm create vite</span><br></pre></td></tr></table></figure><p>å®‰è£…<code>pinia</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm add pinia</span><br></pre></td></tr></table></figure><p>ä¹ æƒ¯åœ¨ç›¸å¯¹é¡¹ç›®æ ¹ç›®å½•åˆ›å»º<code>src/store/index.ts</code>æ–‡ä»¶ï¼Œä»¥æ­¤ä½œä¸ºå…¥å£æ¥é…ç½®æ•´ä¸ªé¡¹ç›®çš„ _store_ï¼ˆstateï¼Ÿï¼Ÿï¼‰</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> pinia;</span><br></pre></td></tr></table></figure><p>åœ¨<code>vue</code>çš„å…¥å£æ–‡ä»¶<code>main.ts</code>ä¸­å¯¼å…¥å¹¶ä½¿ç”¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> pinia <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(pinia);</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>è®°å¾—è¦åœ¨æŒ‚åœ¨<code>#app</code>ä¹‹å‰ä½¿ç”¨</li></ul><p>å¦‚æœæ˜¯åœ¨<code>Vue2</code>ä¸­</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia, <span class="title class_">PiniaVuePlugin</span> &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">PiniaVuePlugin</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  <span class="comment">// åŒä¸€ä¸ª`pinia&#x27;å®ä¾‹ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸ªé¡µé¢çš„å¤šä¸ª Vue åº”ç”¨ä¸­ä½¿ç”¨ã€‚</span></span><br><span class="line">  pinia,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="å¿«é€Ÿä½¿ç”¨"><a href="#å¿«é€Ÿä½¿ç”¨" class="headerlink" title="å¿«é€Ÿä½¿ç”¨"></a>å¿«é€Ÿä½¿ç”¨</h1><h2 id="åœ¨-setup-ä¸­ä½¿ç”¨"><a href="#åœ¨-setup-ä¸­ä½¿ç”¨" class="headerlink" title="åœ¨ setup ä¸­ä½¿ç”¨"></a>åœ¨ setup ä¸­ä½¿ç”¨</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><ul><li>Composition API</li></ul><p>åœ¨<code>setup</code>ä¸­ä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼Œå†™æ³•å’Œæ™®é€šçš„ JavaScript å¤§å·®ä¸å·®</p><p>ä½¿ç”¨<code>defineStore</code>å®šä¹‰ä¸€ä¸ª<code>Store</code>:ï¼ˆå¯åœ¨<code>src/store</code>ä¸‹åˆ›å»ºæ–°çš„æ–‡ä»¶ï¼‰</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserStore = <span class="title function_">defineStore</span>(<span class="string">&quot;user&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> username = <span class="title function_">ref</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setUsername</span> = (<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">    username.<span class="property">value</span> = name;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; username, setUsername &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ğŸ‡ Store çš„åå­—æ¨èæ˜¯<code>useXXXStore</code></p><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ Store çš„å”¯ä¸€ ID</li><li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°</li></ul><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>åœ¨ Vue ç»„ä»¶çš„<code>&lt;script setup&gt;</code>ä¸­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&quot;xx/store/userStore&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥è§£æ„çš„ username ä¸å…·æœ‰å“åº”å¼</span></span><br><span class="line"><span class="comment">// ä½œä¸º action çš„ setUsername æ­£å¸¸ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> &#123; username, setUsername &#125; = <span class="title function_">useUserStore</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">setUsername</span>(<span class="string">&quot;Jerry&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(username); <span class="comment">// è¿˜æ˜¯åŸæ¥çš„å€¼</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">useUserStore</span>().<span class="property">username</span>); <span class="comment">// Jerry</span></span><br></pre></td></tr></table></figure><p>è¦ä¿æŒå“åº”æ€§ï¼Œå¯ä½¿ç”¨<code>storeToRefs</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; storeToRefs &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">useUserStore</span>();</span><br><span class="line"><span class="keyword">const</span> &#123; username &#125; = <span class="title function_">storeToRefs</span>(store);</span><br><span class="line"><span class="comment">// éœ€è¦å˜ä¸ºå“åº”æ€§çš„æ˜¯ stateï¼ˆå€¼ï¼‰ï¼Œactionç›´æ¥è§£æ„å°±è¡Œ</span></span><br><span class="line"><span class="keyword">const</span> &#123; setUsername &#125; = store;</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœæœ‰æŠ¥é”™è¯´ç±»ä¼¼æ˜¯ï¼š<code>setUsername is not a function</code>çš„ï¼Œé‡å¯ä¸€ä¸‹é¡¹ç›®å°±å¥½äº†ã€‚ï¼Ÿä¸çŸ¥é“æ˜¯ vite çš„é—®é¢˜è¿˜æ˜¯ pinia çš„é—®é¢˜</p></blockquote><h2 id="ä¸åœ¨-setup-ä¸­ä½¿ç”¨"><a href="#ä¸åœ¨-setup-ä¸­ä½¿ç”¨" class="headerlink" title="ä¸åœ¨ setup ä¸­ä½¿ç”¨"></a>ä¸åœ¨ setup ä¸­ä½¿ç”¨</h2><ul><li>Option API</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&quot;counter&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">double</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">count</span> * <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹æ³•å’Œåœ¨<code>setup</code>ä¸­ä¸€æ ·ï¼Œå°±åƒæ˜¯<code>Vue</code>ä¸­<em>Option API</em>å’Œ<em>Composition API</em>çš„åŒºåˆ«</p><h1 id="ç»†èŠ‚ä½¿ç”¨"><a href="#ç»†èŠ‚ä½¿ç”¨" class="headerlink" title="ç»†èŠ‚ä½¿ç”¨"></a>ç»†èŠ‚ä½¿ç”¨</h1><h2 id="state"><a href="#state" class="headerlink" title="state"></a>state</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStore = <span class="title function_">defineStore</span>(<span class="string">&quot;storeId&quot;</span>, &#123;</span><br><span class="line">  <span class="comment">// ä¸ºäº†å®Œæ•´ç±»å‹æ¨ç†ï¼Œæ¨èä½¿ç”¨ç®­å¤´å‡½æ•°</span></span><br><span class="line">  <span class="attr">state</span>: (): <span class="function"><span class="params">State</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">items</span>: [] <span class="keyword">as</span> <span class="title class_">ItemInfo</span>[],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ItemInfo</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">State</span> &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">items</span>: array;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸€èˆ¬éƒ½ä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œæ— éœ€æ‰‹åŠ¨å†™</li></ul><h3 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h3><p>ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥è¿›è¡Œè¯»å†™æ¥æ”¹å˜ storeï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>$patch</code>æ–¹æ³•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="title function_">useStore</span>();</span><br><span class="line"></span><br><span class="line">store.<span class="property">count</span>++;</span><br><span class="line"></span><br><span class="line">store.$patch(&#123;</span><br><span class="line">  <span class="attr">count</span>: store.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">  <span class="attr">items</span>: [&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">name</span>: <span class="string">&quot;huawei&quot;</span> &#125;],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥ä»¥å‡½æ•°ä½œä¸ºå‚æ•°çš„å½¢å¼ä½¿ç”¨</span></span><br><span class="line">store.$patch(<span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">  state.<span class="property">items</span>.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;shoes&quot;</span>, <span class="attr">quantity</span>: <span class="number">1</span> &#125;);</span><br><span class="line">  state.<span class="property">hasChanged</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥é‡ç½®state</span></span><br><span class="line">store.$reset();</span><br></pre></td></tr></table></figure><h3 id="æ›¿æ¢"><a href="#æ›¿æ¢" class="headerlink" title="æ›¿æ¢"></a>æ›¿æ¢</h3><p><strong>ä¸èƒ½å®Œå…¨æ›¿æ¢æ‰</strong>store çš„ stateï¼Œå¯ä»¥ patch å®ƒä»¬</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™å®é™…ä¸Šå¹¶æ²¡æœ‰æ›¿æ¢`$state`</span></span><br><span class="line">store.<span class="property">$state</span> = &#123; <span class="attr">count</span>: <span class="number">24</span> &#125;;</span><br><span class="line"><span class="comment">// åœ¨å®ƒå†…éƒ¨è°ƒç”¨ `$patch()`ï¼š</span></span><br><span class="line">store.$patch(&#123; <span class="attr">count</span>: <span class="number">24</span> &#125;);</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡å˜æ›´<code>pinia</code>å®ä¾‹çš„<code>state</code>æ¥è®¾ç½®æ•´ä¸ªåº”ç”¨çš„åˆå§‹ stateã€‚å¸¸ç”¨äº<em>SSR ä¸­çš„æ¿€æ´»è¿‡ç¨‹</em>ï¼ˆä¸ºäº†å®‰å…¨èµ·è§ï¼Œ<code>pinia.state.value</code>è¢«è½¬ä¹‰ä¸ºå…¶ä»–å½¢å¼ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pinia.<span class="property">state</span>.<span class="property">value</span> = &#123;&#125;;</span><br></pre></td></tr></table></figure><h3 id="è®¢é˜…-State"><a href="#è®¢é˜…-State" class="headerlink" title="è®¢é˜… State"></a>è®¢é˜… State</h3><p><code>$subscribe</code>ç›‘å¬<code>state</code>çš„å˜åŒ–ï¼Œç›¸æ¯”äº<code>watch</code>ï¼Œå¥½å¤„æ˜¯ <em>subscriptions</em> ï¼ˆè®¢é˜…çš„å†…å®¹ï¼‰åœ¨ <em>patch</em> ååªè§¦å‘ä¸€æ¬¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cartStore.$subscribe(<span class="function">(<span class="params">mutation, state</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// import &#123; MutationType &#125; from &#x27;pinia&#x27;</span></span><br><span class="line">  mutation.<span class="property">type</span>; <span class="comment">// &#x27;direct&#x27; | &#x27;patch object&#x27; | &#x27;patch function&#x27;</span></span><br><span class="line">  <span class="comment">// å’Œ cartStore.$id ä¸€æ ·</span></span><br><span class="line">  mutation.<span class="property">storeId</span>; <span class="comment">// &#x27;cart&#x27;</span></span><br><span class="line">  <span class="comment">// åªæœ‰ mutation.type === &#x27;patch object&#x27;çš„æƒ…å†µä¸‹æ‰å¯ç”¨</span></span><br><span class="line">  mutation.<span class="property">payload</span>; <span class="comment">// ä¼ é€’ç»™ cartStore.$patch() çš„è¡¥ä¸å¯¹è±¡ã€‚</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¯å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°†æ•´ä¸ª state æŒä¹…åŒ–åˆ°æœ¬åœ°å­˜å‚¨ã€‚</span></span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;cart&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(state));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><em>state subscription</em> ä¼šè¢«ç»‘å®šåˆ°æ·»åŠ å®ƒä»¬çš„ç»„ä»¶ä¸Šï¼Œç»„ä»¶è¢«å¸è½½çš„æ—¶å€™ï¼Œè¿™äº›è®¢é˜…ä¼šè¢«åˆ é™¤ã€‚æ·»åŠ <code>&#123;detachd: true&#125;</code>ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°å°†è®¢é˜…ä»å½“å‰ç»„ä»¶ä¸­åˆ†ç¦»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">const someStore = useSomeStore();</span><br><span class="line">// æ­¤è®¢é˜…å™¨å³ä¾¿åœ¨ç»„ä»¶å¸è½½ä¹‹åä»ä¼šè¢«ä¿ç•™</span><br><span class="line">someStore.$subscribe(callback, &#123; detached: true &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>ä¹Ÿå¯ä»¥åœ¨<em>pinia</em>å®ä¾‹ä¸Šç›‘å¬æ•´ä¸ª state</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  pinia.<span class="property">state</span>,</span><br><span class="line">  <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ¯å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°†æ•´ä¸ª state æŒä¹…åŒ–åˆ°æœ¬åœ°å­˜å‚¨ã€‚</span></span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;piniaState&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(state));</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="åœ¨-OptionAPI-çš„ç”¨æ³•"><a href="#åœ¨-OptionAPI-çš„ç”¨æ³•" class="headerlink" title="åœ¨ OptionAPI çš„ç”¨æ³•"></a>åœ¨ OptionAPI çš„ç”¨æ³•</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹æ–‡ä»¶è·¯å¾„ï¼š</span></span><br><span class="line"><span class="comment">// ./src/stores/counter.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&quot;counter&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>mapState()</code>è¾…åŠ©å‡½æ•°å°† state å±æ€§æ˜ å°„ä¸º<strong>åªè¯»</strong>çš„è®¡ç®—å±æ€§</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&#x27;../stores/counter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥è®¿é—®ç»„ä»¶ä¸­çš„ this.count</span></span><br><span class="line">    <span class="comment">// ä¸ä» store.count ä¸­è¯»å–çš„æ•°æ®ç›¸åŒ</span></span><br><span class="line">    ...<span class="title function_">mapState</span>(useCounterStore, [<span class="string">&#x27;count&#x27;</span>])</span><br><span class="line">    <span class="comment">// ä¸ä¸Šè¿°ç›¸åŒï¼Œä½†å°†å…¶æ³¨å†Œä¸º this.myOwnName</span></span><br><span class="line">    ...<span class="title function_">mapState</span>(useCounterStore, &#123;</span><br><span class="line">      <span class="attr">myOwnName</span>: <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">      <span class="comment">// ä½ ä¹Ÿå¯ä»¥å†™ä¸€ä¸ªå‡½æ•°æ¥è·å¾—å¯¹ store çš„è®¿é—®æƒ</span></span><br><span class="line">      <span class="attr">double</span>: <span class="function"><span class="params">store</span> =&gt;</span> store.<span class="property">count</span> * <span class="number">2</span>,</span><br><span class="line">      <span class="comment">// å®ƒå¯ä»¥è®¿é—® `this`ï¼Œä½†å®ƒæ²¡æœ‰æ ‡æ³¨ç±»å‹...</span></span><br><span class="line">      <span class="title function_">magicValue</span>(<span class="params">store</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> store.<span class="property">someGetter</span> + <span class="variable language_">this</span>.<span class="property">count</span> + <span class="variable language_">this</span>.<span class="property">double</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>mapWritableState()</code>è¾…åŠ©å‡½æ•°å°† state æ˜ å°„ä¸º<strong>å¯ä¿®æ”¹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapWritableState &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&#x27;../stores/counter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥è®¿é—®ç»„ä»¶ä¸­çš„ this.countï¼Œå¹¶å…è®¸è®¾ç½®å®ƒã€‚</span></span><br><span class="line">    <span class="comment">// this.count++</span></span><br><span class="line">    <span class="comment">// ä¸ä» store.count ä¸­è¯»å–çš„æ•°æ®ç›¸åŒ</span></span><br><span class="line">    ...<span class="title function_">mapWritableState</span>(useCounterStore, [<span class="string">&#x27;count&#x27;</span>])</span><br><span class="line">    <span class="comment">// ä¸ä¸Šè¿°ç›¸åŒï¼Œä½†å°†å…¶æ³¨å†Œä¸º this.myOwnName</span></span><br><span class="line">    ...<span class="title function_">mapWritableState</span>(useCounterStore, &#123;</span><br><span class="line">      <span class="attr">myOwnName</span>: <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½†æ˜¯å°±ä¸èƒ½ä¼ é€’å‡½æ•°äº†</li></ul><h2 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h2><ul><li>å®Œå…¨ç­‰åŒäº state çš„è®¡ç®—å±æ€§ã€‚æ¨èä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ª state ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°</li><li>åœ¨<code>setup</code>ä¸­ï¼Œå°±æ˜¯é€šè¿‡ state è¿”å›è¡ç”Ÿå€¼çš„é‚£ä¸ªæ–¹æ³•ï¼ˆä¸ä¼ å‚ï¼‰</li><li>ä¸å¯å¼‚æ­¥</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useStore = <span class="title function_">defineStore</span>(<span class="string">&quot;main&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">doubleCount</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">count</span> * <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="è®¿é—®å…¶ä»–-Getter"><a href="#è®¿é—®å…¶ä»–-Getter" class="headerlink" title="è®¿é—®å…¶ä»– Getter"></a>è®¿é—®å…¶ä»– Getter</h3><p>é™¤äº†ä¾èµ– stateï¼Œä¹Ÿå¯ä»¥è®¿é—®åˆ°å…¶ä»–çš„ getter</p><p>åœ¨ä½¿ç”¨<code>TypeScript</code>çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯é€šè¿‡<code>this</code>è®¿é—®å…¶ä»– getterï¼Œéœ€è¦æ˜ç¡®å½“å‰ getter çš„è¿”å›ç±»å‹ï¼ˆts çš„é—®é¢˜ï¼‰</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useStore = <span class="title function_">defineStore</span>(<span class="string">&quot;main&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="comment">// è‡ªåŠ¨æ¨æ–­å‡ºè¿”å›ç±»å‹æ˜¯ä¸€ä¸ª number</span></span><br><span class="line">    <span class="title function_">doubleCount</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">count</span> * <span class="number">2</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// è¿”å›ç±»å‹**å¿…é¡»**æ˜ç¡®è®¾ç½®</span></span><br><span class="line">    <span class="title function_">doublePlusOne</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">      <span class="comment">// æ•´ä¸ª store çš„ è‡ªåŠ¨è¡¥å…¨å’Œç±»å‹æ ‡æ³¨ âœ¨</span></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">doubleCount</span> + <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>è®¿é—®å¦å¤–ä¸€ä¸ª storeï¼ˆå¦å¤–çš„<code>defineStore</code>ï¼‰ çš„ Getterï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„æ“ä½œ</li></ul><h3 id="ä¼ å‚"><a href="#ä¼ å‚" class="headerlink" title="ä¼ å‚"></a>ä¼ å‚</h3><p>è®¡ç®—å±æ€§ä¸ä¼ å‚çš„ï¼Œä¸è¿‡å¯ä»¥è®© getter è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶ä»»æ„å‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useStore = <span class="title function_">defineStore</span>(<span class="string">&quot;main&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">getUserById</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="function">(<span class="params">userId</span>) =&gt;</span> state.<span class="property">users</span>.<span class="title function_">find</span>(<span class="function">(<span class="params">user</span>) =&gt;</span> user.<span class="property">id</span> === userId);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>è¿™æ ·çš„ getter ä¸ä¼šè¢«ç¼“å­˜ï¼ˆè®¡ç®—å±æ€§ç¼“å­˜ï¼‰ï¼Œä½†æ€§èƒ½ä¼šå¥½ç‚¹</li></ul><h3 id="åœ¨setupä¸­ä½¿ç”¨"><a href="#åœ¨setupä¸­ä½¿ç”¨" class="headerlink" title="åœ¨setupä¸­ä½¿ç”¨"></a>åœ¨<code>setup</code>ä¸­ä½¿ç”¨</h3><p>ä½œä¸º store çš„ä¸€ä¸ªå±æ€§ï¼Œå¯ç›´æ¥è®¿é—®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">const store = useCounterStore();</span><br><span class="line">store.count = 3;</span><br><span class="line">store.doubleCount; // 6</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="åœ¨-OptionAPI-ä¸­çš„ç”¨æ³•"><a href="#åœ¨-OptionAPI-ä¸­çš„ç”¨æ³•" class="headerlink" title="åœ¨ OptionAPI ä¸­çš„ç”¨æ³•"></a>åœ¨ OptionAPI ä¸­çš„ç”¨æ³•</h3><p>è¿™é‡Œé¢ä¹Ÿåˆ†ä¸ºä¸¤ç§é£æ ¼ï¼š</p><ol><li>ç»„åˆå¼ APIï¼Œä¸æ˜¯åœ¨<code>&lt;script setup&gt;</code>é‡Œé¢ï¼Œæ˜¯åœ¨<code>defineComponent</code>é‡Œé¢</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&#x27;../stores/counter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> counterStore = <span class="title function_">useCounterStore</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; counterStore &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="title function_">quadrupleCounter</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">counterStore</span>.<span class="property">doubleCount</span> * <span class="number">2</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>OptionAPI çš„å½¢å¼ï¼ˆå’Œ state ä¸€æ ·ï¼Œä½¿ç”¨è¾…åŠ©å‡½æ•°ï¼‰</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&quot;../stores/counter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">// å…è®¸åœ¨ç»„ä»¶ä¸­è®¿é—® this.doubleCount</span></span><br><span class="line">    <span class="comment">// ä¸ä» store.doubleCount ä¸­è¯»å–çš„ç›¸åŒ</span></span><br><span class="line">    ...<span class="title function_">mapState</span>(useCounterStore, [<span class="string">&quot;doubleCount&quot;</span>]),</span><br><span class="line">    <span class="comment">// ä¸ä¸Šè¿°ç›¸åŒï¼Œä½†å°†å…¶æ³¨å†Œä¸º this.myOwnName</span></span><br><span class="line">    ...<span class="title function_">mapState</span>(useCounterStore, &#123;</span><br><span class="line">      <span class="attr">myOwnName</span>: <span class="string">&quot;doubleCount&quot;</span>,</span><br><span class="line">      <span class="comment">// ä½ ä¹Ÿå¯ä»¥å†™ä¸€ä¸ªå‡½æ•°æ¥è·å¾—å¯¹ store çš„è®¿é—®æƒ</span></span><br><span class="line">      <span class="attr">double</span>: <span class="function">(<span class="params">store</span>) =&gt;</span> store.<span class="property">doubleCount</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h2><ul><li>ç›¸å½“äºç»„ä»¶çš„<code>method</code></li><li>åœ¨<code>setup</code>ä¸­ï¼Œå°±æ˜¯æ”¹å˜ state çš„é‚£ä¸ªæ–¹æ³•</li><li>å¯ä»¥æ˜¯å¼‚æ­¥çš„</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mande &#125; <span class="keyword">from</span> <span class="string">&quot;mande&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> api = <span class="title function_">mande</span>(<span class="string">&quot;/api/users&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUsers = <span class="title function_">defineStore</span>(<span class="string">&quot;users&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">userData</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">registerUser</span>(<span class="params">login, password</span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">userData</span> = <span class="keyword">await</span> api.<span class="title function_">post</span>(&#123; login, password &#125;);</span><br><span class="line">        <span class="title function_">showTooltip</span>(<span class="string">`Welcome back <span class="subst">$&#123;<span class="variable language_">this</span>.userData.name&#125;</span>!`</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="title function_">showTooltip</span>(error);</span><br><span class="line">        <span class="comment">// è®©è¡¨å•ç»„ä»¶æ˜¾ç¤ºé”™è¯¯</span></span><br><span class="line">        <span class="keyword">return</span> error;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨çš„æ—¶å€™æ­£å¸¸è°ƒç”¨å°±è¡Œ</li></ul><h3 id="è®¢é˜…-action"><a href="#è®¢é˜…-action" class="headerlink" title="è®¢é˜… action"></a>è®¢é˜… action</h3><p>é€šè¿‡<code>store.$onAction()</code>æ¥ç›‘å¬ action å’Œå®ƒçš„ç»“æœï¼›ä¼ é€’ç»™å®ƒçš„å›è°ƒå‡½æ•°ä¼šåœ¨ action æœ¬èº«ä¹‹å‰æ‰§è¡Œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> unsubscribe = someStore.$onAction(</span><br><span class="line">  <span class="function">(<span class="params">&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">    name, // ä½¿ç”¨åˆ°çš„ action åç§°</span></span></span><br><span class="line"><span class="params"><span class="function">    store, // store å®ä¾‹ï¼Œç±»ä¼¼ <span class="string">`someStore`</span></span></span></span><br><span class="line"><span class="params"><span class="function">    args, // ä¼ é€’ç»™ action çš„å‚æ•°æ•°ç»„</span></span></span><br><span class="line"><span class="params"><span class="function">    after, // åœ¨ action è¿”å›æˆ–è§£å†³åçš„é’©å­</span></span></span><br><span class="line"><span class="params"><span class="function">    onError, // action æŠ›å‡ºæˆ–æ‹’ç»çš„é’©å­</span></span></span><br><span class="line"><span class="params"><span class="function">  &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸ºè¿™ä¸ªç‰¹å®šçš„ action è°ƒç”¨æä¾›ä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line">    <span class="keyword">const</span> startTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="comment">// è¿™å°†åœ¨æ‰§è¡Œ &quot;store &quot;çš„ action ä¹‹å‰è§¦å‘ã€‚</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Start &quot;<span class="subst">$&#123;name&#125;</span>&quot; with params [<span class="subst">$&#123;args.join(<span class="string">&quot;, &quot;</span>)&#125;</span>].`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™å°†åœ¨ action æˆåŠŸå¹¶å®Œå…¨è¿è¡Œåè§¦å‘ã€‚</span></span><br><span class="line">    <span class="comment">// å®ƒç­‰å¾…ç€ä»»ä½•è¿”å›çš„ promiseï¼ˆactionçš„è¿”å›å€¼ï¼‰</span></span><br><span class="line">    <span class="title function_">after</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">        <span class="string">`Finished &quot;<span class="subst">$&#123;name&#125;</span>&quot; after <span class="subst">$&#123;</span></span></span><br><span class="line"><span class="subst"><span class="string">          <span class="built_in">Date</span>.now() - startTime</span></span></span><br><span class="line"><span class="subst"><span class="string">        &#125;</span>ms.\nResult: <span class="subst">$&#123;result&#125;</span>.`</span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœ action æŠ›å‡ºæˆ–è¿”å›ä¸€ä¸ªæ‹’ç»çš„ promiseï¼Œè¿™å°†è§¦å‘</span></span><br><span class="line">    <span class="title function_">onError</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(</span><br><span class="line">        <span class="string">`Failed &quot;<span class="subst">$&#123;name&#125;</span>&quot; after <span class="subst">$&#123;<span class="built_in">Date</span>.now() - startTime&#125;</span>ms.\nError: <span class="subst">$&#123;error&#125;</span>.`</span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰‹åŠ¨åˆ é™¤ç›‘å¬å™¨</span></span><br><span class="line"><span class="title function_">unsubscribe</span>();</span><br></pre></td></tr></table></figure><ul><li>è®¢é˜…é»˜è®¤ç»‘å®šåœ¨<em>æ·»åŠ å®ƒä»¬çš„ç»„ä»¶å†…</em>ï¼Œç»„ä»¶å¸è½½æ—¶ï¼Œè®¢é˜…ä¹Ÿä¼šè‡ªåŠ¨å–æ¶ˆ</li></ul><p>å¦‚æœä¸æƒ³è®©è®¢é˜…è·Ÿç€ç»„ä»¶å–æ¶ˆï¼Œå°†<code>true</code>ä¼ é€’ç»™ç¬¬äºŒä¸ªå‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">const someStore = useSomeStore();</span><br><span class="line">// æ­¤è®¢é˜…å™¨å³ä¾¿åœ¨ç»„ä»¶å¸è½½ä¹‹åä»ä¼šè¢«ä¿ç•™</span><br><span class="line">someStore.$onAction(callback, true);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="åœ¨-OptionAPI-ä¸­çš„ç”¨æ³•-1"><a href="#åœ¨-OptionAPI-ä¸­çš„ç”¨æ³•-1" class="headerlink" title="åœ¨ OptionAPI ä¸­çš„ç”¨æ³•"></a>åœ¨ OptionAPI ä¸­çš„ç”¨æ³•</h3><ol><li>ä½¿ç”¨ <code>setup()</code></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&#x27;../stores/counter&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> counterStore = <span class="title function_">useCounterStore</span>()</span><br><span class="line">    <span class="keyword">return</span> &#123; counterStore &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">incrementAndPrint</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">counterStore</span>.<span class="title function_">increment</span>()</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;New Count:&#x27;</span>, <span class="variable language_">this</span>.<span class="property">counterStore</span>.<span class="property">count</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>ä¸ä½¿ç”¨ <code>setup()</code>ï¼Œä¹Ÿæ˜¯ä½¿ç”¨è¾…åŠ©å‡½æ•°</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapActions &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&#x27;../stores/counter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="comment">// è®¿é—®ç»„ä»¶å†…çš„ this.increment()</span></span><br><span class="line">    <span class="comment">// ä¸ä» store.increment() è°ƒç”¨ç›¸åŒ</span></span><br><span class="line">    ...<span class="title function_">mapActions</span>(useCounterStore, [<span class="string">&#x27;increment&#x27;</span>])</span><br><span class="line">    <span class="comment">// ä¸ä¸Šè¿°ç›¸åŒï¼Œä½†å°†å…¶æ³¨å†Œä¸ºthis.myOwnName()</span></span><br><span class="line">    ...<span class="title function_">mapActions</span>(useCounterStore, &#123; <span class="attr">myOwnName</span>: <span class="string">&#x27;increment&#x27;</span> &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h1><p>æ’ä»¶æ˜¯<strong>ä¸€ä¸ªå‡½æ•°</strong>ï¼Œé€šè¿‡<code>pinia.use()</code>æ·»åŠ åˆ° pinia å®ä¾‹ä¸­ï¼Œå¯ä»¥<strong>é€‰æ‹©æ€§åœ°è¿”å›</strong>è¦æ·»åŠ åˆ° store çš„å±æ€§</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>();</span><br><span class="line"></span><br><span class="line">pinia.<span class="title function_">use</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºçš„æ¯ä¸ª store ä¸­éƒ½ä¼šæ·»åŠ ä¸€ä¸ªåä¸º `secret` çš„å±æ€§ã€‚</span></span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">secret</span>: <span class="string">&quot;the cake is a lie&quot;</span> &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">useStore</span>();</span><br><span class="line">store.<span class="property">secret</span>; <span class="comment">// &#x27;the cake is a lie&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>æ‰€ä»¥åœ¨åˆ›å»ºå…¨å±€ï¼ˆå…±äº«ï¼‰çš„ store å˜é‡æ—¶å¾ˆæœ‰ç”¨</li><li>æ¯ä¸ª store éƒ½è¢«<code>reactive</code>åŒ…è£…è¿‡ï¼Œæ‰€ä»¥å¯¹äº<code>ref</code>çš„å€¼ä¹Ÿæ— éœ€ä½¿ç”¨<code>.value</code></li></ul><p>æ’ä»¶å‡½æ•°æœ‰ä¸€ä¸ª<strong>å¯é€‰</strong>çš„<code>context</code>å‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">myPiniaPlugin</span>(<span class="params">context</span>) &#123;</span><br><span class="line">  context.<span class="property">pinia</span>; <span class="comment">// ç”¨ `createPinia()` åˆ›å»ºçš„ piniaã€‚</span></span><br><span class="line">  context.<span class="property">app</span>; <span class="comment">// ç”¨ `createApp()` åˆ›å»ºçš„å½“å‰åº”ç”¨(ä»… Vue 3)ã€‚</span></span><br><span class="line">  context.<span class="property">store</span>; <span class="comment">// è¯¥æ’ä»¶æƒ³æ‰©å±•çš„ store</span></span><br><span class="line">  context.<span class="property">options</span>; <span class="comment">// å®šä¹‰ä¼ ç»™ `defineStore()` çš„ store çš„å¯é€‰å¯¹è±¡ã€‚</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ’ä»¶æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥åœ¨<code>pinia.use</code>çš„æ—¶å€™ä¹Ÿå¯ä»¥ä¼ é€’å‚æ•°è¿›å»</p><p>ğŸ¤” ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª<em>context</em>ï¼Œè¦æƒ³æ¥æ”¶åˆ°ä¼ é€’è¿‡æ¥çš„å‚æ•°ï¼Œéœ€è¦ä½¿ç”¨<em>å‡½æ•°æŸ¯é‡ŒåŒ–</em></p><ul><li>åœ¨å¤–é¢å†åŒ…ä¸€å±‚å‡½æ•°ç”¨æ¥æ¥æ”¶ä¼ é€’è¿‡æ¥çš„å‚æ•°</li><li>ç„¶åè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>pinia.use</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">myPlugin</span>(<span class="params">options</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ’ä»¶æ“ä½œ</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ’ä»¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; myPlugin &#125; <span class="keyword">from</span> <span class="string">&quot;xx.js&quot;</span>;</span><br><span class="line"></span><br><span class="line">pinia.<span class="title function_">use</span>(<span class="title function_">myPlugin</span>(&#123; <span class="attr">msg</span>: <span class="string">&quot;hello pinia&quot;</span> &#125;));</span><br></pre></td></tr></table></figure><p>åœ¨ TypeScript ä¸­ä½¿ç”¨æ—¶å¯ä»¥æŒ‡å®š<code>options</code>çš„ç±»å‹ï¼Œç„¶åå†ä½¿ç”¨çš„æ—¶å€™ä¼šæœ‰ç±»å‹æ£€æµ‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Options</span> &#123;</span><br><span class="line">  <span class="attr">msg</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">myPlugin</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">Options</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ’ä»¶æ“ä½œ</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨çš„æ—¶å€™ä¼ é€’ä¸ç¬¦åˆ<code>Options</code>æ—¶ä¼šæŠ¥é”™</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸŒ Vue çŠ¶æ€ç®¡ç†&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="vue" scheme="https://smalljerry.cn/tags/vue/"/>
    
    <category term="çŠ¶æ€ç®¡ç†" scheme="https://smalljerry.cn/tags/%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Vueæ ·å¼ç¯‡</title>
    <link href="https://smalljerry.cn/2023/09/19/Vue%E6%A0%B7%E5%BC%8F%E7%AF%87/"/>
    <id>https://smalljerry.cn/2023/09/19/Vue%E6%A0%B7%E5%BC%8F%E7%AF%87/</id>
    <published>2023-09-18T23:23:32.000Z</published>
    <updated>2025-02-22T02:14:47.345Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸ“¦ Vue3</p><span id="more"></span><h1 id="style"><a href="#style" class="headerlink" title="style"></a><code>style</code></h1><ul><li>å…¨ç§°<code>v-bind:style</code>ï¼Œç®€å†™<code>:style</code></li></ul><p>ğŸ˜ƒ å¦‚æœæ ·å¼éœ€è¦æµè§ˆå™¨å‰ç¼€ï¼ŒVue ä¼šè‡ªåŠ¨åŠ ä¸Š</p><p>ä¹Ÿå¯ä»¥è‡ªå·±ä¼ é€’</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; display: [&#x27;-webkit-box&#x27;, &#x27;-ms-flexbox&#x27;, &#x27;flex&#x27;] &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœæµè§ˆå™¨ä¸éœ€è¦å‰ç¼€ï¼Œç»“æœå°±åªæœ‰<code>display: flex</code></li></ul><p><strong>ä¼ é€’å¯¹è±¡</strong></p><ul><li>å¯ç”¨ <em>camelCase</em> æˆ–è€… <em>kebab-cased</em></li></ul><p>ä½¿ç”¨<code>:style=&quot;&#123;&#125;&quot;</code>æˆ–è€…æ˜¯<code>:style=&quot;[]&quot;</code>ç»‘å®šçš„æ ·å¼</p><blockquote><p>è®°å¾—å€¼ä¹Ÿéœ€è¦ç”¨ <code>&quot;&quot;</code>åŒ…ä½ï¼ŒReact ä¸­å°±ä¸ç”¨ã€‚å¦‚æœéœ€è¦ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ï¼ŒåŒå¼•å·æ¢æˆ**`**</p></blockquote><p>å¸¸è§ä½¿ç”¨ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> activeColor = <span class="title function_">ref</span>(<span class="string">&quot;red&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fontSize = <span class="title function_">ref</span>(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styleObject = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">  <span class="attr">fontSize</span>: <span class="string">&quot;13px&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isBig = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="keyword">const</span> bigActive = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  isBig ? &#123; <span class="attr">fontSize</span>: <span class="string">&quot;18px&quot;</span> &#125; : &#123; <span class="attr">fontSize</span>: <span class="string">&quot;14px&quot;</span> &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; color: activeColor, fontSize: fontSize + &#x27;px&#x27; &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; &#x27;font-size&#x27;: fontSize + &#x27;px&#x27; &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;styleObject&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;isBig&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>ä¼ é€’æ•°ç»„</strong></p><p>åœ¨ JS ä¸­å†™å¥½çš„æ ·å¼å¯¹è±¡ä¼ é€’åˆ°è¡Œå†…çš„æ•°ç»„ä¸­</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;[baseStyles, overridingStyles]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ç»„ä»¶ä¸Šä½¿ç”¨<code>style</code>ï¼Œç»„ä»¶å†…çš„æ ¹å…ƒç´ ä¼šç»§æ‰¿ç»„ä»¶ä¸Šçš„æ ·å¼ã€‚ğŸ‘‰<a href="#%E7%BB%84%E4%BB%B6%E4%B8%8A%E7%9A%84-class">class é€ä¼ </a></p><h1 id="class"><a href="#class" class="headerlink" title="class"></a><code>class</code></h1><ul><li>å…¨ç§°<code>v-bind:class</code>ï¼Œç®€å†™<code>:class</code></li></ul><blockquote><p>è®°å¾—å€¼ä¹Ÿéœ€è¦ç”¨ <code>&quot;&quot;</code>åŒ…ä½</p></blockquote><p><code>class</code>å’Œ<code>:class</code>å¯åŒæ—¶å­˜åœ¨ï¼Œæ¸²æŸ“ååˆå¹¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main-pane&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; active: isActive &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>æ ·å¼ç±»<code>active</code>æ˜¯å¦å­˜åœ¨ï¼Œå–å†³äº<code>isActive</code>æ˜¯å¦ä¸º true</li><li>å’Œ<code>style</code>ä¸€æ ·ï¼Œæ”¯æŒç»‘å®š<em>å¯¹è±¡</em>æˆ–è€…<em>è®¡ç®—å±æ€§</em>ï¼Œä¹Ÿæ”¯æŒ<em>æ•°ç»„</em></li></ul><p>ç»‘å®šæ•°ç»„çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥åœ¨æ•°ç»„é‡Œé¢åµŒå¥—å¯¹è±¡</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;[&#123; active: isActive &#125;, errorClass]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç»„ä»¶ä¸Šçš„-class"><a href="#ç»„ä»¶ä¸Šçš„-class" class="headerlink" title="ç»„ä»¶ä¸Šçš„ class"></a>ç»„ä»¶ä¸Šçš„ class</h2><p>å¯¹äº<strong>å•æ ¹ç»„ä»¶</strong>ï¼Œç»„ä»¶ä¸Šçš„<code>class</code>ä¼šå’Œç»„ä»¶å†…æ ¹å…ƒç´ çš„åˆå¹¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å­ç»„ä»¶æ¨¡æ¿ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;foo bar&quot;</span>&gt;</span>Hi!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åœ¨ä½¿ç”¨ç»„ä»¶æ—¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">class</span>=<span class="string">&quot;baz boo&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>æ¸²æŸ“ç»“æœ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;foo bar baz boo&quot;</span>&gt;</span>Hi!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹äº<strong>å¤šæ ¹ç»„ä»¶</strong>ï¼Œåœ¨ç»„ä»¶å†…éƒ¨éœ€è¦ä½¿ç”¨<code>$attr.class</code>æ¥æŒ‡å®šå“ªä¸ª<strong>æ ¹å…ƒç´ </strong>æ¥æ¥æ”¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- MyComponent æ¨¡æ¿ä½¿ç”¨ $attrs æ—¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">:class</span>=<span class="string">&quot;$attrs.class&quot;</span>&gt;</span>Hi!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>This is a child component<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">class</span>=<span class="string">&quot;baz&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>è¦åœ¨ JS ä¸­è·å–åˆ°ï¼Œå¯ä»¥é€šè¿‡<code>useAttrs()</code></p><p>åœ¨<code>setup</code>ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useAttrs &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">const attrs = useAttrs();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ä¸ç”¨<code>setup</code>çš„è¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props, ctx</span>) &#123;</span><br><span class="line">    <span class="comment">// é€ä¼  attribute è¢«æš´éœ²ä¸º ctx.attrs</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(ctx.<span class="property">attrs</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸èƒ½ç”¨ç›‘å¬å™¨æ¥ç›‘å¬ attrs çš„å˜åŒ–</p></blockquote><h1 id="lt-style-gt-æ ‡ç­¾"><a href="#lt-style-gt-æ ‡ç­¾" class="headerlink" title="&lt;style&gt;æ ‡ç­¾"></a><code>&lt;style&gt;</code>æ ‡ç­¾</h1><h2 id="css-é¢„å¤„ç†å™¨"><a href="#css-é¢„å¤„ç†å™¨" class="headerlink" title="css é¢„å¤„ç†å™¨"></a>css é¢„å¤„ç†å™¨</h2><p><code>&lt;style lang=&#39;xx&#39;&gt;&lt;/style&gt;</code>ï¼š<code>xx</code>ä¸€èˆ¬ä¼šæœ‰ <em>less</em>, <em>sass</em>(ä½¿ç”¨çš„æ—¶å€™ä¼ <em>scss</em>)ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.example</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ ·å¼ä½œç”¨åŸŸ"><a href="#æ ·å¼ä½œç”¨åŸŸ" class="headerlink" title="æ ·å¼ä½œç”¨åŸŸ"></a>æ ·å¼ä½œç”¨åŸŸ</h2><p><code>&lt;style scoped&gt;&lt;/style&gt;</code>ï¼šä½¿å¾—é‡Œé¢çš„æ ·å¼ä»…åœ¨å½“å‰ç»„ä»¶å¯ç”¨</p><ul><li>åœ¨åŒä¸€ç»„ä»¶ä¸­ï¼Œå¯å’Œä»£è¡¨<strong>å…¨å±€</strong>çš„<code>&lt;style&gt;&lt;/style&gt;</code>åŒæ—¶å­˜åœ¨</li><li>è°¨æ…ä½¿ç”¨åä»£é€‰æ‹©å™¨</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;style scoped&gt;</span><br><span class="line">.example &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;example&quot;&gt;hi&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>è½¬æ¢ä¸ºï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.example</span><span class="selector-attr">[data-v-f3f3eg9]</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;example&quot;</span> <span class="attr">data-v-f3f3eg9</span>&gt;</span>hi<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>data-v-f3f3eg9 åé¢çš„å“ˆå¸Œå€¼æ ¹æ®æ–‡ä»¶çš„è·¯å¾„ç”Ÿæˆ</li></ul><blockquote><p>ä½¿ç”¨äº†ä½œç”¨åŸŸä¹‹åï¼Œçˆ¶ç»„ä»¶æ ·å¼ä¸ä¼šå½±å“å­ç»„ä»¶ã€‚ä¸è¿‡ä¸ºäº†å¸ƒå±€è€ƒè™‘ï¼Œå­ç»„ä»¶çš„æ ¹èŠ‚ç‚¹ä¼šå—åˆ°å½±å“</p></blockquote><p><strong>æ·±åº¦é€‰æ‹©å™¨</strong>ï¼š<code>:deep()</code></p><p>åœ¨<em>scoped</em>ä½œç”¨åŸŸé‡Œé¢ï¼Œè¦é€‰æ‹©å­ç»„ä»¶é‡Œé¢çš„å†…å®¹ï¼Œä½¿ç”¨ä¼ªç±»<code>:deep()</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;style scoped&gt;</span><br><span class="line">.a :deep(.b) &#123;</span><br><span class="line">  /* ... */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* å°†ä¼šç¼–è¯‘ä¸º */</span><br><span class="line">.a[data-v-f3f3eg9] .b &#123;</span><br><span class="line">  /* ... */</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><blockquote><p>æ‹¬å·é‡Œé¢çš„å†…å®¹ä¸éœ€è¦ç”¨å¼•å·åŒ…èµ·æ¥</p></blockquote><p><strong>æ’æ§½é€‰æ‹©å™¨</strong>ï¼š<code>:slotted</code></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>scoped</code>ä¸ä¼šå½±å“åˆ°<code>&lt;slot/&gt;</code>æ¸²æŸ“å‡ºæ¥çš„å†…å®¹ï¼Œå› ä¸ºå®ƒä»¬è¢«è®¤ä¸ºæ˜¯çˆ¶ç»„ä»¶æ‰€æŒæœ‰å¹¶ä¼ é€’è¿›æ¥çš„ã€‚</p><p>è¦æŒ‡å®šæ’æ§½çš„é¢å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;style scoped&gt;</span><br><span class="line">:slotted(div) &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><strong>å…¨å±€é€‰æ‹©å™¨</strong>ï¼š<code>:global</code></p><p>å°±æ˜¯è®©å½“å‰æŒ‡å®šçš„é€‰æ‹©å™¨é…ç½®çš„æ ·å¼å…¨å±€èŒƒå›´å†…ç”Ÿæ•ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;style scoped&gt;</span><br><span class="line">:global(.red) &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h2 id="CSS-Modules"><a href="#CSS-Modules" class="headerlink" title="CSS Modules"></a>CSS Modules</h2><p><code>&lt;style module=&quot;xxx&quot;&gt;</code>è¢«ç¼–è¯‘æˆ CSS Module</p><ul><li>åœ¨ CSS Module é‡Œçš„å†…å®¹ä¼šå˜æˆå¯¹è±¡<ul><li>ç›´æ¥<code>module</code>ï¼Œä½¿ç”¨é»˜è®¤åç§°<code>$style</code></li><li>è‡ªå®šä¹‰åç§°<code>module=&quot;classes&quot;</code></li></ul></li><li>å¯åœ¨<code>&lt;template&gt;</code>å’Œ<code>&lt;script setup&gt;</code>ä¸­ä½¿ç”¨</li></ul><p>åœ¨<em>æ¨¡æ¿</em>ä¸­ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;p :class=&quot;$style.red&quot;&gt;This should be red&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style module&gt;</span><br><span class="line">.red &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ul><li>ç»‘å®šçš„ <em>class</em>ä¼šè¿›è¡Œå“ˆå¸ŒåŒ–</li></ul><p>åœ¨ <em>setup</em> ä¸­ä½¿ç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useCssModule &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ setup() ä½œç”¨åŸŸä¸­...</span></span><br><span class="line"><span class="comment">// é»˜è®¤æƒ…å†µä¸‹, è¿”å› &lt;style module&gt; çš„ class</span></span><br><span class="line"><span class="title function_">useCssModule</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·åæƒ…å†µä¸‹, è¿”å› &lt;style module=&quot;classes&quot;&gt; çš„ class</span></span><br><span class="line"><span class="title function_">useCssModule</span>(<span class="string">&quot;classes&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="CSS-ä¸­çš„-v-bind"><a href="#CSS-ä¸­çš„-v-bind" class="headerlink" title="CSS ä¸­çš„ v-bind"></a>CSS ä¸­çš„ <code>v-bind</code></h2><p>åœ¨<code>&lt;style&gt;</code>ä¸­ç”¨æ¥ç»‘å®š<code>&lt;script&gt;</code>ä¸­çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">const theme = &#123;</span><br><span class="line">  color: &quot;red&quot;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;p&gt;hello&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">p &#123;</span><br><span class="line">  // æ˜¯è¡¨è¾¾å¼ï¼Œå°±éœ€è¦ç”¨å¼•å·åŒ…èµ·æ¥</span><br><span class="line">  color: v-bind(&quot;theme.color&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h1 id="åŠ¨ç”»"><a href="#åŠ¨ç”»" class="headerlink" title="åŠ¨ç”»"></a>åŠ¨ç”»</h1><p>Vue æä¾›ç»„ä»¶ <code>&lt;Transition&gt;</code> å’Œ <code>&lt;TransitionGroup&gt;</code> æ¥å¤„ç†å…ƒç´ çš„</p><ul><li>è¿›å…¥</li><li>ç¦»å¼€</li><li>åˆ—è¡¨é¡ºåºå˜åŒ–</li></ul><p>çš„è¿‡æ¸¡æ•ˆæœ</p><ul><li><code>&lt;Transition&gt;</code>ï¼Œç»„ä»¶æˆ–å…ƒç´ <strong>è¿›å…¥</strong>æˆ–<strong>ç¦»å¼€</strong>DOM æ—¶åº”ç”¨åŠ¨ç”»</li><li><code>&lt;TransitionGroup&gt;</code>ï¼Œåœ¨ä¸€ä¸ª<code>v-for</code>åˆ—è¡¨çš„å…ƒç´ æˆ–ç»„ä»¶è¢«<strong>æ’å…¥</strong>ï¼Œ<strong>ç§»åŠ¨</strong>ï¼Œ<strong>åˆ é™¤</strong>æ—¶åº”ç”¨åŠ¨ç”»</li></ul><h2 id="lt-Transition-gt-ç»„ä»¶"><a href="#lt-Transition-gt-ç»„ä»¶" class="headerlink" title="&lt;Transition&gt;ç»„ä»¶"></a><code>&lt;Transition&gt;</code>ç»„ä»¶</h2><blockquote><p>ä»…æ”¯æŒå•ä¸ªå…ƒç´ æˆ–è€…ä¸€ä¸ªå•æ ¹ç»„ä»¶</p></blockquote><p>åŠ¨ç”»é€šè¿‡é»˜è®¤æ’æ§½ä¼ é€’ç»™å®ƒåŒ…è£¹çš„å…ƒç´ æˆ–è€…ç»„ä»¶ä¸Šã€‚è§¦å‘æ¡ä»¶ï¼š</p><ul><li><code>v-if</code></li><li><code>v-show</code></li><li><code>&lt;component&gt;</code>åˆ‡æ¢çš„æ—¶å€™</li><li>æ”¹å˜ç‰¹æ®Šçš„<code>key</code>å±æ€§</li></ul><p>æ•´ä¸ªåŠ¨ç”»è¿‡ç¨‹ï¼š</p><ol><li>Vue ä¼šè‡ªåŠ¨æ£€æµ‹ç›®æ ‡å…ƒç´ æ˜¯å¦åº”ç”¨äº† CSS è¿‡æ¸¡æˆ–åŠ¨ç”»ã€‚åˆ™ä¸€äº› <code>CSSè¿‡æ¸¡class</code>ï¼ˆ<code>v-enter</code>é‚£äº›ï¼‰ä¼šåœ¨é€‚å½“çš„æ—¶æœºè¢«æ·»åŠ å’Œç§»é™¤ã€‚</li><li>å¦‚æœæœ‰ä½œä¸ºç›‘å¬å™¨çš„ <code>JavaScripté’©å­</code>ï¼Œè¿™äº›é’©å­å‡½æ•°ä¼šåœ¨é€‚å½“æ—¶æœºè¢«è°ƒç”¨ã€‚</li><li>ä¸Šé¢ä¸¤ç‚¹éƒ½æ²¡ï¼Œé‚£ä¹ˆ DOM çš„æ’å…¥ã€åˆ é™¤æ“ä½œå°†åœ¨æµè§ˆå™¨çš„ä¸‹ä¸€ä¸ªåŠ¨ç”»å¸§åæ‰§è¡Œã€‚</li></ol><p>ğŸš— å¯ç”¨çš„å±æ€§å’Œäº‹ä»¶</p><p>å±æ€§</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">TransitionProps</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç”¨äºè‡ªåŠ¨ç”Ÿæˆè¿‡æ¸¡ CSS class åã€‚</span></span><br><span class="line"><span class="comment">   * ä¾‹å¦‚ `name: &#x27;fade&#x27;` å°†è‡ªåŠ¨æ‰©å±•ä¸º `.fade-enter`ã€</span></span><br><span class="line"><span class="comment">   * `.fade-enter-active` ç­‰ã€‚</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">name</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ˜¯å¦åº”ç”¨ CSS è¿‡æ¸¡ classã€‚</span></span><br><span class="line"><span class="comment">   * é»˜è®¤ï¼štrue</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">css</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŒ‡å®šè¦ç­‰å¾…çš„è¿‡æ¸¡äº‹ä»¶ç±»å‹</span></span><br><span class="line"><span class="comment">   * æ¥ç¡®å®šè¿‡æ¸¡ç»“æŸçš„æ—¶é—´ã€‚</span></span><br><span class="line"><span class="comment">   * é»˜è®¤æƒ…å†µä¸‹ä¼šè‡ªåŠ¨æ£€æµ‹</span></span><br><span class="line"><span class="comment">   * æŒç»­æ—¶é—´è¾ƒé•¿çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">type</span>?: <span class="string">&quot;transition&quot;</span> | <span class="string">&quot;animation&quot;</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ˜¾å¼æŒ‡å®šè¿‡æ¸¡çš„æŒç»­æ—¶é—´ã€‚</span></span><br><span class="line"><span class="comment">   * é»˜è®¤æƒ…å†µä¸‹æ˜¯ç­‰å¾…è¿‡æ¸¡æ•ˆæœçš„æ ¹å…ƒç´ çš„ç¬¬ä¸€ä¸ª `transitionend`</span></span><br><span class="line"><span class="comment">   * æˆ–`animationend`äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">duration</span>?: <span class="built_in">number</span> | &#123; <span class="attr">enter</span>: <span class="built_in">number</span>; <span class="attr">leave</span>: <span class="built_in">number</span> &#125;;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ§åˆ¶ç¦»å¼€/è¿›å…¥è¿‡æ¸¡çš„æ—¶åºã€‚</span></span><br><span class="line"><span class="comment">   * é»˜è®¤æƒ…å†µä¸‹æ˜¯åŒæ—¶çš„ã€‚</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">mode</span>?: <span class="string">&quot;in-out&quot;</span> | <span class="string">&quot;out-in&quot;</span> | <span class="string">&quot;default&quot;</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ˜¯å¦å¯¹åˆå§‹æ¸²æŸ“ä½¿ç”¨è¿‡æ¸¡ã€‚</span></span><br><span class="line"><span class="comment">   * é»˜è®¤ï¼šfalse</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">appear</span>?: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç”¨äºè‡ªå®šä¹‰è¿‡æ¸¡ class çš„ propã€‚</span></span><br><span class="line"><span class="comment">   * åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨çŸ­æ¨ªçº¿å‘½åï¼Œä¾‹å¦‚ï¼šenter-from-class=&quot;xxx&quot;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">enterFromClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">enterActiveClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">enterToClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">appearFromClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">appearActiveClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">appearToClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">leaveFromClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">leaveActiveClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">leaveToClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº‹ä»¶</p><ul><li>@before-enter</li><li>@before-leave</li><li>@enter</li><li>@leave</li><li>@appear</li><li>@after-enter</li><li>@after-leave</li><li>@after-appear</li><li>@enter-cancelled</li><li>@leave-cancelled (v-show only)</li><li>@appear-cancelled</li></ul><h3 id="åŸºäº-CSS-çš„è¿‡æ¸¡æ•ˆæœ"><a href="#åŸºäº-CSS-çš„è¿‡æ¸¡æ•ˆæœ" class="headerlink" title="åŸºäº CSS çš„è¿‡æ¸¡æ•ˆæœ"></a>åŸºäº CSS çš„è¿‡æ¸¡æ•ˆæœ</h3><h4 id="CSS-è¿‡æ¸¡-class"><a href="#CSS-è¿‡æ¸¡-class" class="headerlink" title="CSS è¿‡æ¸¡ class"></a>CSS è¿‡æ¸¡ class</h4><p><a href="https://cn.vuejs.org/assets/transition-classes.f0f7b3c9.png">å›¾ç‰‡æ¥è‡ª Vue - Transition</a></p><ol><li><p><code>v-enter-from</code>ï¼šè¿›å…¥åŠ¨ç”»çš„èµ·å§‹çŠ¶æ€ã€‚åœ¨å…ƒç´ æ’å…¥ä¹‹å‰æ·»åŠ ï¼Œåœ¨å…ƒç´ æ’å…¥å®Œæˆåçš„ä¸‹ä¸€å¸§ç§»é™¤ã€‚</p></li><li><p><code>v-enter-active</code>ï¼šè¿›å…¥åŠ¨ç”»çš„ç”Ÿæ•ˆçŠ¶æ€ã€‚åº”ç”¨äºæ•´ä¸ªè¿›å…¥åŠ¨ç”»é˜¶æ®µã€‚åœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰æ·»åŠ ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚è¿™ä¸ª class å¯ä»¥è¢«ç”¨æ¥å®šä¹‰è¿›å…¥åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€å»¶è¿Ÿä¸é€Ÿåº¦æ›²çº¿ç±»å‹ã€‚</p></li><li><p><code>v-enter-to</code>ï¼šè¿›å…¥åŠ¨ç”»çš„ç»“æŸçŠ¶æ€ã€‚åœ¨å…ƒç´ æ’å…¥å®Œæˆåçš„ä¸‹ä¸€å¸§è¢«æ·»åŠ  (ä¹Ÿå°±æ˜¯ <code>v-enter-from</code> è¢«ç§»é™¤çš„åŒæ—¶)ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚</p></li><li><p><code>v-leave-from</code>ï¼šç¦»å¼€åŠ¨ç”»çš„èµ·å§‹çŠ¶æ€ã€‚åœ¨ç¦»å¼€è¿‡æ¸¡æ•ˆæœè¢«è§¦å‘æ—¶ç«‹å³æ·»åŠ ï¼Œåœ¨ä¸€å¸§åè¢«ç§»é™¤ã€‚</p></li><li><p><code>v-leave-active</code>ï¼šç¦»å¼€åŠ¨ç”»çš„ç”Ÿæ•ˆçŠ¶æ€ã€‚åº”ç”¨äºæ•´ä¸ªç¦»å¼€åŠ¨ç”»é˜¶æ®µã€‚åœ¨ç¦»å¼€è¿‡æ¸¡æ•ˆæœè¢«è§¦å‘æ—¶ç«‹å³æ·»åŠ ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚è¿™ä¸ª class å¯ä»¥è¢«ç”¨æ¥å®šä¹‰ç¦»å¼€åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€å»¶è¿Ÿä¸é€Ÿåº¦æ›²çº¿ç±»å‹ã€‚</p></li><li><p><code>v-leave-to</code>ï¼šç¦»å¼€åŠ¨ç”»çš„ç»“æŸçŠ¶æ€ã€‚åœ¨ä¸€ä¸ªç¦»å¼€åŠ¨ç”»è¢«è§¦å‘åçš„ä¸‹ä¸€å¸§è¢«æ·»åŠ  (ä¹Ÿå°±æ˜¯ <code>v-leave-from</code> è¢«ç§»é™¤çš„åŒæ—¶)ï¼Œåœ¨è¿‡æ¸¡æˆ–åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚</p></li></ol><p>ä½¿ç”¨<code>name</code>å±æ€§å£°æ˜ä¸€ä¸ªè¿‡æ¸¡æ•ˆæœåæ¥ä»£æ›¿å‰ç¼€<code>v</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Transition name=&quot;fade&quot;&gt;</span><br><span class="line">  ...</span><br><span class="line">&lt;/Transition&gt;</span><br></pre></td></tr></table></figure><ul><li><code>name</code>å¯åŠ¨æ€ç»‘å®š</li></ul><p>æ­é… css è‡ªå·±çš„ <code>tansition</code> å±æ€§ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨ css çš„<code>animation</code>ï¼Œä¸€èˆ¬éƒ½åœ¨<code>*-enter-active</code>å’Œ<code>*-leave</code>ä¸­ä½¿ç”¨</p><blockquote><p>åŒæ—¶ä½¿ç”¨<code>transition</code>å’Œ<code>animation</code>ï¼Œéœ€è¦åœ¨æ ‡ç­¾ä¸­ä½¿ç”¨<code>type</code>å±æ€§ä¼ å…¥ä¸¤è€…ä¹‹ä¸€ï¼Œä»¥å‘Šè¯‰ Vue éœ€è¦å…³æ³¨å“ªç§åŠ¨ç”»ç±»å‹</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  è¿›å…¥å’Œç¦»å¼€åŠ¨ç”»å¯ä»¥ä½¿ç”¨ä¸åŒ</span></span><br><span class="line"><span class="comment">  æŒç»­æ—¶é—´å’Œé€Ÿåº¦æ›²çº¿ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-class">.fade-enter-active</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease-out;</span><br><span class="line">  <span class="comment">/** æˆ–è€… */</span></span><br><span class="line">  <span class="attribute">animation</span>: bounce-in <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.8s</span> <span class="built_in">cubic-bezier</span>(<span class="number">1</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="comment">/** æˆ–è€… */</span></span><br><span class="line">  <span class="attribute">animation</span>: bounce-in <span class="number">0.5s</span> reverse;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-enter-from</span>,</span><br><span class="line"><span class="selector-class">.fade-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">20px</span>);</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> bounce-in &#123;</span><br><span class="line">  <span class="comment">/** */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ‡ åŠ¨ç”»æ•ˆæœä¼šç›´æ¥åº”ç”¨åœ¨å­å…ƒç´ ä¸Šï¼Œæ­¤å¤–è¿˜å¯ä»¥é€‰æ‹©æŒ‡å®šæ›´æ·±å±‚æ¬¡çš„å­å…ƒç´ æ¥è§¦å‘åŠ¨ç”»æ•ˆæœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;Transition name=&quot;nested&quot;&gt;</span><br><span class="line">  &lt;div v-if=&quot;show&quot; class=&quot;outer&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;inner&quot;&gt;</span><br><span class="line">      Hello</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/Transition&gt;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* åº”ç”¨äºåµŒå¥—å…ƒç´ çš„è§„åˆ™ */</span></span><br><span class="line"><span class="selector-class">.nested-enter-active</span> <span class="selector-class">.inner</span>,</span><br><span class="line"><span class="selector-class">.nested-leave-active</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.nested-enter-from</span> <span class="selector-class">.inner</span>,</span><br><span class="line"><span class="selector-class">.nested-leave-to</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">30px</span>);</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* ... çœç•¥äº†å…¶ä»–å¿…è¦çš„ CSS */</span></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥å•ç‹¬æ‹¿å‡ºæ¥ï¼Œæ·»åŠ ä¸€ä¸ªè¿‡æ¸¡å»¶è¿Ÿï¼Œä»¥è·å¾—äº¤é”™æ•ˆæœ</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å»¶è¿ŸåµŒå¥—å…ƒç´ çš„è¿›å…¥ä»¥è·å¾—äº¤é”™æ•ˆæœ */</span></span><br><span class="line"><span class="selector-class">.nested-enter-active</span> <span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">transition-delay</span>: <span class="number">0.25s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‘æ ‡ç­¾ä¼ é€’<code>duration</code>æ¥æŒ‡å®šè¿‡æ¸¡çš„æŒç»­æ—¶é—´ï¼Œä»¥ç¡®ä¿è¿™ä¸ªå»¶è¿Ÿä¼šåœ¨è¿™ä¸ªåŠ¨ç”»å‘¨æœŸä¸­ç”Ÿæ•ˆï¼ˆå¦‚æœåœ¨<code>transitionend</code>å’Œ<code>animationend</code>æ—¶é—´ç»“æŸäº†ï¼Œå»¶è¿Ÿéƒ½æ²¡åˆ°æ¥ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Transition :duration=&quot;550&quot;&gt;...&lt;/Transition&gt;</span><br><span class="line">&lt;!-- ä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªå¯¹è±¡æ¥åˆ†åˆ«æŒ‡å®šè¿›å…¥å’Œç¦»å¼€ --&gt;</span><br><span class="line">&lt;Transition :duration=&quot;&#123; enter: 500, leave: 800 &#125;&quot;&gt;...&lt;/Transition&gt;</span><br></pre></td></tr></table></figure><h4 id="è‡ªå®šä¹‰è¿‡æ¸¡-class"><a href="#è‡ªå®šä¹‰è¿‡æ¸¡-class" class="headerlink" title="è‡ªå®šä¹‰è¿‡æ¸¡ class"></a>è‡ªå®šä¹‰è¿‡æ¸¡ class</h4><p>å‘ <code>&lt;Transition&gt;</code> ä¼ é€’ä»¥ä¸‹çš„ props æ¥æŒ‡å®šè‡ªå®šä¹‰çš„è¿‡æ¸¡ classï¼š</p><ul><li>enter-from-class</li><li>enter-active-class</li><li>enter-to-class</li><li>leave-from-class</li><li>leave-active-class</li><li>leave-to-class</li></ul><p>åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹ CSS åŠ¨ç”»åº“çš„æ—¶å€™éå¸¸æœ‰ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- å‡è®¾ä½ å·²ç»åœ¨é¡µé¢ä¸­å¼•å…¥äº† Animate.css --&gt;</span><br><span class="line">&lt;Transition</span><br><span class="line">  name=&quot;custom-classes&quot;</span><br><span class="line">  enter-active-class=&quot;animate__animated animate__tada&quot;</span><br><span class="line">  leave-active-class=&quot;animate__animated animate__bounceOutRight&quot;</span><br><span class="line">&gt;</span><br><span class="line">  &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt;</span><br><span class="line">&lt;/Transition&gt;</span><br></pre></td></tr></table></figure><h3 id="JavaScript-é’©å­"><a href="#JavaScript-é’©å­" class="headerlink" title="JavaScript é’©å­"></a>JavaScript é’©å­</h3><p>ä¹Ÿå¯ä¸å¬è¿‡ç›‘å¬<code>&lt;Transition&gt;</code>ç»„ä»¶ä¸Šçš„äº‹ä»¶æ¥å®ç°åŠ¨ç”»</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Transition</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">before-enter</span>=<span class="string">&quot;onBeforeEnter&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">enter</span>=<span class="string">&quot;onEnter&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">after-enter</span>=<span class="string">&quot;onAfterEnter&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">enter-cancelled</span>=<span class="string">&quot;onEnterCancelled&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">before-leave</span>=<span class="string">&quot;onBeforeLeave&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">leave</span>=<span class="string">&quot;onLeave&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">after-leave</span>=<span class="string">&quot;onAfterLeave&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">leave-cancelled</span>=<span class="string">&quot;onLeaveCancelled&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å…ƒç´ è¢«æ’å…¥åˆ° DOM ä¹‹å‰è¢«è°ƒç”¨</span></span><br><span class="line"><span class="comment">// ç”¨è¿™ä¸ªæ¥è®¾ç½®å…ƒç´ çš„ &quot;enter-from&quot; çŠ¶æ€</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onBeforeEnter</span>(<span class="params">el</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨å…ƒç´ è¢«æ’å…¥åˆ° DOM ä¹‹åçš„ä¸‹ä¸€å¸§è¢«è°ƒç”¨</span></span><br><span class="line"><span class="comment">// ç”¨è¿™ä¸ªæ¥å¼€å§‹è¿›å…¥åŠ¨ç”»</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onEnter</span>(<span class="params">el, done</span>) &#123;</span><br><span class="line">  <span class="comment">// è°ƒç”¨å›è°ƒå‡½æ•° done è¡¨ç¤ºè¿‡æ¸¡ç»“æŸ</span></span><br><span class="line">  <span class="comment">// å¦‚æœä¸ CSS ç»“åˆä½¿ç”¨ï¼Œåˆ™è¿™ä¸ªå›è°ƒæ˜¯å¯é€‰å‚æ•°</span></span><br><span class="line">  <span class="title function_">done</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“è¿›å…¥è¿‡æ¸¡å®Œæˆæ—¶è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onAfterEnter</span>(<span class="params">el</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“è¿›å…¥è¿‡æ¸¡åœ¨å®Œæˆä¹‹å‰è¢«å–æ¶ˆæ—¶è°ƒç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onEnterCancelled</span>(<span class="params">el</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ leave é’©å­ä¹‹å‰è°ƒç”¨</span></span><br><span class="line"><span class="comment">// å¤§å¤šæ•°æ—¶å€™ï¼Œä½ åº”è¯¥åªä¼šç”¨åˆ° leave é’©å­</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onBeforeLeave</span>(<span class="params">el</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ç¦»å¼€è¿‡æ¸¡å¼€å§‹æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="comment">// ç”¨è¿™ä¸ªæ¥å¼€å§‹ç¦»å¼€åŠ¨ç”»</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onLeave</span>(<span class="params">el, done</span>) &#123;</span><br><span class="line">  <span class="comment">// è°ƒç”¨å›è°ƒå‡½æ•° done è¡¨ç¤ºè¿‡æ¸¡ç»“æŸ</span></span><br><span class="line">  <span class="comment">// å¦‚æœä¸ CSS ç»“åˆä½¿ç”¨ï¼Œåˆ™è¿™ä¸ªå›è°ƒæ˜¯å¯é€‰å‚æ•°</span></span><br><span class="line">  <span class="title function_">done</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ç¦»å¼€è¿‡æ¸¡å®Œæˆã€</span></span><br><span class="line"><span class="comment">// ä¸”å…ƒç´ å·²ä» DOM ä¸­ç§»é™¤æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onAfterLeave</span>(<span class="params">el</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»…åœ¨ v-show è¿‡æ¸¡ä¸­å¯ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onLeaveCancelled</span>(<span class="params">el</span>) &#123;&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»…ç”± JavaScript æ‰§è¡Œçš„åŠ¨ç”»æ—¶ï¼Œå¯æ·»åŠ ä¸€ä¸ª <code>:css=&quot;false&quot;</code>ï¼Œå‘Šè¯‰ Vue å¯è·³è¿‡å¯¹ CSS è¿‡æ¸¡çš„è‡ªåŠ¨æ£€æµ‹ã€‚ä½¿ç”¨ä¹‹åï¼š</p><ul><li><code>@enter</code>å’Œ<code>@leave</code>å›è°ƒå‡½æ•°<code>done</code>æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™é’©å­ä¼šè¢«åŒæ­¥è°ƒç”¨ï¼Œè¿‡æ¸¡å°†ç«‹å³å®Œæˆ</li></ul><h3 id="å¯å¤ç”¨"><a href="#å¯å¤ç”¨" class="headerlink" title="å¯å¤ç”¨"></a>å¯å¤ç”¨</h3><p>ğŸ˜ƒ å¯ä»¥å‘æ ‡ç­¾é‡Œé¢ä¼ é€’<code>&lt;slot&gt;</code>æ¥å°è£…æˆå¯å¤ç”¨çš„è¿‡æ¸¡ç»„ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- MyTransition.vue --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// JavaScript é’©å­é€»è¾‘...</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- åŒ…è£…å†…ç½®çš„ Transition ç»„ä»¶ --&gt;</span><br><span class="line">  &lt;Transition name=&quot;my-transition&quot; @enter=&quot;onEnter&quot; @leave=&quot;onLeave&quot;&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;!-- å‘å†…ä¼ é€’æ’æ§½å†…å®¹ --&gt;</span><br><span class="line">  &lt;/Transition&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">/*</span><br><span class="line">  å¿…è¦çš„ CSS...</span><br><span class="line">  æ³¨æ„ï¼šé¿å…åœ¨è¿™é‡Œä½¿ç”¨ &lt;style scoped&gt;</span><br><span class="line">  å› ä¸ºé‚£ä¸ä¼šåº”ç”¨åˆ°æ’æ§½å†…å®¹ä¸Š</span><br><span class="line">*/</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">MyTransition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;show&quot;</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">MyTransition</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–è¿‡æ¸¡æ•ˆæœ"><a href="#å…¶ä»–è¿‡æ¸¡æ•ˆæœ" class="headerlink" title="å…¶ä»–è¿‡æ¸¡æ•ˆæœ"></a>å…¶ä»–è¿‡æ¸¡æ•ˆæœ</h3><p><strong>å‡ºç°æ—¶è¿‡æ¸¡</strong></p><p>åˆæ¬¡æ¸²æŸ“æ—¶åº”ç”¨ä¸€ä¸ªè¿‡æ¸¡æ•ˆæœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Transition appear&gt;</span><br><span class="line">  ...</span><br><span class="line">&lt;/Transition&gt;</span><br></pre></td></tr></table></figure><p><strong>å…ƒç´ é—´è¿‡æ¸¡</strong></p><p>ä½¿ç”¨ <code>v-if</code> / <code>v-else</code> / <code>v-else-if</code>åœ¨å‡ ä¸ªç»„ä»¶ä¹‹é—´åˆ‡æ¢</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;docState === &#x27;saved&#x27;&quot;</span>&gt;</span>Edit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-else-if</span>=<span class="string">&quot;docState === &#x27;edited&#x27;&quot;</span>&gt;</span>Save<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-else-if</span>=<span class="string">&quot;docState === &#x27;editing&#x27;&quot;</span>&gt;</span>Cancel<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>è¿‡æ¸¡æ¨¡å¼</strong></p><p>æƒ³å…ˆæ‰§è¡Œç¦»å¼€åŠ¨ç”»ï¼Œç­‰å®ƒå®Œæˆä¹‹ååœ¨æ‰§è¡Œå…ƒç´ çš„è¿›å…¥åŠ¨ç”»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Transition mode=&quot;out-in&quot;&gt;</span><br><span class="line">  ...</span><br><span class="line">&lt;/Transition&gt;</span><br></pre></td></tr></table></figure><ul><li>ä¹Ÿæ”¯æŒ<code>in-out</code>ï¼Œä½†æ˜¯ä¸å¸¸ç”¨</li></ul><p><strong>ç»„ä»¶ä¹‹é—´è¿‡æ¸¡</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Transition name=&quot;fade&quot; mode=&quot;out-in&quot;&gt;</span><br><span class="line">  &lt;component :is=&quot;activeComponent&quot;&gt;&lt;/component&gt;</span><br><span class="line">&lt;/Transition&gt;</span><br></pre></td></tr></table></figure><h3 id="æ€§èƒ½è€ƒè™‘"><a href="#æ€§èƒ½è€ƒè™‘" class="headerlink" title="æ€§èƒ½è€ƒè™‘"></a>æ€§èƒ½è€ƒè™‘</h3><p>å¤šæ•°ä½¿ç”¨<code>transform</code>å’Œ<code>opacity</code></p><ol><li>å› ä¸ºä¸ä¼šå½±å“åˆ° DOM ç»“æ„</li><li>å¤šæ•°ç°ä»£æµè§ˆå™¨çš„<code>transform</code>åŠ¨ç”»ä¼šä½¿ç”¨ GPU è¿›è¡Œç¡¬ä»¶åŠ é€Ÿ</li></ol><p>ç›¸æ¯”ä¹‹ä¸‹<code>height</code>ã€<code>margin</code>è¿™äº›ä¼šè§¦å‘ CSS å¸ƒå±€å˜åŠ¨ï¼Œè®¡ç®—æ¶ˆè€—å°±é«˜äº†ã€‚<a href="https://csstriggers.com/">ğŸŒ æŸ¥çœ‹æ›´å¤š</a></p><h2 id="lt-TransitionGroup-gt-ç»„ä»¶"><a href="#lt-TransitionGroup-gt-ç»„ä»¶" class="headerlink" title="&lt;TransitionGroup&gt;ç»„ä»¶"></a><code>&lt;TransitionGroup&gt;</code>ç»„ä»¶</h2><p>å’Œ<code>&lt;Transition&gt;</code>åŸºæœ¬ç›¸åŒçš„å±æ€§ã€CSS è¿‡æ¸¡ classã€JavaScript é’©å­</p><p>åŒºåˆ«ï¼š</p><ul><li>é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šç”Ÿæˆå®¹å™¨å…ƒç´ ï¼›é€šè¿‡<code>tag</code>æŒ‡å®šä¸€ä¸ªå…ƒç´ ä½œä¸ºå®¹å™¨å…ƒç´ æ¥æ¸²æŸ“ï¼ˆå¤–å±‚è‡ªåŠ¨ç”Ÿæˆçš„åŒ…è£¹å±‚ï¼‰</li><li>_è¿‡æ¸¡æ¨¡å¼_ï¼ˆ<code>mode</code>ï¼‰ä¸å¯ç”¨</li><li>åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ éœ€è¦æœ‰å”¯ä¸€<code>key</code></li><li>CSS è¿‡æ¸¡ class ä¼šè¢«åº”ç”¨åœ¨åˆ—è¡¨ä¸Šè€Œä¸æ˜¯å®¹å™¨å…ƒç´ ä¸Š</li></ul><blockquote><p>åœ¨<em>DOM æ¨¡æ¿</em>ï¼ˆhtml æ–‡ä»¶æˆ–è€… JS ç‰‡æ®µï¼‰ä¸­ä½¿ç”¨æ—¶ï¼Œéœ€è¦ä½¿ç”¨<code>&lt;transition-group&gt;</code></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;TransitionGroup name=&quot;list&quot; tag=&quot;ul&quot;&gt;</span><br><span class="line">  &lt;li v-for=&quot;item in items&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">    &#123;&#123; item &#125;&#125;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">&lt;/TransitionGroup&gt;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.list-move</span>, <span class="comment">/* å¯¹ç§»åŠ¨ä¸­çš„å…ƒç´ åº”ç”¨çš„è¿‡æ¸¡ */</span></span><br><span class="line"><span class="selector-class">.list-enter-active</span>,</span><br><span class="line"><span class="selector-class">.list-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.5s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.list-enter-from</span>,</span><br><span class="line"><span class="selector-class">.list-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">30px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç¡®ä¿å°†ç¦»å¼€çš„å…ƒç´ ä»å¸ƒå±€æµä¸­åˆ é™¤</span></span><br><span class="line"><span class="comment">  ä»¥ä¾¿èƒ½å¤Ÿæ­£ç¡®åœ°è®¡ç®—ç§»åŠ¨çš„åŠ¨ç”»ã€‚ */</span></span><br><span class="line"><span class="selector-class">.list-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº‹ä»¶å’Œ<code>&lt;Transition&gt;</code>ä¸€æ ·</p><p>å±æ€§å¯¹æ¯”<code>&lt;Transition&gt;</code>å°‘äº†<code>mode</code>ï¼Œå…¶ä»–ä¸€æ ·ï¼Œå¹¶ä¸”å¤šäº†ä¸¤ä¸ªï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">TransitionGroupProps</span> <span class="keyword">extends</span> <span class="title class_">Omit</span>&lt;<span class="title class_">TransitionProps</span>, &quot;mode&quot;&gt; &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å¦‚æœæœªå®šä¹‰ï¼Œåˆ™æ¸²æŸ“ä¸ºç‰‡æ®µ (fragment)ã€‚</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">tag</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç”¨äºè‡ªå®šä¹‰è¿‡æ¸¡æœŸé—´è¢«åº”ç”¨çš„ CSS classã€‚</span></span><br><span class="line"><span class="comment">   * åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ kebab-caseï¼Œä¾‹å¦‚ move-class=&quot;xxx&quot;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">moveClass</span>?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¸è¿›å»¶è¿Ÿåˆ—è¡¨åŠ¨ç”»"><a href="#æ¸è¿›å»¶è¿Ÿåˆ—è¡¨åŠ¨ç”»" class="headerlink" title="æ¸è¿›å»¶è¿Ÿåˆ—è¡¨åŠ¨ç”»"></a>æ¸è¿›å»¶è¿Ÿåˆ—è¡¨åŠ¨ç”»</h3><ul><li>é€šè¿‡è¯»å–å…ƒç´ çš„ data attribute</li></ul><p>æŠŠæ¯ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•æ¸²æŸ“ä¸ºè¯¥å…ƒç´ ä¸Šçš„ä¸€ä¸ª data attribute</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;TransitionGroup</span><br><span class="line">  tag=&quot;ul&quot;</span><br><span class="line">  :css=&quot;false&quot;</span><br><span class="line">  @before-enter=&quot;onBeforeEnter&quot;</span><br><span class="line">  @enter=&quot;onEnter&quot;</span><br><span class="line">  @leave=&quot;onLeave&quot;</span><br><span class="line">&gt;</span><br><span class="line">  &lt;li</span><br><span class="line">    v-for=&quot;(item, index) in computedList&quot;</span><br><span class="line">    :key=&quot;item.msg&quot;</span><br><span class="line">    :data-index=&quot;index&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &#123;&#123; item.msg &#125;&#125;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">&lt;/TransitionGroup&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ JavaScript é’©å­ä¸­ï¼ŒåŸºäºå½“å‰å…ƒç´ çš„ data attribute å¯¹å…ƒç´ çš„è¿›åœºåŠ¨ç”»æ·»åŠ ä¸€ä¸ªå»¶è¿Ÿ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">onEnter</span>(<span class="params">el, done</span>) &#123;</span><br><span class="line">  gsap.<span class="title function_">to</span>(el, &#123;</span><br><span class="line">    <span class="attr">opacity</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="string">&quot;1.6em&quot;</span>,</span><br><span class="line">    <span class="attr">delay</span>: el.<span class="property">dataset</span>.<span class="property">index</span> * <span class="number">0.15</span>,</span><br><span class="line">    <span class="attr">onComplete</span>: done,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸ“¦ Vue3&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="vue" scheme="https://smalljerry.cn/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>Rollupå¿«é€Ÿæ‰‹å†Œ</title>
    <link href="https://smalljerry.cn/2023/09/03/Rollup%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C/"/>
    <id>https://smalljerry.cn/2023/09/03/Rollup%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C/</id>
    <published>2023-09-03T08:10:14.000Z</published>
    <updated>2025-02-22T02:14:47.344Z</updated>
    
    <content type="html"><![CDATA[<p>ã€ğŸš§ æ–½å·¥ä¸­ã€‘</p><p>[ ] ç›¸å…³æ’ä»¶æ¡ˆä¾‹</p><span id="more"></span><h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><h2 id="å¸¸è§è¯æ±‡"><a href="#å¸¸è§è¯æ±‡" class="headerlink" title="å¸¸è§è¯æ±‡"></a>å¸¸è§è¯æ±‡</h2><p><strong>æ†ç»‘åŒ…ï¼ˆbundleï¼‰</strong></p><p>æ˜¯æŒ‡å°†å¤šä¸ªæºä»£ç æ–‡ä»¶æˆ–æ¨¡å—ç»„åˆæˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶æˆ–ä¸€ç»„æ–‡ä»¶çš„è¿‡ç¨‹</p><ul><li>å‡å°æ–‡ä»¶æ•°é‡ï¼Œæ›´æœ‰æ•ˆåœ¨æµè§ˆå™¨æˆ–è€…å…¶ä»–ç¯å¢ƒä¸­åŠ è½½å’Œæ‰§è¡Œ</li><li>å‡å°‘ç½‘ç»œè¯·æ±‚</li></ul><p>ç”¨äºéƒ¨ç½²åœ¨ç”Ÿäº§ç¯å¢ƒï¼Œä¸€èˆ¬ä¼šç»è¿‡å‹ç¼©å’Œæ··æ·†</p><h2 id="rollup-æ¦‚å¿µ"><a href="#rollup-æ¦‚å¿µ" class="headerlink" title="rollup æ¦‚å¿µ"></a>rollup æ¦‚å¿µ</h2><ol><li>å‘æœªæ¥å…¼å®¹</li><li>é™¤å±‘ä¼˜åŒ–ï¼ˆTree-shakingï¼‰</li></ol><p><strong>å‘æœªæ¥å…¼å®¹</strong></p><p>è™½ç„¶<code>ES6</code>æ–°ç‰¹æ€§åœ¨ç°ä»£æµè§ˆå™¨ä¸­å·²ç»ç¨³å®šï¼Œä½†åœ¨ Nodejs ä¸­è¿˜æœªå®Œå…¨è½åœ°</p><p>Rollup çš„ä½œç”¨å°±æ˜¯å¯ä»¥ä½¿ç”¨æ–°çš„ç‰¹æ€§ï¼Œç„¶åæ‰“åŒ…æˆ<code>CommonJS</code>æˆ–<code>AMD</code>ç­‰æ ¼å¼ï¼Œå³ä½¿ä»¥åè¿™äº›ç‰¹æ€§åœ¨ Nodejs ä¸­å®Œæ•´æ”¯æŒï¼Œç°åœ¨çš„ä»£ç ä¹Ÿä¸éœ€è¦æ”¹åŠ¨ï¼ˆå‘æœªæ¥å…¼å®¹ï¼‰</p><p><strong>é™¤å±‘ä¼˜åŒ–</strong></p><p>é™æ€åˆ†æå¯¼å…¥çš„ä»£ç ï¼Œç„¶åå»é™¤æ²¡æœ‰ä½¿ç”¨çš„ä»£ç ï¼Œå‡å°‘æ‰“åŒ…åçš„ä½“ç§¯</p><p>ğŸ“„ åŸå§‹æ–‡ä»¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;./utils&#x27;</span>);<span class="string">`ï¼Œ</span></span><br></pre></td></tr></table></figure><p>ä½†ä½¿ç”¨çš„æ—¶å€™åªç”¨åˆ°<code>utils</code>ä¸­çš„<code>ajax</code>æ–¹æ³•ï¼Œæ‰“åŒ…å‡ºæ¥ä¼šæ˜¯ï¼š</p><p>ğŸ“„ æ‰“åŒ…ç»“æœ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ajax &#125; <span class="keyword">from</span> <span class="string">&quot;./utils&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å…¨å±€å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install rollup --global</span><br></pre></td></tr></table></figure><p>æœ¬åœ°å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install rollup --save-dev</span><br></pre></td></tr></table></figure><p><code>package.json</code>ä¸­çš„<code>scripts</code>èŠ‚ç‚¹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rollup --config&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h1><h2 id="å‘½ä»¤è¡Œ"><a href="#å‘½ä»¤è¡Œ" class="headerlink" title="å‘½ä»¤è¡Œ"></a>å‘½ä»¤è¡Œ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main.js</span></span><br><span class="line"><span class="keyword">import</span> foo <span class="keyword">from</span> <span class="string">&quot;./foo.js&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/foo.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">&quot;hello world!&quot;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rollup src/main.js -f cjs</span><br></pre></td></tr></table></figure><ul><li><code>-f</code>å…¨ç§°<code>--format</code>ï¼ŒæŒ‡å®šä¸º<em>CommonJS</em></li><li>æ²¡æœ‰æŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œé»˜è®¤ä»¥<code>stdout</code>è¾“å‡º</li></ul><p>å¾—åˆ°è¾“å‡ºå†…å®¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = <span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> main = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(foo);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = main;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>-o</code>æŒ‡å®šè¾“å‡ºæ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rollup src/main.js -o bundle.js -f cjs</span><br></pre></td></tr></table></figure><h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.mjs</span></span><br><span class="line"><span class="keyword">import</span> xxplugin <span class="keyword">from</span> <span class="string">&quot;xxplugin&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">input</span>: <span class="string">&quot;src/main.js&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">file</span>: <span class="string">&quot;bundle.js&quot;</span>, <span class="comment">// è¿˜å¯ä»¥ä½¿ç”¨ dir</span></span><br><span class="line">    <span class="attr">format</span>: <span class="string">&quot;cjs&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">xxplugin</span>()],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœè¾“å‡ºä¸€ä¸ªä»¥ä¸Šçš„æ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨<code>output.dir</code></li></ul><p><em>CJS</em>çš„è¯ï¼Œä½¿ç”¨<code>module.exports = &#123;/* config */&#125;</code></p><p>ä½¿ç”¨<code>-c</code>ï¼ˆ<code>--config</code>ï¼‰æŒ‡å®šé…ç½®æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rollup -c</span><br></pre></td></tr></table></figure><ul><li>ä¼šè‡ªåŠ¨è¯»å–<code>rollup.config.js</code>æˆ–<code>rollup.config.mjs</code>ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä¼šæŠ¥é”™</li></ul><p>å¯ä»¥åœ¨å‘½ä»¤è¡Œéšä¾¿è¦†ç›–é…ç½®æ–‡ä»¶çš„é…ç½®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rollup -c -o bundle-2.js # `-o` ç­‰ä»·äº `--file`ï¼ˆæ›¾ç”¨åä¸º &quot;output&quot;ï¼‰</span><br></pre></td></tr></table></figure><p>ğŸ‡ ä¸€èˆ¬ä¼šä½¿ç”¨<code>defindConfig</code>å‡½æ•°ï¼Œè¿™æ ·ä¼šæœ‰ä»£ç æç¤º</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;rollup&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="comment">/* ä½ çš„é…ç½® */</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="mjs-å’Œ-cjs"><a href="#mjs-å’Œ-cjs" class="headerlink" title="mjs å’Œ cjs"></a>mjs å’Œ cjs</h3><p>é»˜è®¤å°±æ˜¯<code>cjs</code>ï¼Œå³ä½¿æ˜¯<code>.js</code>æ–‡ä»¶ã€‚å¦‚æœè¦ä½¿ç”¨<code>mjs</code>ï¼Œéœ€è¦åœ¨<code>package.json</code>ä¸­é…ç½®ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;module&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨<code>cjs</code>çš„è¯ï¼Œ<code>__dirname</code>å¯ç”¨</li></ul><h3 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h3><p><code>@rollup/plugin-typescript</code>æ’ä»¶å¯ä»¥è®© Rollup æ”¯æŒ TypeScript</p><ul><li>é…ç½®æ–‡ä»¶<code>.ts</code></li><li><code>tsconfig.json</code>ä¸­çš„<code>include</code>å­—æ®µåŒ…å«é…ç½®æ–‡ä»¶</li></ul><p>åœ¨ <em>TypeScript</em> ä¸­æ”¯æŒä½¿ç”¨<code>RollupOptions</code>ç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">RollupOptions</span> &#125; <span class="keyword">from</span> <span class="string">&quot;rollup&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">config</span>: <span class="title class_">RollupOptions</span> = &#123;</span><br><span class="line">  <span class="comment">/* ä½ çš„é…ç½® */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> config;</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><blockquote><p><code>import.meta.url</code>çš„è·¯å¾„æ˜¯å½“å‰æ–‡ä»¶çš„è·¯å¾„ï¼Œè€Œä¸æ˜¯<code>process.cwd()</code>çš„è·¯å¾„</p></blockquote><h3 id="è·¯å¾„ä½¿ç”¨"><a href="#è·¯å¾„ä½¿ç”¨" class="headerlink" title="è·¯å¾„ä½¿ç”¨"></a>è·¯å¾„ä½¿ç”¨</h3><p>åœ¨ CommonJS ä¸­ï¼Œç»å¸¸ä¼šç”¨åˆ°<code>__dirname</code>ï¼Œä½†æ˜¯åœ¨ Rollup åŸç”Ÿ ES æ¨¡å—ä¸­ï¼Œæ˜¯æ²¡æœ‰è¿™ä¸ªçš„ï¼Œæ¨èä½¿ç”¨<code>import.meta.url</code>æ¥è·å–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; fileURLToPath &#125; <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  ...,</span><br><span class="line">  <span class="comment">// ä¸º &lt;currentdir&gt;/src/some-file.js ç”Ÿæˆç»å¯¹è·¯å¾„</span></span><br><span class="line">  <span class="attr">external</span>: [<span class="title function_">fileURLToPath</span>(<span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&#x27;src/some-file.js&#x27;</span>, <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>))]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å¯¼å…¥-pakage-json"><a href="#å¯¼å…¥-pakage-json" class="headerlink" title="å¯¼å…¥ pakage.json"></a>å¯¼å…¥ pakage.json</h3><p>ä¾‹å¦‚è‡ªåŠ¨å°†ä¾èµ–é¡¹æ ‡è®°ä¸º<code>external</code></p><p>åœ¨<code>node 17.5+</code>ä¸­ï¼Œå¯ä½¿ç”¨å¯¼å…¥æ–­è¨€</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pkg <span class="keyword">from</span> <span class="string">&quot;./package.json&quot;</span> assert &#123; <span class="attr">type</span>: <span class="string">&quot;json&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// Mark package dependencies as &quot;external&quot;. Rest of configuration</span></span><br><span class="line">  <span class="comment">// omitted.</span></span><br><span class="line">  <span class="attr">external</span>: <span class="title class_">Object</span>.<span class="title function_">keys</span>(pkg.<span class="property">dependencies</span>),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨æ—§ç‰ˆ<code>node</code>ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>@rollup/plugin-json</code>ã€‚æˆ–è€…ä½¿ç”¨ node æä¾›çš„<code>createRequire</code>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRequire &#125; <span class="keyword">from</span> <span class="string">&quot;node:module&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">require</span> = <span class="title function_">createRequire</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>);</span><br><span class="line"><span class="keyword">const</span> pkg = <span class="built_in">require</span>(<span class="string">&quot;./package.json&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥ä½¿ç”¨<code>fs</code>æ¨¡å—è¯»å–æ–‡ä»¶å†…å®¹</p><h2 id="ä½¿ç”¨æ’ä»¶"><a href="#ä½¿ç”¨æ’ä»¶" class="headerlink" title="ä½¿ç”¨æ’ä»¶"></a>ä½¿ç”¨æ’ä»¶</h2><p><a href="https://github.com/rollup/awesome" target="_blank">ğŸŒ Awesome Rollup</a></p><h3 id="å¯¼å…¥ç°æœ‰çš„-CommonJS-æ¨¡å—"><a href="#å¯¼å…¥ç°æœ‰çš„-CommonJS-æ¨¡å—" class="headerlink" title="å¯¼å…¥ç°æœ‰çš„ CommonJS æ¨¡å—"></a>å¯¼å…¥ç°æœ‰çš„ CommonJS æ¨¡å—</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @rollup/plugin-commonjs --save-dev</span><br></pre></td></tr></table></figure><ul><li>éœ€è¦ node14+</li></ul><h3 id="ä»-JSON-æ–‡ä»¶ä¸­å¯¼å…¥æ•°æ®"><a href="#ä»-JSON-æ–‡ä»¶ä¸­å¯¼å…¥æ•°æ®" class="headerlink" title="ä» JSON æ–‡ä»¶ä¸­å¯¼å…¥æ•°æ®"></a>ä» JSON æ–‡ä»¶ä¸­å¯¼å…¥æ•°æ®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @rollup/plugin-json --save-dev</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; version &#125; <span class="keyword">from</span> <span class="string">&quot;../package.json&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;version &quot;</span> + version);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡ºæ’ä»¶"><a href="#è¾“å‡ºæ’ä»¶" class="headerlink" title="è¾“å‡ºæ’ä»¶"></a>è¾“å‡ºæ’ä»¶</h3><ul><li>ç­‰ Rollup ä¸»è¦åˆ†æå®Œäº†ä¹‹åï¼Œå†å¯¹ä»£ç è¿›è¡Œåˆ«çš„æ“ä½œï¼Œæ¯”å¦‚å‹ç¼©åŠ å¯†ä¹‹ç±»çš„</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @rollup/plugin-terser --save-dev</span><br></pre></td></tr></table></figure><p>ğŸ‘‰ å¯¹äºä¸åŒçš„è¾“å‡ºæ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ’ä»¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.mjs</span></span><br><span class="line"><span class="keyword">import</span> json <span class="keyword">from</span> <span class="string">&quot;@rollup/plugin-json&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> terser <span class="keyword">from</span> <span class="string">&quot;@rollup/plugin-terser&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">input</span>: <span class="string">&quot;src/main.js&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">file</span>: <span class="string">&quot;bundle.js&quot;</span>,</span><br><span class="line">      <span class="attr">format</span>: <span class="string">&quot;cjs&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">file</span>: <span class="string">&quot;bundle.min.js&quot;</span>,</span><br><span class="line">      <span class="attr">format</span>: <span class="string">&quot;iife&quot;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;version&quot;</span>,</span><br><span class="line">      <span class="attr">plugins</span>: [<span class="title function_">terser</span>()],</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">json</span>()],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>iife</code>æ ¼å¼æ˜¯å°†å˜é‡æ”¾åˆ°ä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œçš„å‡½æ•°ä¸­ï¼Œè¿™æ ·å°±ä¸ä¼šæ±¡æŸ“å…¨å±€å˜é‡äº†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> version = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> n = <span class="string">&quot;1.0.0&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;version &quot;</span> + n);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h1 id="é…ç½®é€‰é¡¹"><a href="#é…ç½®é€‰é¡¹" class="headerlink" title="é…ç½®é€‰é¡¹"></a>é…ç½®é€‰é¡¹</h1><h2 id="external"><a href="#external" class="headerlink" title="external"></a>external</h2><p>ç±»å‹ï¼š<code>(string | RegExp)[]| RegExp| string| (id: string, parentId: string, isResolved: boolean) =&gt; boolean</code></p><p>éœ€è¦æ’é™¤åœ¨æ‰“åŒ…ä¹‹å¤–çš„æ¨¡å—</p><ul><li>è¿™äº›æ¨¡å—ä¸ä¼šå‡ºç°åœ¨æ‰“åŒ…åçš„ä»£ç ä¸­</li><li>rollup ä¼šç”Ÿæˆä¸€ä¸ª<code>require</code>æˆ–<code>import</code>è¯­å¥ï¼Œè®©è¿è¡Œæ—¶å»åŠ è½½è¿™äº›æ¨¡å—ï¼Œä»¥é¿å…ä¸å¿…è¦çš„ä¾èµ–é¡¹é‡å¤æ‰“åŒ…ã€‚</li><li>éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œéœ€è¦ç¡®ä¿<code>external</code>æŒ‡å®šçš„è¿™äº›æ¨¡å—å·²ç»å­˜åœ¨</li></ul><p><strong>åŒ¹é…æ–¹å¼ï¼š</strong></p><ol><li>å¤–éƒ¨ä¾èµ–åç§°</li></ol><p>å¦‚æœå°†<code>import dependency.js</code>æ ‡è®°ä¸ºå¤–éƒ¨ä¾èµ–ï¼Œé‚£ä¹ˆå°±ä¼ é€’<code>dependency.js</code>ï¼›<code>import &quot;dependency&quot;</code>çš„è¯ï¼Œä¼ é€’<code>dependency</code></p><ol start="2"><li>è§£æè¿‡çš„æ¨¡å— IDï¼ˆç–‘é—®ï¼‰</li></ol><p>è§£æè¿‡çš„æ¨¡å— IDï¼Œä¾‹å¦‚æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæˆ–è€…<code>node_modules</code>ä¸­çš„æ¨¡å—</p><p>å¦‚æœé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼<code>/node_modules/</code>åŒ¹é…</p><ol start="3"><li>è‡ªå®šä¹‰å‡½æ•°</li></ol><p>ä¸‰ä¸ªå‚æ•°å¯ä½¿ç”¨ï¼š<code>(id, parent, isResolved) =&gt; boolean</code></p><ul><li><code>id</code>: æ¨¡å—çš„ ID</li><li><code>parent</code>: å¼•å…¥è¿™ä¸ªæ¨¡å—çš„æ¨¡å— ID</li><li><code>isResolved</code>: æ¨¡å—æ˜¯å¦å·²ç»è¢«æ’ä»¶è§£æï¼Œæ¯”å¦‚ç”¨<code>@rollup/plugin-node-resolve</code>æ’ä»¶è§£æè¿‡äº†</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">external</span>: <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ’é™¤æ‰€æœ‰ä»¥ &#x27;react&#x27; å¼€å¤´çš„æ¨¡å—</span></span><br><span class="line">    <span class="keyword">return</span> id.<span class="title function_">startsWith</span>(<span class="string">&quot;react&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å…¶ä»–é…ç½®é€‰é¡¹...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="input"><a href="#input" class="headerlink" title="input"></a>input</h2><p>ç±»å‹ï¼šå­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²æ•°ç»„ã€<code>&#123;[entryName]: string&#125;</code></p><p>æ‰“åŒ…çš„å…¥å£ï¼Œä¾‹å¦‚<code>main.ts</code>ã€<code>index.js</code></p><p>å¦‚æœä¼ è¿‡æ¥çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæˆ–è€…æ˜¯ä¸Šé¢çš„ç¬¬ä¸‰ä¸ªç±»å‹ï¼Œæ‰“åŒ…çš„äº§ç‰©ä¹Ÿæ˜¯åˆ†å¼€çš„ï¼Œé™¤éè¾“å‡ºçš„æ—¶å€™æŒ‡å®šäº†<code>output.file</code>ã€‚é‚£è¾“å‡ºçš„æ–‡ä»¶åä¼šè·Ÿéš<code>output.entryFileNames</code></p><h2 id="output-file-å’Œ-output-dir"><a href="#output-file-å’Œ-output-dir" class="headerlink" title="output.file å’Œ output.dir"></a>output.file å’Œ output.dir</h2><p>ç±»å‹ï¼šå­—ç¬¦ä¸²</p><p><code>output.file</code>æŒ‡å®šè¾“å‡ºçš„æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªå…·ä½“æ–‡ä»¶ï¼›å¦‚æœéœ€è¦è¾“å‡ºå¤šä¸ªæ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨<code>output.dir</code></p><h1 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h1><h2 id="æ‰“åŒ…-TypeScript"><a href="#æ‰“åŒ…-TypeScript" class="headerlink" title="æ‰“åŒ… TypeScript"></a>æ‰“åŒ… TypeScript</h2><p>éœ€è¦æå‰å®‰è£…çš„æœ‰<code>typescript</code> å’Œ<code>tslib</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @rollup/plugin-typescript --save-dev</span><br></pre></td></tr></table></figure><p>æ’ä»¶é»˜è®¤ä½¿ç”¨<code>tsconfig.json</code>ä¸­çš„é…ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">input</span>: <span class="string">&quot;./main.ts&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">dir</span>: <span class="string">&quot;output&quot;</span>,</span><br><span class="line">    <span class="attr">format</span>: <span class="string">&quot;cjs&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">typescript</span>(&#123;</span><br><span class="line">      <span class="attr">compilerOptions</span>: &#123; <span class="attr">lib</span>: [<span class="string">&quot;es5&quot;</span>, <span class="string">&quot;es6&quot;</span>, <span class="string">&quot;dom&quot;</span>], <span class="attr">target</span>: <span class="string">&quot;es5&quot;</span> &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä»–é…ç½®é”™è¯¯æ ¹æ®æŠ¥é”™æç¤ºä¿®æ”¹å°±å¥½äº†</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;ã€ğŸš§ æ–½å·¥ä¸­ã€‘&lt;/p&gt;
&lt;p&gt;[ ] ç›¸å…³æ’ä»¶æ¡ˆä¾‹&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ‰“åŒ…" scheme="https://smalljerry.cn/tags/%E6%89%93%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>VueRouterå¿«é€Ÿæ‰‹å†Œ</title>
    <link href="https://smalljerry.cn/2023/08/26/VueRouter%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C/"/>
    <id>https://smalljerry.cn/2023/08/26/VueRouter%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C/</id>
    <published>2023-08-26T07:27:20.000Z</published>
    <updated>2025-02-22T02:14:47.345Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸ«¡ğŸ™ƒ</p><p>[ ] å…ˆçœ‹å®˜æ–¹æ–‡æ¡£ï¼Œç„¶åç»„ç»‡å‡ºæ¥ç¬”è®°å’Œæ¡ˆä¾‹ä»£ç </p><span id="more"></span><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router@4</span><br></pre></td></tr></table></figure><h1 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h1><h2 id="ä¸¤ä¸ªæ ‡ç­¾"><a href="#ä¸¤ä¸ªæ ‡ç­¾" class="headerlink" title="ä¸¤ä¸ªæ ‡ç­¾"></a>ä¸¤ä¸ªæ ‡ç­¾</h2><h3 id="router-link"><a href="#router-link" class="headerlink" title="router-link"></a>router-link</h3><p>è·³è½¬æ²¡ç”¨<code>&lt;a&gt;</code>æ ‡ç­¾ï¼Œç”¨<code>&lt;router-link&gt;</code>æ ‡ç­¾ï¼Œåœ¨ä¸é‡æ–°åŠ è½½é¡µé¢çš„æƒ…å†µä¸‹ï¼Œæ”¹å˜ URL</p><p>æ ‡ç­¾å±æ€§ï¼š</p><ul><li>toï¼šæŒ‡å®šè·³è½¬çš„è·¯å¾„ï¼Œæœ€åç¼–è¯‘æˆ<code>&lt;a&gt;</code>æ ‡ç­¾çš„<code>href</code>å±æ€§</li><li>tagï¼šæŒ‡å®šæ¸²æŸ“æˆä»€ä¹ˆæ ‡ç­¾ï¼Œé»˜è®¤æ˜¯<code>&lt;a&gt;</code></li><li>replaceï¼šé»˜è®¤æ˜¯<code>false</code>ï¼Œç‚¹å‡»è·³è½¬åï¼Œä¼šå‘ history æ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ï¼Œè®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™ä¸ä¼šæ·»åŠ æ–°è®°å½•ï¼Œæ›¿æ¢å½“å‰çš„ history è®°å½•</li><li>active-classï¼šæŒ‡å®šå½“å‰è·¯ç”±é«˜äº®çš„ç±»åï¼Œé»˜è®¤æ˜¯<code>router-link-active</code></li></ul><p>é™¤äº†ä½¿ç”¨æ ‡ç­¾æ¥å¯¼èˆª(<strong>å£°æ˜å¼å¯¼èˆª</strong>)ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>router.push</code>æ–¹æ³•ï¼Œ<strong>ç¼–ç¨‹å¼å¯¼èˆª</strong></p><h3 id="router-view"><a href="#router-view" class="headerlink" title="router-view"></a>router-view</h3><ul><li>è·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶å°†æ¸²æŸ“åœ¨è¿™é‡Œ</li><li>ä¸€ä¸ªé¡µé¢ä¸­å¯ä»¥æœ‰å¤šä¸ª<code>&lt;router-view&gt;</code>æ ‡ç­¾ï¼Œç”¨äºæ˜¾ç¤ºä¸åŒçš„å†…å®¹</li></ul><h2 id="åˆ›å»ºè·¯ç”±"><a href="#åˆ›å»ºè·¯ç”±" class="headerlink" title="åˆ›å»ºè·¯ç”±"></a>åˆ›å»ºè·¯ç”±</h2><blockquote><p>å®˜ç½‘æ¨èçš„æ˜¯é€šè¿‡åŠ¨æ€å¯¼å…¥ç»„ä»¶æ¥å®ç°åˆ›å»ºè·¯ç”±(è·¯ç”±æ‡’åŠ è½½)</p></blockquote><p>ğŸ“„router/index.ts: åˆ›å»ºè·¯ç”±</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory, <span class="title class_">RouteRecordRaw</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;../views/Home.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&quot;../views/About.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">RouteRecordRaw</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Home&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;About&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">About</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/profle&quot;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Profile&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../views/Profile.vue&quot;</span>), <span class="comment">// åŠ¨æ€åŠ è½½</span></span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  routes,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure><p>ğŸ“„main.ts: å°†è·¯ç”±å½“æˆæ’ä»¶æŒ‚åœ¨åˆ° Vue å®ä¾‹ä¸­</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(router).<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure><p>ğŸ“„Home.vueï¼šä¸¤ä¸ªæ ‡ç­¾ï¼Œå®ç°è·¯ç”±è·³è½¬å’Œæ¸²æŸ“</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ğŸ“„About.vueï¼šåœ¨<em>setup</em>ä¸­é€šè¿‡ hooks å®ç°è·³è½¬ã€è·å–è·¯ç”±å‚æ•°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>About<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; useRouter, useRoute &#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> router = <span class="title function_">useRouter</span>(); <span class="comment">// options API ä¸­çš„ this.$router</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> route = <span class="title function_">useRoute</span>(); <span class="comment">// options API ä¸­çš„ this.$route</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">pushWithQuery</span>(<span class="params">query</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>: <span class="string">&quot;home&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">query</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        ...route.<span class="property">query</span>,</span></span><br><span class="line"><span class="language-javascript">        ...query,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨æ¨¡æ¿ä¸­å¯ä»¥è®¿é—®åˆ° $router å’Œ $route å¯¹è±¡ï¼Œä½†æ˜¯åœ¨ setup ä¸­ä¸èƒ½è®¿é—®ï¼Œéœ€è¦é€šè¿‡<code>useRouter</code>å’Œ<code>useRoute</code>è·å–</li></ul><blockquote><p><code>router</code> å’Œ <code>route</code> çš„åŒºåˆ«ï¼šrouter æ˜¯è·¯ç”±å®ä¾‹ï¼Œroute æ˜¯å½“å‰è·¯ç”±å¯¹è±¡</p></blockquote><blockquote><p>åœ¨<code>setup</code>ä¸­ä½¿ç”¨çš„æ—¶å€™ï¼Œ<code>useRouter</code>å’Œ<code>useRoute</code>å¿…é¡»æ˜¯é¡¶çº§è°ƒç”¨ï¼Œå¦‚æœåœ¨æ–¹æ³•é‡Œé¢è°ƒç”¨ï¼Œå¾—åˆ°çš„è¿”å›å€¼æ˜¯<code>undefined</code></p></blockquote><p>router çš„ä¸€äº›æ–¹æ³•ï¼š</p><ul><li><code>router.push</code>ï¼šè·³è½¬åˆ°æŒ‡å®šè·¯ç”±</li><li><code>router.replace</code>ï¼šè·³è½¬åˆ°æŒ‡å®šè·¯ç”±ï¼Œä¸ä¼šåœ¨ history ä¸­æ·»åŠ æ–°è®°å½•</li><li><code>router.go</code>ï¼šå‰è¿›æˆ–åé€€æŒ‡å®šæ­¥æ•°</li><li><code>router.back</code>ï¼šåé€€</li><li><code>router.forward</code>ï¼šå‰è¿›</li><li><code>router.addRoute</code>ï¼š<strong>åŠ¨æ€æ·»åŠ è·¯ç”±</strong></li><li><code>router.removeRoute</code>ï¼š<strong>åŠ¨æ€åˆ é™¤è·¯ç”±</strong></li><li><code>router.getRoutes</code>ï¼šè·å–æ‰€æœ‰è·¯ç”±ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„</li><li><code>router.hasRoute</code>ï¼šåˆ¤æ–­æ˜¯å¦æœ‰æŒ‡å®šè·¯ç”±</li></ul><p>route å¯¹è±¡æ˜¯å“åº”å¼çš„ï¼Œå¯ä»¥é€šè¿‡<code>watch</code>ç›‘å¬å˜åŒ–</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useRoute &#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, watch &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>();</span><br><span class="line"><span class="keyword">const</span> userData = <span class="title function_">ref</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“å‚æ•°æ›´æ”¹æ—¶è·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> route.<span class="property">params</span>.<span class="property">id</span>,</span><br><span class="line">  <span class="title function_">async</span> (newId) =&gt; &#123;</span><br><span class="line">    userData.<span class="property">value</span> = <span class="keyword">await</span> <span class="title function_">fetchUser</span>(newId);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="åŠ¨æ€è·¯ç”±"><a href="#åŠ¨æ€è·¯ç”±" class="headerlink" title="åŠ¨æ€è·¯ç”±"></a>åŠ¨æ€è·¯ç”±</h3><blockquote><p><code>router.addRoute</code>åªæ³¨å†Œä¸€ä¸ªæ–°è·¯ç”±ï¼Œå¦‚æœæ–°å¢çš„è·¯ç”±ä¸å½“å‰ä½ç½®åŒ¹é…ï¼Œå°±å¾—æ‰‹åŠ¨é…ç½®<code>router.push</code>æˆ–è€…<code>router.replace</code>è·³è½¬</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">addRoute</span>(&#123; <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>, <span class="attr">component</span>: <span class="title class_">About</span> &#125;);</span><br><span class="line"><span class="comment">// æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ this.$route æˆ– route = useRoute() ï¼ˆåœ¨ setup ä¸­ï¼‰</span></span><br><span class="line">router.<span class="title function_">replace</span>(router.<span class="property">currentRoute</span>.<span class="property">value</span>.<span class="property">fullPath</span>);</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœéœ€è¦ç­‰å¾…æ–°çš„è·¯ç”±æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ <code>await router.replace()</code></li></ul><p>åœ¨å¯¼èˆªå®ˆå«ä¸­æ·»åŠ è·¯ç”±çš„æ—¶å€™ï¼Œä½¿ç”¨<code>return</code>è¿”å›æ–°çš„è·¯ç”±ï¼Œè€Œä¸æ˜¯ä½¿ç”¨<code>router.push</code>æˆ–è€…<code>router.replace</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_">hasNecessaryRoute</span>(to)) &#123;</span><br><span class="line">    router.<span class="title function_">addRoute</span>(<span class="title function_">generateRoute</span>(to));</span><br><span class="line">    <span class="comment">// è§¦å‘é‡å®šå‘</span></span><br><span class="line">    <span class="keyword">return</span> to.<span class="property">fullPath</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>hasNecessaryRoute()</code> åœ¨æ·»åŠ æ–°çš„è·¯ç”±åè¿”å› <code>false</code>ï¼Œä»¥é¿å…æ— é™é‡å®šå‘ã€‚</li></ul><p>æ·»åŠ <em>åµŒå¥—è·¯ç”±</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">addRoute</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;admin&quot;</span>, <span class="attr">path</span>: <span class="string">&quot;/admin&quot;</span>, <span class="attr">component</span>: <span class="title class_">Admin</span> &#125;);</span><br><span class="line">router.<span class="title function_">addRoute</span>(<span class="string">&quot;admin&quot;</span>, &#123; <span class="attr">path</span>: <span class="string">&quot;settings&quot;</span>, <span class="attr">component</span>: <span class="title class_">AdminSettings</span> &#125;);</span><br></pre></td></tr></table></figure><p>ğŸ—‘ï¸ åˆ é™¤è·¯ç”±æœ‰å‡ ä¸ªæ–¹å¼:</p><ol><li>ç›´æ¥ä½¿ç”¨<code>router.addRoute</code>ï¼Œå¦‚æœæœ‰é‡åçš„ï¼Œå…ˆåˆ é™¤å†æ·»åŠ </li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">addRoute</span>(&#123; <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;about&quot;</span>, <span class="attr">component</span>: <span class="title class_">About</span> &#125;);</span><br><span class="line"><span class="comment">// è¿™å°†ä¼šåˆ é™¤ä¹‹å‰å·²ç»æ·»åŠ çš„è·¯ç”±ï¼Œå› ä¸ºä»–ä»¬å…·æœ‰ç›¸åŒçš„åå­—ä¸”åå­—å¿…é¡»æ˜¯å”¯ä¸€çš„</span></span><br><span class="line">router.<span class="title function_">addRoute</span>(&#123; <span class="attr">path</span>: <span class="string">&quot;/other&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;about&quot;</span>, <span class="attr">component</span>: <span class="title class_">Other</span> &#125;);</span><br></pre></td></tr></table></figure><ol start="2"><li>é€šè¿‡<code>router.addRoute()</code>è¿”å›çš„å›è°ƒå‡½æ•°æ¥åˆ é™¤</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> removeRoute = router.<span class="title function_">addRoute</span>(routeRecord);</span><br><span class="line"><span class="title function_">removeRoute</span>(); <span class="comment">// åˆ é™¤è·¯ç”±å¦‚æœå­˜åœ¨çš„è¯</span></span><br></pre></td></tr></table></figure><ol start="3"><li>é€šè¿‡<code>router.removeRoute</code>æ¥æŒ‰<em>åç§°</em>åˆ é™¤</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">addRoute</span>(&#123; <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;about&quot;</span>, <span class="attr">component</span>: <span class="title class_">About</span> &#125;);</span><br><span class="line"><span class="comment">// åˆ é™¤è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">removeRoute</span>(<span class="string">&quot;about&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®è·å–"><a href="#æ•°æ®è·å–" class="headerlink" title="æ•°æ®è·å–"></a>æ•°æ®è·å–</h3><p>è¿›å…¥è·¯ç”±ä¹‹åéœ€è¦ä»æœåŠ¡å™¨è·å–æ•°æ®ï¼Œä¸€èˆ¬ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>å¯¼èˆªå®Œæˆä¹‹åè·å–ï¼Œå…ˆå¯¼èˆªï¼Œç„¶ååœ¨ç»„ä»¶çš„å£°æ˜å‘¨æœŸå‡½æ•°ä¸­è·å–ã€‚è¿™æœŸé—´æ˜¾ç¤º <em>æ­£åœ¨åŠ è½½</em> z ä¹‹ç±»çš„åŠ¨ç”»ï¼Œç„¶åä¹Ÿå¯ä»¥æ·»åŠ ä¸ª<code>watch</code>ä»¥ä¾¿å†æ¬¡è·å–</li><li>å¯¼èˆªå®Œæˆä¹‹å‰è·å–ï¼Œåœ¨å¯¼èˆªå®ˆå«ä¸­è¿›è¡Œ</li></ul><h2 id="ç¼–ç¨‹å¼å¯¼èˆª"><a href="#ç¼–ç¨‹å¼å¯¼èˆª" class="headerlink" title="ç¼–ç¨‹å¼å¯¼èˆª"></a>ç¼–ç¨‹å¼å¯¼èˆª</h2><p>ğŸŒ è¿™ä¸ªæ–¹æ³•ä¼šå‘ history æ ˆæ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ï¼Œæ‰€ä»¥ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨åé€€æŒ‰é’®æ—¶ï¼Œä¼šå›åˆ°ä¹‹å‰çš„ URLã€‚</p><ul><li>ç‚¹å‡»å¯¼èˆªæ ‡ç­¾ï¼Œå†…éƒ¨ä¼šè°ƒç”¨<code>router.push</code>æ–¹æ³•</li></ul><p><code>push</code>æ–¹æ³•çš„å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæè¿°åœ°å€çš„å¯¹è±¡</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­—ç¬¦ä¸²è·¯å¾„</span></span><br><span class="line">router.<span class="title function_">push</span>(<span class="string">&quot;/users/eduardo&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¦æœ‰è·¯å¾„çš„å¯¹è±¡</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123; <span class="attr">path</span>: <span class="string">&quot;/users/eduardo&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘½åçš„è·¯ç”±ï¼Œå¹¶åŠ ä¸Šå‚æ•°ï¼Œè®©è·¯ç”±å»ºç«‹ url</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;user&quot;</span>, <span class="attr">params</span>: &#123; <span class="attr">username</span>: <span class="string">&quot;eduardo&quot;</span> &#125; &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¦æŸ¥è¯¢å‚æ•°ï¼Œç»“æœæ˜¯ /register?plan=private</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123; <span class="attr">path</span>: <span class="string">&quot;/register&quot;</span>, <span class="attr">query</span>: &#123; <span class="attr">plan</span>: <span class="string">&quot;private&quot;</span> &#125; &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¦ hashï¼Œç»“æœæ˜¯ /about#team</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123; <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>, <span class="attr">hash</span>: <span class="string">&quot;#team&quot;</span> &#125;);</span><br></pre></td></tr></table></figure><h3 id="åŠ¨æ€è·¯ç”±åŒ¹é…"><a href="#åŠ¨æ€è·¯ç”±åŒ¹é…" class="headerlink" title="åŠ¨æ€è·¯ç”±åŒ¹é…"></a>åŠ¨æ€è·¯ç”±åŒ¹é…</h3><ul><li>ç›®çš„æ˜¯ä¸ºäº†æ ¹æ®ä¸åŒçš„å‚æ•°ï¼Œæ¸²æŸ“ä¸åŒçš„å†…å®¹</li></ul><p>åŠ¨æ€è·¯ç”±åŒ¹é…çš„å‚æ•°ï¼Œå¯ä»¥é€šè¿‡<code>useRoute</code>è·å–</p><ul><li><code>useRoute</code>è¿”å›çš„æ˜¯å“åº”å¼çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡<code>watch</code>ç›‘å¬å˜åŒ–</li><li>ä¹Ÿå¯ä»¥é€šè¿‡<code>$route.params</code>è·å–ï¼Œ<code>$route</code>ä¸æ˜¯å“åº”å¼çš„</li></ul><p>é™¤äº†<code>params</code>ï¼Œè¿˜æœ‰<code>query</code>ã€<code>hash</code>ç­‰ï¼Œ<code>params</code>å’Œ<code>query</code>éƒ½æ˜¯å¯¹è±¡ï¼Œ<code>hash</code>æ˜¯å­—ç¬¦ä¸²</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;User&lt;/div&gt;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™äº›éƒ½ä¼šä¼ é€’ç»™ `createRouter`</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// åŠ¨æ€å­—æ®µä»¥å†’å·å¼€å§‹</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/users/:id&quot;</span>, <span class="attr">component</span>: <span class="title class_">User</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œå®ƒä»¬ä¼šæ˜ å°„åˆ° <code>$route.params</code> ä¸Šçš„ç›¸åº”å­—æ®µ</p><table><thead><tr><th align="center">åŒ¹é…æ¨¡å¼</th><th align="center">åŒ¹é…è·¯å¾„</th><th align="center">$route.params</th></tr></thead><tbody><tr><td align="center">/users/:username</td><td align="center">/users/eduardo</td><td align="center">{ username: â€˜eduardoâ€™ }</td></tr><tr><td align="center">/users/:username/posts/:postId</td><td align="center">/users/eduardo/posts/123</td><td align="center">{ username: â€˜eduardoâ€™, postId: â€˜123â€™ }</td></tr></tbody></table><blockquote><p>è·¯ç”±å‚æ•°å˜åŒ–ï¼Œç»„ä»¶ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œå› ä¸ºç»„ä»¶çš„å¤ç”¨ï¼Œå¯ä»¥é€šè¿‡<code>watch</code>ç›‘å¬å‚æ•°å˜åŒ–ï¼Œé‡æ–°è·å–æ•°æ®ä»è€Œæ›´æ–°ç»„ä»¶ã€‚æˆ–è€…ä½¿ç”¨å¯¼èˆªå®ˆå«ç›‘å¬å‚æ•°å˜åŒ–</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;...&quot;</span>,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">beforeRouteUpdate</span>(<span class="params">to, <span class="keyword">from</span></span>) &#123;</span><br><span class="line">    <span class="comment">// å¯¹è·¯ç”±å˜åŒ–åšå‡ºå“åº”...</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">userData</span> = <span class="keyword">await</span> <span class="title function_">fetchUser</span>(to.<span class="property">params</span>.<span class="property">id</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨æ­£åˆ™åŒ¹é…"><a href="#ä½¿ç”¨æ­£åˆ™åŒ¹é…" class="headerlink" title="ä½¿ç”¨æ­£åˆ™åŒ¹é…"></a>ä½¿ç”¨æ­£åˆ™åŒ¹é…</h4><p>å¸¸è§„åŒ¹é…çš„æ—¶å€™ï¼Œå†…éƒ¨ä¼šä½¿ç”¨<code>([^/]+)</code>æ¥åŒ¹é…å‚æ•°</p><ul><li>è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯<code>/</code></li></ul><p>å¦‚æœæƒ³æ ¹æ®å‚æ•°çš„æ ¼å¼æ¥åŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// /:orderId -&gt; ä»…åŒ¹é…æ•°å­—</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/:orderId(\\d+)&quot;</span> &#125;,</span><br><span class="line">  <span class="comment">// /:productName -&gt; åŒ¹é…å…¶ä»–ä»»ä½•å†…å®¹</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/:productName&quot;</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><ul><li><code>\d</code>éœ€è¦ä½¿ç”¨<code>\\d</code>æ¥è½¬ä¹‰</li></ul><h4 id="å¯é‡å¤çš„å‚æ•°"><a href="#å¯é‡å¤çš„å‚æ•°" class="headerlink" title="å¯é‡å¤çš„å‚æ•°"></a>å¯é‡å¤çš„å‚æ•°</h4><p>å°†å‚æ•°æ ‡è®°ä¸ºå¯é‡å¤ï¼š</p><ul><li>é€šè¿‡<code>+</code>æ¥è¡¨ç¤ºå‚æ•°å¯ä»¥é‡å¤ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª<ul><li>å°±æ˜¯è¯´è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯<code>/</code></li></ul></li><li>é€šè¿‡<code>*</code>æ¥è¡¨ç¤ºå‚æ•°å¯ä»¥é‡å¤ï¼Œå¯ä»¥æ˜¯é›¶ä¸ªæˆ–å¤šä¸ª<ul><li>å°±æ˜¯è¯´å¯ä»¥æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯å¯é€‰çš„</li><li>é€šè¿‡<code>?</code>ä¹Ÿå¯ä»¥è¡¨ç¤ºå¯é€‰çš„</li></ul></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// /:chapters -&gt;  åŒ¹é… /one, /one/two, /one/two/three, ç­‰</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/:chapters+&quot;</span> &#125;,</span><br><span class="line">  <span class="comment">// /:chapters -&gt; åŒ¹é… /, /one, /one/two, /one/two/three, ç­‰</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/:chapters*&quot;</span> &#125;,</span><br><span class="line">  <span class="comment">// å¯é€‰</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/:chapters?&quot;</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>åœ¨ä¼ é€’çš„æ—¶å€™ï¼Œå¯¹åº”çš„å‚æ•°éœ€è¦ä¼ é€’æ•°ç»„</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»™å®š &#123; path: &#x27;/:chapters*&#x27;, name: &#x27;chapters&#x27; &#125;,</span></span><br><span class="line">router.<span class="title function_">resolve</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;chapters&quot;</span>, <span class="attr">params</span>: &#123; <span class="attr">chapters</span>: [] &#125; &#125;).<span class="property">href</span>;</span><br><span class="line"><span class="comment">// äº§ç”Ÿ /</span></span><br><span class="line">router.<span class="title function_">resolve</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;chapters&quot;</span>, <span class="attr">params</span>: &#123; <span class="attr">chapters</span>: [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>] &#125; &#125;).<span class="property">href</span>;</span><br><span class="line"><span class="comment">// äº§ç”Ÿ /a/b</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™å®š &#123; path: &#x27;/:chapters+&#x27;, name: &#x27;chapters&#x27; &#125;,</span></span><br><span class="line">router.<span class="title function_">resolve</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;chapters&quot;</span>, <span class="attr">params</span>: &#123; <span class="attr">chapters</span>: [] &#125; &#125;).<span class="property">href</span>;</span><br><span class="line"><span class="comment">// æŠ›å‡ºé”™è¯¯ï¼Œå› ä¸º `chapters` ä¸ºç©º</span></span><br></pre></td></tr></table></figure><ul><li><code>router.resolve</code>æ–¹æ³•å¯ä»¥æ ¹æ®è·¯ç”±åç§°å’Œå‚æ•°ï¼Œè¿”å›ä¸€ä¸ª URL</li></ul><p>åŒæ—¶å¯ä»¥åŠ ä¸Šæ­£åˆ™è¡¨è¾¾å¼</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// ä»…åŒ¹é…æ•°å­—</span></span><br><span class="line">  <span class="comment">// åŒ¹é… /1, /1/2, ç­‰</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/:chapters(\\d+)+&quot;</span> &#125;,</span><br><span class="line">  <span class="comment">// åŒ¹é… /, /1, /1/2, ç­‰</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/:chapters(\\d+)*&quot;</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h4 id="Sensitive-å’Œ-strict-è·¯ç”±"><a href="#Sensitive-å’Œ-strict-è·¯ç”±" class="headerlink" title="Sensitive å’Œ strict è·¯ç”±"></a>Sensitive å’Œ strict è·¯ç”±</h4><p>ä¾‹å¦‚ï¼Œè·¯ç”± <code>/users</code> å°†åŒ¹é… <code>/users</code>ã€<code>/users/</code>ã€ç”šè‡³ <code>/Users/</code></p><p>å¯é€šè¿‡å…¨å±€é…ç½®é…ç½®ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  routes,</span><br><span class="line">  <span class="attr">sensitive</span>: <span class="literal">true</span>, <span class="comment">// åŒ¹é…è§„åˆ™æ˜¯å¦å¤§å°å†™æ•æ„Ÿï¼Ÿ(é»˜è®¤å€¼ï¼šfalse)</span></span><br><span class="line">  <span class="attr">strict</span>: <span class="literal">true</span>, <span class="comment">// åŒ¹é…è§„åˆ™æ˜¯å¦ä¸¥æ ¼æ¨¡å¼ï¼Ÿ(é»˜è®¤å€¼ï¼šfalse)</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åœ¨è·¯ç”±é…ç½®ä¸­é…ç½®ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    <span class="comment">// å°†åŒ¹é… /users/posva è€Œéï¼š</span></span><br><span class="line">    <span class="comment">// - /users/posva/ å½“ strict: true</span></span><br><span class="line">    <span class="comment">// - /Users/posva å½“ sensitive: true</span></span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/users/:id&quot;</span>, <span class="attr">sensitive</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    <span class="comment">// å°†åŒ¹é… /users, /Users, ä»¥åŠ /users/42 è€Œé /users/ æˆ– /users/42/</span></span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/users/:id?&quot;</span> &#125;,</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">strict</span>: <span class="literal">true</span>, <span class="comment">// applies to all routes</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="åµŒå¥—è·¯ç”±"><a href="#åµŒå¥—è·¯ç”±" class="headerlink" title="åµŒå¥—è·¯ç”±"></a>åµŒå¥—è·¯ç”±</h3><p>ä¸€ä¸ªé¡µé¢ä¸­æœ‰å¤šä¸ª<code>&lt;router-view&gt;</code>æ ‡ç­¾ï¼Œç”¨äºæ˜¾ç¤ºä¸åŒçš„å†…å®¹</p><ul><li>æœ€å¤–å±‚çš„<code>&lt;router-view&gt;</code>æ ‡ç­¾ï¼Œç”¨äºæ˜¾ç¤ºæœ€å¤–å±‚çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯çˆ¶è·¯ç”±çš„å†…å®¹</li><li>ä¸€ä¸ªè¢«æ¸²æŸ“çš„ç»„ä»¶é‡Œé¢ä¹Ÿå¯ä»¥æœ‰è‡ªå·±çš„<code>&lt;router-view&gt;</code>æ ‡ç­¾ï¼Œç”¨äºæ˜¾ç¤ºå†…å±‚çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯å­è·¯ç”±çš„å†…å®¹</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/user/:id&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">User</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// å½“ /user/:id/profile åŒ¹é…æˆåŠŸ</span></span><br><span class="line">        <span class="comment">// UserProfile å°†è¢«æ¸²æŸ“åˆ° User çš„ &lt;router-view&gt; å†…éƒ¨</span></span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;profile&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">UserProfile</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// å½“ /user/:id/posts åŒ¹é…æˆåŠŸ</span></span><br><span class="line">        <span class="comment">// UserPosts å°†è¢«æ¸²æŸ“åˆ° User çš„ &lt;router-view&gt; å†…éƒ¨</span></span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;posts&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">UserPosts</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><ul><li>ä»¥ <code>/</code> å¼€å¤´çš„åµŒå¥—è·¯å¾„å°†è¢«è§†ä¸ºæ ¹è·¯å¾„</li></ul><p>å¦‚æœè®¿é—®äº†ä¸å­˜åœ¨çš„è·¯ç”±ï¼Œ<code>&lt;router-view&gt;</code>é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå¯ä»¥é€šè¿‡<code>&lt;router-view v-slot=&quot;&#123; Component &#125;&quot;&gt;</code>æ¥å¤„ç†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; Component &#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;Component&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åªæœ‰åœ¨åŒ¹é…åˆ°çš„è·¯ç”±æœ‰ç»„ä»¶æ—¶ï¼Œæ‰ä¼šæ˜¾ç¤º --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;Component&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªç©ºçš„åµŒå¥—è·¯ç”±ä½œä¸ºé»˜è®¤å­è·¯ç”±ï¼ˆpath ä¼ é€’ç©ºå­—ç¬¦ä¸²ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/user/:id&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">User</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      <span class="comment">// å½“ /user/:id åŒ¹é…æˆåŠŸ</span></span><br><span class="line">      <span class="comment">// UserHome å°†è¢«æ¸²æŸ“åˆ° User çš„ &lt;router-view&gt; å†…éƒ¨</span></span><br><span class="line">      &#123; <span class="attr">path</span>: <span class="string">&quot;&quot;</span>, <span class="attr">component</span>: <span class="title class_">UserHome</span> &#125;,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// ...å…¶ä»–å­è·¯ç”±</span></span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="å‘½åè·¯ç”±å’Œå‘½åè§†å›¾"><a href="#å‘½åè·¯ç”±å’Œå‘½åè§†å›¾" class="headerlink" title="å‘½åè·¯ç”±å’Œå‘½åè§†å›¾"></a>å‘½åè·¯ç”±å’Œå‘½åè§†å›¾</h2><h3 id="å‘½åè·¯ç”±"><a href="#å‘½åè·¯ç”±" class="headerlink" title="å‘½åè·¯ç”±"></a>å‘½åè·¯ç”±</h3><p>ç»™è·¯ç”±é…ç½®ä¸€ä¸ª<code>name</code>å±æ€§ï¼Œå¯ä»¥é€šè¿‡<code>name</code>æ¥è·³è½¬</p><ul><li>æ²¡æœ‰ç¡¬ç¼–ç çš„ URLï¼Œæ²¡æœ‰ç¡¬ç¼–ç çš„ URLï¼Œæ‰€ä»¥å¦‚æœæƒ³æ”¹å˜ /user/:idï¼Œå¯ä»¥éšæ—¶ä¿®æ”¹è·¯ç”±é…ç½®ï¼Œè€Œä¸ç”¨åœ¨ä»£ç ä¸­æœç´¢æ‰€æœ‰ç”¨åˆ°è¯¥è·¯å¾„çš„åœ°æ–¹</li><li>params çš„è‡ªåŠ¨ç¼–ç /è§£ç ã€‚</li><li>é˜²æ­¢ä½ åœ¨ url ä¸­å‡ºç°æ‰“å­—é”™è¯¯ã€‚</li><li>ç»•è¿‡è·¯å¾„æ’åºï¼ˆå¦‚æ˜¾ç¤ºä¸€ä¸ªï¼‰/user/:id å’Œ /user/:usernameï¼Œå› ä¸ºåè€…æ˜¯åœ¨å‰è€…ä¹‹åå®šä¹‰çš„ã€‚</li></ul><p>params çš„è‡ªåŠ¨ç¼–ç /è§£ç ï¼Œæ›´æ–¹ä¾¿ä½¿ç”¨å‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/user/:userId&quot;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="title class_">User</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡å‘½åè·¯ç”±è·³è½¬</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;user&quot;</span>, <span class="attr">params</span>: &#123; <span class="attr">userId</span>: <span class="string">&quot;123&quot;</span> &#125; &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¦æŸ¥è¯¢å‚æ•°ï¼Œå˜æˆ /register?plan=private</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;register&quot;</span>, <span class="attr">query</span>: &#123; <span class="attr">plan</span>: <span class="string">&quot;private&quot;</span> &#125; &#125;);</span><br></pre></td></tr></table></figure><p>æˆ–è€…åœ¨æ ‡ç­¾ä¸­ä½¿ç”¨</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;&#123; name: &#x27;user&#x27;, params: &#123; username: &#x27;erina&#x27; &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">  User</span><br><span class="line"><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å‘½åè§†å›¾"><a href="#å‘½åè§†å›¾" class="headerlink" title="å‘½åè§†å›¾"></a>å‘½åè§†å›¾</h3><p>ç»™<code>&lt;router-view&gt;</code>æ ‡ç­¾æ·»åŠ <code>name</code>å±æ€§ï¼Œå¯ä»¥åœ¨è·¯ç”±é…ç½®ä¸­æŒ‡å®šæ¸²æŸ“çš„ç»„ä»¶ã€‚ä¾‹å¦‚åˆ›å»ºä¸€ä¸ªå¸ƒå±€ï¼Œæœ‰ sidebar (ä¾§å¯¼èˆª) å’Œ main (ä¸»å†…å®¹) ä¸¤ä¸ªè§†å›¾</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">class</span>=<span class="string">&quot;view left-sidebar&quot;</span> <span class="attr">name</span>=<span class="string">&quot;LeftSidebar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">class</span>=<span class="string">&quot;view main-content&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">class</span>=<span class="string">&quot;view right-sidebar&quot;</span> <span class="attr">name</span>=<span class="string">&quot;RightSidebar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè·¯ç”±ä¸­æœ‰å¤šä¸ªè§†å›¾ï¼Œæ‰€ä»¥å¾—ä½¿ç”¨<code>components</code>é…ç½®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHashHistory</span>(),</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">      <span class="attr">components</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="title class_">Home</span>,</span><br><span class="line">        <span class="comment">// LeftSidebar: LeftSidebar çš„ç¼©å†™</span></span><br><span class="line">        <span class="title class_">LeftSidebar</span>,</span><br><span class="line">        <span class="comment">// å®ƒä»¬ä¸ `&lt;router-view&gt;` ä¸Šçš„ `name` å±æ€§åŒ¹é…</span></span><br><span class="line">        <span class="title class_">RightSidebar</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="é‡å®šå‘å’Œåˆ«å"><a href="#é‡å®šå‘å’Œåˆ«å" class="headerlink" title="é‡å®šå‘å’Œåˆ«å"></a>é‡å®šå‘å’Œåˆ«å</h2><h3 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h3><p>é€šè¿‡ routes é…ç½®æ¥å®Œæˆ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [&#123; <span class="attr">path</span>: <span class="string">&quot;/home&quot;</span>, <span class="attr">redirect</span>: <span class="string">&quot;/&quot;</span> &#125;];</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªå‘½åçš„è·¯ç”±</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [&#123; <span class="attr">path</span>: <span class="string">&quot;/home&quot;</span>, <span class="attr">redirect</span>: &#123; <span class="attr">name</span>: <span class="string">&quot;home&quot;</span> &#125; &#125;];</span><br></pre></td></tr></table></figure><p>ç”šè‡³å¯ä»¥ä¼ é€’ä¸€ä¸ªæ–¹æ³•ï¼ŒåŠ¨æ€è¿”å›é‡å®šå‘çš„ç›®æ ‡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// /search/screens -&gt; /search?q=screens</span></span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/search/:searchText&quot;</span>,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="function">(<span class="params">to</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// æ–¹æ³•æ¥æ”¶ç›®æ ‡è·¯ç”±ä½œä¸ºå‚æ•°</span></span><br><span class="line">      <span class="comment">// return é‡å®šå‘çš„å­—ç¬¦ä¸²è·¯å¾„/è·¯å¾„å¯¹è±¡</span></span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">path</span>: <span class="string">&quot;/search&quot;</span>, <span class="attr">query</span>: &#123; <span class="attr">q</span>: to.<span class="property">params</span>.<span class="property">searchText</span> &#125; &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/search&quot;</span>,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><blockquote><p>é‡å®šå‘æ—¶å¯ä»¥ä¸æŒ‡å®š<code>component</code>ï¼Œå› ä¸ºé‡å®šå‘çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»„ä»¶éœ€è¦æ¸²æŸ“</p></blockquote><p><strong>ç›¸å¯¹é‡å®šå‘</strong></p><ul><li>é‡å®šå‘çš„ç›®æ ‡ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œè¿™æ ·å°±ä¸ç”¨å†™å®Œæ•´çš„è·¯å¾„äº†</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// å°†æ€»æ˜¯æŠŠ/users/123/postsé‡å®šå‘åˆ°/users/123/profileã€‚</span></span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/users/:id/posts&quot;</span>,</span><br><span class="line">    <span class="attr">redirect</span>: <span class="function">(<span class="params">to</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// è¯¥å‡½æ•°æ¥æ”¶ç›®æ ‡è·¯ç”±ä½œä¸ºå‚æ•°</span></span><br><span class="line">      <span class="comment">// ç›¸å¯¹ä½ç½®ä¸ä»¥`/`å¼€å¤´</span></span><br><span class="line">      <span class="comment">// æˆ– &#123; path: &#x27;profile&#x27;&#125;</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;profile&quot;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="åˆ«å"><a href="#åˆ«å" class="headerlink" title="åˆ«å"></a>åˆ«å</h3><ul><li>é‡å®šå‘çš„æ—¶å€™<code>/home</code>ä¼šæ›¿æ¢æ‰<code>/</code>ï¼Œåˆ«åä¸ä¼šæ”¹å˜ URLï¼Œä½†æ˜¯ä¼šåœ¨è·¯ç”±åŒ¹é…æ—¶æ·»åŠ åˆ° history è®°å½•ä¸­</li></ul><p>æ‰€ä»¥åº”è¯¥è¿™æ ·é…ç½®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [&#123; <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">component</span>: <span class="title class_">Homepage</span>, <span class="attr">alias</span>: <span class="string">&quot;/home&quot;</span> &#125;];</span><br></pre></td></tr></table></figure><p>é€šè¿‡åˆ«åå¯ä»¥å°† UI ç»“æ„æ˜ å°„åˆ°ä¸€ä¸ªä»»æ„çš„ URLï¼Œè€Œä¸å—é…ç½®çš„åµŒå¥—ç»“æ„çš„é™åˆ¶ã€‚ä½¿åˆ«åä»¥ / å¼€å¤´ï¼Œä»¥ä½¿åµŒå¥—è·¯å¾„ä¸­çš„è·¯å¾„æˆä¸ºç»å¯¹è·¯å¾„ã€‚ä½ ç”šè‡³å¯ä»¥å°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œç”¨ä¸€ä¸ªæ•°ç»„æä¾›å¤šä¸ªåˆ«åï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/users&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">UsersLayout</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      <span class="comment">// ä¸ºè¿™ 3 ä¸ª URL å‘ˆç° UserList</span></span><br><span class="line">      <span class="comment">// - /users</span></span><br><span class="line">      <span class="comment">// - /users/list</span></span><br><span class="line">      <span class="comment">// - /people</span></span><br><span class="line">      &#123; <span class="attr">path</span>: <span class="string">&quot;&quot;</span>, <span class="attr">component</span>: <span class="title class_">UserList</span>, <span class="attr">alias</span>: [<span class="string">&quot;/people&quot;</span>, <span class="string">&quot;list&quot;</span>] &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="è·¯ç”±ç»„ä»¶ä¼ å‚"><a href="#è·¯ç”±ç»„ä»¶ä¼ å‚" class="headerlink" title="è·¯ç”±ç»„ä»¶ä¼ å‚"></a>è·¯ç”±ç»„ä»¶ä¼ å‚</h2><p>é€šè¿‡ä½¿ç”¨ props å°†è·¯ç”±å‚æ•°ä¼ é€’ç»™ç»„ä»¶</p><blockquote><p>åœ¨ç»„ä»¶ä¸­è·å–è·¯ç”±ä¼ è¿‡æ¥çš„ <em>props</em> æ—¶ï¼Œéœ€è¦å®šä¹‰ç„¶åä½¿ç”¨</p></blockquote><p><strong>å¸ƒå°”æ¨¡å¼</strong>ï¼šå°†<code>props</code>è®¾ç½®ä¸º<code>true</code>ï¼Œ<code>route.params</code>ä¼šè¢«è®¾ç½®ä¸ºç»„ä»¶çš„ props</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;User &#123;&#123; $route.params.id &#125;&#125;&lt;/div&gt;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> routes = [&#123; <span class="attr">path</span>: <span class="string">&quot;/user/:id&quot;</span>, <span class="attr">component</span>: <span class="title class_">User</span> &#125;];</span><br></pre></td></tr></table></figure><p>æ›¿æ¢æˆ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="comment">// è¯·ç¡®ä¿æ·»åŠ ä¸€ä¸ªä¸è·¯ç”±å‚æ•°å®Œå…¨ç›¸åŒçš„ prop å</span></span><br><span class="line">  <span class="attr">props</span>: [<span class="string">&quot;id&quot;</span>],</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&quot;&lt;div&gt;User &#123;&#123; id &#125;&#125;&lt;/div&gt;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> routes = [&#123; <span class="attr">path</span>: <span class="string">&quot;/user/:id&quot;</span>, <span class="attr">component</span>: <span class="title class_">User</span>, <span class="attr">props</span>: <span class="literal">true</span> &#125;];</span><br></pre></td></tr></table></figure><p><strong>å‘½åè§†å›¾</strong>ï¼šæ¯ä¸ªè§†å›¾éœ€è¦å®šä¹‰è‡ªå·±çš„ props</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/user/:id&quot;</span>,</span><br><span class="line">    <span class="attr">components</span>: &#123; <span class="attr">default</span>: <span class="title class_">User</span>, <span class="attr">sidebar</span>: <span class="title class_">Sidebar</span> &#125;,</span><br><span class="line">    <span class="attr">props</span>: &#123; <span class="attr">default</span>: <span class="literal">true</span>, <span class="attr">sidebar</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p><strong>å¯¹è±¡æ¨¡å¼</strong>ï¼šå¦‚æœ props è¢«è®¾ç½®ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä¼šè¢«æŒ‰åŸæ ·è®¾ç½®ä¸ºç»„ä»¶çš„ props</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/user/:id&quot;</span>,</span><br><span class="line">    <span class="attr">components</span>: &#123; <span class="attr">default</span>: <span class="title class_">User</span>, <span class="attr">sidebar</span>: <span class="title class_">Sidebar</span> &#125;,</span><br><span class="line">    <span class="attr">props</span>: &#123; <span class="attr">default</span>: <span class="literal">true</span>, <span class="attr">sidebar</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p><strong>å‡½æ•°æ¨¡å¼</strong>ï¼šå¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°è¿”å› propsï¼Œå°†å‚æ•°è½¬æ¢ä¸ºå…¶ä»–ç±»å‹ï¼Œå°†é™æ€å€¼ä¸åŸºäºè·¯ç”±çš„å€¼ç›¸ç»“åˆç­‰ç­‰ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/search&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">SearchUser</span>,</span><br><span class="line">    <span class="attr">props</span>: <span class="function">(<span class="params">route</span>) =&gt;</span> (&#123; <span class="attr">query</span>: route.<span class="property">query</span>.<span class="property">q</span> &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="è·¯ç”±å…ƒä¿¡æ¯"><a href="#è·¯ç”±å…ƒä¿¡æ¯" class="headerlink" title="è·¯ç”±å…ƒä¿¡æ¯"></a>è·¯ç”±å…ƒä¿¡æ¯</h2><p>é…ç½®<code>meta</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">    <span class="comment">// è·¯ç”±å…ƒä¿¡æ¯</span></span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">requiresAuth</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><ul><li>æ•°ç»„ä¸­æ¯ä¸ªå¯¹è±¡å«åš<strong>è·¯ç”±è®°å½•</strong>ï¼Œåœ¨åµŒå¥—è·¯ç”±ä¸­å°±åˆ†ä¸º<strong>çˆ¶è·¯ç”±è®°å½•</strong>å’Œ<strong>å­è·¯ç”±è®°å½•</strong></li><li>åŒ¹é…åˆ°çš„è·¯ç”±æš´éœ²ä¸º<code>$route</code>å¯¹è±¡çš„<code>matched</code>å±æ€§ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†æ‰€æœ‰åŒ¹é…åˆ°çš„è·¯ç”±è®°å½•</li></ul><p><code>$route.meta</code>æ–¹æ³•å¯ä»¥è·å–åˆ°è·¯ç”±å…ƒä¿¡æ¯ï¼Œç›´æ¥ç”¨<code>.</code>è®¿é—®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è€Œä¸æ˜¯å»æ£€æŸ¥æ¯æ¡è·¯ç”±è®°å½•</span></span><br><span class="line">  <span class="comment">// to.matched.some(record =&gt; record.meta.requiresAuth)</span></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">requiresAuth</span> &amp;&amp; !auth.<span class="title function_">isLoggedIn</span>()) &#123;</span><br><span class="line">    <span class="comment">// æ­¤è·¯ç”±éœ€è¦æˆæƒï¼Œè¯·æ£€æŸ¥æ˜¯å¦å·²ç™»å½•</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰ï¼Œåˆ™é‡å®šå‘åˆ°ç™»å½•é¡µé¢</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">      <span class="comment">// ä¿å­˜æˆ‘ä»¬æ‰€åœ¨çš„ä½ç½®ï¼Œä»¥ä¾¿ä»¥åå†æ¥</span></span><br><span class="line">      <span class="attr">query</span>: &#123; <span class="attr">redirect</span>: to.<span class="property">fullPath</span> &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>TypeScript</code>ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>RouteMeta</code>æ¥å®šä¹‰è·¯ç”±å…ƒä¿¡æ¯çš„ç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// typings.d.ts or router.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&quot;vue-router&quot;</span> &#123;</span><br><span class="line">  <span class="keyword">interface</span> <span class="title class_">RouteMeta</span> &#123;</span><br><span class="line">    <span class="comment">// æ˜¯å¯é€‰çš„</span></span><br><span class="line">    <span class="attr">isAdmin</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="comment">// æ¯ä¸ªè·¯ç”±éƒ½å¿…é¡»å£°æ˜</span></span><br><span class="line">    <span class="attr">requiresAuth</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>props</code>ä¼šæä¾›è¿™ä¸ªå—ä»¥å ï¼Ÿï¼ŸğŸ«¡</p></blockquote><h2 id="ä¸åŒçš„å†å²æ¨¡å¼"><a href="#ä¸åŒçš„å†å²æ¨¡å¼" class="headerlink" title="ä¸åŒçš„å†å²æ¨¡å¼"></a>ä¸åŒçš„å†å²æ¨¡å¼</h2><p>åœ¨ä»¥å¾€<em>vue2</em>ä½¿ç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨<code>mode</code>æ¥é…ç½®ï¼Œ<em>vue3</em>ç°åœ¨ä½¿ç”¨<code>history</code>æ¥é…ç½®</p><p>å®ƒä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼š</p><ul><li>mode: history | hash | abstract</li><li>history: createWebHistory | createWebHashHistory | createMemoryHistory</li></ul><p><strong>ğŸ‘‰ hash æ¨¡å¼</strong></p><p>åœ¨å†…éƒ¨ä¼ é€’å®é™… URL ä¹‹å‰ä½¿ç”¨äº†ä¸€ä¸ªå“ˆå¸Œå­—ç¬¦ï¼ˆ<code>#</code>ï¼‰</p><p>URL çœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š<code>http://oursite.com/#/user/id</code></p><p>å®ƒçš„å¥½å¤„æ˜¯ä¸éœ€è¦åç«¯é…ç½®ï¼Œç¼ºç‚¹æ˜¯<strong>åœ¨ SEO æ–¹é¢ä¸å¤ªå‹å¥½</strong></p><p><strong>ğŸ‘‰ HTML5 æ¨¡å¼</strong></p><p>âœ… æ¨èä½¿ç”¨</p><p>URL å¼€èµ·æ¥å°±åƒè¿™æ ·ï¼š<code>http://oursite.com/user/id</code></p><p>å®ƒçš„å¥½å¤„æ˜¯ URL çœ‹èµ·æ¥æ›´åŠ å‹å¥½ï¼Œä½†æ˜¯éœ€è¦åç«¯é…ç½®</p><h1 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h1><h2 id="å¯¼èˆªå®ˆå«"><a href="#å¯¼èˆªå®ˆå«" class="headerlink" title="å¯¼èˆªå®ˆå«"></a>å¯¼èˆªå®ˆå«</h2><p>å¯¼èˆªå®ˆå«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä¼šåœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶è¢«è°ƒç”¨</p><p>å‡ºç°çš„åœ°æ–¹æœ‰ï¼šå…¨å±€çš„ã€å•ä¸ªè·¯ç”±ç‹¬äº«çš„ã€ç»„ä»¶å†…çš„</p><h3 id="å…¨å±€å‰ç½®å®ˆå«"><a href="#å…¨å±€å‰ç½®å®ˆå«" class="headerlink" title="å…¨å±€å‰ç½®å®ˆå«"></a>å…¨å±€å‰ç½®å®ˆå«</h3><p><code>router.beforeEach</code>æ–¹æ³•æ³¨å†Œä¸€ä¸ªå…¨å±€å‰ç½®å®ˆå«ï¼Œå®ˆå«æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥è·³è½¬éœ€è¦åœ¨å®ˆå«<code>resolve</code>ä¹‹åæ‰ä¼šç»§ç»­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123; ... &#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// è¿”å› false ä»¥å–æ¶ˆå¯¼èˆª</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å›è°ƒå‚æ•°ï¼š</p><ul><li><code>to</code>ï¼šå³å°†è¦è¿›å…¥çš„ç›®æ ‡è·¯ç”±å¯¹è±¡</li><li><code>from</code>ï¼šå½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”±</li><li><code>next</code>ï¼šè°ƒç”¨è¯¥æ–¹æ³•åï¼Œèƒ½è¿›å…¥ä¸‹ä¸€ä¸ªé’©å­ï¼Œä¸è¿‡ç°åœ¨å¯ä»¥ç”¨<code>return</code>æ¥ä»£æ›¿<code>next</code><ul><li><code>next(false)</code>ï¼šå–æ¶ˆå½“å‰å¯¼èˆª</li><li><code>next(&#39;/&#39;)</code>ï¼šè·³è½¬</li><li><code>next(&#123; path: &#39;/&#39; &#125;)</code>ï¼šè·³è½¬</li></ul></li></ul><p>ç°åœ¨ <em>Vue Router 4</em> ä¸­å¯ä»¥ä½¿ç”¨<code>return</code>ï¼Œä¸ç”¨<code>next()</code>ï¼Œè¿”å›å€¼å¯ä»¥æœ‰ï¼š</p><ul><li><code>false</code>ï¼šå–æ¶ˆå½“å‰å¯¼èˆª</li><li>ä¸€ä¸ªè·¯ç”±åœ°å€ï¼šè·³è½¬åˆ°æŒ‡å®šè·¯ç”±ï¼Œç±»ä¼¼äº<code>router.push()</code>ï¼Œä¹Ÿå¯ä»¥è®¾ç½®<code>replace: true</code>ã€<code>name: &#39;home&#39;</code>ç­‰</li><li>å¦‚æœä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œ<code>undefined</code> æˆ–è¿”å› <code>true</code>ï¼Œåˆ™å¯¼èˆªæ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶è°ƒç”¨ä¸‹ä¸€ä¸ªå¯¼èˆªå®ˆå«</li></ul><blockquote><p>return ä¼šæ¯” next å¥½ç‚¹å§åº”è¯¥ï¼Œå› ä¸º next å¿…é¡»å¾—è°ƒç”¨ï¼Œè€Œ return å¯ä»¥ä¸ç”¨å†™é‚£ä¹ˆå¤š if else</p></blockquote><p>å¦‚æœé‡åˆ°äº†æ„æ–™ä¹‹å¤–çš„æƒ…å†µï¼Œå¯èƒ½ä¼šæŠ›å‡ºä¸€ä¸ª Errorã€‚è¿™ä¼šå–æ¶ˆå¯¼èˆªå¹¶ä¸”è°ƒç”¨ <code>router.onError()</code> æ³¨å†Œè¿‡çš„å›è°ƒã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">beforeEach</span>(<span class="title function_">async</span> (to, <span class="keyword">from</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    <span class="comment">// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•</span></span><br><span class="line">    !isAuthenticated &amp;&amp;</span><br><span class="line">    <span class="comment">// â—ï¸ é¿å…æ— é™é‡å®šå‘</span></span><br><span class="line">    to.<span class="property">name</span> !== <span class="string">&quot;Login&quot;</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="comment">// å°†ç”¨æˆ·é‡å®šå‘åˆ°ç™»å½•é¡µé¢</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">name</span>: <span class="string">&quot;Login&quot;</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="å…¨å±€è§£æå®ˆå«"><a href="#å…¨å±€è§£æå®ˆå«" class="headerlink" title="å…¨å±€è§£æå®ˆå«"></a>å…¨å±€è§£æå®ˆå«</h3><p><code>router.beforeResolve</code>æ–¹æ³•æ³¨å†Œä¸€ä¸ªå…¨å±€è§£æå®ˆå«ï¼Œå’Œå‰ç½®å¯¼èˆªå®ˆå«ç±»ä¼¼ï¼Œä½†æ˜¯å¾—åœ¨ <strong>æ‰€æœ‰ç»„ä»¶å†…å®ˆå«</strong>å’Œ <strong>å¼‚æ­¥è·¯ç”±ç»„ä»¶</strong> è¢«è§£æä¹‹åï¼Œè§£æå®ˆå«å°±è¢«è°ƒç”¨</p><p>ç¤ºä¾‹ï¼šç¡®ä¿ç”¨æˆ·å¯è®¿é—®åˆ°è‡ªå®šä¹‰<em>meta</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">beforeResolve</span>(<span class="title function_">async</span> (to) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">requiresCamera</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">askForCameraPermission</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">if</span> (error <span class="keyword">instanceof</span> <span class="title class_">NotAllowedError</span>) &#123;</span><br><span class="line">        <span class="comment">// ... å¤„ç†é”™è¯¯ï¼Œç„¶åå–æ¶ˆå¯¼èˆª</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æ„æ–™ä¹‹å¤–çš„é”™è¯¯ï¼Œå–æ¶ˆå¯¼èˆªå¹¶æŠŠé”™è¯¯ä¼ ç»™å…¨å±€å¤„ç†å™¨</span></span><br><span class="line">        <span class="keyword">throw</span> error;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>router.beforeResolve æ˜¯è·å–æ•°æ®æˆ–æ‰§è¡Œä»»ä½•å…¶ä»–æ“ä½œï¼ˆå¦‚æœç”¨æˆ·æ— æ³•è¿›å…¥é¡µé¢æ—¶ä½ å¸Œæœ›é¿å…æ‰§è¡Œçš„æ“ä½œï¼‰çš„ç†æƒ³ä½ç½®ã€‚</p><h3 id="å…¨å±€åç½®é’©å­"><a href="#å…¨å±€åç½®é’©å­" class="headerlink" title="å…¨å±€åç½®é’©å­"></a>å…¨å±€åç½®é’©å­</h3><ul><li>å’Œå®ˆå«ä¸åŒçš„æ˜¯ï¼Œåç½®é’©å­æ²¡æœ‰ <code>next</code> å‡½æ•°ï¼Œä¸èƒ½æ”¹å˜å¯¼èˆªæœ¬èº«ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æ˜¯<code>failure</code></li><li>å¯¹äºåˆ†æã€æ›´æ”¹é¡µé¢æ ‡é¢˜ã€å£°æ˜é¡µé¢ç­‰è¾…åŠ©åŠŸèƒ½ä»¥åŠè®¸å¤šå…¶ä»–äº‹æƒ…éƒ½å¾ˆæœ‰ç”¨ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, failure</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!failure) <span class="title function_">sendToAnalytics</span>(to.<span class="property">fullPath</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯<strong>å¯¼èˆªæ•…éšœ</strong></p><h2 id="å¯¼èˆªæ•…éšœ"><a href="#å¯¼èˆªæ•…éšœ" class="headerlink" title="å¯¼èˆªæ•…éšœ"></a>å¯¼èˆªæ•…éšœ</h2><h3 id="å¼‚æ­¥ç­‰å¾…å¯¼èˆªç»“æœ"><a href="#å¼‚æ­¥ç­‰å¾…å¯¼èˆªç»“æœ" class="headerlink" title="å¼‚æ­¥ç­‰å¾…å¯¼èˆªç»“æœ"></a>å¼‚æ­¥ç­‰å¾…å¯¼èˆªç»“æœ</h3><p>å¯¼èˆªæ•…éšœæ˜¯å¯¼èˆªæœŸé—´å‡ºç°çš„ä»»ä½•é”™è¯¯æˆ–è¢«å–æ¶ˆçš„å¯¼èˆªã€‚å½“ä½¿ç”¨ <code>router-link</code> ç»„ä»¶æ—¶ï¼ŒVue Router ä¼šè‡ªåŠ¨è°ƒç”¨ <code>router.push</code> æ¥è§¦å‘ä¸€æ¬¡å¯¼èˆªã€‚</p><p>ä¸€èˆ¬æ¥è¯´å¯¼èˆªéƒ½ä¼šåˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œæƒ³è¦åœ¨å¯¼èˆªå®Œæˆä¹‹ååšä¸€äº›äº‹æƒ…ï¼Œå¯ä»¥ä½¿ç”¨<code>router.afterEach</code>ï¼Œä½†æ˜¯å¦‚æœå¯¼èˆªè¢«å–æ¶ˆäº†ï¼ˆæˆ–è€…é”™è¯¯ä¹‹ç±»çš„ï¼‰ï¼Œå°±ä¸ä¼šè§¦å‘<code>router.afterEach</code></p><p>è§£å†³çš„åŠæ³•å°±æ˜¯ä½¿ç”¨<strong>å¯¼èˆªçš„å¼‚æ­¥ç‰¹æ€§</strong>è¿›è¡Œç­‰å¾…</p><p>æ¯”å¦‚ç­‰å¯¼èˆªç»“æŸä¹‹åå†å…³é—­èœå•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> router.<span class="title function_">push</span>(<span class="string">&quot;/my-profile&quot;</span>);</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">isMenuOpen</span> = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ˜¯ç›‘å¬å¯¼èˆªæ•…éšœï¼Œç„¶ååšç‚¹ä»€ä¹ˆ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">onError</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (error <span class="keyword">instanceof</span> <span class="title class_">NotAllowedError</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="æ•…éšœ"><a href="#æ•…éšœ" class="headerlink" title="æ•…éšœ"></a>æ•…éšœ</h3><p>å¯¼èˆªæˆåŠŸçš„è¯ï¼Œ<code>await</code>ç­‰åˆ°çš„æ˜¯<code>undefined</code>ï¼Œå¦‚æœå¯¼èˆªå¤±è´¥äº†ï¼Œ<code>await</code>ç­‰åˆ°çš„æ˜¯ä¸€ä¸ª<code>NavigationFailure</code>å¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> navigationResult = <span class="keyword">await</span> router.<span class="title function_">push</span>(<span class="string">&quot;/my-profile&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (navigationResult) &#123;</span><br><span class="line">  <span class="comment">// å¯¼èˆªè¢«é˜»æ­¢</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// å¯¼èˆªæˆåŠŸ (åŒ…æ‹¬é‡æ–°å¯¼èˆªçš„æƒ…å†µ)</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">isMenuOpen</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ˜¯(çœŸçš„å—)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">await</span> router.<span class="title function_">push</span>(<span class="string">&quot;/my-profile&quot;</span>);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">isMenuOpen</span> = <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="keyword">if</span> (error <span class="keyword">instanceof</span> <span class="title class_">NotAllowedError</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// æ„æ–™ä¹‹å¤–çš„é”™è¯¯ï¼Œå–æ¶ˆå¯¼èˆªå¹¶æŠŠé”™è¯¯ä¼ ç»™å…¨å±€å¤„ç†å™¨</span></span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>**isNavigationFailure()**</code>ï¼šæ¥äº†è§£å“ªäº›å¯¼èˆªè¢«é˜»æ­¢äº†å’Œä¸ºä»€ä¹ˆè¢«é˜»æ­¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NavigationFailureType</span>, isNavigationFailure &#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯•å›¾ç¦»å¼€æœªä¿å­˜çš„ç¼–è¾‘æ–‡æœ¬ç•Œé¢</span></span><br><span class="line"><span class="keyword">const</span> failure = <span class="keyword">await</span> router.<span class="title function_">push</span>(<span class="string">&quot;/articles/2&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">isNavigationFailure</span>(failure, <span class="title class_">NavigationFailureType</span>.<span class="property">aborted</span>)) &#123;</span><br><span class="line">  <span class="comment">// ç»™ç”¨æˆ·æ˜¾ç¤ºä¸€ä¸ªå°é€šçŸ¥</span></span><br><span class="line">  <span class="title function_">showToast</span>(<span class="string">&quot;You have unsaved changes, discard and leave anyway?&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ‘‰ <code>isNavigationFailure()</code> ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯</p><ul><li><code>aborted</code>ï¼šå¯¼èˆªè¢«å–æ¶ˆï¼Œ<code>return false</code>æˆ–<code>next(false)</code></li><li><code>cancelled</code>ï¼šå½“å‰å¯¼èˆªæ²¡å®Œæˆä¹‹å‰ï¼Œåˆè§¦å‘äº†ä¸€ä¸ªæ–°çš„å¯¼èˆªï¼ˆåœ¨å¯¼èˆªç­‰å¾…çš„æ—¶å€™ï¼Œè°ƒç”¨äº†ä¸ªæ–°çš„<code>router.push()</code>ï¼‰</li><li><code>duplicated</code>ï¼šå¯¼èˆªè¢«é˜»æ­¢ï¼Œå› ä¸ºå·²ç»åœ¨ç›®æ ‡ä½ç½®äº†</li></ul><p>å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ä¼ çš„è¯ï¼Œå°±åªæ˜¯åˆ¤æ–­æ˜¯å¦æ˜¯<em>Navigation Failure</em> ğŸ™ƒ</p><p>ğŸ‘‰ <code>isNavigationFailure()</code> ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè®°å½•ç€è·¯ç”±çš„<code>to</code>, <code>from</code></p><h3 id="æ£€æµ‹é‡å®šå‘"><a href="#æ£€æµ‹é‡å®šå‘" class="headerlink" title="æ£€æµ‹é‡å®šå‘"></a>æ£€æµ‹é‡å®šå‘</h3><p>é‡å®šå‘ä¸ä¼šé˜»æ­¢å¯¼èˆªï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¼èˆªï¼Œæ‰€ä»¥<code>router.push()</code>è¿”å›çš„æ˜¯<code>undefined</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> router.<span class="title function_">push</span>(<span class="string">&quot;/my-profile&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (router.<span class="property">currentRoute</span>.<span class="property">value</span>.<span class="property">redirectedFrom</span>) &#123;</span><br><span class="line">  <span class="comment">// redirectedFrom æ˜¯è§£æå‡ºçš„è·¯ç”±åœ°å€ï¼Œå°±åƒå¯¼èˆªå®ˆå«ä¸­çš„ toå’Œ from</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¿‡æ¸¡ç‰¹æ•ˆå’Œæ»šåŠ¨è¡Œä¸º"><a href="#è¿‡æ¸¡ç‰¹æ•ˆå’Œæ»šåŠ¨è¡Œä¸º" class="headerlink" title="è¿‡æ¸¡ç‰¹æ•ˆå’Œæ»šåŠ¨è¡Œä¸º"></a>è¿‡æ¸¡ç‰¹æ•ˆå’Œæ»šåŠ¨è¡Œä¸º</h2><h3 id="è¿‡åº¦ç‰¹æ•ˆ"><a href="#è¿‡åº¦ç‰¹æ•ˆ" class="headerlink" title="è¿‡åº¦ç‰¹æ•ˆ"></a>è¿‡åº¦ç‰¹æ•ˆ</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; Component &#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;Component&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>Component</code>æ˜¯å½“å‰è·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶</li><li><code>v-solt</code>å¯ä»¥ç”¨ç®€å†™<code>#default=&quot;&#123; Component &#125;&quot;</code></li></ul><p>é™¤äº†ä½¿ç”¨<code>v-slot</code>ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>&lt;router-view&gt;</code>çš„<code>transition</code>å±æ€§</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">transition</span>=<span class="string">&quot;fade&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>ğŸ™ƒ é’ˆå¯¹æ¯ä¸ªè·¯ç”±é…ç½®ä¸åŒçš„è¿‡æ¸¡ç‰¹æ•ˆ</p><ul><li>å¯ä»¥åœ¨è·¯ç”±é…ç½®ä¸­åŠ å…¥<code>meta</code></li><li>æˆ–è€…åœ¨å…¨å±€åç½®é’©å­ä¸­åŠ å…¥<code>meta</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/custom-transition&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">PanelLeft</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">transition</span>: <span class="string">&quot;slide-left&quot;</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/other-transition&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">PanelRight</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">transition</span>: <span class="string">&quot;slide-right&quot;</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; Component, route &#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä½¿ç”¨ä»»ä½•è‡ªå®šä¹‰è¿‡æ¸¡å’Œå›é€€åˆ° `fade` --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">transition</span> <span class="attr">:name</span>=<span class="string">&quot;route.meta.transition || &#x27;fade&#x27;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;Component&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>â”â” Vue å¯èƒ½ä¼šè‡ªåŠ¨å¤ç”¨çœ‹èµ·æ¥ç›¸ä¼¼çš„ç»„ä»¶ï¼Œä»è€Œå¿½ç•¥äº†ä»»ä½•è¿‡æ¸¡ã€‚å¯ä»¥ç»™åŠ¨æ€ç»„ä»¶åŠ ä¸Šä¸€ä¸ª <code>key</code> å±æ€§ï¼Œæ¥æç¤º Vue å»å¼ºåˆ¶é‡æ–°æ¸²æŸ“</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; Component, route &#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;Component&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;route.path&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ»šåŠ¨è¡Œä¸º"><a href="#æ»šåŠ¨è¡Œä¸º" class="headerlink" title="æ»šåŠ¨è¡Œä¸º"></a>æ»šåŠ¨è¡Œä¸º</h3><ul><li>å°±æ˜¯åœ¨å‰è¿›åé€€çš„æ—¶å€™ï¼Œé¡µé¢æ»šåŠ¨åˆ°å“ªé‡Œï¼Œæˆ–è€…æ˜¯ä¿æŒåŸæ¥çš„æ»šåŠ¨ä½ç½®</li></ul><blockquote><p>æ³¨æ„: è¿™ä¸ªåŠŸèƒ½åªåœ¨æ”¯æŒ history.pushState çš„æµè§ˆå™¨ä¸­å¯ç”¨ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  <span class="title function_">scrollBehavior</span>(<span class="params">to, <span class="keyword">from</span>, savedPosition</span>) &#123;</span><br><span class="line">    <span class="comment">// return æœŸæœ›æ»šåŠ¨åˆ°å“ªä¸ªçš„ä½ç½®</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>è¿”å›ä¸€ä¸ª<em>falsy</em>å€¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä¸ä¼šå‘ç”Ÿæ»šåŠ¨</li><li>è¿”å›<code>savedPosition</code>ï¼Œä¼šæ»šåŠ¨åˆ°ä¹‹å‰ä¿å­˜çš„ä½ç½®</li></ul><p>ä½ç½®ä½¿ç”¨çš„æ˜¯<code>top</code>å’Œ<code>left</code>ï¼Œå¯ä»¥æ˜¯æ•°å­—æˆ–è€…æ˜¯å­—ç¬¦ä¸²</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="title function_">scrollBehavior</span>(<span class="params">to, <span class="keyword">from</span>, savedPosition</span>) &#123;</span><br><span class="line">    <span class="comment">// å§‹ç»ˆåœ¨å…ƒç´  #main ä¸Šæ–¹æ»šåŠ¨ 10px</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™</span></span><br><span class="line">      <span class="comment">// el: document.getElementById(&#x27;main&#x27;),</span></span><br><span class="line">      <span class="attr">el</span>: <span class="string">&quot;#main&quot;</span>,</span><br><span class="line">      <span class="attr">top</span>: -<span class="number">10</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è¦æ¨¡æ‹Ÿ â€œæ»šåŠ¨åˆ°é”šç‚¹â€ çš„è¡Œä¸ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="title function_">scrollBehavior</span>(<span class="params">to, <span class="keyword">from</span>, savedPosition</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">hash</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">el</span>: to.<span class="property">hash</span>,</span><br><span class="line">        <span class="attr">behavior</span>: <span class="string">&quot;smooth&quot;</span>, <span class="comment">// æ»šå¾—æ›´æµç•…ï¼Œå¦‚æœæµè§ˆå™¨æ”¯æŒçš„è¯</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å»¶è¿Ÿæ»šåŠ¨ï¼Œç­‰å¾…é¡µé¢åŠ¨æ•ˆå®Œæˆåå†æ»šåŠ¨ï¼Œå¯ä»¥è¿”å›ä¸ª<code>Promise</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="title function_">scrollBehavior</span>(<span class="params">to, <span class="keyword">from</span>, savedPosition</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(&#123; <span class="attr">left</span>: <span class="number">0</span>, <span class="attr">top</span>: <span class="number">0</span> &#125;);</span><br><span class="line">      &#125;, <span class="number">500</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><!-- <br /><br /><br /><br /><div style="text-align: center;"><h1 style="font-size: 50px; margin-bottom: -20px;"><span style="color: #41b883;">VueRouter</span  > å¿«é€Ÿæ‰‹å†Œ <span style="font-size: 20px; margin-left: -10px";margin-top: -20px;>âš¡</span></h1><h1> ğŸš„ ğŸš… ğŸšˆ ğŸš ğŸ’¨</h1></div><br /><br /><br /><br /> -->]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸ«¡ğŸ™ƒ&lt;/p&gt;
&lt;p&gt;[ ] å…ˆçœ‹å®˜æ–¹æ–‡æ¡£ï¼Œç„¶åç»„ç»‡å‡ºæ¥ç¬”è®°å’Œæ¡ˆä¾‹ä»£ç &lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="vue" scheme="https://smalljerry.cn/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>Typescript å¿«é€Ÿæ‰‹å†Œ 2.0</title>
    <link href="https://smalljerry.cn/2023/08/12/Typescript-%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C-2-0/"/>
    <id>https://smalljerry.cn/2023/08/12/Typescript-%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C-2-0/</id>
    <published>2023-08-12T06:25:33.000Z</published>
    <updated>2025-02-22T02:14:47.345Z</updated>
    
    <content type="html"><![CDATA[<p>åŠªåŠ›å­¦ä¹  ğŸï¸ğŸï¸</p><span id="more"></span><h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><h2 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h2><p>ç”Ÿæˆé…ç½®æ–‡ä»¶ <em>ts.config.json</em></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc --init</span><br></pre></td></tr></table></figure><p>ç›‘å¬æ–‡ä»¶å˜åŒ–</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc -w index.ts</span><br></pre></td></tr></table></figure><p>å®‰è£… <em>ts-node</em> ç›´æ¥è¿è¡Œ ts æ–‡ä»¶ï¼Œä¸ç”¨å…ˆæ‰‹åŠ¨ç¼–è¯‘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ts-node -g</span><br></pre></td></tr></table></figure><h2 id="ç±»å‹ã€æ¥å£"><a href="#ç±»å‹ã€æ¥å£" class="headerlink" title="ç±»å‹ã€æ¥å£"></a>ç±»å‹ã€æ¥å£</h2><h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><p>ç±»å‹çš„çº§åˆ«ï¼ˆä»é¡¶çº§åˆ°ä½çº§æ’ï¼‰</p><ol><li>any, unknown</li><li>Object</li><li>Number, String, Boolean</li><li>number, string, boolean</li><li>1, â€˜helloâ€™, false</li><li>never</li></ol><p>å…¶ä¸­ï¼š</p><ul><li><code>any</code>: ä»»æ„ç±»å‹ï¼Œå¯ç»™éšä¾¿èµ‹å€¼</li><li><code>unknown</code>: ä¸çŸ¥é“çš„ç±»å‹ï¼Œåªèƒ½ç»™è‡ªå·±æˆ–è€… any èµ‹å€¼</li></ul><p><code>unknown</code>çš„å¯¹è±¡æ˜¯æ— æ³•è¯»å–å±æ€§çš„</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">person</span>: <span class="built_in">unknown</span> = &#123; <span class="attr">name</span>: <span class="string">&quot;Jerry&quot;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;;</span><br><span class="line">person.<span class="property">name</span>; <span class="comment">// âŒ è¿™é‡Œä¼šæŠ¥é”™</span></span><br></pre></td></tr></table></figure><ul><li>æ‰€ä»¥<code>unknown</code>ç±»å‹ä¼šæ¯”è¾ƒå®‰å…¨ï¼Œå½“ä¸çŸ¥é“ç”¨ä»€ä¹ˆç±»å‹çš„æ—¶å€™å¯ä»¥é€‰å®ƒ</li></ul><hr><p><code>Object</code>, <code>object</code>, <code>&#123;&#125;</code>çš„åŒºåˆ«ï¼šğŸ™ƒ</p><p>â–¶ï¸ Objectï¼šåœ¨åŸå‹é“¾ä¸Šï¼Œå¯åŒ…å«æ‰€æœ‰</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">test</span>: <span class="title class_">Object</span> = <span class="number">1</span>;</span><br><span class="line">test = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">test = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p>â–¶ï¸ objectï¼šä»£è¡¨éåŸå§‹ç±»å‹çš„ç±»å‹ï¼ˆå¼•ç”¨ç±»å‹ï¼‰ï¼Œæ¯”è¾ƒå¸¸ç”¨äº<em>æ³›å‹çº¦æŸ</em></p><p>â–¶ï¸ {}ï¼šç›¸å½“äº<code>new Object</code>ï¼Œå’Œ<code>Object</code>ä¸€æ ·ï¼Œ<strong>ä½†æ˜¯å˜é‡ä¸èƒ½å¤åˆ¶</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">person</span>: &#123;&#125; = &#123; <span class="attr">name</span>: <span class="string">&quot;Jerry&quot;</span> &#125;;</span><br><span class="line">person.<span class="property">age</span>; <span class="comment">// âŒ è¿™é‡Œä¼šæŠ¥é”™</span></span><br></pre></td></tr></table></figure><hr><h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><ul><li>ä¸¤ä¸ªé‡åçš„ interface ä¼šåˆå¹¶èµ·æ¥</li><li>å¤šè¡Œæ—¶ï¼Œå±æ€§ä¹‹é—´å¯ä»¥ç”¨<code>;</code>ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨</li></ul><p><code>ç´¢å¼•ç­¾å(index signature)</code>çš„å¯èƒ½ä½¿ç”¨åœºæ™¯ï¼šåç«¯è¿”å›å¯¹è±¡ï¼Œä½†æ˜¯å‰ç«¯åªæƒ³è¦å…¶ä¸­çš„å‡ ä¸ªå±æ€§</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">  [<span class="attr">propName</span>: <span class="built_in">string</span>]: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Fn</span> &#123;</span><br><span class="line">  (nameL <span class="built_in">string</span>): <span class="built_in">number</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">fn</span>: <span class="title class_">Fn</span> = <span class="function">(<span class="params"><span class="attr">name</span>:<span class="built_in">string</span></span>) =&gt;</span> [<span class="number">1</span>]</span><br></pre></td></tr></table></figure><blockquote><p>interface é‡Œé¢æœ‰å”¯ä¸€ id æˆ–è€…å‡½æ•°ï¼Œå¯ä»¥ç”¨<code>readonly</code>é™åˆ¶ä¸€ä¸‹ï¼ˆåœ¨å¯¹åº” key å‰é¢åŠ ä¸Šï¼‰</p></blockquote><p><em>æ•°ç»„æ¥å£</em> çš„å‡ ç§ä½¿ç”¨æ–¹å¼</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">name1</span>: <span class="built_in">string</span>[] = [<span class="string">&quot;Tom&quot;</span>, <span class="string">&quot;Jerry&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">name2</span>: <span class="title class_">Array</span>&lt;<span class="built_in">string</span>&gt; = [<span class="string">&quot;Tom&quot;</span>, <span class="string">&quot;Jerry&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Name</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">name3</span>: <span class="title class_">Name</span>[] = [&#123; <span class="attr">name</span>: <span class="string">&quot;Tom&quot;</span> &#125;, &#123; <span class="attr">name</span>: <span class="string">&quot;Jerry&quot;</span> &#125;];</span><br></pre></td></tr></table></figure><p>äºŒç»´æ•°ç»„æˆ–è€…æ›´å¤š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">name1</span>: <span class="built_in">string</span>[][] = [[&#123; <span class="attr">name</span>: <span class="string">&quot;Tom&quot;</span> &#125;], [&#123; <span class="attr">name</span>: <span class="string">&quot;Jerry&quot;</span> &#125;]];</span><br><span class="line"><span class="keyword">let</span> <span class="attr">name2</span>: <span class="title class_">Array</span>&lt;<span class="title class_">Array</span>&lt;<span class="built_in">string</span>&gt;&gt; = [[&#123; <span class="attr">name</span>: <span class="string">&quot;Tom&quot;</span> &#125;], [&#123; <span class="attr">name</span>: <span class="string">&quot;Jerry&quot;</span> &#125;]];</span><br></pre></td></tr></table></figure><p>å¦‚æœæ•°ç»„é‡Œé¢å•¥éƒ½æœ‰ã€‚ç›´æ¥ç”¨<code>any</code>æˆ–è€…ç”¨<code>å…ƒç»„</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">name</span>: <span class="built_in">any</span>[] = [<span class="number">1</span>, <span class="string">&quot;qaq&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="attr">name</span>: [<span class="built_in">number</span>, <span class="built_in">string</span>] = [<span class="number">1</span>, <span class="string">&quot;qaq&quot;</span>];</span><br></pre></td></tr></table></figure><p>_å‰©ä½™å‚æ•°_ï¼šæœ‰å±äºè‡ªå·±çš„æ¥å£</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">func</span>(<span class="params">...<span class="attr">args</span>: <span class="built_in">string</span>[]</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>); <span class="comment">// ç±»å‹æ˜¯ IArgments</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç±»å‹åˆ«å"><a href="#ç±»å‹åˆ«å" class="headerlink" title="ç±»å‹åˆ«å"></a>ç±»å‹åˆ«å</h3><p>å°±æ˜¯ç”¨<code>type</code>æ¥æŒ‡å®šæŸä¸ªç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> s = <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> strArr = <span class="built_in">string</span>[];</span><br></pre></td></tr></table></figure><p><code>interface</code>ä¸èƒ½ä½¿ç”¨è”åˆç±»å‹ï¼Œä½†å¯ä»¥ä½¿ç”¨<code>extends</code></p><ul><li>é‡åˆ°é‡å¤çš„ä¼šåˆå¹¶</li></ul><p><code>type</code>æ²¡æœ‰ç»§æ‰¿ï¼Œä½†å¯ä»¥ä½¿ç”¨è”åˆç±»å‹ï¼Œå¦‚<code>type s = string | number</code></p><ul><li>é‡åˆ°é‡å¤çš„ä¸ä¼šåˆå¹¶</li></ul><p>ğŸ¤¤<code>type</code>çš„åˆ«çš„ç”¨æ³•</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å·¦è¾¹çš„å€¼ä¼šä½œä¸ºå³è¾¹ç±»å‹çš„å­ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> num = <span class="number">1</span> <span class="keyword">extends</span> <span class="built_in">number</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br></pre></td></tr></table></figure><ul><li>è¿™é‡Œæ˜¯ 1</li><li>type ä¸­çš„ extends æ˜¯åŒ…å«çš„æ„æ€</li></ul><hr><h3 id="ç±»å‹æ–­è¨€ã€äº¤å‰ç±»å‹ã€è”åˆç±»å‹"><a href="#ç±»å‹æ–­è¨€ã€äº¤å‰ç±»å‹ã€è”åˆç±»å‹" class="headerlink" title="ç±»å‹æ–­è¨€ã€äº¤å‰ç±»å‹ã€è”åˆç±»å‹"></a>ç±»å‹æ–­è¨€ã€äº¤å‰ç±»å‹ã€è”åˆç±»å‹</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = <span class="keyword">function</span> (<span class="params"><span class="attr">type</span>: <span class="built_in">number</span></span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> !!<span class="keyword">type</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><code>!0</code> æ˜¯ <code>true</code>ï¼Œå†<code>!</code>å°±æ˜¯<code>false</code>äº†ï¼Œè¿™æ—¶ç±»å‹å°±ä»<code>number</code>å˜æˆäº†<code>boolean</code>ï¼Œä½†æ˜¯è¡¨è¾¾çš„æ„ä¹‰è¿˜æ˜¯å¯¹ã€é”™ï¼ˆä¾‹å¦‚ï¼šæœ‰æ—¶åç«¯è¿”å›æ•°å­—è€Œä¸æ˜¯ true false çš„æ—¶å€™ï¼‰</li></ul><p>è”åˆç±»å‹ï¼Œ<code>interface</code>çš„è¯ï¼Œä½¿ç”¨ä¸€ä¸ª<code>&amp;</code>æ¥è”åˆï¼Œæ˜¯ä¸€ä¸ªã€‚</p><p>ç±»å‹æ–­è¨€ï¼Œå°±æ˜¯é‚£ä¸ª<code>as</code>ï¼Œå¯ä»¥ç”¨æ¥æ¬ºéª— TypeScriptï¼Œå¦‚æœæœ‰é”™çš„è¯ï¼Œç¼–è¯‘çš„æ—¶å€™è¿˜æ˜¯ä¼šæŠ¥é”™çš„ã€‚å¦å¤–çš„å†™æ³•æ˜¯<code>&lt;ç±»å‹&gt;å˜é‡</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="variable language_">window</span> <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">abc</span> = <span class="number">123</span>;</span><br></pre></td></tr></table></figure><ul><li>any å¯ä»¥ æ–­è¨€ä¸ºä»»ä½•ç±»å‹</li></ul><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add1</span>(<span class="params"><span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span></span>): <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">const</span> add2 = (<span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span>): <span class="function"><span class="params">number</span> =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>å¯¹äºå‡½æ•°çš„ä¸€ä¸ªå‚æ•°ï¼šé»˜è®¤å€¼ å’Œ å¯é€‰ ä¸èƒ½ä¸€èµ·ç”¨</p></blockquote><p>åœ¨å®šä¹‰å‡½æ•°çš„æ—¶å€™ï¼Œ<strong>ç¬¬ä¸€ä¸ªå‚æ•°</strong>å¯ä»¥å®šä¹‰<code>this</code>ï¼Œç”¨æ¥æŒ‡å®šå‡½æ•°å½“å‰æ‰€å¤„çš„å¯¹è±¡</p><ul><li>åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œ<code>this</code>ä¸ç”¨ä¼ é€’</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Obj</span> &#123;</span><br><span class="line">  <span class="attr">user</span>: <span class="built_in">number</span>[]</span><br><span class="line">  <span class="attr">add</span>: <span class="function">(<span class="params"><span class="variable language_">this</span>.<span class="title class_">Obj</span>, <span class="attr">num</span>:<span class="built_in">number</span></span>)=&gt;</span><span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">obj</span>: <span class="title class_">Obj</span> = &#123;</span><br><span class="line">  <span class="attr">user</span>: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],</span><br><span class="line">  <span class="title function_">add</span>(<span class="params"><span class="variable language_">this</span>.obj, <span class="attr">num</span>:<span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">user</span>.<span class="title function_">push</span>(num)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.<span class="title function_">add</span>(<span class="number">6</span>)</span><br></pre></td></tr></table></figure><ul><li>è¿™ä¸ªè¯­æ³•åœ¨ <code>js</code> ä¸­ä¸èƒ½ä½¿ç”¨</li></ul><p><strong>å‡½æ•°é‡è½½</strong></p><p>å¯èƒ½åœºæ™¯</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">user</span>: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="comment">// å¦‚æœä¼ è¿›æ¥çš„æ˜¯numberç±»å‹çš„æ•°ç»„ï¼Œé‚£å°±æ·»åŠ </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findNum</span>(<span class="params"><span class="attr">add</span>: <span class="built_in">number</span>[]</span>): <span class="built_in">number</span>[];</span><br><span class="line"><span class="comment">// å¦‚æœä¼ è¿›idå°±å•ä¸ªæŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findNum</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>): <span class="built_in">number</span>[];</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findNum</span>(<span class="params"><span class="attr">ids</span>: <span class="built_in">number</span> | <span class="built_in">number</span>[]</span>): <span class="built_in">number</span>[] &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> ids === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> user.<span class="title function_">filter</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v === ids);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(ids)) &#123;</span><br><span class="line">    user.<span class="title function_">push</span>(...ids);</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="class"><a href="#class" class="headerlink" title="class"></a>class</h2><p><code>implements</code>ï¼šç”¨æ¥å®ç°æ¥å£ï¼Œçº¦æŸç±»çš„ç»“æ„</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Options</span> &#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="built_in">string</span> | <span class="title class_">HTMLElement</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æ¥å£çº¦æŸ</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">VueClass</span> &#123;</span><br><span class="line">  <span class="attr">options</span>: <span class="title class_">Options</span>;</span><br><span class="line">  <span class="title function_">init</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vue</span> <span class="keyword">implements</span> <span class="title class_">VueClass</span> &#123;</span><br><span class="line">  <span class="attr">options</span>: <span class="title class_">Options</span>;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">Options</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">options</span> = options;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">init</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;init&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>extends</code>ï¼šç”¨æ¥ç»§æ‰¿ç±»</p><ul><li>extends éœ€è¦å†™åœ¨ implements å‰é¢ï¼Œå› ä¸º extends ä¼šç»§æ‰¿ implements çš„æ¥å£</li><li>super åŸç†æ˜¯çˆ¶ç±»çš„<code>prototype.constructor.call</code><ul><li>é‡Œé¢çš„å‚æ•°æ˜¯çˆ¶ç±»çš„å‚æ•°å¦‚æœæœ‰ä¸ªè¯ï¼Œéœ€è¦å‘é‡Œé¢ä¼ é€’å®å‚</li><li>å¯ä»¥ç›´æ¥é€šè¿‡<code>super.</code>æ¥è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æˆ–è€…å±æ€§</li></ul></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Dom</span> &#123;</span><br><span class="line">  <span class="title function_">createElement</span>(<span class="params"><span class="attr">el</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">createElement</span>(le);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">setText</span>(<span class="params"><span class="attr">el</span>: <span class="title class_">HTMLElement</span>, <span class="attr">text</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    el.<span class="property">textContent</span> = text;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vue</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Dom</span> <span class="keyword">implements</span> <span class="title class_">VueClass</span> &#123;</span><br><span class="line">  <span class="attr">options</span>: <span class="title class_">Options</span>;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">Options</span></span>) &#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œéœ€è¦å†™åœ¨æœ€ä¸Šé¢</span></span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">options</span> = options;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">init</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">render</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä»–å…³é”®å­—ï¼š</p><ul><li><code>readonly</code>ï¼šåªèƒ½åœ¨å£°æ˜å±æ€§çš„æ—¶å€™æˆ–è€…æ„é€ å‡½æ•°ä¸­èµ‹å€¼</li><li><code>private</code>: ç±»å†…éƒ¨ä½¿ç”¨</li><li><code>protected</code>: ç±»å†…éƒ¨å’Œå­ç±»ä½¿ç”¨</li><li><code>public</code>: ç±»å†…éƒ¨ã€å­ç±»ã€ç±»å¤–éƒ¨éƒ½å¯ä»¥ä½¿ç”¨</li><li><code>static</code>: é™æ€å±æ€§ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åæ¥è°ƒç”¨ã€‚<ul><li><strong>åªèƒ½è°ƒç”¨é™æ€çš„å±æ€§å’Œæ–¹æ³•</strong>ï¼Œå› ä¸ºä¸éœ€è¦å®ä¾‹åŒ–ï¼Œè‡ªç„¶å°±ä¸åœ¨å®ä¾‹ä¸Šé¢äº†</li><li>æƒ³è¦æ•°æ®çš„è¯ï¼Œå¯ä»¥æŠŠæ•°æ®ä½œä¸ºå‡½æ•°çš„å‚æ•°ä¼ è¿›æ¥</li></ul></li></ul><p><code>get</code>ã€<code>set</code>: å¯æ‹¦æˆªå±æ€§çš„è¯»å–å’Œèµ‹å€¼æ“ä½œ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vue</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">_el</span>: <span class="built_in">string</span> | <span class="title class_">HTMLElement</span>;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">el</span>: <span class="built_in">string</span> | <span class="title class_">HTMLElement</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_el</span> = el;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">el</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_el</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">el</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_el</span> = val;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> vue = <span class="keyword">new</span> <span class="title class_">Vue</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">vue.<span class="property">el</span> = <span class="string">&quot;span&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(vue.<span class="property">el</span>);</span><br></pre></td></tr></table></figure><p><code>abstract</code>ï¼šæŠ½è±¡ç±»ï¼Œä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½è¢«ç»§æ‰¿ ğŸ¤¤</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Dom</span> &#123;</span><br><span class="line">  <span class="keyword">abstract</span> <span class="title function_">createElement</span>(<span class="attr">el</span>: <span class="built_in">string</span>): <span class="title class_">HTMLElement</span>;</span><br><span class="line">  <span class="keyword">abstract</span> <span class="title function_">setText</span>(<span class="attr">el</span>: <span class="title class_">HTMLElement</span>, <span class="attr">text</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  <span class="keyword">abstract</span> <span class="title function_">render</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vue</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Dom</span> &#123;</span><br><span class="line">  <span class="attr">options</span>: <span class="title class_">Options</span>;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">Options</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">options</span> = options;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">createElement</span>(<span class="attr">el</span>: <span class="built_in">string</span>): <span class="title class_">HTMLElement</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">createElement</span>(el);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">setText</span>(<span class="attr">el</span>: <span class="title class_">HTMLElement</span>, <span class="attr">text</span>: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    el.<span class="property">textContent</span> = text;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> el = <span class="variable language_">this</span>.<span class="title function_">createElement</span>(<span class="variable language_">this</span>.<span class="property">options</span>.<span class="property">el</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setText</span>(el, <span class="string">&quot;hello&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸‹é¢å®ç°çš„å«æ´¾ç”Ÿç±»ï¼ŒæŠ½è±¡ç±»ä¸­çš„ä¸œè¥¿ï¼Œæ´¾ç”Ÿç±»å¿…é¡»å®ç°</li></ul><h2 id="å†…ç½®å¯¹è±¡"><a href="#å†…ç½®å¯¹è±¡" class="headerlink" title="å†…ç½®å¯¹è±¡"></a>å†…ç½®å¯¹è±¡</h2><p>ğŸ‘‰ğŸ™ƒ æœ‰è§„å¯å¾ª</p><p><strong>ECMA</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">num</span>: <span class="title class_">Number</span> = <span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="attr">date</span>: <span class="title class_">Date</span> = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="keyword">let</span> <span class="attr">xhr</span>: <span class="title class_">XMLHttpRequest</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br></pre></td></tr></table></figure><ul><li>ä¸€èˆ¬æ˜¯ <em>new</em> ä»€ä¹ˆï¼Œå°±æ˜¯ä»€ä¹ˆç±»å‹</li></ul><p><strong>DOM</strong></p><p>ä¸€èˆ¬æ˜¯ä»€ä¹ˆ<code>HTMLxxxElement</code></p><p>sectionã€header è¿™ç§ï¼Œä¼šå½’ä¸º <code>HTMLElement</code></p><p><code>querySelectorAll</code>è¿™ç§ï¼Œå°±æ˜¯<code>NodeList</code>ï¼Œå¦‚æœé‡Œé¢æ˜¯æœ‰å‡ ä¸ªçš„ï¼Œä¸å›ºå®šçš„ï¼Œä½¿ç”¨<code>NodeListOf</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">div</span>: <span class="title class_">NodeListOf</span>&lt;<span class="title class_">HTMLDivElement</span> | <span class="title class_">HTMLElement</span>&gt; =</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;div&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>BOM</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">local</span>: <span class="title class_">Storage</span> = <span class="variable language_">localStorage</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">lo</span>: <span class="title class_">Location</span> = location;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">prop</span>: <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// cookie æ˜¯å­—ç¬¦ä¸²å“‡</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">coo</span>: <span class="built_in">string</span> = <span class="variable language_">document</span>.<span class="property">cookie</span>;</span><br></pre></td></tr></table></figure><h2 id="å…ƒç»„ã€æšä¸¾"><a href="#å…ƒç»„ã€æšä¸¾" class="headerlink" title="å…ƒç»„ã€æšä¸¾"></a>å…ƒç»„ã€æšä¸¾</h2><h3 id="å…ƒç»„"><a href="#å…ƒç»„" class="headerlink" title="å…ƒç»„"></a>å…ƒç»„</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">arr</span>: [<span class="built_in">number</span>, <span class="built_in">boolean</span>] = [<span class="number">1</span>, <span class="literal">false</span>];</span><br><span class="line"></span><br><span class="line">arr.<span class="title function_">push</span>(<span class="literal">null</span>); <span class="comment">// âŒ è™½ç„¶é•¿åº¦è¿‡äº†ï¼Œä½†æ˜¯è¿™ä¸ªå…ƒç»„ä¼šè¢«æ¨æ–­ä¸ºè”åˆç±»å‹</span></span><br><span class="line">arr.<span class="title function_">push</span>(<span class="number">1</span>); <span class="comment">// âœ… æ‰€ä»¥åªèƒ½è£…ä¸Šé¢æŒ‡å®šçš„ç±»å‹</span></span><br></pre></td></tr></table></figure><p>å…¶ä»–é™åˆ¶ï¼šåªè¯»ã€æŒ‡å®šåç§°ã€å¯é€‰</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">arr</span>: <span class="keyword">readonly</span> [<span class="attr">x</span>: <span class="built_in">number</span>, <span class="attr">y</span>?: <span class="built_in">boolean</span>] = [<span class="number">1</span>];</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨åœºæ™¯ï¼šä¾‹å¦‚ä¸€ä¸ª<em>excel</em>è¡¨æ ¼</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">excel</span>: [<span class="built_in">string</span>, <span class="built_in">string</span>, <span class="built_in">number</span>][] = [</span><br><span class="line">  [<span class="string">&quot;å°æ»¡&quot;</span>, <span class="string">&quot;å¥³&quot;</span>, <span class="number">18</span>],</span><br><span class="line">  [<span class="string">&quot;å°æ»¡&quot;</span>, <span class="string">&quot;å¥³&quot;</span>, <span class="number">18</span>],</span><br><span class="line">  [<span class="string">&quot;å°æ»¡&quot;</span>, <span class="string">&quot;å¥³&quot;</span>, <span class="number">18</span>],</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>â” è¦è·å–å…ƒç»„ä¸­æŸä¸€ä¸ªçš„ç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> first = (<span class="keyword">typeof</span> arr)[<span class="number">0</span>];</span><br></pre></td></tr></table></figure><p>â” è¦è·å–å®ƒçš„é•¿åº¦</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> first = (<span class="keyword">typeof</span> arr)[<span class="string">&quot;length&quot;</span>];</span><br></pre></td></tr></table></figure><h3 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">  red,</span><br><span class="line">  green,</span><br><span class="line">  blue,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Color</span>.<span class="property">red</span>); <span class="comment">// 0 ,åé¢çš„æ˜¯ 1ã€2</span></span><br></pre></td></tr></table></figure><p>ç»™å®ƒæŒ‡å®šå€¼</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Color</span> &#123;</span><br><span class="line">  red = <span class="number">1</span>,</span><br><span class="line">  green,</span><br><span class="line">  blue,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Color</span>.<span class="property">red</span>); <span class="comment">// 1 ,åé¢çš„æ˜¯ 2ã€3</span></span><br></pre></td></tr></table></figure><p>æ™®é€šæšä¸¾å’Œä½¿ç”¨<code>const</code>å®šä¹‰çš„æšä¸¾</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">  red = <span class="number">1</span>,</span><br><span class="line">  green,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">enum</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">  red = <span class="number">1</span>,</span><br><span class="line">  green,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼šè¢«ç¼–è¯‘æˆä¸€ä¸ªå¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Test</span>;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">Test</span>) &#123;</span><br><span class="line">  <span class="title class_">Test</span>[(<span class="title class_">Test</span>[<span class="string">&quot;red&quot;</span>] = <span class="number">1</span>)] = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">  <span class="title class_">Test</span>[(<span class="title class_">Test</span>[<span class="string">&quot;green&quot;</span>] = <span class="number">2</span>)] = <span class="string">&quot;green&quot;</span>;</span><br><span class="line">&#125;)(<span class="title class_">Test</span> || (<span class="title class_">Test</span> = &#123;&#125;));</span><br></pre></td></tr></table></figure><p>åŠ äº†<code>const</code>çš„ï¼Œä¼šç›´æ¥ç¼–è¯‘ç§°ä¸€ä¸ªå¸¸é‡ ??</p><blockquote><p>ä½†æ˜¯æˆ‘çš„ç¼–è¯‘å‡ºä¸€ä¸ªç©ºç™½æ–‡æ¡£ã€‚typescript 5.1.6</p></blockquote><p>ğŸ‘‰ åå‘æ˜ å°„ é€šè¿‡ value è·å¾— keyï¼Œæ­£å‘åä¹‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Types</span> &#123;</span><br><span class="line">  success,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">success</span>: <span class="built_in">number</span> = <span class="title class_">Types</span>.<span class="property">success</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(success); <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> key = <span class="title class_">Types</span>[success]; <span class="comment">// success</span></span><br></pre></td></tr></table></figure><h2 id="neverã€symbol"><a href="#neverã€symbol" class="headerlink" title="neverã€symbol"></a>neverã€symbol</h2><h3 id="never"><a href="#never" class="headerlink" title="never"></a>never</h3><p>æ°¸è¿œæ— æ³•åˆ°è¾¾çš„ç±»å‹ ğŸ™ƒ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> A = <span class="built_in">string</span> &amp; <span class="built_in">number</span>;</span><br></pre></td></tr></table></figure><ul><li><code>type A</code>å°±æ˜¯ä¸€ä¸ª<code>never</code>ç±»å‹</li></ul><p>å¦‚æœåœ¨è”åˆç±»å‹ä¸­ä½¿ç”¨åˆ°<code>never</code>ï¼Œæ˜¯ä¼šç›´æ¥è¢«å¿½ç•¥æ‰çš„</p><p>å¸¸ç”¨çš„åœºæ™¯ï¼šå…œåº•é€»è¾‘ï¼Œç›´æ¥ä»£ç æŠ¥é”™ï¼Œæ‰¾åˆ°é—®é¢˜æ‰€åœ¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> A = <span class="string">&quot;å”±&quot;</span> | <span class="string">&quot;è·³&quot;</span> | <span class="string">&quot;rap&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">kun</span>(<span class="params"><span class="attr">value</span>: A</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (value) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;å”±&quot;</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;è·³&quot;</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;rap&quot;</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">const</span> <span class="attr">error</span>: <span class="built_in">never</span> = value;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é»˜è®¤å€¼å¾—æ—¶å€™ï¼Œ<code>value</code>ä¼šæ˜¯<code>never</code>ç±»å‹</li></ul><p>è¿™æ ·çš„è¯ä»£ç æ²¡æœ‰é—®é¢˜ã€‚ç„¶åä»¥åè¦æ”¹çš„æ—¶å€™ï¼Œçªç„¶æƒ³åœ¨<code>A</code>ä¸­å†åŠ ä¸Šç±»å‹<code>&#39;ç¯®çƒ&#39;</code>ï¼Œè¿™æ ·ä»£ç å°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿™æ—¶å€™<code>default</code>å°±ä¼šæ˜¯ä¸€ä¸ª<code>string</code>ç¯®çƒã€‚<code>string</code>æ— æ³•èµ‹å€¼ç»™<code>never</code></p><p>è¿™æ ·çš„è¯é˜²æ­¢ä»£ç å¤šäº†ï¼Œéƒ½ä¸çŸ¥é“é”™è¯¯åœ¨å“ª</p><h3 id="symbol"><a href="#symbol" class="headerlink" title="symbol"></a>symbol</h3><ul><li>å¯é¿å…å¯¹è±¡ä¸­é‡å¤å‡ºç°çš„<em>key</em></li></ul><blockquote><p>for inã€Object.keys ä¸èƒ½è¯»å–åˆ° symbol</p></blockquote><p>æ¯ä¸€ä¸ªéƒ½æ˜¯<strong>å”¯ä¸€çš„</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">a1</span>: <span class="built_in">symbol</span> = <span class="title class_">Symbol</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="attr">a2</span>: <span class="built_in">symbol</span> = <span class="title class_">Symbol</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a1 == a2); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>ğŸ˜… å°±æ˜¯æƒ³è¦å¾—åˆ°ä¸¤ä¸ªç›¸ç­‰çš„ï¼Ÿï¼Ÿï¼Ÿ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&quot;xiaoman&quot;</span>) == <span class="title class_">Symbol</span>.<span class="title function_">for</span>(<span class="string">&quot;xiaoman&quot;</span>));</span><br></pre></td></tr></table></figure><ul><li><p>ä½¿ç”¨<code>.for</code>ä¼šåœ¨å…¨å±€çš„<em>symbol</em>ä¸­æ‰¾æœ‰æ²¡æœ‰æ³¨å†Œè¿‡è¿™ä¸ª<em>key</em></p><ul><li>æœ‰çš„è¯<strong>ç›´æ¥</strong>æ‹¿æ¥ç”¨</li><li>æ²¡æœ‰çš„è¯ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª</li></ul></li></ul><p><code>Object.getOwnPropertyNames</code>ï¼šè·å–å¯¹è±¡ä¸­æ™®é€šçš„å±æ€§å</p><p><code>Object.getOwnPropertySymbols</code>ï¼šè·å–å¯¹è±¡ä¸­ symbol ç±»å‹çš„å±æ€§</p><p><code>Reflect.ownKeys</code>ï¼šä¸Šé¢ä¸¤ä¸ªéƒ½å¯åŒæ—¶è·å–</p><h1 id="é…ç½®ã€å£°æ˜"><a href="#é…ç½®ã€å£°æ˜" class="headerlink" title="é…ç½®ã€å£°æ˜"></a>é…ç½®ã€å£°æ˜</h1><h2 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h2><p><em>ts</em> å’Œ <em>es6</em> ä¸­ï¼ŒåŒ…å«é¡¶çº§<code>import</code>æˆ–è€…<code>export</code>çš„æ–‡ä»¶ä¼šè¢«å½“æˆä¸€ä¸ªæ¨¡å—ï¼Œåä¹‹æ–‡ä»¶é‡Œé¢çš„å†…å®¹è¢«è§†ä¸ºå…¨å±€å¯è§</p><p>è¿™æ ·çš„è¯ï¼Œåœ¨ä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶ä¸­å£°æ˜ç›¸åŒçš„å˜é‡ï¼Œ<strong>ä¼šæŠ¥é”™è¯´å˜é‡å·²ç»å­˜åœ¨</strong></p><p>ğŸ“„index.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>ğŸ“„index2.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†è¿™ä¸ªæ–‡ä»¶å˜æˆä¸€ä¸ªæ¨¡å—</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>é™¤äº†è¿™ä¸ªæ–¹æ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ ğŸ‘‰<strong>å‘½åç©ºé—´</strong></p><p>ğŸ“„index.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ“„index2.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title class_">B</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨çš„æ—¶å€™ï¼Œå’Œå¯¹è±¡ä¸€æ ·</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(A.<span class="property">a</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(B.<span class="property">a</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">B</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">namespace</span> <span class="title class_">C</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å‘½åç©ºé—´è¿˜å¯ä»¥åµŒå¥—ï¼Œåœ¨é‡Œé¢<code>export namespace</code></li><li>æœ€å¤–å±‚å¯¼å‡ºçš„å‘½åç©ºé—´ï¼Œé€šè¿‡<code>import</code>æ¥å¯¼å…¥ï¼Œ<code>import &#123;xx&#125; from &#39;./index.ts&#39;</code></li><li>è¿˜å¯ä»¥è¿™æ ·å¯¼å…¥<code>import x = B.C</code></li></ul><p>é‡åçš„å‘½åç©ºé—´ä¼šåˆæˆä¸€ä¸ª</p><h2 id="ä¸‰æ–œçº¿æŒ‡ä»¤"><a href="#ä¸‰æ–œçº¿æŒ‡ä»¤" class="headerlink" title="ä¸‰æ–œçº¿æŒ‡ä»¤"></a>ä¸‰æ–œçº¿æŒ‡ä»¤</h2><ul><li>å¸¸è§çš„æ˜¯ç”¨åˆ°å¼•å…¥ä¾èµ–</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;reference path=&quot;index2.ts&quot; /&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ç¼–è¯‘çš„æ—¶å€™å¼€å¯<code>removeCommoent</code>çš„é€‰é¡¹ï¼Œç¼–è¯‘åçš„æ–‡ä»¶å°±ä¼šç§»é™¤æ‰è¿™ä¸ªå¼•ç”¨å£°æ˜çš„æ³¨é‡Š</p><h2 id="å£°æ˜æ–‡ä»¶"><a href="#å£°æ˜æ–‡ä»¶" class="headerlink" title="å£°æ˜æ–‡ä»¶"></a>å£°æ˜æ–‡ä»¶</h2><p><code>xx.d.ts</code>æ–‡ä»¶</p><p>æœ‰äº›åº“å®‰è£…çš„æ—¶å€™æ²¡æœ‰å£°æ˜æ–‡ä»¶ï¼Œå¯ä»¥å°è¯•å®‰è£…ä¸€ä¸‹ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯çœŸçš„æ²¡æœ‰å£°æ˜æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev @types/xxx</span><br></pre></td></tr></table></figure><ul><li><code>@types</code>å¼€å¤´æ˜¯ä¸€ä¸ªè§„èŒƒæ¥çš„</li></ul><p>æ²¡æœ‰çš„è¯ï¼Œè‡ªå·±æ‰‹å†™ä¸€ä¸‹å’¯ã€‚è¦ä¸ºè°å†™å£°æ˜æ–‡ä»¶ï¼Œå°±ä»¥è¿™ä¸ªåŒ…çš„åå­—ä¸ºå£°æ˜æ–‡ä»¶çš„åå­—ï¼Œæ¯”å¦‚<em>express</em> æ²¡æœ‰å£°æ˜æ–‡ä»¶ï¼Œé‚£å°±åº”è¯¥æ˜¯<code>express.d.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&quot;express&quot;</span> &#123;</span><br><span class="line">  <span class="keyword">interface</span> <span class="title class_">Router</span> &#123;&#125;</span><br><span class="line">  <span class="keyword">interface</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="title function_">use</span>(): <span class="built_in">void</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> <span class="attr">a</span>: <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">function</span> <span class="title function_">qa</span>(<span class="params"><span class="attr">param</span>: <span class="built_in">any</span></span>);</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœæ–‡ä»¶é‡Œé¢æ²¡æœ‰<code>import</code>æˆ–è€…<code>export</code>çš„è¯ï¼Œä¹Ÿéœ€è¦æŒ‡å®šä¸€ä¸‹<code>export&#123;&#125;</code>æ¥ä½¿å¾— ts èƒ½æŠŠå½“å‰æ–‡ä»¶è¯†åˆ«ä¸ºæ¨¡å—</p></blockquote><h1 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h1><h2 id="åŸºç¡€-1"><a href="#åŸºç¡€-1" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><p><strong>åœ¨å‡½æ•°ä¸­ä½¿ç”¨</strong></p><p>ä»£ç é€»è¾‘ä¸€æ ·ï¼Œä½†æƒ³è¿”å›ä¸åŒçš„ç±»å‹ã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨æ³›å‹ï¼Œé‚£åªèƒ½èµ‹å€¼ä¸¤ä»½ä»£ç ï¼Œä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥è¦ä½¿ç”¨åŠ¨æ€ç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">func1</span>(<span class="params"><span class="attr">a</span>:<span class="built_in">number</span>, <span class="attr">b</span>:<span class="built_in">number</span></span>)<span class="title class_">Array</span>&lt;<span class="built_in">number</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> [a, b]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">func1</span>(<span class="params"><span class="attr">a</span>:<span class="built_in">string</span>, <span class="attr">b</span>:<span class="built_in">string</span></span>)<span class="title class_">Array</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> [a, b]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ³›å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> func&lt;T&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: T): <span class="title class_">Array</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> [a, b];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// number</span></span><br><span class="line"><span class="title function_">func</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">func&lt;<span class="built_in">number</span>&gt;(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// ğŸ‡ å®Œæ•´çš„è°ƒç”¨å½¢æ€åº”</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// éƒ½è¡Œ</span></span><br><span class="line"><span class="title function_">func</span>(<span class="literal">false</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><ul><li>ä¸ç”¨å®Œæ•´çš„è°ƒç”¨å½¢æ€ï¼Œå› ä¸ºå¯ä»¥ç±»å‹æ¨æ–­</li></ul><p>åœ¨<code>type</code>ä¸­ä½¿ç”¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> A&lt;T&gt; = <span class="built_in">string</span> | <span class="built_in">number</span> | T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: A&lt;<span class="built_in">boolean</span>&gt; = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p>åœ¨<code>interface</code>ä¸­ä½¿ç”¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Obj</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">name</span>: T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">obj</span>: <span class="title class_">Obj</span>&lt;<span class="built_in">string</span>&gt; = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;zs&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¤šä¸ªæ³›å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> func&lt;T, K&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: K): <span class="title class_">Array</span>&lt;T | K&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> [a, b];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">func</span>(<span class="number">1</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><p>æ³›å‹ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ï¼šå‡½æ•°ä¸ä¼ å€¼ï¼Œæ³›å‹ä½¿ç”¨é»˜è®¤æ³›å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> func&lt;T = <span class="built_in">number</span>, K = <span class="built_in">string</span>&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: K): <span class="title class_">Array</span>&lt;T | K&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> [a, b];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">func</span>();</span><br></pre></td></tr></table></figure><h2 id="å®é™…åº”ç”¨"><a href="#å®é™…åº”ç”¨" class="headerlink" title="å®é™…åº”ç”¨"></a>å®é™…åº”ç”¨</h2><p>å¯¹æ¥ä¸€ä¸‹è¯·æ±‚æ¥å£çš„æ•°æ®</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = &#123;</span><br><span class="line">  get&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">xhr</span>: <span class="title class_">XMLHttpRequest</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">      xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, url);</span><br><span class="line">      xhr.<span class="property">onreadystatechange</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 0~4, 4 ä»£è¡¨ complete</span></span><br><span class="line">        <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">          <span class="title function_">resolve</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// å¿…é¡»æ»´</span></span><br><span class="line">      xhr.<span class="title function_">send</span>(<span class="literal">null</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Data</span> &#123;</span><br><span class="line">  <span class="attr">message</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">axios.<span class="property">get</span>&lt;<span class="title class_">Data</span>&gt;(<span class="string">&quot;./data.json&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>ä¼ å…¥<code>Data</code>ï¼Œè¿”å›<code>Promise&lt;Data&gt;</code>ï¼Œè¿™æ ·çš„è¯æœ‰çº¦æŸï¼Œè€Œä¸”<code>.then()</code>ä¹Ÿæœ‰æç¤º</li></ul><h2 id="æ³›å‹çº¦æŸ"><a href="#æ³›å‹çº¦æŸ" class="headerlink" title="æ³›å‹çº¦æŸ"></a>æ³›å‹çº¦æŸ</h2><p>æ³›å‹æœ‰æ—¶å€™å¤ªè¿‡çµæ´»</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> add&lt;T&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: T) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b; <span class="comment">// âŒ æŠ¥é”™ï¼Œä½†æ˜¯è¿™ç¡®å®æ­£ç¡®çš„è¡Œä¸º</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">add</span>(<span class="literal">undefined</span>, <span class="literal">undefined</span>); <span class="comment">// è¿™ä¸¤ä¸ªè‚¯å®šæ˜¯ä¸èƒ½ç›¸åŠ çš„</span></span><br></pre></td></tr></table></figure><p>åŠ ä¸Šçº¦æŸ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> add&lt;T <span class="keyword">extends</span> <span class="built_in">number</span>&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: T) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Len</span> &#123;</span><br><span class="line">  <span class="attr">length</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> fn&lt;T <span class="keyword">extends</span> <span class="title class_">Len</span>&gt;(<span class="attr">a</span>: T) &#123;</span><br><span class="line">  a.<span class="property">length</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(<span class="string">&quot;111&quot;</span>); <span class="comment">// âœ…</span></span><br><span class="line"><span class="title function_">fn</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]); <span class="comment">// âœ…</span></span><br><span class="line"><span class="title function_">fn</span>(<span class="number">123</span>); <span class="comment">// âŒ</span></span><br><span class="line"><span class="title function_">fn</span>(<span class="literal">false</span>); <span class="comment">// âŒ</span></span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;xm&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// obj çº¦æŸä¸º object ç±»å‹ï¼Œkey çº¦æŸä¸º obj ä¸­çš„æŸä¸€ä¸ª key å€¼</span></span><br><span class="line"><span class="keyword">function</span> ob&lt;T <span class="keyword">extends</span> <span class="built_in">object</span>, K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">obj</span>: T, <span class="attr">key</span>: K) &#123;</span><br><span class="line">  <span class="keyword">return</span> obj[key];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">ob</span>(obj, <span class="string">&quot;name&quot;</span>);</span><br></pre></td></tr></table></figure><p><code>keyof</code>æ˜¯å°†å¯¹è±¡çš„ç±»å‹çš„<em>key</em> ä½œä¸ºä¸€ä¸ªè”åˆç±»å‹</p><ul><li>æ³¨æ„ä¸æ˜¯ç›´æ¥ä½œç”¨åœ¨å¯¹è±¡èº«ä¸Šï¼Œå› ä¸ºå¯¹è±¡æ˜¯å¯¹<em>å€¼</em> çš„å¼•ç”¨ï¼Œè€Œ<code>keyof</code>çš„ä½œç”¨å¯¹è±¡æ˜¯<em>ç±»å‹</em></li></ul><p>å¯ä»¥è¿™æ ·ä½¿ç”¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Key</span> = keyof <span class="keyword">typeof</span> obj;</span><br></pre></td></tr></table></figure><p>ğŸ™ƒ<code>keyof</code>çš„é«˜çº§ç”¨æ³•</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Data</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">gender</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¦ä½¿ Data ä¸­çš„æ¯ä¸€ä¸ªéƒ½å˜æˆå¯é€‰ï¼Œé™¤äº†ç»™æ¯ä¸ªåŠ ä¸Š ? ï¼Œè¿˜å¯ä»¥è¿™æ ·</span></span><br><span class="line"><span class="comment">// ç±»ä¼¼äº for(let key in obj)</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Options</span>&lt;T <span class="keyword">extends</span> <span class="built_in">object</span>&gt; = &#123;</span><br><span class="line">  [<span class="title class_">Key</span> <span class="keyword">in</span> keyof T]?: T[<span class="title class_">Key</span>];</span><br><span class="line">  <span class="comment">// readonly [Key in keyof T]: T[Key]</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B = <span class="title class_">Options</span>&lt;<span class="title class_">Data</span>&gt;;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™<code>type B</code>ä¼šæ˜¯</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> B = &#123;</span><br><span class="line">  <span class="attr">message</span>?: <span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">  <span class="attr">code</span>?: <span class="built_in">number</span> | <span class="literal">undefined</span>;</span><br><span class="line">  <span class="attr">name</span>?: <span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">  <span class="attr">age</span>?: <span class="built_in">number</span> | <span class="literal">undefined</span>;</span><br><span class="line">  <span class="attr">gender</span>?: <span class="built_in">string</span> | <span class="literal">undefined</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å…¶å®ä½¿ç”¨<code>Partial</code>ä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> C = <span class="title class_">Partial</span>&lt;<span class="title class_">Data</span>&gt;;</span><br></pre></td></tr></table></figure><p><code>readonly</code>çš„è¯ï¼Œå°±ä½¿ç”¨<code>Readonly</code></p><h1 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h1><blockquote><p>éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰“å¼€ <code>experimentalDecorators</code>å’Œ<code>emitDecoratorMetadata</code></p></blockquote><p>è£…é¥°å™¨æœ‰ï¼š</p><ol><li>ç±»è£…é¥°å™¨</li><li>å±æ€§è£…é¥°å™¨</li><li>å‚æ•°è£…é¥°å™¨</li><li>æ–¹æ³•è£…é¥°å™¨</li><li>è£…é¥°å™¨å·¥å‚</li></ol><p>ç±»è£…é¥°å™¨ï¼Œåœ¨ä¸ç ´ååŸæœ‰å†…å®¹çš„æƒ…å†µä¸‹ï¼ˆæˆ–è€…è¯´ä¸çŸ¥é“åŸæ¥æœ‰ä»€ä¹ˆçš„æƒ…å†µä¸‹ï¼‰å¢åŠ å†…å®¹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Base</span>: <span class="title class_">ClassDecorator</span> = <span class="function">(<span class="params">target</span>) =&gt;</span> &#123;</span><br><span class="line">  target.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">xiaoman</span> = <span class="string">&quot;å°æ»¡&quot;</span>;</span><br><span class="line">  target.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">fn</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æˆ‘æ˜¯æ†¨æ†¨&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Base</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Http</span> &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> http = <span class="keyword">new</span> <span class="title class_">Http</span>() <span class="keyword">as</span> <span class="built_in">any</span>;</span><br><span class="line">http.<span class="title function_">fn</span>();</span><br></pre></td></tr></table></figure><ul><li><code>target</code>æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°</li></ul><p>è¿˜æœ‰å¦ä¸€ç§å†™æ³•æ˜¯ä¸ç”¨<code>@Base</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Http</span> &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> http = <span class="keyword">new</span> <span class="title class_">Http</span>() <span class="keyword">as</span> <span class="built_in">any</span>;</span><br><span class="line"><span class="title class_">Base</span>(<span class="title class_">Http</span>);</span><br></pre></td></tr></table></figure><p>â”â” å¦‚æœè¦å‘<code>@Base</code>ä¼ é€’å‚æ•°å‘¢</p><ul><li><code>target</code>æ˜¯é»˜è®¤å­˜åœ¨çš„ï¼Œå¥½åƒäº‹ä»¶ç›‘å¬çš„äº‹ä»¶å¯¹è±¡ä¸€æ ·</li><li>å¯ä»¥ä½¿ç”¨<em>å‡½æ•°æŸ¯é‡ŒåŒ–</em> äº‹å…ˆå‚æ•°ä¼ é€’</li></ul><p>å°±æ˜¯å†å¥—ä¸€å±‚å‡½æ•°</p><ul><li>å¤–é¢ä¸€å±‚å‡½æ•°æ¥æ”¶<code>@Base</code>ä¼ è¿‡æ¥çš„å‚æ•°</li><li>é‡Œä¸€å±‚å‡½æ•°æ¥æ”¶é»˜è®¤å­˜åœ¨çš„å‚æ•°</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Base</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">fn</span>: <span class="title class_">ClassDecorator</span> = <span class="function">(<span class="params">target</span>) =&gt;</span> &#123;</span><br><span class="line">    target.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">xiaoman</span> = <span class="string">&quot;å°æ»¡&quot;</span>;</span><br><span class="line">    target.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">fn</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æˆ‘æ˜¯æ†¨æ†¨&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> fn;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Base</span>(<span class="string">&quot;xb&quot;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Http</span> &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿™ä¸€æ‹›å«åšï¼šè£…é¥°å™¨å·¥å‚ã€å‡½æ•°æŸ¯é‡ŒåŒ–ã€é—­åŒ…</li></ul><p>å‡½æ•°è£…é¥°å™¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Get</span> = (<span class="params"><span class="attr">url</span>: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">fn</span>: <span class="title class_">MethodDecorator</span> = <span class="function">(<span class="params">target, key, <span class="attr">descriptor</span>: <span class="title class_">PropertyDescriptor</span></span>) =&gt;</span> &#123;</span><br><span class="line">    axios.<span class="title function_">get</span>(url).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      descriptor.<span class="title function_">value</span>(res.<span class="property">data</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> fn;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Base</span>(<span class="string">&quot;xb&quot;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Http</span> &#123;</span><br><span class="line">  <span class="meta">@Get</span>(<span class="string">&quot;https://xxxx.com/&quot;</span>)</span><br><span class="line">  <span class="title function_">getList</span>(<span class="params"><span class="attr">data</span>: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œè£…é¥°å™¨è‡ªå·±çš„</li></ul><p>å•¥ä¹Ÿä¸ç”¨åšï¼Œç›´æ¥è°ƒç”¨<code>@Get()</code>ä¼ é€’ä¸ªåœ°å€è¿‡å»å°±è¡Œäº†</p><h1 id="ç±»å‹å…¼å®¹"><a href="#ç±»å‹å…¼å®¹" class="headerlink" title="ç±»å‹å…¼å®¹"></a>ç±»å‹å…¼å®¹</h1><p>é¸­å­ç±»å‹ï¼šä¸¤ä¸ªç±»å‹æœ‰å…±é€šçš„åœ°æ–¹</p><p>åå˜ï¼šå­ç±»å‹å¯ä»¥å®Œå…¨è¦†ç›–æ‰ä¸»ç±»å‹ï¼ˆå­ç±»å‹å¯ä»¥å¤šå†…å®¹ï¼Œä½†æ˜¯ä¸èƒ½å°‘å†…å®¹ï¼‰</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸»ç±»å‹</span></span><br><span class="line"><span class="keyword">interface</span> A &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­ç±»å‹</span></span><br><span class="line"><span class="keyword">interface</span> B &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">sex</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: A = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;xb&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">b</span>: B = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;xh&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">19</span>,</span><br><span class="line">  <span class="attr">sex</span>: <span class="string">&quot;man&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åå˜ ï¼ˆå¯ä»¥èµ‹å€¼ï¼‰</span></span><br><span class="line">a = b;</span><br></pre></td></tr></table></figure><p>é€†å˜ï¼šä¸€èˆ¬åœ¨å‡½æ•°ä¸Šå‡ºç°ï¼ˆå’Œåå˜æ˜¯åè¿‡æ¥çš„ï¼‰ï¼Œç±»ä¼¼äº<code>b = a</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">fna</span> = (<span class="params"><span class="attr">params</span>: A</span>) =&gt; &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> <span class="title function_">fnb</span> = (<span class="params"><span class="attr">params</span>: B</span>) =&gt; &#123;&#125;;</span><br><span class="line"></span><br><span class="line">fna = fnb; <span class="comment">// âŒ</span></span><br><span class="line">fnb = fna; <span class="comment">// âœ…</span></span><br></pre></td></tr></table></figure><ul><li>ï¼ˆåŒå‘åå˜ï¼‰é…ç½®æ–‡ä»¶å¼€å¯<code>strictFunctionTypes</code>è®¾ä¸º<code>false</code>ï¼Œç¬¬ä¸€ä¸ªèµ‹å€¼å¯ä»¥æˆç«‹</li><li>ç¬¬äºŒä¸ªä¹‹æ‰€ä»¥æˆç«‹ï¼Œå› ä¸ºèµ‹å€¼å®Œäº†å<code>fnb</code>å°±æ˜¯<code>fna</code></li></ul><h1 id="utility"><a href="#utility" class="headerlink" title="utility"></a>utility</h1><p><code>Record&lt;Keys, Type&gt;</code></p><p>ç»„å»ºä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œè¿™ä¸ªå¯¹è±¡ç±»å‹çš„ key æ˜¯ ä¼ å…¥çš„ <em>Keys</em> ï¼Œå¯¹è±¡çš„å€¼æ˜¯ä¼ å…¥çš„ <em>Type</em></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">CatInfo</span> &#123;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">breed</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">CatName</span> = <span class="string">&quot;miffy&quot;</span> | <span class="string">&quot;boris&quot;</span> | <span class="string">&quot;mordred&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">cats</span>: <span class="title class_">Record</span>&lt;<span class="title class_">CatName</span>, <span class="title class_">CatInfo</span>&gt; = &#123;</span><br><span class="line">  <span class="attr">miffy</span>: &#123; <span class="attr">age</span>: <span class="number">10</span>, <span class="attr">breed</span>: <span class="string">&quot;Persian&quot;</span> &#125;,</span><br><span class="line">  <span class="attr">boris</span>: &#123; <span class="attr">age</span>: <span class="number">5</span>, <span class="attr">breed</span>: <span class="string">&quot;Maine Coon&quot;</span> &#125;,</span><br><span class="line">  <span class="attr">mordred</span>: &#123; <span class="attr">age</span>: <span class="number">16</span>, <span class="attr">breed</span>: <span class="string">&quot;British Shorthair&quot;</span> &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">cats.<span class="property">boris</span>;</span><br></pre></td></tr></table></figure><hr><p>æ•´ç†æ¥æºï¼šğŸ“„ æˆ‘çš„ç¬”è®°ã€ğŸ“º bilibili<code>å°æ»¡zs</code></p><!--<div style="display: flex;"><span style="margin:auto; font-size: 70px; color: white; background-color: #3178c6;padding: 20px">Typescript <span style="font-size: 0.7em;color: #282c34">å¿«é€Ÿæ‰‹å†Œ 2.0</span></span></div> -->]]></content>
    
    
    <summary type="html">&lt;p&gt;åŠªåŠ›å­¦ä¹  ğŸï¸ğŸï¸&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ts" scheme="https://smalljerry.cn/tags/ts/"/>
    
  </entry>
  
  <entry>
    <title>TypeScriptå¿«é€Ÿæ‰‹å†Œ</title>
    <link href="https://smalljerry.cn/2021/10/07/TypeScript%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C/"/>
    <id>https://smalljerry.cn/2021/10/07/TypeScript%E5%BF%AB%E9%80%9F%E6%89%8B%E5%86%8C/</id>
    <published>2021-10-07T03:07:15.000Z</published>
    <updated>2025-02-22T02:14:47.344Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€äº›åŸºæœ¬ä½¿ç”¨ç¬”è®°<br>ä¸€äº›æ³¨æ„ç‚¹ï¼Œä¸å…¨</p><span id="more"></span><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><ol><li>åœ¨<em>ts</em>æ–‡ä»¶ä¸­å¦‚æœæ²¡æœ‰<code>typescript</code>è¯­æ³•ä»£ç ï¼Œæ˜¯å¯ä»¥ç›´æ¥åœ¨<em>html</em>æ–‡ä»¶ä¸­å¼•ç”¨å¹¶ä¸”è¿è¡Œçš„</li><li>ts ä¸­ä½¿ç”¨çš„å…³é”®å­—<code>let</code>åœ¨ç¼–è¯‘æˆ js çš„æ—¶å€™ä¼šå˜æˆ<code>var</code></li></ol><h1 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h1><p>å¦‚æœå£°æ˜å˜é‡çš„æ—¶å€™ç›´æ¥èµ‹å€¼ï¼ŒTS å¯ä»¥è‡ªåŠ¨æ£€æµ‹å˜é‡çš„ç±»å‹ï¼ˆå³ä½¿ä¸æŒ‡å®šï¼‰</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xm = <span class="string">&#x27;å°æ˜&#x27;</span>;</span><br><span class="line"><span class="comment">// æ­¤æ—¶ xm çš„ç±»å‹æ˜¯ stringï¼Œèµ‹äºˆå…¶ä»–ç±»å‹çš„å€¼ä¼šæŠ¥é”™</span></span><br><span class="line">xm = <span class="number">18</span>;  âŒ</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨å£°æ˜çš„æ—¶å€™ä½¿ç”¨å­—é¢é‡æŒ‡å®šç±»å‹ï¼Œåé¢å°±ä¸èƒ½æ”¹äº†ï¼ˆç±»ä¼¼äºå¸¸é‡ï¼‰</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">xm</span>: <span class="string">&#x27;xm&#x27;</span>;</span><br><span class="line">xm = <span class="string">&#x27;zs&#x27;</span>;  âŒ</span><br><span class="line">xm = <span class="string">&#x27;xm&#x27;</span>;  âœ”ï¸</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ <code>|</code>æ¥å£°æ˜å¤šä¸ªç±»å‹ï¼ˆè”åˆç±»å‹ï¼‰</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">xm</span>: <span class="string">&#x27;male&#x27;</span> | <span class="string">&#x27;female&#x27;</span></span><br><span class="line">xm = <span class="string">&#x27;male&#x27;</span></span><br><span class="line">xm = <span class="string">&#x27;female&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">zs</span>: <span class="built_in">boolean</span> | <span class="built_in">string</span></span><br><span class="line">zs = <span class="literal">true</span></span><br><span class="line">zs = <span class="string">&#x27;zs&#x27;</span></span><br></pre></td></tr></table></figure><p>åœ¨å£°æ˜å˜é‡æ—¶ä¸æŒ‡å®šç±»å‹ï¼Œåˆ™é»˜è®¤æ˜¯<code>any</code>ç±»å‹ï¼Œä¹Ÿå¯ä»¥æŒ‡å®š<code>any</code>ç±»å‹ï¼Œä½†æ˜¯ä¸å¥½ã€‚å¿…è¦æ—¶ï¼Œä½¿ç”¨<code>unknown</code>ç±»å‹æ¥ä»£æ›¿<code>any</code>ç±»å‹</p><p><code>unknown</code>åœ¨å®šä¹‰çš„æ—¶å€™å’Œ<code>any</code>ä¸€æ ·ï¼Œå¯ä»¥éšä¾¿å€¼ï¼Œ<strong>ä½†æ˜¯ä¸èƒ½å°†è‡ªå·±çš„å€¼ç›´æ¥èµ‹ç»™åˆ«çš„å˜é‡</strong>ï¼ˆé™¤éå¯¹æ–¹æ˜¯ anyï¼‰ã€‚</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">xm</span>: <span class="built_in">unknown</span>;</span><br><span class="line">xm = <span class="number">18</span>;  xm = <span class="literal">true</span>;  xm = <span class="string">&#x27;xm&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">zs</span>: <span class="built_in">string</span>;</span><br><span class="line">zs = xm;  âŒ</span><br><span class="line"><span class="comment">// å¯¹äºunknownç±»å‹ï¼Œè¦æƒ³èµ‹å€¼ï¼Œå…ˆè¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> xm === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    zs = xm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç±»å‹æ–­è¨€</strong>ï¼Œç”¨æ¥å‘Šè¯‰è§£æå™¨å˜é‡çš„å®é™…ç±»å‹ã€‚æœ‰ä¸¤ç§å†™æ³•ï¼š</p><ol><li>å˜é‡ as ç±»å‹</li><li>&lt;ç±»å‹&gt;å˜é‡</li></ol><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zs = xm <span class="keyword">as</span> <span class="built_in">string</span></span><br><span class="line">zs = &lt;<span class="built_in">string</span>&gt;xm</span><br><span class="line"><span class="comment">// å¦‚æœä¸¤ä¸ªå˜é‡çš„ç±»å‹ä¸ä¸€æ ·ï¼Œåˆ™æŠ¥é”™</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨<code>jsx</code>ä¸­åªèƒ½ä½¿ç”¨<code>as</code>å…³é”®å­—</li></ul><p><code>never</code>ç±»å‹ï¼Œè¡¨ç¤ºæ°¸è¿œä¸ä¼šæœ‰è¿”å›å€¼ï¼ˆå¦‚æŠ›å‡ºå¼‚å¸¸ï¼‰</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">err</span>(<span class="params"></span>): <span class="built_in">never</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;é”™é”™é”™...&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å˜é‡ä¹Ÿå¯ä»¥æ˜¯<code>never</code>ï¼Œå³ä½¿æ˜¯<code>any</code>ä¹Ÿä¸èƒ½èµ‹å€¼ç»™<code>never</code></li><li>å’Œ<code>void</code>çš„åŒºåˆ«æ˜¯ï¼Œ<code>void</code>æ˜¯æ²¡æœ‰è¿”å›å€¼ï¼Œä¸è¿‡å¯ä»¥åšå…¶ä»–äº‹æƒ…ï¼Œ<code>never</code>é‡Œé¢æ˜¯æ— æ³•åˆ°è¾¾çš„äº‹æƒ…ï¼Œå¦‚æ­»å¾ªç¯</li></ul><p>åœ¨å£°æ˜å¯¹è±¡çš„æ—¶å€™å¯ä»¥æŒ‡å®šé‡Œé¢çš„å±æ€§ï¼Œå±æ€§åé¢åŠ <code>?</code>è¡¨ç¤ºå½“å‰å±æ€§å¯é€‰</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">xm</span>: &#123;<span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>?: <span class="built_in">number</span>&#125;;</span><br><span class="line">xm = &#123;<span class="attr">name</span>: <span class="string">&#x27;xm&#x27;</span>&#125;;  âœ”ï¸</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æŒ‡å®šä»»æ„ç±»å‹çš„å±æ€§</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">xm</span>: &#123; <span class="attr">name</span>: <span class="built_in">string</span>; [<span class="attr">prop</span>: <span class="built_in">string</span>]: <span class="built_in">any</span> &#125;</span><br><span class="line">xm = &#123; <span class="attr">name</span>: <span class="string">&#x27;xm&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>, <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span> &#125;</span><br></pre></td></tr></table></figure><p><strong>æ•°ç»„ç±»å‹</strong>ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>å˜é‡: ç±»å‹[]</li><li>å˜é‡: Array&lt;ç±»å‹&gt;</li></ol><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">array_1</span>: <span class="built_in">string</span>[]</span><br><span class="line">array = [<span class="string">&#x27;zs&#x27;</span>, <span class="string">&#x27;ls&#x27;</span>, <span class="string">&#x27;xm&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> <span class="attr">array_2</span>: <span class="title class_">Array</span>&lt;<span class="built_in">number</span>&gt;</span><br><span class="line">array_2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure><p><strong>å…ƒç»„</strong>(tuple)ï¼Œå›ºå®šé•¿åº¦çš„æ•°ç»„ï¼š</p><ol><li>å˜é‡: [ç±»å‹, ç±»å‹, ç±»å‹]</li></ol><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">array</span>: [<span class="built_in">string</span>, <span class="built_in">number</span>, <span class="built_in">boolean</span>]</span><br><span class="line">array = [<span class="string">&#x27;xm&#x27;</span>, <span class="number">18</span>, <span class="literal">true</span>]</span><br></pre></td></tr></table></figure><p><strong>æšä¸¾</strong>(enum)ï¼š</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Gender</span> &#123;</span><br><span class="line">  <span class="title class_">Male</span> = <span class="number">0</span>,</span><br><span class="line">  <span class="title class_">Female</span> = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">xm</span>: &#123; <span class="attr">name</span>: <span class="built_in">string</span>; <span class="title class_">Gender</span>: <span class="title class_">Gender</span> &#125;</span><br><span class="line">xm = &#123; <span class="attr">name</span>: <span class="string">&#x27;xm&#x27;</span>, <span class="attr">grnder</span>: <span class="title class_">Gender</span>.<span class="property">Male</span> &#125;</span><br></pre></td></tr></table></figure><p>åˆå¹¶</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">xm</span>: &#123; <span class="attr">name</span>: <span class="built_in">string</span> &#125; &amp; &#123; <span class="attr">age</span>: <span class="built_in">number</span> &#125;</span><br><span class="line">xm = &#123; <span class="attr">name</span>: <span class="string">&#x27;xm&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;</span><br></pre></td></tr></table></figure><p>ç±»å‹åˆ«åï¼Œç”¨æˆ·å¯ä»¥åˆ›å»ºè‡ªå·±æƒ³è¦çš„ç±»å‹ï¼Œç„¶åç»™å®ƒå–ä¸ªåå­—ä¾¿äºè°ƒç”¨</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> myType = <span class="number">1</span> | <span class="number">2</span> | <span class="number">3</span> | <span class="number">4</span> | <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">age</span>: myType;</span><br><span class="line">age = <span class="number">1</span>;  âœ”ï¸</span><br><span class="line">age = <span class="number">6</span>;  âŒ</span><br></pre></td></tr></table></figure><h1 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h1><p>å…¶ä¸­ä¸»è¦æœ‰ï¼š<em>å±æ€§</em> å’Œ<em>æ–¹æ³•</em></p><h2 id="åŸºæœ¬"><a href="#åŸºæœ¬" class="headerlink" title="åŸºæœ¬"></a>åŸºæœ¬</h2><p>ç›´æ¥å®šä¹‰çš„å±æ€§æ˜¯å®ä¾‹å±æ€§ï¼Œéœ€è¦å®ä¾‹åŒ–åè®¿é—®ã€‚<code>static</code>ä¸ºé™æ€å±æ€§ï¼Œé€šè¿‡ç±»ç›´æ¥è®¿é—®ã€‚<code>readonly</code>è¡¨ç¤ºåªè¯»å±æ€§ï¼Œå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯åœ¨<code>static</code>åé¢ä½¿ç”¨</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span> = <span class="string">&#x27;xm&#x27;</span></span><br><span class="line">  <span class="keyword">static</span> <span class="attr">age</span>: <span class="built_in">number</span> = <span class="number">18</span></span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">gender</span>: <span class="built_in">string</span> = <span class="string">&#x27;male&#x27;</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="attr">status</span>: <span class="built_in">string</span> = <span class="string">&#x27;good&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> xm = <span class="keyword">new</span> <span class="title class_">Person</span>()</span><br><span class="line">xm.<span class="property">name</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property">age</span></span><br></pre></td></tr></table></figure><h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><p>ä¹‹æ‰€ä»¥ç§°ä¸ºæ„é€ å‡½æ•°ï¼Œæ˜¯å› ä¸ºå®åœ¨å¯¹è±¡åˆ›å»ºæ—¶ï¼ˆå®ä¾‹åŒ–ï¼‰è°ƒç”¨çš„</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">age</span>: bumber</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="comment">// å…¶ä¸­thisæŒ‡å‘å½“å‰å®ä¾‹</span></span><br><span class="line">    ;(<span class="variable language_">this</span>.<span class="property">name</span> = name), (<span class="variable language_">this</span>.<span class="property">age</span> = age)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">bark</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;wang~wang~~&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> dog_1 = <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&#x27;tom&#x27;</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure><h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LittleDog</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Dog</span> &#123;</span><br><span class="line">  <span class="comment">// é‡å†™</span></span><br><span class="line">  <span class="title function_">bark</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hahaha&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»§æ‰¿ä¼šè·å¾—çˆ¶ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•</li><li>åœ¨å­ç±»ä¸­æœ‰å’Œçˆ¶ç±»ç›¸åŒåå­—çš„æ–¹æ³•ï¼Œå°±å«åš<strong>é‡å†™</strong></li></ul><h3 id="super"><a href="#super" class="headerlink" title="super"></a>super</h3><p>åœ¨ç»§æ‰¿çš„æ—¶å€™ï¼Œå­ç±»æƒ³ç»§æ‰¿çˆ¶ç±»çš„å±æ€§ï¼Œåˆæƒ³æ·»åŠ å¦å¤–çš„å±æ€§ï¼Œå°±å¾—ç”¨<code>super()</code>æ¥<strong>è°ƒç”¨</strong>çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”ä¼ å…¥æƒ³è¦ç»§æ‰¿çš„å±æ€§</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LittleDog</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Dog</span> &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">kind</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">kind</span> = kind</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h2><p><code>abstract</code>å¼€å¤´ï¼ŒæŠ½è±¡ç±»<strong>ä¸èƒ½</strong>ç”¨äºåˆ›å»ºå¯¹è±¡ï¼Œä¸“é—¨ç”¨æ¥è¢«ç»§æ‰¿çš„</p><p>æŠ½è±¡ç±»ä¸­æœ‰æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡æ–¹æ³•å¿…é¡»åœ¨æŠ½è±¡ç±»ä¸­</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="title function_">hello</span>():<span class="built_in">void</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span> &#123;</span><br><span class="line">    <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;wangwang&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span> &#123;</span><br><span class="line">    <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;miaomiao&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fish = <span class="keyword">new</span> <span class="title class_">Animal</span>();  âŒ</span><br><span class="line"><span class="keyword">const</span> dog = <span class="keyword">new</span> <span class="title class_">Dog</span>();  âœ”ï¸</span><br><span class="line">dog.<span class="title function_">hello</span>();</span><br></pre></td></tr></table></figure><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p>æ¥å£ç”¨æ¥å®šä¹‰ä¸€ä¸ªç±»çš„ç»“æ„ï¼Œè§„å®šé‡Œé¢è¦åŒ…å«çš„å†…å®¹ã€‚æ¥å£å¯ä»¥é‡å¤å£°æ˜ï¼Œä¸èƒ½æœ‰å®é™…çš„å€¼</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> theInter &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> theInter &#123;</span><br><span class="line">  <span class="attr">gender</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="title function_">hello</span>(): <span class="built_in">void</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">obj</span>: theInter = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;xm&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">  <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Male</span> <span class="keyword">implements</span> theInter &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">gender</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span>, <span class="attr">gender</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    ;(<span class="variable language_">this</span>.<span class="property">name</span> = name), (<span class="variable language_">this</span>.<span class="property">age</span> = age)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gender</span> = gender</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨å¯¹è±¡ä¸­ç”¨æ¥å£æ—¶ï¼Œæ¥å£å¯ä»¥å½“æˆä¸€ä¸ªç±»å‹ï¼Œè¿™æ˜¯<code>interface</code>å…³é”®å­—å¯ä»¥å’Œ<code>type</code>å…³é”®å­—äº’æ¢</li></ul><h2 id="å±æ€§å°è£…"><a href="#å±æ€§å°è£…" class="headerlink" title="å±æ€§å°è£…"></a>å±æ€§å°è£…</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="attr">_name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="keyword">private</span> <span class="attr">_age</span>: <span class="built_in">number</span> <span class="comment">// åªèƒ½åœ¨ç±»å†…éƒ¨è®¿é—®</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="attr">_gender</span>: <span class="built_in">string</span> <span class="comment">// åœ¨ç±»å†…éƒ¨å’Œå…¶å­ç±»å†…éƒ¨è®¿é—®</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_name</span> = name</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_age</span> = age</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// getterã€setterå­˜å–å™¨</span></span><br><span class="line">  <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_name</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">setName</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_name</span> = value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ TS ä¸­ï¼Œå­˜å–å™¨æœ‰å¦å¤–çš„å†™æ³•</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> <span class="title function_">name</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">set</span> <span class="title function_">name</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_name</span> = value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å†™ï¼Œåœ¨å®ä¾‹åŒ–ä¹‹åï¼Œå’Œè°ƒç”¨å±æ€§æ—¶ä¸€æ ·çš„å†™æ³•</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xm = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;xm&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;male&#x27;</span>)</span><br><span class="line">xm.<span class="property">_name</span> <span class="comment">// å¯ä»¥è·å¾—nameå±æ€§ï¼Œé€šè¿‡å®ä¾‹å±æ€§</span></span><br><span class="line">xm.<span class="property">name</span> <span class="comment">// å¯ä»¥åçš„nameå±æ€§ï¼Œé€šè¿‡å­˜å–å™¨</span></span><br><span class="line">xm.<span class="property">name</span> = <span class="string">&#x27;zs&#x27;</span> <span class="comment">// è®¾ç½®å±æ€§å€¼ï¼Œé€šè¿‡å­˜å–å™¨</span></span><br></pre></td></tr></table></figure><h2 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h2><p>åœ¨å£°æ˜å‡½æ•°æˆ–è€…æ—¶ç±»çš„æ—¶å€™ï¼Œå¦‚æœ<em>ä¸çŸ¥é“ç”¨ä»€ä¹ˆç±»å‹</em>ï¼Œå°±å¯ä»¥ä½¿ç”¨æ³›å‹ã€‚ç­‰è°ƒç”¨çš„æ—¶å€™å†æ ¹æ®å‚æ•°æŒ‡å®š</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> fn&lt;T&gt;(<span class="attr">a</span>: T): T &#123;</span><br><span class="line">  <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result_1 = <span class="title function_">fn</span>(<span class="number">10</span>) <span class="comment">// ä¸æŒ‡å®šæ³›å‹ï¼ŒTSè‡ªåŠ¨æ£€æµ‹ï¼Œæ­¤æ—¶ä¸ºnumber</span></span><br><span class="line"><span class="keyword">let</span> result_2 = fn&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;hello&#x27;</span>) <span class="comment">// æŒ‡å®šç±»å‹ï¼Œstring</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥æœ‰å¤šä¸ªæ³›å‹</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> fn&lt;T, U&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: U): T &#123;</span><br><span class="line">  <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³›å‹è¿˜å¯ä»¥ç»§æ‰¿äºæ¥å£</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Inter</span> &#123;</span><br><span class="line">  <span class="attr">length</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> fn&lt;T <span class="keyword">extends</span> <span class="title class_">Inter</span>&gt;(<span class="attr">a</span>: T): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a.<span class="property">length</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">name</span>: T</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: T</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> myclass = <span class="keyword">new</span> <span class="title class_">MyClass</span>&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;xm&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸€äº›åŸºæœ¬ä½¿ç”¨ç¬”è®°&lt;br&gt;ä¸€äº›æ³¨æ„ç‚¹ï¼Œä¸å…¨&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="js" scheme="https://smalljerry.cn/tags/js/"/>
    
    <category term="ts" scheme="https://smalljerry.cn/tags/ts/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯é‡Œçš„å„ç§ä½ç½®</title>
    <link href="https://smalljerry.cn/2021/09/09/%E5%89%8D%E7%AB%AF%E9%87%8C%E7%9A%84%E5%90%84%E7%A7%8D%E4%BD%8D%E7%BD%AE/"/>
    <id>https://smalljerry.cn/2021/09/09/%E5%89%8D%E7%AB%AF%E9%87%8C%E7%9A%84%E5%90%84%E7%A7%8D%E4%BD%8D%E7%BD%AE/</id>
    <published>2021-09-09T12:07:40.000Z</published>
    <updated>2025-02-22T02:14:47.356Z</updated>
    
    <content type="html"><![CDATA[<p>å…ƒç´ æ‰€å¤„ä½ç½®ï¼Œé¼ æ ‡äº‹ä»¶ä½ç½®</p><span id="more"></span><h1 id="å…ƒç´ "><a href="#å…ƒç´ " class="headerlink" title="å…ƒç´ "></a>å…ƒç´ </h1><h2 id="åŸºç¡€å±æ€§"><a href="#åŸºç¡€å±æ€§" class="headerlink" title="åŸºç¡€å±æ€§"></a>åŸºç¡€å±æ€§</h2><p><strong>scrollTop</strong>ï¼š<code>Element.scrollTop</code> å±æ€§å¯ä»¥<code>è·å–æˆ–è®¾ç½®</code>ä¸€ä¸ªå…ƒç´ çš„å†…å®¹å‚ç›´æ»šåŠ¨çš„<strong>åƒç´ </strong>æ•°ã€‚</p><p><strong>scrollLeft</strong>ï¼š<code>Element.scrollLeft</code> å±æ€§å¯ä»¥<code>è¯»å–æˆ–è®¾ç½®</code>å…ƒç´ æ»šåŠ¨æ¡åˆ°å…ƒç´ å·¦è¾¹çš„è·ç¦»ã€‚</p><p><strong>offsetParent</strong>ï¼š<code>åªè¯»</code>ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘æœ€è¿‘çš„åŒ…å«è¯¥å…ƒç´ çš„<em>å®šä½å…ƒç´ </em> æˆ–è€…æœ€è¿‘çš„<code>table, td, th, body</code>å…ƒç´ ã€‚å½“å…ƒç´ <code>display: none;</code>çš„æ—¶å€™ï¼ŒoffsetParent è¿”å›<code>null</code>ã€‚</p><p><strong>offsetTop</strong>ï¼š<code>åªè¯»</code>ï¼Œè¿”å›å½“å‰å…ƒç´ ç›¸å¯¹äºå…¶<code>offsetParent</code>å…ƒç´ é¡¶éƒ¨å†…è¾¹è·çš„è·ç¦»ã€‚</p><p><strong>offsetLeft</strong>ï¼š<code>åªè¯»</code>ï¼Œè¿”å›å½“å‰å…ƒç´ <em>å·¦ä¸Šè§’</em> ç›¸å¯¹äº<code>offsetParent</code>å·¦è¾¹ç•Œçš„è·ç¦»ã€‚</p><p><strong>offsetWidth</strong>ï¼š<code>åªè¯»</code>ï¼Œè¿”å›ä¸€ä¸ªå…ƒç´ çš„<em>å¸ƒå±€å®½åº¦</em>ã€‚é‡Œé¢åŒ…å« borderã€paddingã€scrollbarã€widthã€‚</p><p><strong>offsetHeight</strong>ï¼š<code>åªè¯»</code>ï¼Œè¿”å›å¸ƒå±€é«˜åº¦ã€‚é‡Œé¢<strong>ä¸</strong>åŒ…å«<code>::beforeã€::after</code>ç­‰ä¼ªç±»å…ƒç´ </p><p><strong>clientWidth</strong>ï¼š<code>åªè¯»</code>ï¼Œè¿”å›å…ƒç´ <em>å†…éƒ¨å®½åº¦</em> ï¼ŒåŒ…æ‹¬ paddingï¼Œä¸åŒ…æ‹¬ borderã€margin å’Œ scrollbarã€‚<span style="color: orange;">å†…è”å…ƒç´ ä»¥åŠæ²¡æœ‰ CSS æ ·å¼çš„å…ƒç´ çš„ clientWidth å±æ€§å€¼ä¸º 0ã€‚</span></p><p><strong>clientHeight</strong>ï¼š<code>åªè¯»</code>ï¼Œ<span style="color: orange;">clientHeight å¯ä»¥é€šè¿‡ CSS height + CSS padding - æ°´å¹³æ»šåŠ¨æ¡é«˜åº¦ (å¦‚æœå­˜åœ¨)æ¥è®¡ç®—</span></p><p><strong>clientLeft</strong>ï¼š<code>åªè¯»</code>ï¼Œä¸€ä¸ªå…ƒç´ çš„å·¦è¾¹æ¡†çš„å®½åº¦ã€‚å¦‚æœå…ƒç´ çš„æ–‡æœ¬æ–¹å‘æ˜¯ä»å³åˆ°å·¦ï¼Œå¹¶ä¸”ç”±äºå†…å®¹æº¢å‡ºå¯¼è‡´å·¦è¾¹å‡ºç°äº†ä¸€ä¸ªå‚ç›´æ»šåŠ¨æ¡ï¼Œåˆ™è¯¥å±æ€§åŒ…æ‹¬æ»šåŠ¨æ¡çš„å®½åº¦ã€‚<code>clientLeft</code> ä¸åŒ…æ‹¬å·¦å¤–è¾¹è·å’Œå·¦å†…è¾¹è·ã€‚<code>display: inline;</code>æ—¶ï¼Œè¿™ä¸ªå€¼ä¸º 0ã€‚</p><p><strong>clientTop</strong>ï¼š<code>åªè¯»</code>ï¼Œé¡¶éƒ¨è¾¹æ¡†å®½åº¦ï¼ŒåŒä¸Šã€‚</p><p>**getBoundingClientRect()**ï¼šæ–¹æ³•è¿”å›å…ƒç´ çš„å¤§å°åŠå…¶ç›¸å¯¹äºè§†å£çš„ä½ç½®ã€‚å¦‚æœæ˜¯æ ‡å‡†ç›’å­ï¼Œå…ƒç´ çš„å°ºå¯¸ç­‰äº<code>width/height</code> + <code>padding</code> + <code>border-width</code>çš„æ€»å’Œã€‚å¦‚æœ<code>box-sizing: border-box</code>ï¼Œå…ƒç´ çš„çš„å°ºå¯¸ç­‰äº <code>width/height</code>ã€‚</p><h2 id="Element-getBoundingClientRect"><a href="#Element-getBoundingClientRect" class="headerlink" title="Element.getBoundingClientRect()"></a>Element.getBoundingClientRect()</h2><ul><li>è¿”å›ä¸€ä¸ª <code>DOMRect</code> å¯¹è±¡ï¼Œæä¾›äº†å…ƒç´ çš„å¤§å°ï¼ŒåŠå…¶ç›¸å¯¹äºè§†å£çš„ä½ç½®ã€‚</li></ul><p>é‡Œé¢æœ‰<strong>åªè¯»</strong>å±æ€§ï¼šï¼ˆä»¥<strong>åƒç´ </strong>ä¸ºå•ä½ï¼‰</p><ul><li><code>x</code>æˆ–è€…<code>left</code></li><li><code>y</code>æˆ–è€…<code>top</code></li><li><code>width</code>ã€<code>height</code>ï¼šåŒ…å«äº†<code>padding</code>å’Œ<code>border-width</code>ï¼ˆ<code>border-box</code>é™¤å¤–ï¼‰</li><li><code>right</code>ï¼š<code>x + width</code></li><li><code>bottom</code>ï¼š<code>y + height</code></li></ul><h1 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h1><p><strong>clientX</strong>ï¼šæ˜¯<code>åªè¯»</code>å±æ€§ï¼Œäº‹ä»¶å‘ç”Ÿæ—¶åº”ç”¨å®¢æˆ·ç«¯åŒºåŸŸï¼ˆæµè§ˆå™¨ï¼‰çš„æ°´å¹³<strong>åæ ‡</strong></p><p><strong>clientY</strong>ï¼š<code>åªè¯»</code>ï¼Œå‚ç›´åæ ‡</p><p><strong>screenX</strong>ï¼šé¼ æ ‡äº‹ä»¶çš„<code>åªè¯»</code>å±æ€§ï¼Œé¼ æ ‡åœ¨å…¨å±€ï¼ˆå±å¹•ï¼‰ä¸­çš„æ°´å¹³åæ ‡ï¼ˆåç§»é‡ï¼‰ã€‚è¿™é‡Œçš„å±å¹•æŒ‡çš„æ˜¯<em>æ•´ä¸ªå±å¹•</em>ï¼Œå³ä½¿æµè§ˆå™¨çª—å£ç¼©å°ï¼Œä¹Ÿè¿˜æ˜¯æ•´ä¸ªå±å¹•ã€‚</p><p><strong>screenY</strong>ï¼š<code>åªè¯»</code>ï¼Œç«–ç›´åæ ‡ã€‚</p><p><strong>pageX</strong>ï¼š<code>åªè¯»</code>ï¼Œé¼ æ ‡äº‹ä»¶è¿”å›çš„ç›¸å¯¹äºæ•´ä¸ªæ–‡æ¡£çš„<em>X åæ ‡</em>ï¼ˆå•ä½ï¼špxï¼‰ ã€‚å¦‚æœæœ‰æ»šåŠ¨æ¡ï¼Œè¦åŠ ä¸Šæ»šåŠ¨æ¡çš„å€¼ã€‚</p><p><strong>pageY</strong>ï¼š<code>åªè¯»</code>ï¼ŒåŒä¸Š pageXã€‚</p><h2 id="ResizeObserver"><a href="#ResizeObserver" class="headerlink" title="ResizeObserver"></a>ResizeObserver</h2><ul><li>ç›‘å¬<strong>å…ƒç´ </strong>çš„è¾¹ç•Œå°ºå¯¸å˜åŒ–</li></ul><p><code>ResizeObserver.observe()</code>ï¼šå¯¹æŒ‡å®šå…ƒç´ ä»…ä»ç›‘å¬</p><p><code>ResizeObserver.disconnect(target, options)</code>ï¼šå–æ¶ˆæ‰€æœ‰ç›‘å¬</p><ul><li><code>options</code>ï¼š<code>box</code>å±æ€§ï¼ŒæŒ‡å®šç›‘å¬çš„ç›’å­ç±»å‹ï¼Œ<code>content-box</code>ï¼ˆé»˜è®¤ï¼‰æˆ–è€…<code>border-box</code>æˆ–è€…<code>device-pixel-content-box</code>ï¼ˆè®¾å¤‡åƒç´ ç›’å­ï¼‰</li></ul><p><code>ResizeObserver.unobserve(target)</code>ï¼šå–æ¶ˆæŒ‡å®šå…ƒç´ çš„ç›‘å¬</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;å…ƒç´ æ‰€å¤„ä½ç½®ï¼Œé¼ æ ‡äº‹ä»¶ä½ç½®&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="js" scheme="https://smalljerry.cn/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>ç§»åŠ¨webå¼€å‘</title>
    <link href="https://smalljerry.cn/2021/07/21/%E7%A7%BB%E5%8A%A8web%E5%BC%80%E5%8F%91/"/>
    <id>https://smalljerry.cn/2021/07/21/%E7%A7%BB%E5%8A%A8web%E5%BC%80%E5%8F%91/</id>
    <published>2021-07-21T08:47:40.000Z</published>
    <updated>2025-02-22T02:14:47.356Z</updated>
    
    <content type="html"><![CDATA[<p>ç®€å•ä»‹ç»ç§»åŠ¨ç«¯ web å¼€å‘æ‰€éœ€è¦çš„åŸºç¡€çŸ¥è¯†</p><p>å¥½å¥½å­¦ä¹ ã€‚<span id="more"></span></p><h1 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h1><h2 id="lt-meta-gt-è§†å£æ ‡ç­¾"><a href="#lt-meta-gt-è§†å£æ ‡ç­¾" class="headerlink" title="&lt;meta&gt;è§†å£æ ‡ç­¾"></a><code>&lt;meta&gt;</code>è§†å£æ ‡ç­¾</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span></span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure><p>æ·»åŠ è§†å£æ ‡ç­¾ä¹‹å‰ï¼Œé¡µé¢ä¼šæœ‰æ‹–åŠ¨æ¡ï¼Œè¿™æ˜¯é»˜è®¤çš„é¡µé¢å¤§å°ã€‚æ·»åŠ è§†å£æ ‡ç­¾ä¹‹åï¼Œé¡µé¢å°±ä¼šè‡ªåŠ¨é€‚åº”è®¾å¤‡çš„å¤§å°ï¼Œæ‹–åŠ¨æ¡ä¹Ÿä¸ä¼šå‡ºç°äº†ã€‚</p><h2 id="äºŒå€å›¾"><a href="#äºŒå€å›¾" class="headerlink" title="äºŒå€å›¾"></a>äºŒå€å›¾</h2><p>å•ä½<code>px</code>å’ŒçœŸå®çš„ç‰©ç†åƒç´ ï¼ˆåˆ†è¾¨ç‡ï¼‰åœ¨ç§»åŠ¨ç«¯æ˜¯æœ‰ä¸€å®šç¨‹åº¦çš„åå·®çš„ï¼Œå¾€å¾€æ˜¯<code>1px</code>å¯¹åº”å¤šä¸ªåƒç´ ç‚¹</p><p>ä¾‹ï¼šéœ€è¦åœ¨å±å¹•æ˜¾ç¤º<code>50px</code>çš„å›¾ç‰‡ï¼Œæ”¾åˆ°æ‰‹æœºå±å¹•å¯èƒ½ä¼šè¢«æ”¾å¤§åˆ°<code>100px</code>ï¼Œè¿™æ ·å›¾ç‰‡å°±ä¼šæ¨¡ç³Šã€‚å‡†å¤‡ä¸€å¼ <code>100px</code>çš„å›¾ç‰‡ï¼Œç„¶åæ‰‹åŠ¨è°ƒèŠ‚è¿™å¼ å›¾ç‰‡çš„ CSS æ ·å¼ä¸º<code>50px</code>ï¼Œä»¥æ­¤è§£å†³æ¨¡ç³Šã€‚</p><p>ä¸ä»…æ˜¯äºŒå€å›¾ï¼Œå¶å¯èƒ½æ˜¯ä¸‰å€å›¾ã€å››å€å›¾ã€‚</p><p>å¯¹äºèƒŒæ™¯å›¾ç‰‡çš„è®¾ç½®ï¼Œä½¿ç”¨<code>background-size</code>å±æ€§ï¼Œå…¶å€¼é™¤äº†æ•°å€¼å•ä½ï¼Œè¿˜æœ‰<em>cover</em>å’Œ<em>contain</em>ã€‚åä¸¤è€…çš„åŒºåˆ«æ˜¯<em>cover</em>é“ºæ»¡æ•´ä¸ªå®¹å™¨ï¼Œ<em>contain</em>çš„å®½æˆ–è€…é«˜é“ºæ»¡å®¹å™¨åå°±åœæ­¢ç¼©æ”¾ã€‚</p><h2 id="å¼€å‘é€‰æ‹©"><a href="#å¼€å‘é€‰æ‹©" class="headerlink" title="å¼€å‘é€‰æ‹©"></a>å¼€å‘é€‰æ‹©</h2><ol><li>å•ç‹¬çš„ç§»åŠ¨ç«¯é¡µé¢ï¼šä¸ºç§»åŠ¨ç«¯å¦å¤–å†™ä»£ç ï¼ˆæ¨èï¼‰ï¼Œé€šè¿‡æ‰“å¼€ç½‘ç«™çš„è®¾å¤‡æ¥è·³è½¬åˆ°ä¸åŒçš„é¡µé¢ã€‚</li><li>å“åº”å¼é¡µé¢å…¼å®¹ç§»åŠ¨ç«¯ï¼šä¸€å¥—ä»£ç åŒ…å«æ¡Œé¢å’Œç§»åŠ¨ç«¯ï¼ˆä¸å¤ªæ¨èï¼‰ï¼Œé€šè¿‡åˆ¤æ–­å±å¹•çš„å®½åº¦æ¥æ”¹å˜æ ·å¼ã€‚</li></ol><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><ol><li>CSS åˆå§‹åŒ–â€”â€”<a href="https://github.com/necolas/normalize.css/">normalize.css</a>ã€‚<code>npm install --save normalize.css</code></li><li>å¯ä»¥ä½¿ç”¨<code>box-sizing</code>å±æ€§è§£å†³ä¸€äº›é—®é¢˜ï¼Œçœå»å‡å»<code>marginã€padding</code>çš„éº»çƒ¦</li><li>å¯¹äº Safari ä¸­çš„æ ‡å‡†ï¼Œæ¸…é™¤ç±»ä¼¼äº<code>&lt;a&gt;</code>ç‚¹å‡»çš„é«˜äº®æ•ˆæœï¼š<code>-webkit-tap-heighlight-color: transparent</code>ï¼ˆéæ ‡å‡†ï¼‰</li><li>å¯¹äº Safari ä¸ŠæŒ‰é’®å’Œè¾“å…¥æ¡†è‡ªå®šä¹‰æ ·å¼æ·»åŠ å‰æï¼š<code>-webkit-apperance: none</code>ï¼ˆå®éªŒä¸­çš„åŠŸèƒ½ï¼‰</li><li>å¯¹äº Safari ä¸Šï¼Œå¦‚<code>&lt;a&gt;</code>ï¼ŒæŒ‰ä½åä¼šå¼¹å‡ºè¿™ä¸ªè·³è½¬çš„é¢„è§ˆçª—å£ï¼Œ<code>-webkit-touch-callout: none</code>å¯ä»¥å…³é—­å®ƒï¼ˆéæ ‡å‡†ï¼‰(ä»…æ”¯æŒ Safari)</li></ol><p><strong>å•ç‹¬é¡µé¢å¸¸è§å¸ƒå±€</strong>ï¼šæµå¼å¸ƒå±€ã€flex å¸ƒå±€ã€less+rem+åª’ä½“æŸ¥è¯¢å¸ƒå±€ã€æ··åˆå¸ƒå±€<br><strong>å“åº”å¼é¡µé¢å…¼å®¹</strong>ï¼šåª’ä½“æŸ¥è¯¢ã€Bootsrap ä¹‹ç±»çš„æ¡†æ¶</p><h1 id="æµå¼å¸ƒå±€"><a href="#æµå¼å¸ƒå±€" class="headerlink" title="æµå¼å¸ƒå±€"></a>æµå¼å¸ƒå±€</h1><ul><li>ä¹Ÿç§°<em>ç™¾åˆ†æ¯”å¸ƒå±€</em>ã€<em>éå›ºå®šåƒç´ å¸ƒå±€</em></li><li>ä¸€èˆ¬ä¼šä½¿ç”¨åˆ°<code>float</code>ã€<code>position</code></li></ul><h2 id="åŸºç¡€æ ·å¼"><a href="#åŸºç¡€æ ·å¼" class="headerlink" title="åŸºç¡€æ ·å¼"></a>åŸºç¡€æ ·å¼</h2><p>åŸºæœ¬å®½åº¦</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">320px</span>;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">640px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ¥ä¸‹æ¥çš„å†…å®¹çš„å®½åº¦éƒ½æ˜¯ä½¿ç”¨<code>%</code>ä½œä¸ºå•ä½ã€‚</p><p><strong>ä¾‹ 1</strong>ï¼Œä¸¤è¾¹ç»¿è‰²çš„æ˜¯å›ºå®šä½ç½®å›ºå®šå¤§å°çš„æŒ‰é’®ï¼Œä¸­é—´çš„æ˜¯æœç´¢æ¡†ï¼Œé•¿åº¦å¯ä»¥éšç€å±å¹•å°ºå¯¸çš„æ”¹å˜è€Œæ”¹å˜</p><p><img src="https://z3.ax1x.com/2021/07/22/WBaSR1.png" alt="æœç´¢æ¡†æ¡ˆä¾‹"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* ä¸­é—´çš„æ˜¯æ ‡å‡†æµå°±è¡Œï¼Œä¼šé“ºæ»¡ã€‚ç„¶åè®¾ç½®marginæˆ–è€…paddingè°ƒèŠ‚å·¦å³é—´éš™çš„è·ç¦» */</span></span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ³¨ï¼šå›ºå®šå®šä½çš„ç›’å­è¦æœ‰ä¸ªå®½åº¦æ‰è¡Œã€‚</li></ul><p><strong>ä¾‹ 2</strong>ï¼Œä¸€ä¸ªå¯¼èˆªæ é‡Œé¢æœ‰ 10 ä¸ªå›¾æ ‡ï¼Œæ¯è¡Œ 5 ä¸ªã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨<code>&lt;nav&gt;</code>å’Œ<code>&lt;a&gt;</code>ï¼Œ<code>&lt;a&gt;</code>é‡Œé¢æ”¾å…·ä½“å†…å®¹</p><p><img src="https://z3.ax1x.com/2021/07/25/W2itdP.png" alt="ä¾‹2"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.nav</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">20%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç²¾çµå›¾"><a href="#ç²¾çµå›¾" class="headerlink" title="ç²¾çµå›¾"></a>ç²¾çµå›¾</h2><ul><li>ä»¥<code>background</code>çš„å½¢å¼å­˜åœ¨</li></ul><p>å¯¹äºäºŒå€ç²¾çµå›¾ï¼Œåœ¨å›¾ç‰‡ç¼–è¾‘å·¥å…·ä¸­å°†ç²¾çµå›¾<strong>ç­‰æ¯”</strong>ç¼©æ”¾åˆ°åŸæ¥çš„<strong>ä¸€åŠ</strong>ï¼Œç„¶åæ ¹æ®å¤§å°ï¼Œæµ‹é‡å‡ºæ‰€éœ€å›¾æ ‡åœ¨æ•´ä¸ªç²¾çµå›¾ä¸­æ‰€å¤„çš„åæ ‡ï¼Œå¦‚ï¼š<code>background: url(./img/jl.png) no-repeat 100px 0</code>ï¼Œåé¢çš„å°±æ˜¯åæ ‡ã€‚</p><blockquote><p>åœ¨å›¾ç‰‡ç¼–è¾‘å™¨ä¸­ç¼©æ”¾åªæ˜¯ä½œä¸ºåæ ‡å‚è€ƒï¼Œä¸è¦ä¿å­˜ç¼©æ”¾åçš„å›¾ç‰‡ã€‚</p></blockquote><p>æœ€åï¼Œè¿˜è¦ä½¿ç”¨<code>background-size</code>æ¥åœ¨ CSS å±‚é¢ç¼©å°ç²¾çµå›¾ä¸ºåŸæ¥çš„<strong>ä¸€åŠ</strong></p><h1 id="flex-å¸ƒå±€"><a href="#flex-å¸ƒå±€" class="headerlink" title="flex å¸ƒå±€"></a>flex å¸ƒå±€</h1><ul><li>ä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥ä½¿ç”¨<code>flex</code>å¸ƒå±€</li><li>çˆ¶ç›’å­è®¾ç½®ä¸º<code>flex</code>çš„æ—¶å€™ï¼Œ<code>floatã€clearã€vertical-align</code>å¤±æ•ˆ</li></ul><p><strong>å¸¸è§çˆ¶é¡¹å±æ€§</strong></p><table><thead><tr><th>å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>flex-direction</td><td>è®¾ç½®<strong>ä¸»è½´</strong>çš„æ–¹å‘</td></tr><tr><td>justify-content</td><td>è®¾ç½®<span style="color: orange;">ä¸»è½´</span>ä¸Šå­å…ƒç´ æ’åˆ—æ–¹å¼</td></tr><tr><td>flex-wrap</td><td>è®¾ç½®å­å…ƒç´ æ˜¯å¦æ¢è¡Œ</td></tr><tr><td>align-content</td><td>è®¾ç½®<span style="color: orange;">ä¾§è½´</span>ä¸Šå­å…ƒç´ æ’åˆ—æ–¹å¼ï¼ˆå¤šè¡Œï¼‰</td></tr><tr><td>align-items</td><td>è®¾ç½®ä¾§è½´ä¸Šå­å…ƒç´ æ’åˆ—æ–¹å¼ï¼ˆå•è¡Œï¼‰</td></tr><tr><td>flex-flow</td><td>ç›¸å½“äºåŒæ—¶è®¾ç½®äº† flex-direction å’Œ flex-wrap</td></tr></tbody></table><ul><li>å…ƒç´ æ˜¯è·Ÿç€ä¸»è½´æ¥æ’åˆ—çš„ï¼Œæ‰€ä»¥å…ˆçŸ¥é“æ˜¯å“ªä¸€æ¡</li></ul><p><code>flex-wrap</code>ï¼Œæ˜¯å¦æ¢è¡Œã€‚å„ä¸ªå­å…ƒç´ åœ¨ä¸»è½´æ–¹å‘ä¸Šçš„æ€»é•¿åº¦<strong>å¤§äº</strong>çˆ¶å…ƒç´ çš„é•¿åº¦ï¼Œä½¿ç”¨<code>wrap</code>ä¹‹åä¼šæ¢è¡Œï¼ˆå¹¶ä¸”ä¸€è¡Œæˆ–ä¸€åˆ—æ˜¾ç¤ºå¤šå°‘ä¸ªï¼Œå–å†³äºå­å…ƒç´ çš„é•¿åº¦ï¼‰ã€‚å¦‚æœä¸ä½¿ç”¨ï¼Œå­å…ƒç´ çš„å®½åº¦å°±ä¼šç­‰æ¯”ç¼©å°ï¼ŒæŒ¤åœ¨ä¸€è¡Œæˆ–æ˜¯ä¸€åˆ—ã€‚</p><p><code>align-item</code>ï¼Œå…¶ä¸­<code>stretch</code>å€¼æ˜¯æ‹‰ä¼¸æ•ˆæœï¼Œå‰ææ˜¯å­å…ƒç´ <strong>æ²¡æœ‰è®¾ç½®é«˜åº¦</strong></p><p><code>align-content</code>ï¼Œå¤šäº†<code>space-aroundã€space-between</code>ï¼Œå¯ä»¥è®¾ç½®ä¸Šä¸€è¡Œç½®é¡¶ï¼Œä¸‹ä¸€è¡Œåœ¨æœ€åº•ï¼ˆå‰ææ˜¯è¦æœ‰æ¢è¡Œï¼‰ã€‚<code>align-item</code>æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºåªèƒ½æ“ä½œä¸€è¡Œã€‚</p><p><strong>å¸¸è§å­é¡¹å±æ€§</strong></p><table><thead><tr><th>å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>flex</td><td>å­é¡¹å çš„ä»½æ•°ï¼ˆä¸ä»…èƒ½å·¦å³è¿˜èƒ½ä¸Šä¸‹ï¼Œæ‰€ä»¥æ¯”ç™¾åˆ†æ¯”å¥½ç”¨äº›ï¼‰</td></tr><tr><td>align-self</td><td>æ§åˆ¶å­é¡¹è‡ªå·±åœ¨ä¾§è½´çš„æ’åˆ—æ–¹å¼ï¼ˆæŸå•ä¸ªï¼‰</td></tr><tr><td>order</td><td>å±æ€§å®šä¹‰å­é¡¹çš„æ’åˆ—é¡ºåºï¼ˆå‰åæ’åºï¼Œé»˜è®¤æ˜¯ 0ï¼Œå¯ä»¥ä¸ºè´Ÿæ•°ï¼‰</td></tr></tbody></table><p><code>flex</code>çš„å€¼å¯ä»¥ä¸ºç™¾åˆ†æ•°ã€‚</p><h2 id="åŸºç¡€æ ·å¼-1"><a href="#åŸºç¡€æ ·å¼-1" class="headerlink" title="åŸºç¡€æ ·å¼"></a>åŸºç¡€æ ·å¼</h2><p>å¯¹äºé¡¶å›ºçš„æœç´¢æ¡†ï¼Œåº”è¯¥æ˜¯å›ºå®šå®šä½çš„ï¼Œå¹¶ä¸”å›ºå®šå®šä½ä½ç½®ä¸çˆ¶å…ƒç´ æ— å…³ï¼Œæ˜¯ä»¥å±å¹•ä¸ºå‡†çš„</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.search</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">50%</span>);</span><br><span class="line">  <span class="comment">/* å›ºå®šçš„ç›’å­è¦æœ‰å®½åº¦ */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">320px</span>;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">540px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ“‹ å‚è€ƒï¼šé»‘é©¬ç¨‹åºå‘˜</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç®€å•ä»‹ç»ç§»åŠ¨ç«¯ web å¼€å‘æ‰€éœ€è¦çš„åŸºç¡€çŸ¥è¯†&lt;/p&gt;
&lt;p&gt;å¥½å¥½å­¦ä¹ ã€‚</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="ç§»åŠ¨ç«¯" scheme="https://smalljerry.cn/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>webå®‰å…¨</title>
    <link href="https://smalljerry.cn/2021/07/10/web%E5%AE%89%E5%85%A8/"/>
    <id>https://smalljerry.cn/2021/07/10/web%E5%AE%89%E5%85%A8/</id>
    <published>2021-07-10T08:29:33.000Z</published>
    <updated>2025-02-22T02:14:47.356Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>æˆ‘çš„reactå¿«é€Ÿæ‰‹å†Œ</title>
    <link href="https://smalljerry.cn/2021/06/10/react/"/>
    <id>https://smalljerry.cn/2021/06/10/react/</id>
    <published>2021-06-10T12:11:50.000Z</published>
    <updated>2025-02-22T02:14:47.356Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸ‰ å¸Œæœ›å¯ä»¥è®°å½•ä¸€äº›ç¬”è®°ï¼Œä¿æŒåŸæœ‰ä¹…ç¬”è®°çš„å‰æä¸‹åŠ¨æ€æ›´æ–°ï¼Œæ–¹ä¾¿å¯¹æ¯”å¤ä¹ </p><p>ğŸ‘‰ å€¼å¾—å­¦ä¹ çš„ <a href="https://react.dev/learn/thinking-in-react">Thinking In React</a></p><span id="more"></span><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ğŸ™ƒ è®°å½•æ—¶é—´ã€ç‰ˆæœ¬çš„ä¸åŒï¼Œä»£ç é£æ ¼ä¼šä¸åŒï¼Œæœ€æ–°çš„ç‰ˆæœ¬ç¤ºä¾‹ä¼šæ˜¯æœ€ä¸Šé¢ä¸€ä¸ªç„¶åç”¨ <code>æ–°---</code> å’Œ <code>æ—§---</code> æ ‡è¯†</p><p><code>TBR</code> æ ‡å‡ºçš„ï¼Œæ˜¯æ²¡çœ‹æ˜ç™½ï¼Œè¿˜éœ€ç»†å“çš„ ğŸ˜…</p><h1 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="ä½¿ç”¨-vite"><a href="#ä½¿ç”¨-vite" class="headerlink" title="ä½¿ç”¨ vite"></a>ä½¿ç”¨ vite</h3><p><a href="https://vitejs.dev/guide/">ğŸŒ Getting Start</a></p><p>å…ˆåˆ›å»º <code>vite</code> å†é€‰æ‹© <code>react</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm create vite@latest</span><br></pre></td></tr></table></figure><p>ç›´æ¥æŒ‡å®š <code>react</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm create vite@latest my-react-app -- --template react</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yarn</span></span><br><span class="line">yarn create vite my-react-app --template react</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">pnpm</span></span><br><span class="line">pnpm create vite my-react-app --template react</span><br></pre></td></tr></table></figure><ul><li>æˆ–è€…æ˜¯ <code>react-ts</code></li></ul><h3 id="éè„šæ‰‹æ¶"><a href="#éè„šæ‰‹æ¶" class="headerlink" title="éè„šæ‰‹æ¶"></a>éè„šæ‰‹æ¶</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react react-dom</span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>&lt;script&gt;</code>å¯¼å…¥ï¼Œæ³¨æ„å¯¼å…¥é¡ºåº</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./node_modules/react/umd/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./node_modules/react-dom/umd/react-dom.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/*åˆ›å»ºreactå…ƒç´ ï¼ˆäº†è§£ï¼‰</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">- å‚æ•°ä¸€ï¼šå…ƒç´ åç§°</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">- å‚æ•°äºŒï¼šå…ƒç´ å±æ€§ï¼Œæ˜¯å¯¹è±¡</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">- å‚æ•°ä¸‰ï¼šå…ƒç´ çš„å­èŠ‚ç‚¹ï¼ˆä»è¿™ä¸ªå‚æ•°å¼€å§‹ï¼Œä¹‹åæ·»åŠ çš„å‚æ•°éƒ½æ˜¯å­èŠ‚ç‚¹ï¼‰</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">*/</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> title = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&quot;h1&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;hello react!&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/*æ¸²æŸ“reactå…ƒç´ </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    - å‚æ•°ä¸€ï¼šè¦æ¸²æŸ“çš„å…ƒç´ </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    - å‚æ•°äºŒï¼šæŒ‚è½½ç‚¹</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    */</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(title, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="è„šæ‰‹æ¶"><a href="#è„šæ‰‹æ¶" class="headerlink" title="è„šæ‰‹æ¶"></a>è„šæ‰‹æ¶</h3><p><code>React.createElement()</code>å’Œ<code>createRoot()</code>çš„åŒºåˆ«</p><ul><li>å‰è€…ï¼šåˆ›å»º React Element</li><li>åè€…ï¼šåˆ›å»ºä¸€ä¸ª root-level çš„å®¹å™¨æ¥æ¸²æŸ“ React ç¨‹åº <code>React 18</code></li></ul><h4 id="React-18-ä»¥å‰"><a href="#React-18-ä»¥å‰" class="headerlink" title="React 18 ä»¥å‰"></a>React 18 ä»¥å‰</h4><p>ä¸‹è½½</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¨è</span></span><br><span class="line">npx create-react-app myReact</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># ä¸å¤ªæ¨è</span></span></span><br><span class="line">npm init react-app myReact</span><br><span class="line">yarn create react-app myReact</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ï¼ˆè¦è¿›å…¥é¡¹ç›®çš„æ ¹ç›®å½•ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ï¼Œé€šè¿‡ ES6 çš„ <code>import</code> å…³é”®å­—</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºreactå…ƒç´ </span></span><br><span class="line"><span class="keyword">const</span> title = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&quot;h1&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;hello react!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¸²æŸ“å…ƒç´ </span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(title, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><h4 id="React-18-ä»¥å"><a href="#React-18-ä»¥å" class="headerlink" title="React 18 ä»¥å"></a>React 18 ä»¥å</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react react-dom</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¸…ç©ºç°æœ‰çš„HTMLå†…å®¹</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨Reactç»„ä»¶å–è€Œä»£ä¹‹</span></span><br><span class="line"><span class="keyword">const</span> root = <span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;app&quot;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>);</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ˜¯å¹¶ä¸æƒ³æ¸…ç©ºå½“å‰ HTML é¡µé¢çš„å†…å®¹ï¼Œé‚£å°±æ‰¾ä¸€ä¸ªå…ƒç´ å½“ä½œå®¹å™¨æ¥æ¸²æŸ“å½“å‰çš„ React ç»„ä»¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My app<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This paragraph is a part of HTML.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">nav</span> <span class="attr">id</span>=<span class="string">&quot;navigation&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This paragraph is also a part of HTML.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">NavigationBar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> Actually implement a navigation bar</span></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello from React!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> domNode = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;navigation&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> root = <span class="title function_">createRoot</span>(domNode);</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">NavigationBar</span> /&gt;</span></span>);</span><br></pre></td></tr></table></figure><h2 id="React-å’Œ-JSX"><a href="#React-å’Œ-JSX" class="headerlink" title="React å’Œ JSX"></a>React å’Œ JSX</h2><p><code>jsx</code> æ˜¯ <code>JavaScript XML</code> çš„ç®€å†™ï¼Œåœ¨ JavaScript æ–‡ä»¶ä¸­å†™ HTML-like æ ‡ç­¾</p><ul><li>å› ä¸º<code>jsx</code>ä¸æ˜¯æ ‡å‡†çš„<code>ECMAScript</code>è¯­æ³•ï¼Œè€Œæ˜¯å®ƒçš„è¯­æ³•æ‰©å±•ï¼Œæ‰€ä»¥åœ¨æ™®é€šç¯å¢ƒæ˜¯ä¸å¯ä»¥ä½¿ç”¨çš„ï¼›è¦åœ¨è„šæ‰‹æ¶ä¸­ä½¿ç”¨ï¼ˆå› ä¸ºè„šæ‰‹æ¶ä¸­åŒ…å«äº†<code>babel</code>ï¼Œ@babel/preset-reactï¼‰</li></ul><blockquote><p>JSX å’Œ React æ˜¯ä¸¤ä¸ªä¸œè¥¿ï¼Œå‰è€…æ˜¯è¯­æ³•æ‹“å±•ï¼Œåè€…æ˜¯ä¸€ä¸ª JavaScript åº“ã€‚React æ˜¯ä½¿ç”¨äº†è¿™ç§è¯­æ³•æ‹“å±•ã€‚é€šå¸¸æ˜¯ä¸€èµ·ä½¿ç”¨çš„ï¼Œä½†ä¹Ÿå¯ä»¥åˆ†å¼€ä½¿ç”¨ã€‚<a href="https://legacy.reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html#whats-a-jsx-transform">æ›´å¤šä»‹ç»</a></p></blockquote><h3 id="è¯­æ³•è§„åˆ™"><a href="#è¯­æ³•è§„åˆ™" class="headerlink" title="è¯­æ³•è§„åˆ™"></a>è¯­æ³•è§„åˆ™</h3><p><strong>1. å•æ ¹èŠ‚ç‚¹</strong></p><blockquote><p>åŸå› ï¼šJSX çœ‹èµ·æ¥åƒ HTMLï¼Œä½†æ˜¯æ˜¯è½¬æ¢æˆåŸç”Ÿçš„ JavaScript å¯¹è±¡ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯ä¸å¯ä»¥è¿”å›ä¸¤ä¸ªå¯¹è±¡çš„ï¼Œæ‰€ä»¥æ‰éœ€è¦åŒ…è£¹èµ·æ¥</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>123<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>456<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="comment">// æˆ–è€…ç©ºç™½çš„</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>123<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>456<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>è¿™ä¸ªç©ºç™½çš„æ ‡ç­¾å«åš Fragment ï¼ˆç‰‡æ®µ ï¼Ÿï¼Ÿï¼‰</li><li>å®Œæ•´æ ·å­ï¼š<code>&lt;Fragment&gt;&lt;/Fragment&gt;</code></li><li>å‘ Fragment ä¼  _key_ï¼Œä¸èƒ½ä½¿ç”¨çŸ­æ ‡ç­¾ <code>&lt;&gt;&lt;/&gt;</code>ï¼Œéœ€è¦ä» react å¯¼å…¥ Fragment ç„¶å s ä½¿ç”¨<code>&lt;Fragment key=&#123;yourKey&#125;&gt;...&lt;/Fragment&gt;</code></li><li>ä¸ä¼šé‡ç½®<code>state</code>ï¼Œåœ¨ä»<code>&lt;&gt;&lt;Child /&gt;&lt;/&gt;</code>åˆ°<code>[&lt;Child&gt;]</code>æˆ–åè½¬çš„æ—¶å€™ï¼›<code>&lt;&gt;&lt;&gt;&lt;Child /&gt;&lt;/&gt;&lt;/&gt;</code>å°±ä¼šé‡ç½®ã€‚å…³äºé‡ç½® stateï¼Œéœ€è¦è·³è½¬çœ‹åˆ°<code>state</code>ç« èŠ‚</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºreactå…ƒç´ </span></span><br><span class="line"><span class="keyword">const</span> title = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    Hello Hi <span class="tag">&lt;<span class="name">span</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¸²æŸ“å…ƒç´ </span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(title, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><ul><li>class =&gt; className ã€for =&gt; htmlForï¼Œç­‰ç­‰</li><li>å¦‚æœå…ƒç´ æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå¯ä»¥è½¬ä¸ºå•æ ‡ç­¾ï¼š<code>&lt;span&gt;&lt;/span&gt;</code> =&gt; <code>&lt;span /&gt;</code>ï¼Œå½“ç„¶ä¸è½¬ä¹Ÿè¡Œ</li></ul><p><strong>2. å¿…é¡»è¦å…³é—­æ ‡ç­¾</strong></p><p>â€¦å…¶å®ä¸€ç›´ä¸çŸ¥é“æ ‡ç­¾è¿˜å¯ä»¥ä¸ç”¨å…³é—­çš„ ğŸ¥²</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li&gt;12</span><br><span class="line">  &lt;li&gt;34</span><br><span class="line">  &lt;li&gt;56</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;img&gt;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>12<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>34<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>56<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> /&gt;</span></span><br></pre></td></tr></table></figure><p><strong>3. é©¼å³°å¼å±æ€§å</strong></p><p>å› ä¸º JSX è¦è½¬æ¢æˆ JavaScript å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œä¾‹å¦‚ HTML-like ä¸­çš„æ ·å¼ç±»<code>class</code>æ”¹æˆäº†<code>className</code>ï¼Œä¸ç„¶å¾—å’Œ JavaScript ç±»çš„å…³é”®å­—å†²çª</p><p>DOM èŠ‚ç‚¹çš„<code>className</code>å±æ€§ä¹Ÿæ˜¯è¿™ä¸ªæ„æ€ï¼Œé¿å…ä¸æ“ä½œ DOM çš„ç¼–ç¨‹è¯­è¨€ä¿ç•™çš„<code>class</code>å…³é”®å­—å†²çª</p><blockquote><p>å¯¹äºæ ·å¼ç±»ï¼Œclass æ˜¯å±äº HTML çš„ï¼Œè€Œ className æ˜¯ DOM å±æ€§</p></blockquote><p><a href="https://react.dev/reference/react-dom/components/common">ğŸ‘‰ è¿™é‡ŒæŸ¥çœ‹æ‰€æœ‰çš„å±æ€§å</a></p><blockquote><p>ç”±äºå†å²åŸå› <code>aria-*</code> å’Œ <code>data-*</code> ä¾ç„¶ä½¿ç”¨ <code>-</code> è€Œä¸æ˜¯é©¼å³°å¼ã€‚ä¸»è¦åŸå› æœ‰ W3C å®šçš„ä¸€äº› HTML è§„èŒƒï¼Œç„¶å React ä¹Ÿéµå¾ªè¿™äº›è§„èŒƒä»¥é€‚é…å¾ˆå¤šåº“ã€å¼€å‘å·¥å…·ã€ä¸åŒæŠ€æœ¯ç­‰ç­‰</p></blockquote><ul><li>aria è§„èŒƒ: Accessible Rich Internet Applicationsï¼Œæä¾›ä¸€ç»„å±æ€§å¢å¼º web åº”ç”¨ç¨‹åºçš„å¯è®¿é—®æ€§ã€‚</li></ul><h3 id="ä½¿ç”¨-js-è¡¨è¾¾å¼-JSX-çš„èŠ±æ‹¬å·"><a href="#ä½¿ç”¨-js-è¡¨è¾¾å¼-JSX-çš„èŠ±æ‹¬å·" class="headerlink" title="ä½¿ç”¨ js è¡¨è¾¾å¼ (JSX çš„èŠ±æ‹¬å·)"></a>ä½¿ç”¨ js è¡¨è¾¾å¼ (JSX çš„èŠ±æ‹¬å·)</h3><blockquote><p>â— èŠ±æ‹¬å·å¤–é¢æ˜¯ä¸éœ€è¦åŠ  åŒå¼•å·æˆ–è€…å•å¼•å· çš„ï¼›èŠ±æ‹¬å·é‡Œé¢å¦‚æœæ˜¯å­—ç¬¦ä¸² <br /> return è¯­å¥ä¸­ JS è¡¨è¾¾å¼è¦å†™åœ¨èŠ±æ‹¬å·é‡Œé¢</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Avatar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> avatar = <span class="string">&quot;https://i.imgur.com/7vQD0fPs.jpg&quot;</span>;</span><br><span class="line">  <span class="keyword">const</span> description = <span class="string">&quot;Gregorio Y. Zara&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">className</span>=<span class="string">&quot;avatar&quot;</span> <span class="attr">src</span>=<span class="string">&#123;avatar&#125;</span> <span class="attr">alt</span>=<span class="string">&#123;description&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;Jerry&quot;</span>; <span class="comment">// ä½¿ç”¨ä¸€ä¸ªèŠ±æ‹¬å·ï¼Œæ³¨æ„æ˜¯ä¸€ä¸ª</span></span><br><span class="line"><span class="keyword">const</span> title = <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(title, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><p>åœ¨<code>&#123;&#125;</code>ä¸­å¯ä»¥ä½¿ç”¨ä»»æ„çš„åˆæ³•çš„<code>JavaScript</code>è¡¨è¾¾å¼ï¼Œä¸è¿‡ä¹Ÿæœ‰ä¾‹å¤–</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">hello</span> = (<span class="params"></span>) =&gt; <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> myDiv = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>æˆ‘æ˜¯ä¸€ä¸ªdiv<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> title = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;1 + 1&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;1 &lt; 2 ? &quot;å¯¹å‘€&quot; : &quot;ä¸å¯¹&quot;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;hello()&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;div&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(title, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><ul><li>jsx è‡ªèº«ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼Œæ‰€ä»¥<code>&#123;div&#125;</code>ä¹Ÿé€‚ç”¨</li><li><code>&lt;p&gt;&#123; &#123;a: &quot;æˆ‘æ˜¯a&quot;&#125; &#125;&lt;/p&gt;</code>ï¼Œè¿™ç§å¯¹è±¡æ˜¯<strong>ä¸è¡Œ</strong>çš„ï¼Œä½†æ˜¯åœ¨<code>style</code>æ ·å¼ä¸­åˆå¯ä»¥ä½¿ç”¨</li><li>åœ¨é‡Œé¢ä½¿ç”¨è¯­å¥ä¹Ÿæ˜¯<strong>ä¸è¡Œ</strong>çš„ï¼šifã€for è¿™äº›</li></ul><p><strong>JSX ä½¿ç”¨ä¸¤ä¸ªèŠ±æ‹¬å·çš„åœºæ™¯</strong></p><ul><li>CSSï¼š<code>&lt;ul style=&#123;&#123;backgroundColor: 'black', color: 'pink'&#125;&#125;&gt;</code><ul><li>css å±æ€§åè¦é©¼å³°å¼</li></ul></li><li>JSX ä¼ é€’å¯¹è±¡ï¼š<code>person=&#123;&#123; name: "Hedy Lamarr", inventions: 5 &#125;&#125;</code></li></ul><h3 id="æ¡ä»¶æ¸²æŸ“"><a href="#æ¡ä»¶æ¸²æŸ“" class="headerlink" title="æ¡ä»¶æ¸²æŸ“"></a>æ¡ä»¶æ¸²æŸ“</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Item</span>(<span class="params">&#123; name, isPacked &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">className</span>=<span class="string">&quot;item&quot;</span>&gt;</span>&#123;isPacked ? name + &quot;âœ”&quot; : name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Pane</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Item</span> <span class="attr">name</span>=<span class="string">&quot;mike&quot;</span> <span class="attr">isPacked</span>=<span class="string">&#123;false&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Item</span> <span class="attr">name</span>=<span class="string">&quot;amy&quot;</span> <span class="attr">isPacked</span>=<span class="string">&#123;true&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœä¸æ¸²æŸ“ä¸œè¥¿ï¼Œå¯ä»¥è¿”å›<code>null</code>ã€‚<strong>ä¸€èˆ¬ä¸ä¼šè¿™æ ·åš</strong></li></ul><p>ä½¿ç”¨é€»è¾‘ä¸ç®€åŒ–æ¡ä»¶åˆ¤æ–­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">className</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;name&#125; &#123;isPacked &amp;&amp; &quot;âœ”&quot;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>React considers <code>false</code> as a â€œholeâ€ in the JSX treeï¼Œåƒ<code>undefined</code>å’Œ<code>null</code>ä¸€æ ·ä¸æ¸²æŸ“ä¸œè¥¿</li><li>å¯ç”¨å¤šä¸ªèŠ±æ‹¬å·</li></ul><blockquote><p>æ³¨æ„ <code>&amp;&amp;</code> å·¦è¾¹æœ‰æ•°å­—ï¼Œå› ä¸ºå¦‚æœæ˜¯ <em>0</em> çš„è¯ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯<code>false</code>ï¼›å¯ä»¥åŠ ä¸ªå‰æåˆ¤æ–­å½“å·¦è¾¹å¤§äº <em>0</em></p></blockquote><p>å¦‚æœè¦ç®€åŒ–è¿”å›è¯­å¥ï¼Œæˆ–è€…æœ‰ä¸ªé»˜è®¤è¿”å›ï¼Œå¯ä»¥ä½¿ç”¨ç»“åˆä½¿ç”¨<strong>å˜é‡å’Œ JSX</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Item</span>(<span class="params">&#123; name, isPacked &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> content = name;</span><br><span class="line">  <span class="keyword">if</span> (isPacked) &#123;</span><br><span class="line">    <span class="comment">// å¤šè¡Œè¦ä½¿ç”¨æ‹¬å·</span></span><br><span class="line">    content = <span class="language-xml"><span class="tag">&lt;<span class="name">del</span>&gt;</span>&#123;name + &quot;âœ”&quot;&#125;<span class="tag">&lt;/<span class="name">del</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">className</span>=<span class="string">&quot;item&quot;</span>&gt;</span>&#123;content&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ—è¡¨æ¸²æŸ“"><a href="#åˆ—è¡¨æ¸²æŸ“" class="headerlink" title="åˆ—è¡¨æ¸²æŸ“"></a>åˆ—è¡¨æ¸²æŸ“</h3><blockquote><p>ç®­å¤´å‡½æ•°<code>=&gt;</code>åé¢éšå¼è¿”å›ï¼Œä¸ç”¨åŠ ä¸Š<code>return</code>ï¼Œä½†æ˜¯åªè¿”å›ä¸€è¡Œï¼›è¿”å›å¤šè¡Œ<code>=&gt;</code>éœ€è¦åŠ ä¸Š<code>&#123;&#125;</code>å’Œ<code>return</code></p></blockquote><p>å¦‚æœè¦æ¸²æŸ“ä¸€ç»„æ•°æ®ï¼Œåº”è¯¥ä½¿ç”¨æ•°ç»„çš„<code>map()</code>æ–¹æ³•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> songs = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;æˆ‘å¾ˆå¿«ä¹&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&quot;ä½ å¾ˆå¿«ä¹&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&quot;ä»–å¾ˆå¿«ä¹&quot;</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">SongList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// å†³å®šåˆ—è¡¨ç»“æ„ï¼ˆæ¯ä¸€é¡¹éå†éœ€è¦æœ‰ä¸€ä¸ªkeyï¼‰</span></span><br><span class="line">  <span class="keyword">const</span> songItems = songs.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;songItems&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸€èˆ¬ä¼šç”¨æ•°æ®åº“ä¸­å¯¹åº”çš„ ID ä½œä¸º key</li><li>å¦‚æœæ˜¯æœ¬åœ°æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID">crypto.randomUUID()</a> æˆ–è€…æ˜¯åŒ…<a href="https://www.npmjs.com/package/uuid">uuid</a> ç”Ÿæˆ</li></ul><blockquote><p>ä¸è¦ä½¿ç”¨<code>Math.random()</code>ç”Ÿæˆ keyï¼Œkey é™¤äº†æ ‡è¯†å½“å‰ DOMï¼Œè¿˜ä¼šæœ‰ç¼“å­˜ä½œç”¨ï¼Œæ•°æ®ä¸å˜åŒ–çš„ä¸ä¼šé‡æ–°æ¸²æŸ“ä»¥ä½¿å¾—æ¸²æŸ“æ›´å¿«ï¼Œå¦‚æœç”¨äº†éšæœºæ•°ï¼Œæ‰€æœ‰çš„ DOM éƒ½ä¼šåœ¨æ•°æ®æ›´æ–°æ—¶é‡æ–°æ¸²æŸ“ <br /> key åœ¨<code>props</code>æ˜¯è·å–ä¸åˆ°çš„</p></blockquote><p>æƒ³è¦æ¸²æŸ“å¤šä¸ª DOM èŠ‚ç‚¹ä½†æ˜¯åˆä¸æƒ³åœ¨å¤–é¢åŒ…ä¸€ä¸ªå¤šä½™çš„èŠ‚ç‚¹ï¼Œä¾‹å¦‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> listItems = people.<span class="title function_">map</span>(<span class="function"><span class="params">person</span> =&gt;</span> (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;person.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;person.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;person.bio&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">));</span><br></pre></td></tr></table></figure><p>ä¸æƒ³ï¼Œè¦è¿™ä¸ªå¤–é¢çš„<code>&lt;div&gt;</code>ï¼Œå¯ç”¨<code>&lt;Fragment&gt;</code>ä»£æ›¿ï¼Œåœ¨ DOM ä¸­ Fragments ä¸ä¼šå‡ºç°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®°å¾—è¦äº‹å…ˆå¯¼å…¥</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Fragment</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> listItems = people.<span class="title function_">map</span>(<span class="function"><span class="params">person</span> =&gt;</span> (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Fragment</span> <span class="attr">key</span>=<span class="string">&#123;person.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;person.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;person.bio&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Fragment</span>&gt;</span></span></span><br><span class="line">));</span><br></pre></td></tr></table></figure><p>è®°å¾—è¦äº‹å…ˆå¯¼å…¥ï¼š</p><blockquote><p>ä¸èƒ½ä½¿ç”¨ <code>&lt;&gt;&lt;/&gt;</code>ï¼Œå› ä¸ºå®ƒä¸èƒ½ä¼ é€’ <code>key</code></p></blockquote><h3 id="æ ·å¼å¤„ç†"><a href="#æ ·å¼å¤„ç†" class="headerlink" title="æ ·å¼å¤„ç†"></a>æ ·å¼å¤„ç†</h3><p>è¡Œå†…æ ·å¼ï¼šstyleï¼ˆä¸æ¨èï¼‰ï¼Œä½¿ç”¨æ ·å¼æ—¶å¯ä»¥åœ¨<code>&#123;&#125;</code>ä¸­ä½¿ç”¨å¯¹è±¡</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> &quot;<span class="attr">red</span>&quot;, <span class="attr">backgroundColor:</span> &quot;<span class="attr">yellow</span>&quot; &#125;&#125;&gt;</span>JSXè¡Œå†…æ ·å¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>ç±»åï¼šclassName</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* index.css */</span></span><br><span class="line"><span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="string">&quot;red&quot;</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="string">&quot;yellow&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;index.css&quot;</span><span class="keyword">const</span> list = ( <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&quot;title&quot;</span>&gt;</span>JSXç±»æ ·å¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span> )</span><br></pre></td></tr></table></figure><blockquote><p>å°ç»“ï¼šReact æ˜¯åˆ©ç”¨ JavaScript è¯­è¨€è‡ªèº«æ¥ç¼–å†™ç•Œé¢ï¼Œè€Œä¸æ˜¯åƒ Vue ä¸€æ ·é€šè¿‡å¢å¼º HTML çš„åŠŸèƒ½ã€‚</p></blockquote><h1 id="ç»„ä»¶åŸºç¡€"><a href="#ç»„ä»¶åŸºç¡€" class="headerlink" title="ç»„ä»¶åŸºç¡€"></a>ç»„ä»¶åŸºç¡€</h1><ul><li>ä¸€ä¸ªé¡µé¢å¯ä»¥å…¨éƒ¨éƒ½æ˜¯ React ç»„ä»¶ã€‚</li><li>a React component is a JavaScript function that you can sprinkle with markup</li></ul><h2 id="ä¸¤ç§åˆ›å»ºæ–¹å¼"><a href="#ä¸¤ç§åˆ›å»ºæ–¹å¼" class="headerlink" title="ä¸¤ç§åˆ›å»ºæ–¹å¼"></a>ä¸¤ç§åˆ›å»ºæ–¹å¼</h2><blockquote><p><code>React 16.8</code> ä»¥å æ¨èåˆ›å»ºç»„ä»¶çš„æ–¹æ³•ä¸å†æ˜¯ <em>ç±»ç»„ä»¶</em> ï¼Œè€Œæ˜¯ <em>å‡½æ•°ç»„ä»¶</em></p></blockquote><p>å‡½æ•°çš„æ–¹å¼å’Œç±»çš„æ–¹å¼</p><h3 id="å‡½æ•°ç»„ä»¶"><a href="#å‡½æ•°ç»„ä»¶" class="headerlink" title="å‡½æ•°ç»„ä»¶"></a>å‡½æ•°ç»„ä»¶</h3><ul><li>ä½¿ç”¨<code>function</code>å…³é”®å­—</li><li>å‡½æ•°åç§°<strong>å¤§å†™</strong>å¼€å¤´</li><li>å‡½æ•°ç»„ä»¶å¿…é¡»æœ‰è¿”å›å€¼ï¼ˆè¿”å›<code>null</code>è¡¨ç¤ºä¸æ¸²æŸ“å†…å®¹ï¼‰<ul><li>è¿”å›å•è¡Œå¯ä¸éœ€è¦æ‹¬å·ï¼Œè¿”å›<strong>å¤šè¡Œå¿…é¡»æ‹¬å·</strong></li></ul></li><li>ä¸è¦åœ¨ç»„ä»¶é‡Œé¢å†å®šä¹‰å…¶ä»–ç»„ä»¶</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æˆ–è€…const Hello = ()=&gt; &lt;div&gt;è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶&lt;/div&gt;</span></span><br><span class="line"><span class="comment">// å‡½æ•°åä½œä¸ºæ ‡ç­¾å</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Hello</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Profile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.imgur.com/MK3eW3Am.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Katherine Johnson&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è™½ç„¶é‡Œé¢æœ‰<em>src</em>ã€_alt_ï¼Œä½†æ˜¯å®åˆ™ä¸º JavaScriptï¼Œè¿™ç§å†™æ³•å«</li><li>React ä¼šä»¥å¤§å°å†™æ¥åŒºåˆ† HTML æ ‡ç­¾å’Œ React ç»„ä»¶</li></ul><h3 id="ç±»ç»„ä»¶"><a href="#ç±»ç»„ä»¶" class="headerlink" title="ç±»ç»„ä»¶"></a>ç±»ç»„ä»¶</h3><ul><li>ä½¿ç”¨<code>class</code>å…³é”®å­—</li><li>ç±»åè¦å¤§å†™å¼€å¤´ï¼Œå¹¶ä¸”ç»§æ‰¿äº<code>React.Component</code></li><li>å¿…é¡»æœ‰<code>render()</code>æ–¹æ³•ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•è¦æœ‰è¿”å›å€¼</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">render</span> (</span><br><span class="line">    <span class="keyword">return</span> ( <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªç±»ç»„ä»¶<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> )</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Hello</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>))</span><br></pre></td></tr></table></figure><h2 id="ç»„ä»¶çš„å¯¼å…¥å¯¼å‡º"><a href="#ç»„ä»¶çš„å¯¼å…¥å¯¼å‡º" class="headerlink" title="ç»„ä»¶çš„å¯¼å…¥å¯¼å‡º"></a>ç»„ä»¶çš„å¯¼å…¥å¯¼å‡º</h2><ul><li>ä¸€èˆ¬ä¼šå°†ä¸€ä¸ªç»„ä»¶æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„ js æ–‡ä»¶ä¸­</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åç¼€åå¯çœç•¥</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NavMenu</span> <span class="keyword">from</span> <span class="string">&quot;./navMenu.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†…éƒ¨ä½¿ç”¨çš„è¯ï¼Œæ— éœ€å¯¼å‡º</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">HeaderTitle</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Header</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">NavMenu</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">HeaderTitle</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Hello.js */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">render</span> (</span><br><span class="line">    <span class="keyword">return</span> ( <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹æ–‡ä»¶ç»„ä»¶<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> )</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Hello</span></span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* index.js */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Hello</span> <span class="keyword">from</span> <span class="string">&quot;./Hello.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Hello</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="é»˜è®¤ä¸å‘½åå¯¼å‡ºå¯¼å…¥"><a href="#é»˜è®¤ä¸å‘½åå¯¼å‡ºå¯¼å…¥" class="headerlink" title="é»˜è®¤ä¸å‘½åå¯¼å‡ºå¯¼å…¥"></a>é»˜è®¤ä¸å‘½åå¯¼å‡ºå¯¼å…¥</h3><ul><li>ä¸€ä¸ªæ–‡ä»¶åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤å¯¼å‡º</li></ul><table><thead><tr><th>è¯­æ³•</th><th>å¯¼å‡º</th><th>å¯¼å…¥</th></tr></thead><tbody><tr><td>é»˜è®¤</td><td><code>export default function Button() &#123;&#125;</code></td><td><code>import Button from &#39;./Button.js&#39;;</code></td></tr><tr><td>å‘½å</td><td><code>export function Button() &#123;&#125;</code></td><td><code>import &#123; Button &#125; from &#39;./Button.js&#39;;</code></td></tr></tbody></table><ul><li>é»˜è®¤å¯¼å‡ºï¼Œå¯¼å…¥çš„æ—¶å€™ï¼Œå¯¼å…¥åå­—éšä¾¿å†™</li><li>å‘½åçš„æ—¶å€™ï¼Œåå­—éœ€è¦å¯¹åº”</li></ul><p>è™½ç„¶é»˜è®¤å¯¼å‡º<code>export default () =&gt; &#123;&#125;</code>æ²¡é—®é¢˜ï¼Œä½†æ˜¯ä¸æ¨èæ²¡æœ‰åå­—</p><h2 id="äº‹ä»¶å¤„ç†"><a href="#äº‹ä»¶å¤„ç†" class="headerlink" title="äº‹ä»¶å¤„ç†"></a>äº‹ä»¶å¤„ç†</h2><h3 id="åŸºæœ¬ä½¿ç”¨-1"><a href="#åŸºæœ¬ä½¿ç”¨-1" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h3><ul><li><code>on+äº‹ä»¶åç§°=&#123;äº‹ä»¶å¤„ç†ç¨‹åº&#125;</code>ï¼Œ<code>onClick=&#123;()=&gt;&#123;&#125;&#125;</code></li><li>é©¼å³°å¼å‘½å</li></ul><blockquote><p>äº‹ä»¶å¤„ç†å‡½æ•°å¿…é¡»æ˜¯<strong>ä¼ é€’</strong>è€Œä¸æ˜¯<strong>è°ƒç”¨</strong>ï¼Œå°±æ˜¯è¯´ä¸ç”¨åœ¨å‡½æ•°åé¢åŠ ä¸Šæ‹¬å·</p></blockquote><p>ç»™ç»„ä»¶æ·»åŠ äº‹ä»¶å¤„ç†ï¼šå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åä½œä¸º<em>props</em>ä¼ é€’ç»™<code>&lt;button&gt;</code></p><ul><li>è¿™ä¸ªå‡½æ•°ä¸€èˆ¬åœ¨å½“å‰è¿™ä¸ªç»„ä»¶é‡Œé¢</li><li>ä»¥<code>handle</code>å¼€å¤´ï¼š<code>onClick=&#123;handleClick&#125;</code>, <code>onMouseEnter=&#123;handleMouseEnter&#125;</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Button</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;You clicked me!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>ç‚¹å‡»<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Button</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è§¦å‘å•å‡»äº‹ä»¶&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>ç‚¹å‡»<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="äº‹ä»¶å¯¹è±¡"><a href="#äº‹ä»¶å¯¹è±¡" class="headerlink" title="äº‹ä»¶å¯¹è±¡"></a>äº‹ä»¶å¯¹è±¡</h4><ul><li>äº‹ä»¶å¤„ç†å™¨ä¼šæ•è·åˆ°å­ç»„ä»¶å¯èƒ½ä¼šæœ‰çš„äº‹ä»¶ï¼šç§°ä¸ºå†’æ³¡æˆ–è€…ä¼ æ’­ï¼›åœ¨äº‹ä»¶å‘ç”Ÿçš„åœ°æ–¹å¼€å§‹ï¼Œç„¶åé¡ºç€ç»„ä»¶æ ‘å¾€ä¸Šä¼ é€’ã€‚æ¯”å¦‚å­ç»„ä»¶å’Œçˆ¶ç»„ä»¶éƒ½æœ‰ç‚¹å‡»äº‹ä»¶ã€‚</li></ul><blockquote><p>æ‰€æœ‰äº‹ä»¶éƒ½ä¼šå†’æ³¡ï¼Œé™¤äº†<code>onScroll</code>ï¼Œåªåœ¨ä½¿ç”¨çš„åœ°æ–¹ä¿ƒå‘</p></blockquote><p>äº‹ä»¶å¤„ç†å‡½æ•°ä»…æœ‰çš„ä¸€ä¸ªå‚æ•°å°±æ˜¯<em>äº‹ä»¶å¯¹è±¡</em>ï¼Œä¸€èˆ¬ç”¨<code>e</code>æ¥è¡¨ç¤º</p><ul><li><code>e.stopPropagation()</code> é˜»æ­¢å†’æ³¡</li><li>çˆ¶ç»„ä»¶æ·»åŠ <code>onClickCapture=&#123;()=&gt;&#123; /* ... */&#125;&#125;</code> æ•è·å­ç»„ä»¶äº‹ä»¶</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ•è·äº‹ä»¶</span></span><br><span class="line">&lt;div onClickCapture=&#123;<span class="function">() =&gt;</span> &#123;&#125;&#125;&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;e</span> =&gt;</span> e.stopPropagation()&#125; /&gt;</span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;e</span> =&gt;</span> e.stopPropagation()&#125; /&gt;</span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Button</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">handleClick</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">// é˜»æ­¢é»˜è®¤äº‹ä»¶</span></span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;www.baidu.com&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        å»ç™¾åº¦</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äº‹ä»¶å¤„ç†å‡½æ•°è¯»å–-props-å’Œä½œä¸º-props-ä¼ é€’"><a href="#äº‹ä»¶å¤„ç†å‡½æ•°è¯»å–-props-å’Œä½œä¸º-props-ä¼ é€’" class="headerlink" title="äº‹ä»¶å¤„ç†å‡½æ•°è¯»å– props å’Œä½œä¸º props ä¼ é€’"></a>äº‹ä»¶å¤„ç†å‡½æ•°è¯»å– props å’Œä½œä¸º props ä¼ é€’</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Button</span>(<span class="params">&#123; onClick, children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onClick&#125;</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">PlayButton</span>(<span class="params">&#123; movieName &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ä¹‹æ‰€ä»¥åœ¨è¿™å®šä¹‰äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæ˜¯å› ä¸ºå¯¹äº&lt;Button&gt;çš„ä¸åŒè°ƒç”¨æœ‰ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼Œæ‰€ä»¥ä¸æŠŠå¤„ç†å‡½æ•°æ”¾&lt;button&gt;é‡Œé¢</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handlePlayClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ç›´æ¥ä½¿ç”¨ props</span></span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">`Playing <span class="subst">$&#123;movieName&#125;</span>!`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„onClickå¯¹åº”çš„æ˜¯åŸç”Ÿ&lt;button&gt;é‚£é‡Œçš„onClickï¼Œæ‰€ç¤ºä½¿ç”¨äº†é»˜è®¤å</span></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;handlePlayClick&#125;</span>&gt;</span>Play &quot;&#123;movieName&#125;&quot;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Toolbar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">PlayButton</span> <span class="attr">movieName</span>=<span class="string">&quot;Kiki&#x27;s Delivery Service&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰äº‹ä»¶å¤„ç†å‡½æ•°-props-åå­—"><a href="#è‡ªå®šä¹‰äº‹ä»¶å¤„ç†å‡½æ•°-props-åå­—" class="headerlink" title="è‡ªå®šä¹‰äº‹ä»¶å¤„ç†å‡½æ•° props åå­—"></a>è‡ªå®šä¹‰äº‹ä»¶å¤„ç†å‡½æ•° props åå­—</h3><ul><li>ä½œä¸º props ä¼ é€’æ—¶ä½¿ç”¨çš„åå­—</li><li>ä¸Šé¢çš„<code>handlePlayClick</code>ä½œä¸º props ä¼ é€’çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯<code>onClick</code>ï¼Œç®—æ˜¯ä½¿ç”¨äº†é»˜è®¤åå­—</li></ul><p>ä¸€èˆ¬ä»¥<code>on</code>å¼€å¤´ï¼Œç„¶åé©¼å³°å¼å‘½å</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Button</span>(<span class="params">&#123; onSmash, children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onSmash&#125;</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onSmash</span>=<span class="string">&#123;()</span> =&gt;</span> alert(&quot;Playing!&quot;)&#125;&gt;Play Movie<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onSmash</span>=<span class="string">&#123;()</span> =&gt;</span> alert(&quot;Uploading!&quot;)&#125;&gt;Upload Image<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¯¹äºåŸç”Ÿçš„ HTML å…ƒç´ ï¼Œè¦å°½é‡ä½¿ç”¨å¯¹åº”åŠŸèƒ½çš„å…ƒç´ å…¶å¯¹åº”çš„äº‹ä»¶ã€‚æ¯”å¦‚ç‚¹å‡»äº‹ä»¶ä¼šç”¨åˆ°<code>&lt;button&gt;</code>è€Œä¸æ˜¯<code>div</code></p></blockquote><h2 id="state"><a href="#state" class="headerlink" title="state"></a>state</h2><p>éšç€æ—¶é—´æ”¹å˜çš„æ•°æ®å« _state_ï¼Œå¯¹äºå¯¹è±¡å’Œæ•°ç»„ï¼Œreact æ¨èå®ƒä»¬çš„ä½¿ç”¨æ˜¯ä¸å¯å˜çš„ï¼ˆimmutableï¼‰ï¼Œè¦æƒ³æ›´æ–°ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„</p><h3 id="æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€ç»„ä»¶"><a href="#æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€ç»„ä»¶" class="headerlink" title="æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€ç»„ä»¶"></a>æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€ç»„ä»¶</h3><ul><li><del style="color: darkred">æ— çŠ¶æ€ç»„ä»¶ï¼šå‡½æ•°ç»„ä»¶ï¼›æœ‰çŠ¶æ€ç»„ä»¶ï¼šç±»ç»„ä»¶</del> <code>React 16.8</code></li><li>çŠ¶æ€ï¼ˆstateï¼‰è´Ÿè´£æ•°æ®</li><li><del style="color: darkred;">å‡½æ•°ç»„ä»¶æ²¡çŠ¶æ€ï¼Œå¯ä»¥ç”¨äºå±•ç¤ºæ•°æ®ï¼ˆé™æ€ï¼‰</del> <code>React 16.8</code></li><li>ç±»ç»„ä»¶æœ‰è‡ªå·±çŠ¶æ€ï¼Œå¯ä»¥ç”¨äºæ›´æ–°ç•Œé¢ï¼ˆåŠ¨æ€ï¼‰<code>React 16.8 åä¸å†æ˜¯ä¸»æ¨çš„</code></li></ul><h3 id="state-åŸºæœ¬ä½¿ç”¨-æ–°"><a href="#state-åŸºæœ¬ä½¿ç”¨-æ–°" class="headerlink" title="state åŸºæœ¬ä½¿ç”¨(æ–°)"></a>state åŸºæœ¬ä½¿ç”¨(æ–°)</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [index, setIndex] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ”¹å˜å€¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">setIndex</span>(index + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>useState</code> è¿”å›ä¸¤ä¸ªä¸œè¥¿é€šè¿‡è§£æ„è·å¾—ï¼Œä¸€ä¸ªæ˜¯è¿™ä¸ªå€¼ï¼Œå¦ä¸€ä¸ªæ˜¯æ›´æ–°è¿™ä¸ªå€¼äºŒç‚¹æ–¹æ³•</li><li>åå­—éšä¾¿èµ·ï¼Œä½†ä¹ æƒ¯ä½¿ç”¨ <code>åå­—</code> å’Œ <code>setåå­—</code></li><li>æ¯ä¸ªç»„ä»¶é‡Œçš„ state éƒ½æ˜¯ç‹¬ç«‹çš„</li></ul><blockquote><p><code>use</code>å¼€å¤´çš„<em>Hooks</em>æ–¹æ³•ï¼Œåªå¯åœ¨ç»„ä»¶çš„<strong>top level</strong>æ‰§è¡Œï¼Œä¸å¯å†æ¡ä»¶åˆ¤æ–­ã€åˆ—è¡¨å¾ªç¯ä¸­ä½¿ç”¨</p></blockquote><h4 id="æ›´æ”¹-å¯¹è±¡-ç±»å‹çš„-state"><a href="#æ›´æ”¹-å¯¹è±¡-ç±»å‹çš„-state" class="headerlink" title="æ›´æ”¹ å¯¹è±¡ ç±»å‹çš„ state"></a>æ›´æ”¹ <em>å¯¹è±¡</em> ç±»å‹çš„ state</h4><p>ç›´æ¥æ›´æ–°å¯¹è±¡é‡Œçš„å±æ€§æ˜¯ä¸ä¼šè§¦å‘é¡µé¢æ›´æ–°çš„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [position, setPosition] = <span class="title function_">useState</span>(&#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ..</span></span><br><span class="line"></span><br><span class="line">position.<span class="property">x</span> = e.<span class="property">clientX</span>;</span><br><span class="line">position.<span class="property">y</span> = e.<span class="property">clientY</span>;</span><br></pre></td></tr></table></figure><p>è™½ç„¶åœ¨æŸäº›æƒ…å†µè¿™æ ·åšä¼šæœ‰æ•ˆï¼Œä½†æ˜¯å¹¶ä¸æ¨èã€‚æ‰€ä»¥è¦ä½¿ç”¨<code>setPosition</code>ä¼ é€’ä¸€ä¸ªæ–°çš„å¯¹è±¡è¿‡å»ï¼Œç„¶åç»„ä»¶é‡æ–°æ¸²æŸ“</p><p>é‡ç‚¹æ˜¯ä½¿ç”¨<code>setXXX</code>è¿™ä¸ªå‡½æ•°ï¼Œä¸ç®¡è¦æ›´æ–°çš„å€¼ä»¥ä»€ä¹ˆå½¢å¼å˜åŒ–ï¼Œæ¯”å¦‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nextPosition = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">nextPosition.<span class="property">x</span> = e.<span class="property">clientX</span>;</span><br><span class="line">nextPosition.<span class="property">y</span> = e.<span class="property">clientY</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setPosition</span>(nextPosition); <span class="comment">// äº‹å®ä¸Šå’Œä¸‹é¢è¿™ä¸ªç›¸åŒ</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">setPosition</span>(&#123; <span class="attr">x</span>: e.<span class="property">clientX</span>, <span class="attr">y</span>: e.<span class="property">clientY</span> &#125;);</span><br></pre></td></tr></table></figure><p>ä¸è¿‡è¿™æ ·ä¼šæœ‰ä¸ªæ–°çš„é—®é¢˜ï¼Œå°±æ˜¯åªæ˜¯æƒ³è¦æ”¹å˜æŸä¸€ä¸ªå±æ€§çš„å€¼ï¼Œä¸æƒ³è¦æ”¹å˜å…¶ä»–å€¼ã€‚</p><ul><li>å¦‚æœé‡æ–°å°†æ•´ä¸ªå¯¹è±¡ä¼ ä¸€æ¬¡ï¼Œå±æ€§å¤šäº†ä¼šå¾ˆéº»çƒ¦</li></ul><p>ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦å°†ä¸éœ€è¦æ”¹å˜çš„å¯¹è±¡å±æ€§å¤åˆ¶åˆ°æ–°çš„å¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœåªéœ€è¦æ”¹å˜ firstNameï¼Œè¿™æ ·å¤ªéº»çƒ¦äº†</span></span><br><span class="line"><span class="title function_">setPerson</span>(&#123;</span><br><span class="line">  <span class="attr">firstName</span>: e.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">  <span class="attr">lastName</span>: person.<span class="property">lastName</span>,</span><br><span class="line">  <span class="attr">email</span>: person.<span class="property">email</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ ·ä¼˜åŒ–</span></span><br><span class="line"><span class="title function_">setPerson</span>(&#123;</span><br><span class="line">  ...person, <span class="comment">// å¤åˆ¶æ—§çš„å€¼</span></span><br><span class="line">  <span class="attr">firstName</span>: e.<span class="property">target</span>.<span class="property">value</span>, <span class="comment">// ä»…é‡å†™ firstName</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å±•å¼€è¿ç®—ç¬¦ä»…åœ¨å¯¹è±¡çš„ç¬¬ä¸€å±‚èµ·ä½œç”¨ï¼Œå¦‚æœè¦å¤åˆ¶æ›´æ·±å±‚çš„ï¼Œå¾—å¤šæ¬¡ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [person, setPerson] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Niki de Saint Phalle&quot;</span>,</span><br><span class="line">  <span class="attr">artwork</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;Blue Nana&quot;</span>,</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&quot;Hamburg&quot;</span>,</span><br><span class="line">    <span class="attr">image</span>: <span class="string">&quot;https://i.imgur.com/Sd1AgUOm.jpg&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>åªæƒ³è¦æ›´æ–° <em>artwork</em> çš„ <em>city</em></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nextArtwork = &#123; ...person.<span class="property">artwork</span>, <span class="attr">city</span>: <span class="string">&quot;New Delhi&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> nextPerson = &#123; ...person, <span class="attr">artwork</span>: nextArtwork &#125;;</span><br><span class="line"><span class="title function_">setPerson</span>(nextPerson);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…ç›´æ¥åœ¨é‡Œé¢</span></span><br><span class="line"><span class="title function_">setPerson</span>(&#123;</span><br><span class="line">  ...person, <span class="comment">// Copy other fields</span></span><br><span class="line">  <span class="attr">artwork</span>: &#123;</span><br><span class="line">    <span class="comment">// but replace the artwork</span></span><br><span class="line">    ...person.<span class="property">artwork</span>, <span class="comment">// with the same one</span></span><br><span class="line">    <span class="attr">city</span>: <span class="string">&quot;New Delhi&quot;</span>, <span class="comment">// but in New Delhi!</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>â” å…¶ä»–æƒ…å†µï¼šæ›´æ”¹ <code>obj3.artwork</code>ï¼Œ<code>obj1</code> å’Œ <code>obj2.artwork</code> ä¹Ÿä¼šæ”¹å˜ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç›¸åŒçš„å¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&quot;Blue Nana&quot;</span>,</span><br><span class="line">  <span class="attr">city</span>: <span class="string">&quot;Hamburg&quot;</span>,</span><br><span class="line">  <span class="attr">image</span>: <span class="string">&quot;https://i.imgur.com/Sd1AgUOm.jpg&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Niki de Saint Phalle&quot;</span>,</span><br><span class="line">  <span class="attr">artwork</span>: obj1,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj3 = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Copycat&quot;</span>,</span><br><span class="line">  <span class="attr">artwork</span>: obj1,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="æ›´æ–°-æ•°ç»„-ç±»å‹çš„-state"><a href="#æ›´æ–°-æ•°ç»„-ç±»å‹çš„-state" class="headerlink" title="æ›´æ–° æ•°ç»„ ç±»å‹çš„ state"></a>æ›´æ–° <em>æ•°ç»„</em> ç±»å‹çš„ state</h4><ul><li>åŒæ ·æ¨èä¸å¯å˜ï¼ˆimmutableï¼‰ï¼Œæ‰€ä»¥ä¸è¦ä½¿ç”¨<code>arr[0] = &quot;qaq&quot;</code>æ¥ä¿®æ”¹å…¶ä¸­çš„å€¼</li><li>åŒæ ·ä¹Ÿä¸æ¨èä½¿ç”¨<code>pop()</code>ã€<code>push()</code>ç­‰æ–¹æ³•æ¥æ”¹å˜å®ƒ</li><li>æ¨èä»æ—§æ•°ç»„çš„åŸºç¡€ä¸Šåˆ›å»ºæ–°çš„æ•°ç»„ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸ä¼šæ”¹å˜æ—§æ•°ç»„çš„æ•°ç»„æ–¹æ³•ï¼Œä¾‹å¦‚<code>filter()</code>ã€<code>map()</code></li></ul><p>React ä¸­ state ä¸­æ•°ç»„çš„æ“ä½œæ–¹æ³•æ¨èï¼ˆé¿å…ä½¿ç”¨è¯¥ç™¾å¹´æ•°ç»„çš„ï¼Œæ¨èä½¿ç”¨è¿”å›æ–°æ•°ç»„çš„ï¼‰ï¼š</p><table><thead><tr><th></th><th>é¿å…</th><th>æ¨è</th></tr></thead><tbody><tr><td>æ·»åŠ </td><td>push, unshift</td><td>concat, [â€¦arr]</td></tr><tr><td>åˆ é™¤</td><td>pop, shift, splice</td><td>filter, slice</td></tr><tr><td>æ›¿æ¢</td><td>splice, arr[i]=xx</td><td>map</td></tr><tr><td>æ’åº</td><td>reverse, sort</td><td>å…ˆå¤åˆ¶è¿™ä¸ªæ•°ç»„</td></tr></tbody></table><p><strong>æ·»åŠ å†…å®¹</strong>ï¼šå’Œå¯¹è±¡ä¸€æ ·ï¼Œä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦æ¥å¤åˆ¶ä»¥è¾¾åˆ°æ”¹å˜æŸä¸€ä¸ªå€¼çš„ç›®çš„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [artists, setArtists] = <span class="title function_">useState</span>([]);</span><br><span class="line"></span><br><span class="line"><span class="title function_">setArtists</span>(</span><br><span class="line">  <span class="comment">// Replace the state</span></span><br><span class="line">  [</span><br><span class="line">    <span class="comment">// with a new array</span></span><br><span class="line">    ...artists, <span class="comment">// that contains all the old items</span></span><br><span class="line">    &#123; <span class="attr">id</span>: nextId++, <span class="attr">name</span>: name &#125;, <span class="comment">// and one new item at the end</span></span><br><span class="line">  ]</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>è¦æ”¹å˜æ–°æ’å…¥å€¼çš„ä½ç½®ï¼Œå°†æ–°æ’å…¥çš„å€¼è¿™è¡Œæ”¾åˆ°æ‰©å±•è¿ç®—çš„ä¸Šé¢å°±è¡Œ</li></ul><p><strong>åˆ é™¤å†…å®¹</strong>ï¼šæœ€ç®€å•çš„å°±æ˜¯è¿‡æ»¤æ‰è¿™ä¸ªä¸éœ€è¦çš„ï¼Œæˆ–è€…ç›´æ¥åˆ›å»ºä¸ªæ–°æ•°ç»„çš„ä¸åŒ…å«è¿™ä¸ªè¦åˆ é™¤çš„å†…å®¹</p><p><strong>æ›¿æ¢å†…å®¹</strong>ï¼šåœ¨åŸæœ‰çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œä½¿ç”¨<code>map</code>ï¼Œå¦‚æœç¬¦åˆï¼Œæ”¹å˜è¿™ä¸ªå€¼ç„¶åè¿”å›ï¼Œä¸ç¬¦åˆçš„è¿”å›åŸæ¥çš„æ ·å­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [counters, setCounters] = <span class="title function_">useState</span>([xx, xxx]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextCounters = counters.<span class="title function_">map</span>(<span class="function">(<span class="params">c, i</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (i === index) &#123;</span><br><span class="line">    <span class="comment">// +1</span></span><br><span class="line">    <span class="keyword">return</span> c + <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸æ”¹å˜</span></span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">setCounters</span>(nextCounters);</span><br></pre></td></tr></table></figure><p><strong>æ’å…¥å†…å®¹</strong>ï¼šç¡®å®šè¦æ·»åŠ çš„ä½ç½®ï¼Œç„¶åä½¿ç”¨<code>slice</code>åˆ†å‰²æ•°ç»„ï¼Œå°†è¦æ·»åŠ çš„æ”¾åˆ°ä¸¤ä¸ªåˆ‡ç‰‡ä¸­é—´</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [artists, setArtists] = <span class="title function_">useState</span>([xxx, xx, x]);</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> insertAt = <span class="number">1</span>; <span class="comment">// ä»»ä½•è¦æ’å…¥çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">const</span> nextArtists = [</span><br><span class="line">  <span class="comment">// æ’å…¥ç‚¹å‰:</span></span><br><span class="line">  ...artists.<span class="title function_">slice</span>(<span class="number">0</span>, insertAt),</span><br><span class="line">  <span class="comment">// è¦æ’å…¥çš„:</span></span><br><span class="line">  &#123; <span class="attr">id</span>: nextId++, <span class="attr">name</span>: name &#125;,</span><br><span class="line">  <span class="comment">// æ’å…¥ç‚¹å:</span></span><br><span class="line">  ...artists.<span class="title function_">slice</span>(insertAt),</span><br><span class="line">];</span><br><span class="line"><span class="title function_">setArtists</span>(nextArtists);</span><br></pre></td></tr></table></figure><p><strong>å…¶ä»–æ“ä½œ</strong>ï¼šæ¯”å¦‚ _åè½¬_ï¼Œ_æ’åº_ï¼Œjs æ–¹æ³•ä¼šæ”¹å˜æ—§çš„æ•°ç»„ï¼Œæ‰€ä»¥è¦å…ˆå¤åˆ¶å‡ºä¸€ä¸ªæ•°ç»„ç„¶åå†åšå‡ºæ”¹å˜ï¼Œå¦‚<code>nextList.sort()</code>ï¼Œ<code>nextList[0] = &#123;name: &quot;zs&quot;, age: 18&#125;</code></p><blockquote><p>å¯¹äºæ•°ç»„ <em>list</em> å’Œ _nextList_ï¼Œè™½ç„¶ä¸æ˜¯ç›¸åŒçš„æ•°ç»„ï¼Œä½†æ˜¯<code>list[0]</code>å’Œ<code>nextList[0]</code>æŒ‡å‘çš„æ˜¯ç›¸åŒçš„å¯¹è±¡ï¼Œæ‰€ä»¥ç›´æ¥<code>nextList[0].age=19</code>è¿™æ ·çš„è¿˜æ˜¯ä¸æ¨èçš„ï¼Œå› ä¸ºè¿™æ˜¯æµ…æ‹·è´ï¼Œæ˜¯ç›´æ¥æ”¹æ‰äº†å¯¹è±¡é‡Œé¢çš„ä¸œè¥¿</p></blockquote><p><strong>ğŸ‘‰ æ›´æ–°æ•°ç»„é‡Œé¢çš„å¯¹è±¡</strong></p><p>å¯¹è±¡å…¶å®å¹¶ä¸æ˜¯å†æ•°ç»„é‡Œé¢çš„ï¼Œåªæ˜¯åœ¨ä»£ç è¿™é‡Œçœ‹èµ·æ¥æ˜¯åœ¨é‡Œé¢ï¼›ä½†äº‹å®ä¸Šå½“ä½¿ç”¨æ•°ç»„æ—¶ï¼ˆè™½ç„¶å·²ç»ä½¿ç”¨æ‹“å±•è¿ç®—ç¬¦å¤åˆ¶å‡ºä¸åŒçš„æ•°ç»„ï¼‰ï¼Œå°è¯•æ”¹å˜å…¶ä¸­æ•°ç»„å†…å…ƒç´ çš„å€¼ï¼Œå¦å¤–çš„å¼•ç”¨ä¹Ÿä¼šè·Ÿç€æ”¹å˜ï¼Œå› ä¸ºæ•°ç»„å®ƒå†…å®¹æœ¬èº«è¿˜æ˜¯å’Œæ—§æ•°ç»„ä¸€æ ·ï¼Œåªæ˜¯åœ¨æ–°çš„æ•°ç»„é‡Œé¢å‘†ç€ç½¢äº†</p><p>æ‰€ä»¥æ”¹å˜æ•°ç»„é‡Œé¢ä½ çš„å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨<code>map</code>æ‰¾å‡ºè¦æ”¹å˜çš„å¯¹è±¡ï¼Œç„¶åä½¿ç”¨æ›´æ–°å¯¹è±¡çš„æ–¹æ³•æ›´æ–°ç›®æ ‡å¯¹è±¡</p><h3 id="state-åŸºæœ¬ä½¿ç”¨"><a href="#state-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="state åŸºæœ¬ä½¿ç”¨"></a>state åŸºæœ¬ä½¿ç”¨</h3><ul><li>ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯ç»„ä»¶å†…éƒ¨<strong>ç§æœ‰</strong>çš„æ•°æ®ï¼Œåªèƒ½åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.component</span> &#123;</span><br><span class="line">  <span class="title function_">construtor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ES6 ä¸­ç±»çš„ç»§æ‰¿ä¸­è¦æ±‚è¦æœ‰çš„ï¼Œå¦‚æœæœ‰å‚æ•°å°±å¾—åœ¨å…¶ä¸­ä¼ é€’</span></span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–state</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>è®¡æ•°å™¨ï¼š&#123;this.state.count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.setState(&#123; count: this.state.count + 1 &#125;);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          +1</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>â— æ³¨ï¼šä¸èƒ½ç›´æ¥ä¿®æ”¹ state ä¸­çš„å€¼ï¼š<code>this.state.count++</code>ï¼Œè¿™æ ·æ˜¯é”™çš„</li></ul><p>ä¸Šé¢çš„è¯­æ³•æœ‰ä¸ªç®€åŒ–ç‰ˆçš„ï¼Œå»æ‰äº†æ„é€ å™¨å’Œ super</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>è®¡æ•°å™¨ï¼š&#123;this.state.count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="this-æŒ‡å‘é—®é¢˜è§£å†³-1"><a href="#this-æŒ‡å‘é—®é¢˜è§£å†³-1" class="headerlink" title="this æŒ‡å‘é—®é¢˜è§£å†³ 1"></a>this æŒ‡å‘é—®é¢˜è§£å†³ 1</h3><ul><li>ä½¿ç”¨ç®­å¤´å‡½æ•°è§£å†³</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.component</span> &#123;</span><br><span class="line">  <span class="title function_">construtor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å°†äº‹å‡å¤„ç†ä»£ç æŠ½ç¦»å‡ºæ¥ï¼Œä¼šå¸¦æ¥thisæŒ‡å‘é—®é¢˜,ä½¿ç”¨ç®­å¤´å‡½æ•°è§£å†³</span></span><br><span class="line">  <span class="title function_">add</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>è®¡æ•°å™¨ï¼š&#123;this.state.count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.add()&#125;&gt;+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>â— æ³¨ï¼šåœ¨<code>&lt;button&gt;</code>ä¸­è°ƒç”¨æ—¶ï¼Œå‡½æ•°åé¢<strong>è¦</strong>åŠ ä¸Š<code>()</code></li></ul><h3 id="this-æŒ‡å‘é—®é¢˜è§£å†³-2"><a href="#this-æŒ‡å‘é—®é¢˜è§£å†³-2" class="headerlink" title="this æŒ‡å‘é—®é¢˜è§£å†³ 2"></a>this æŒ‡å‘é—®é¢˜è§£å†³ 2</h3><ul><li>åˆ©ç”¨ ES5 ä¸­çš„<code>bind</code>æ–¹æ³•ç»‘å®š this</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.component</span> &#123;</span><br><span class="line">  <span class="title function_">construtor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="comment">// å°†äº‹å‡å¤„ç†ä»£ç æŠ½ç¦»å‡ºæ¥ï¼Œä¼šå¸¦æ¥thisæŒ‡å‘é—®é¢˜,ä½¿ç”¨bind()ç»‘å®š</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">add</span> = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">add</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>è®¡æ•°å™¨ï¼š&#123;this.state.count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.add&#125;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>â— æ³¨ï¼šåœ¨<code>&lt;button&gt;</code>ä¸­è°ƒç”¨æ—¶ï¼Œè¿™é‡Œå·²ç»ä¸æ˜¯å‡½æ•°è°ƒç”¨ï¼Œæ‰€ä»¥å‡½æ•°åé¢<strong>ä¸ç”¨</strong>åŠ ä¸Š<code>()</code></li></ul><h3 id="this-æŒ‡å‘é—®é¢˜è§£å†³-3"><a href="#this-æŒ‡å‘é—®é¢˜è§£å†³-3" class="headerlink" title="this æŒ‡å‘é—®é¢˜è§£å†³ 3"></a>this æŒ‡å‘é—®é¢˜è§£å†³ 3</h3><p>åŸºäºä¸Šé¢çš„å†…å®¹ï¼Œåªéœ€è¦ä¿®æ”¹<code>add()</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">add = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>è¿™æ˜¯å®éªŒæ€§è¯­æ³•ï¼Œä½†æ˜¯åœ¨<code>babel</code>ä¸­ä½¿ç”¨ä¸å¿…æ‹…å¿ƒ</li></ul><h2 id="è¡¨å•å¤„ç†"><a href="#è¡¨å•å¤„ç†" class="headerlink" title="è¡¨å•å¤„ç†"></a>è¡¨å•å¤„ç†</h2><h3 id="å—æ§ç»„ä»¶"><a href="#å—æ§ç»„ä»¶" class="headerlink" title="å—æ§ç»„ä»¶"></a>å—æ§ç»„ä»¶</h3><ul><li>HTML ä¸­çš„çŠ¶æ€ï¼ˆæ•°æ®ï¼‰æ˜¯å…ƒç´ è‡ªå·±æ§åˆ¶çš„ï¼Œä½†æ˜¯åœ¨ React ä¸­è¦åœ¨ state ä¸­ï¼Œå¹¶ä¸”åªèƒ½é€šè¿‡ setState æ¥ä¿®æ”¹</li><li>è§£å†³è¿™ä¸ªå†²çªï¼ŒReact å°†<code>state</code>å’Œå…ƒç´ çš„<code>value</code>ç»‘å®šåœ¨ä¸€èµ·</li><li>å—æ§ç»„ä»¶ï¼Œå°±æ˜¯å…¶å€¼æ˜¯å—åˆ° React æ§åˆ¶çš„</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œä½¿ç”¨ç®€å†™å½¢å¼</span></span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&quot;gz&quot;</span>,</span><br><span class="line">    <span class="attr">isCheck</span>: <span class="literal">false</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  handleChange = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">txt</span>: e.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  handleCity = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">city</span>: e.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  handleChecked = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">isCHecked</span>: e.<span class="property">target</span>.<span class="property">checked</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">value</span>=<span class="string">&#123;this.state.txt&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;this.handleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">value</span>=<span class="string">&#123;this.state.city&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.handleCity&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;sh&quot;</span>&gt;</span>ä¸Šæµ·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;bj&quot;</span>&gt;</span>åŒ—äº¬<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;gz&quot;</span>&gt;</span>å¹¿å·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">checked</span>=<span class="string">&#123;this.state.isChecked&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;this.handleChecked&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸŒ å¯ä»¥å¯¹ä¸Šé¢çš„ä»£ç è¿›è¡Œä¼˜åŒ–</p><ol><li>ç»™è¡¨å•å…ƒç´ æ·»åŠ <code>name</code>å±æ€§ï¼Œç”¨æ¥åŒºåˆ†ä¸åŒçš„è¡¨å•å…ƒç´ ï¼Œåç§°ä¸å¯¹åº”çš„<code>state</code>ç›¸åŒã€‚</li><li>æ ¹æ®è¡¨å•å…ƒç´ ç±»å‹è·å–å¯¹åº”çš„å€¼ã€‚ï¼ˆvalueã€checkedï¼‰</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">txt</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&quot;gz&quot;</span>,</span><br><span class="line">    <span class="attr">isCheck</span>: <span class="literal">false</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  handleForm = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–å½“å‰DOMå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">const</span> target = e.<span class="property">target</span>;</span><br><span class="line">    <span class="comment">// æ ¹æ®ç±»å‹è·å–å€¼</span></span><br><span class="line">    <span class="keyword">const</span> value = target.<span class="property">type</span> === <span class="string">&quot;checkbox&quot;</span> ? target.<span class="property">checked</span> : target.<span class="property">value</span>;</span><br><span class="line">    <span class="comment">// è·å–name</span></span><br><span class="line">    <span class="keyword">const</span> name = target.<span class="property">name</span>;</span><br><span class="line">    <span class="comment">// å¦‚æœä¸‹é¢çš„nameæ²¡æœ‰[]ï¼Œä»£è¡¨çš„æ˜¯åœ¨stateæ–°å¢ä¸€ä¸ªnameå±æ€§ï¼›ä½¿ç”¨[]è¡¨ç¤ºä¿®æ”¹stateå¯¹è±¡ä¸­å¯¹åº”çš„å€¼</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      [name]: value,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">name</span>=<span class="string">&quot;txt&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">value</span>=<span class="string">&#123;this.state.txt&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;this.handleForm&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;city&quot;</span> <span class="attr">value</span>=<span class="string">&#123;this.state.city&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.handleForm&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;sh&quot;</span>&gt;</span>ä¸Šæµ·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;bj&quot;</span>&gt;</span>åŒ—äº¬<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;gz&quot;</span>&gt;</span>å¹¿å·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">name</span>=<span class="string">&quot;isChecked&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">checked</span>=<span class="string">&#123;this.state.isChecked&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;this.handleForm&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="éå—æ§ç»„ä»¶"><a href="#éå—æ§ç»„ä»¶" class="headerlink" title="éå—æ§ç»„ä»¶"></a>éå—æ§ç»„ä»¶</h3><blockquote><p>é€šè¿‡<code>ref</code>ï¼Œä½¿ç”¨åŸç”Ÿ DOM æ¥è·å–è¡¨å•å…ƒç´ çš„å€¼</p></blockquote><ol><li>åˆ›å»ºä¸€ä¸ª ref å¯¹è±¡</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">constructor</span>(<span class="params"></span>) &#123;    <span class="variable language_">super</span>()    <span class="comment">// thisç‚¹åé¢è¿™ä¸ªåå­—éšä¾¿å–    this.txtRef = React.createRef()&#125;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>å°†åˆ›å»ºå¥½çš„ ref å¯¹è±¡æ”¾åˆ°ç›®æ ‡å…ƒç´ ä¸­</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> ref=&#123;<span class="variable language_">this</span>.<span class="property">txtRef</span>&#125; /&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>é€šè¿‡ ref è·å–åˆ°ç›®æ ‡å…ƒç´ çš„å€¼</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">txtRef</span>.<span class="property">current</span>.<span class="property">value</span>);</span><br></pre></td></tr></table></figure><blockquote><p>react ä¸­ä¸æ¨èç›´æ¥æ“ä½œ DOM</p></blockquote><h2 id="ä¿æŒç»„ä»¶æ•´æ´"><a href="#ä¿æŒç»„ä»¶æ•´æ´" class="headerlink" title="ä¿æŒç»„ä»¶æ•´æ´"></a>ä¿æŒç»„ä»¶æ•´æ´</h2><p><code>1ï¼š</code> ç»„ä»¶å°±åƒæ˜¯å…¬å¼ï¼Œä¸ä¼šæœ‰æ„æ–™ä¹‹å¤–çš„ç»“æœï¼Œæ¯”å¦‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">double</span>(<span class="params">number</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span> * number;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸€ç›´ä¼  2 å®ƒä¸€ç›´è¿”å› 4ï¼›ä¼  4ï¼Œå°±è¿”å› 8ï¼›</li></ul><p><code>2ï¼š</code> ä¿æŒä¸ºä¸€ä¸ªçº¯å‡½æ•°ï¼Œåªç®¡è‡ªå·±çš„äº‹ï¼Œåœ¨è°ƒç”¨è¿™ä¸ªç»„ä»¶ä¹‹å‰ï¼Œä¸ä¼šæ”¹å˜å­˜åœ¨çš„å˜é‡æˆ–å¯¹è±¡</p><p>âŒ ä¸å¥½çš„ç¤ºä¾‹ï¼šæ¯ä½¿ç”¨ä¸€æ¬¡ç»„ä»¶<code>guest</code>çš„å€¼å¢åŠ äº†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> guest = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Cup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// Bad: changing a preexisting variable!</span></span><br><span class="line">  guest = guest + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Tea cup for guest #&#123;guest&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">TeaSet</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Cup</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Cup</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Cup</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ­£ç¡®åšæ³•æ˜¯é€šè¿‡<code>propså°†å€¼ä¼ è¿›å»</code></li><li>æˆ–è€…å°†æ•°æ®åœ¨<code>TeaSet</code>ä¸­æ“ä½œ</li></ul><p><code>3ï¼š</code> â€œå‰¯ä½œç”¨â€ ä¸éœ€è¦ä¿æŒæ•´æ´ï¼Ÿ</p><p>å°±æ˜¯ä¸€äº› äº‹ä»¶å¤„ç†å™¨ ä¸éœ€è¦ è¿™æ ·ï¼Œå› ä¸ºæ¸²æŸ“çš„æ—¶å€™å®ƒä»¬å¹¶æ²¡æœ‰æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨ç­‰æ—¶é—´è§¦å‘ã€‚æ‰€ä»¥åœ¨è¿™å¯ä»¥æ”¹å˜ä¸€äº›ç”¨æˆ·çš„è¾“å…¥ã€å“åº”ç­‰</p><p><code>TBR:</code> <a href="https://react.dev/learn/keeping-components-pure">Keeping Components Pure</a></p><h1 id="ç»„ä»¶è¿›é˜¶"><a href="#ç»„ä»¶è¿›é˜¶" class="headerlink" title="ç»„ä»¶è¿›é˜¶"></a>ç»„ä»¶è¿›é˜¶</h1><h2 id="props"><a href="#props" class="headerlink" title="props"></a>props</h2><ul><li>æ¥æ”¶ä¼ é€’ç»™ç»„ä»¶çš„æ•°æ®</li><li>ä¼ é€’æ•°æ®ï¼šç»™ç»„ä»¶æ ‡ç­¾æ·»åŠ å±æ€§</li><li>æ¥æ”¶æ•°æ®ï¼šå‡½æ•°ç»„ä»¶é€šè¿‡å‚æ•°<code>props</code>æ¥æ”¶æ•°æ®ï¼Œç±»ç»„ä»¶é€šè¿‡<code>this.props</code>æ¥æ”¶æ•°æ®</li><li><code>props</code>åªå¯è¯»</li></ul><p>props æ˜¯åŠ¨æ€çš„ï¼Œå¹¶ä¸æ˜¯ç»„ä»¶è¢«åˆ›å»ºä¹‹åå°±å†™æ­»äº†çš„</p><ul><li>ä½†æ˜¯ props æ˜¯ä¸å¯å˜å¯¹è±¡</li><li>å½“ç»„ä»¶è¦æ”¹å˜å®ƒçš„ propsï¼Œé¦–å…ˆä¼šå‘çˆ¶ç»„ä»¶è¯·æ±‚æ‰€éœ€æ•°æ®æ¥ä¼ é€’ä¸åŒçš„ props</li><li>æ—§çš„ props è¢«ä¸¢å¼ƒï¼Œéšåè¢« JavaScript å¼•æ“å›æ”¶è¿™ä¸ª props å çš„å†…å­˜</li></ul><blockquote><p>ä¸è¦ç›´æ¥æ”¹å˜ props çš„å€¼ï¼Œéœ€è¦ä½¿ç”¨ <code>set state</code></p></blockquote><p><code>æ–°---</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Profile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Avatar</span> <span class="attr">person</span>=<span class="string">&#123;&#123;</span> <span class="attr">name:</span> &quot;<span class="attr">Lin</span> <span class="attr">Lanying</span>&quot;, <span class="attr">imageId:</span> &quot;<span class="attr">1bX5QH6</span>&quot; &#125;&#125; <span class="attr">size</span>=<span class="string">&#123;100&#125;</span> /&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * è¿™é‡Œçš„å‚æ•°ä¹Ÿå¯ä»¥ä¸å±•å¼€ï¼Œç›´æ¥ç”¨ä¸ªå¯¹è±¡ï¼Œæ•ˆæœä¸€æ ·ã€‚ä¸è¿‡å¯èƒ½é€šå¸¸ä¸éœ€è¦æ•´ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="comment"> * å¦‚æœè§£æ„ï¼Œä¸è¦å¿˜äº†å¤§æ‹¬å·</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Avatar</span>(<span class="params">&#123; person, size &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">img</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">className</span>=<span class="string">&quot;avatar&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">src</span>=<span class="string">&#123;getImageUrl(person)&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">alt</span>=<span class="string">&#123;person.name&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">width</span>=<span class="string">&#123;size&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">height</span>=<span class="string">&#123;size&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    /&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getImageUrl</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æŒ‡å®šé»˜è®¤å€¼</strong></p><p>å’Œ js ä¸€æ ·ï¼Œåœ¨å‚æ•°é‚£æŒ‡å®šå°±è¡Œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Avatar</span>(<span class="params">&#123; person, size = <span class="number">10</span> &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ²¡ä¼ é€’ <em>size</em> çš„æ—¶å€™ä¼šä½¿ç”¨é»˜è®¤å€¼ï¼Œæˆ–è€…æ˜¯ä¼ é€’ <code>size=&#123;undefined&#125;</code></li><li><code>size=&#123;null&#125;</code>æˆ–è€…<code>size=&#123;0&#125;</code>ï¼Œä¸ä¼šä½¿ç”¨é»˜è®¤å€¼</li></ul><p><strong>æ›´ç®€æ´çš„ä¼ é€’ props</strong></p><blockquote><p>å‰ææ˜¯è¦æƒ³å¥½ä½¿ç”¨åœºæ™¯ï¼Ÿæ¯”å¦‚çˆ¶ç»„ä»¶å°±æ˜¯éœ€è¦è§£æ„ï¼Œé‚£æ²¡åŠæ³•</p></blockquote><p>ä¸ç®€æ´çš„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Profile</span>(<span class="params">&#123; person, size, isSepia, thickBorder &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Avatar</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">person</span>=<span class="string">&#123;person&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">size</span>=<span class="string">&#123;size&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">isSepia</span>=<span class="string">&#123;isSepia&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">thickBorder</span>=<span class="string">&#123;thickBorder&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿™é‡Œçˆ¶ç»„ä»¶æ¥æ”¶åˆ°çš„ props ç„¶ååˆåŸå°ä¸åŠ¨å†å†™ä¸€æ¬¡ä¼ ç»™å­ç»„ä»¶ï¼Œæœ‰ç‚¹éº»çƒ¦</li></ul><p>å¯ä»¥è¿™æ ·</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Profile</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Avatar</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>æ—§---</code></p><p>å‡½æ•°ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. æ¥æ”¶æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Hello</span> = props =&gt; &#123;</span><br><span class="line">  <span class="comment">// propsæ˜¯ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 1. ä¼ é€’å‚æ•°</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Hello</span> <span class="attr">name</span>=<span class="string">&quot;tom&quot;</span> <span class="attr">age</span>=<span class="string">&#123;10&#125;</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><p>ç±»ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. æ¥æ”¶æ•°æ®</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœä½¿ç”¨æ„é€ å™¨ï¼Œsuperçš„å‚æ•°å¿…é¡»ä¼ propsï¼ˆåªé’ˆå¯¹æ„é€ å™¨é‡Œé¢ï¼‰</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ä¸Šé¢æ„é€ å™¨çš„superä¼ ä¸ä¼ å‚æ•°ï¼Œä¸‹é¢çš„renderéƒ½å¯ä»¥æ¥æ”¶åˆ°props</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;this.props.age&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;tag&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1. ä¼ é€’å‚æ•°</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Hello</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">name</span>=<span class="string">&quot;tom&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">age</span>=<span class="string">&#123;10&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">fn</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">      console.log(&quot;è¿™æ˜¯ä¸€ä¸ªå‡½æ•°&quot;);</span></span><br><span class="line"><span class="language-xml">    &#125;&#125;</span></span><br><span class="line"><span class="language-xml">    tag=&#123;<span class="tag">&lt;<span class="name">p</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªpæ ‡ç­¾<span class="tag">&lt;/<span class="name">p</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">  /&gt;</span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><blockquote><p>ä¼ é€’éå­—ç¬¦ä¸²çš„å†…å®¹è¦ä½¿ç”¨<code>&#123;&#125;</code>åŒ…èµ·æ¥</p></blockquote><h2 id="props-æ·±å…¥"><a href="#props-æ·±å…¥" class="headerlink" title="props æ·±å…¥"></a>props æ·±å…¥</h2><h3 id="children-å±æ€§"><a href="#children-å±æ€§" class="headerlink" title="children å±æ€§"></a>children å±æ€§</h3><ul><li>ä¼ é€’ JSX ä½œä¸ºå­ç»„ä»¶</li></ul><p>é€šè¿‡<code>props.children</code>è·å¾—</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Avatar</span> <span class="keyword">from</span> <span class="string">&quot;./Avatar.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Card</span>(<span class="params">&#123; children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;card&quot;</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Profile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Card</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Avatar</span> <span class="attr">size</span>=<span class="string">&#123;100&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç»„ä»¶æ ‡ç­¾å­èŠ‚ç‚¹<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;props.children&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// æ­£å¸¸æƒ…å†µä¸‹ï¼Œprops.children ä¸ºç©º</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ ä¸Šå­èŠ‚ç‚¹åï¼Œprops.children ä¸ºï¼šæˆ‘æ˜¯å­èŠ‚ç‚¹</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span>&gt;</span>æˆ‘æ˜¯å­èŠ‚ç‚¹<span class="tag">&lt;/<span class="name">App</span>&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><ul><li>å­èŠ‚ç‚¹å¯ä»¥ä¸ºä»»æ„çš„<code>jsx</code>è¡¨è¾¾å¼ã€ç»„ä»¶ã€å‡½æ•°</li><li>å¦‚æœæ˜¯å‡½æ•°ï¼Œç›´æ¥ä½¿ç”¨<code>props.children()</code>ï¼Œå¤–é¢ä¸ç”¨åŠ  {}</li></ul><h3 id="props-æ ¡éªŒ"><a href="#props-æ ¡éªŒ" class="headerlink" title="props æ ¡éªŒ"></a>props æ ¡éªŒ</h3><ul><li>åœ¨åˆ›å»ºç»„ä»¶çš„æ—¶å€™å°±æŒ‡å®š<code>props</code>çš„ç±»å‹æˆ–è€…æ ¼å¼</li></ul><p>åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œå…ˆå®‰è£…<code>prop-types</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install props-types</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&quot;prop-types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> arr = props.<span class="property">colors</span>;</span><br><span class="line">  <span class="keyword">const</span> list = arr.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æ ¡éªŒ</span></span><br><span class="line"><span class="title class_">App</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="comment">// è§„å®šä¸ºæ•°ç»„ç±»å‹</span></span><br><span class="line">  <span class="attr">colors</span>: <span class="title class_">PropTypes</span>.<span class="property">array</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> <span class="attr">colors</span>=<span class="string">&#123;[</span>&quot;<span class="attr">red</span>&quot;, &quot;<span class="attr">yellow</span>&quot;]&#125; /&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li><code>PropTypes.</code>åé¢çš„å°±æ˜¯çº¦æŸè§„åˆ™</li></ul><p>âš  çº¦æŸè§„åˆ™ï¼š</p><ol><li>å¸¸è§çš„çº¦æŸç±»å‹ï¼šarrayã€boolã€funcã€numberã€objectã€string</li><li>React å…ƒç´ ç±»å‹ï¼šelement</li><li>å¿…å¡«é¡¹ï¼šisRequiredï¼ˆåœ¨çº¦æŸè§„åˆ™åç‚¹ä½¿ç”¨ï¼‰</li><li>ç‰¹å®šç»“æ„çš„å¯¹è±¡ï¼šshape({ })</li><li>â€¦â€¦</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&quot;prop-types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æ ¡éªŒ</span></span><br><span class="line"><span class="title class_">App</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">  <span class="attr">fn</span>: <span class="title class_">PropTypes</span>.<span class="property">func</span>.<span class="property">isRequired</span>,</span><br><span class="line">  <span class="attr">tag</span>: <span class="title class_">PropTypes</span>.<span class="property">element</span>,</span><br><span class="line">  <span class="attr">filter</span>: <span class="title class_">PropTypes</span>.<span class="title function_">shape</span>(&#123;</span><br><span class="line">    <span class="attr">area</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>,</span><br><span class="line">    <span class="attr">price</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> <span class="attr">fn</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;&#125;&#125; /&gt;</span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="props-é»˜è®¤å€¼"><a href="#props-é»˜è®¤å€¼" class="headerlink" title="props é»˜è®¤å€¼"></a>props é»˜è®¤å€¼</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ é»˜è®¤å€¼ï¼Œå½“ç»„ä»¶ä¸ä¼ å€¼çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨è¿™ä¸ªé»˜è®¤å€¼</span></span><br><span class="line"><span class="title class_">App</span>.<span class="property">defaultProps</span> = &#123;</span><br><span class="line">  <span class="attr">pageSize</span>: <span class="number">10</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="render-props"><a href="#render-props" class="headerlink" title="render props"></a>render props</h2><ul><li>ç”¨äºç»„ä»¶å¤ç”¨</li><li>å¤ç”¨ state å’Œæ“ä½œ state çš„æ–¹æ³•</li></ul><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><blockquote><p>è¿™ä¸ª render åå­—æ˜¯éšä¾¿å–çš„</p></blockquote><p>ä½¿ç”¨ç»„ä»¶æ—¶æ‹¿åˆ°ç»„ä»¶å†…éƒ¨çš„ propsï¼Œå¯ä»¥ç»™ç»„ä»¶æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åé€šè¿‡å‡½æ•°çš„å‚æ•°æ¥è·å–ã€‚<code>&lt;Mouse render=&#123; (mouse) =&gt; &#123;&#125; &#125; /&gt;</code>ï¼Œç„¶åå‡½æ•°çš„è¿”å›å€¼ä½œä¸ºé¡µé¢è¦æ¸²æŸ“çš„ç»“æ„ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨å›¾ç‰‡å…ˆè¦å¯¼å…¥</span></span><br><span class="line"><span class="keyword">import</span> img <span class="keyword">from</span> <span class="string">&quot;./image/cat.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“å‰ç»„ä»¶æœ‰çŠ¶æ€ï¼Œä¹Ÿæœ‰ä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Mouse</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// é¼ æ ‡ç§»åŠ¨å¤„ç†ç¨‹åº</span></span><br><span class="line">  handleMouseMove = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">x</span>: e.<span class="property">clientX</span>,</span><br><span class="line">      <span class="attr">y</span>: e.<span class="property">clientY</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// ç›‘å¬é¼ æ ‡ç§»åŠ¨çš„ä»£ç </span></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, <span class="variable language_">this</span>.<span class="property">handleMouseMove</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// this.props.renderæ˜¯åœ¨ä½¿ç”¨&lt;Mouse /&gt;çš„æ—¶å€™ä¼ é€’çš„ã€‚è¿™ä¸ªrenderåå­—æ˜¯éšä¾¿çš„ï¼Œç”±&lt;Mouse /&gt;è°ƒç”¨æ—¶æä¾›</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">render</span>(<span class="variable language_">this</span>.<span class="property">state</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">reutrn</span>(</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>render props æ¨¡å¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Mouse</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">render</span>=<span class="string">&#123;mouse</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                é¼ æ ‡ä½ç½®ï¼š&#123;mouse.x&#125; &#123;mouse.y&#125;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            );</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">        &#123;/* å¤ç”¨ä¸€ä¸ª<span class="tag">&lt;<span class="name">Mouse</span> /&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Mouse</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">render</span>=<span class="string">&#123;mouse</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">img</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">src</span>=<span class="string">&#123;img&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">alt</span>=<span class="string">&quot;çŒ«&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">position:</span> &quot;<span class="attr">absolute</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">top:</span> &quot;<span class="attr">mouse.y</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">left:</span> &quot;<span class="attr">mouse.x</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              /&gt;</span></span></span><br><span class="line"><span class="language-xml">            );</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨<code>class Mouse</code>ä¸­ï¼Œç»„ä»¶æ˜¯è¦è¿”å›å†…å®¹çš„ï¼Œä½†æ˜¯åœ¨å¤ç”¨ç»„ä»¶çš„æƒ…å†µä¸‹ï¼Œ<code>class Mouse</code>å¹¶ä¸çŸ¥é“è¦è¿”å›ä»€ä¹ˆï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨<code>&lt;Mouse /&gt;</code>æ—¶å€™æä¾›çš„è¦æ¸²æŸ“çš„å†…å®¹ï¼Œç„¶ååœ¨<code>this.props.render</code>ä¸­æ¥æ”¶</li><li>æ„æ€å°±æ˜¯å£°æ˜<code>&lt;Mouse /&gt;</code>ï¼Œå’Œä½¿ç”¨<code>&lt;Mouse /&gt;</code></li></ul><h3 id="children-å–ä»£-render"><a href="#children-å–ä»£-render" class="headerlink" title="children å–ä»£ render"></a>children å–ä»£ render</h3><p>ğŸ¡ æ ¼å¼ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// åœ¨ class Mouseä¸­ä¿®æ”¹</span></span><br><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">children</span>(<span class="variable language_">this</span>.<span class="property">state</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åœ¨ä½¿ç”¨&lt;Mouse /&gt;æ—¶</span></span><br><span class="line"><span class="comment">// åŒæ ·ï¼Œåœ¨ä½¿ç”¨æ—¶å‚æ•°å¯¹åº”çš„æ˜¯çŠ¶æ€å€¼ï¼Œè¿”å›å€¼å¯¹åº”çš„æ˜¯è¦æ¸²æŸ“çš„å†…å®¹</span></span><br><span class="line">&lt;<span class="title class_">Mouse</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">        <span class="function"><span class="params">mouse</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ( <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>é¼ æ ‡ä½ç½®ï¼š&#123;mouse.x&#125; &#123;mouse.y&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span> )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/<span class="title class_">Mouse</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="ä»£ç ä¼˜åŒ–"><a href="#ä»£ç ä¼˜åŒ–" class="headerlink" title="ä»£ç ä¼˜åŒ–"></a>ä»£ç ä¼˜åŒ–</h3><p>æ ¡éªŒ</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Mouse</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="attr">children</span>: <span class="title class_">Proptypes</span>.<span class="property">func</span>.<span class="property">isRequired</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç§»é™¤<code>mousemove</code>äº‹ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    windows.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, <span class="variable language_">this</span>.<span class="property">handleMouseMove</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»„ä»¶ä¹‹é—´çš„é€šè®¯"><a href="#ç»„ä»¶ä¹‹é—´çš„é€šè®¯" class="headerlink" title="ç»„ä»¶ä¹‹é—´çš„é€šè®¯"></a>ç»„ä»¶ä¹‹é—´çš„é€šè®¯</h2><h3 id="çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶"><a href="#çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶" class="headerlink" title="çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶"></a>çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶</h3><ul><li>çˆ¶ç»„ä»¶æä¾›è¦ä¼ é€’çš„<code>state</code>æ•°æ®</li><li>å­ç»„ä»¶æ ‡ç­¾æ·»åŠ å±æ€§ï¼Œå€¼ä¸º<code>state</code>ä¸­çš„æ•°æ®</li><li>å­ç»„ä»¶é€šè¿‡<code>props</code>æ¥æ”¶çˆ¶ç»„ä»¶ä¸­ä¼ é€’çš„æ•°æ®</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">lastName</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        çˆ¶ç»„ä»¶ï¼š</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child</span> <span class="attr">name</span>=<span class="string">&#123;this.state.lastName&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>å­ç»„ä»¶ï¼Œæ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„æ•°æ®ã€‚&#123;props.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Parent</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="å­ç»„ä»¶ä¼ ç»™çˆ¶ç»„ä»¶"><a href="#å­ç»„ä»¶ä¼ ç»™çˆ¶ç»„ä»¶" class="headerlink" title="å­ç»„ä»¶ä¼ ç»™çˆ¶ç»„ä»¶"></a>å­ç»„ä»¶ä¼ ç»™çˆ¶ç»„ä»¶</h3><ul><li>çˆ¶ç»„ä»¶æä¾›å›è°ƒå‡½æ•°ï¼Œç”¨æ¥æ¥æ”¶æ•°æ®ï¼ˆ<strong>è°è¦æ¥æ”¶æ•°æ®ï¼Œè°å°±æä¾›å›è°ƒå‡½æ•°</strong>ï¼‰</li><li>å°†æ”¹å‡½æ•°ä½œä¸ºå±æ€§çš„å€¼ï¼Œä¼ é€’ç»™å­ç»„ä»¶</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">parentMsg</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  getChildMsg = <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ¥æ”¶å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ•°æ®&quot;</span>, data);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">parentMsg</span>: data,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        çˆ¶ç»„ä»¶ï¼šç»™å­ç»„ä»¶æä¾›äº†å‡½æ•°</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child</span> <span class="attr">getMsg</span>=<span class="string">&#123;this.getChildMsg&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;this.state.parentMsg&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">msg</span>: <span class="string">&quot;ä½ å¥½&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶æä¾›çš„å›è°ƒå‡½æ•°ï¼Œä»è€Œä¼ é€’å†…å®¹</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">getMsg</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">msg</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        å­ç»„ä»¶ï¼š<span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>ç»™çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…„å¼Ÿç»„ä»¶ä¼ å€¼"><a href="#å…„å¼Ÿç»„ä»¶ä¼ å€¼" class="headerlink" title="å…„å¼Ÿç»„ä»¶ä¼ å€¼"></a>å…„å¼Ÿç»„ä»¶ä¼ å€¼</h3><ul><li>å°†è¦å…±äº«çš„æ•°æ®æå‡åˆ°æœ€è¿‘çš„å…¬å…±åº¦ç»„ä»¶ä¸­</li><li>å…¬å…±çˆ¶ç»„ä»¶è¦åšçš„äº‹ï¼šæä¾›å…±äº«æ•°æ®ã€æä¾›æ“ä½œå…±äº«æ•°æ®çš„æ–¹æ³•</li><li>è¦ä¼ å€¼çš„å­ç»„ä»¶é€šè¿‡<code>props</code>æ¥æ”¶æ•°æ®æˆ–æ˜¯æ¥æ”¶æ“ä½œæ•°æ®çš„æ–¹æ³•</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// æä¾›å…±äº«çŠ¶æ€</span></span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// æä¾›ä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•</span></span><br><span class="line">  add = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child1</span> <span class="attr">count</span>=<span class="string">&#123;this.state.count&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child2</span> <span class="attr">add</span>=<span class="string">&#123;this.add&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child1</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>è®¡æ•°å™¨ï¼š&#123;props.count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child2</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> props.add()&#125;&gt;+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h3><ol><li>ä½¿ç”¨<code>React.createContext()</code>åˆ›å»º<code>Provider</code>å’Œ<code>Consumer</code>ä¸¤ä¸ªç»„ä»¶</li><li>ä½¿ç”¨<code>&lt;Provider&gt;</code>å°†çˆ¶ç»„ä»¶åŒ…èµ·æ¥</li><li>è®¾ç½®<code>value</code>å±æ€§ï¼Œè¡¨ç¤ºè¦ä¼ é€’çš„å€¼</li><li>ä½¿ç”¨<code>&lt;Consumer&gt;</code>ç»„ä»¶æ¥æ”¶æ•°æ®</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Provider</span>, <span class="title class_">Consumer</span> &#125; = <span class="title class_">React</span>.<span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">value</span>=<span class="string">&quot;pink&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Node</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Node</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">SubNode</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">SubNode</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">SubNode</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Consumer</span>&gt;</span>&#123;data =&gt; <span class="tag">&lt;<span class="name">span</span>&gt;</span>æˆ‘æ˜¯å­èŠ‚ç‚¹ &#123;data&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;<span class="tag">&lt;/<span class="name">Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"></a>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h2><p>ğŸ“š <a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/">è¯¦ç»†æŒ‡å¯¼</a></p><ul><li>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼šç»„ä»¶ä»è¢«åˆ›å»ºåˆ°æŒ‚è½½åˆ°é¡µé¢ä¸­è¿è¡Œï¼Œå†åˆ°ç»„ä»¶ä¸ç”¨æ—¶å¸è½½çš„è¿‡ç¨‹</li><li>åªæœ‰ç±»ç»„ä»¶æ‰æœ‰ç”Ÿå‘½å‘¨æœŸ</li></ul><p><img src="https://github.com/wojtekmaj/react-lifecycle-methods-diagram/blob/master/src/static/ogimage.png?raw=true" alt="å¸¸ç”¨ç”Ÿå‘½å‘¨æœŸ"></p><p>ğŸ’¤ ä¸å¸¸ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼š<a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/">ç‚¹æˆ‘</a>ğŸ˜</p><table><thead><tr><th>åˆ›å»ºæ—¶</th><th>æ›´æ–°æ—¶</th><th>å¸è½½æ—¶</th></tr></thead><tbody><tr><td>constructorã€æ›´æ–° DOM å’Œ refs æ—¶ã€componentDidMount</td><td>constructorã€æ›´æ–° DOM å’Œ refs æ—¶ã€renderã€componentDidUpdate</td><td>componentWillUnmount</td></tr></tbody></table><h3 id="åˆ›å»ºæ—¶"><a href="#åˆ›å»ºæ—¶" class="headerlink" title="åˆ›å»ºæ—¶"></a>åˆ›å»ºæ—¶</h3><p>ğŸš² æ‰§è¡Œé¡ºåºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A(constructor) --&gt;B(render)</span><br><span class="line">B--&gt;C(componentDidMount)</span><br></pre></td></tr></table></figure><table><thead><tr><th>é’©å­å‡½æ•°</th><th>è§¦å‘æ—¶æœº</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>constructor</td><td>åˆ›å»ºç»„ä»¶æ—¶ï¼Œæœ€å…ˆæ‰§è¡Œ</td><td>1. åˆå§‹åŒ– stateã€2. ä¸ºäº‹ä»¶å¤„ç†ç¨‹åºç»‘å®š this</td></tr><tr><td>render</td><td>æ¯æ¬¡ç»„ä»¶æ¸²æŸ“éƒ½ä¼šè§¦å‘</td><td>æ¸²æŸ“ç•Œé¢ï¼ˆ**ä¸èƒ½è°ƒç”¨<code>setState()</code>**ï¼‰</td></tr><tr><td>componentDidMount</td><td>ç»„ä»¶æŒ‚è½½ï¼ˆå®Œæˆ DOM æ¸²æŸ“ï¼‰å</td><td>1. å‘é€ç½‘ç»œè¯·æ±‚ã€2. DOM æ“ä½œ</td></tr></tbody></table><ul><li><code>componentDidMount</code>æ˜¯åœ¨<code>render()</code>ã€<code>constructor()</code>å¤–é¢ç›´æ¥å‡½æ•°è°ƒç”¨çš„ï¼Œæ˜¯ç±»çš„ä¸€ä¸ªæˆå‘˜</li></ul><h3 id="æ›´æ–°æ—¶"><a href="#æ›´æ–°æ—¶" class="headerlink" title="æ›´æ–°æ—¶"></a>æ›´æ–°æ—¶</h3><ul><li>å¯¼è‡´ç»„ä»¶æ›´æ–°çš„æƒ…å†µï¼šnew propsã€setState()ã€forceUpdate()</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>(props)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">            <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// åªè¦è°ƒç”¨setStateï¼Œé¡µé¢å°±ä¼šé‡æ–°æ¸²æŸ“ï¼Œå°±æ˜¯è°ƒç”¨render</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">            <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// å¼ºåˆ¶æ›´æ–°</span></span><br><span class="line">        <span class="comment">// this.forceUpdate()</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼šrender&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Counter</span> <span class="attr">count</span>=<span class="string">&#123;this.state.count&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>æ‰“è±†è±†<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å­ç»„ä»¶---ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼šrender&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç»Ÿè®¡æ‰“è±†è±†çš„æ¬¡æ•°ï¼š&#123;this.props.count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">componentDidUpdate</span>(<span class="params">prevProps</span>) &#123;</span><br><span class="line">    <span class="comment">// æ¯”è¾ƒæ›´æ–°å‰åpropsæ˜¯å¦ç›¸åŒï¼Œè¿›è€Œå†³å®šè¦ä¸è¦é‡æ–°æ¸²æŸ“å†…å®¹</span></span><br><span class="line">    <span class="comment">// prevPropsï¼šä¸Šä¸€æ¬¡props</span></span><br><span class="line">    <span class="comment">// this.propsï¼šå½“å‰props</span></span><br><span class="line">    <span class="keyword">if</span> (prevProps.<span class="property">count</span> !== <span class="variable language_">this</span>.<span class="property">props</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">            <span class="comment">// TODO</span></span><br><span class="line">        &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;componentDidUpdate&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸš™ æ‰§è¡Œé¡ºåºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A(render) --&gt; B(componentDidUpdate)</span><br></pre></td></tr></table></figure><table><thead><tr><th>é’©å­å‡½æ•°</th><th>è§¦å‘æ—¶æœº</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>render</td><td>æ¯æ¬¡ç»„ä»¶æ¸²æŸ“éƒ½ä¼šè§¦å‘</td><td>æ¸²æŸ“ç•Œé¢</td></tr><tr><td>componentDidUpdate</td><td>ç»„ä»¶æ›´æ–°ï¼ˆå®Œæˆ DOM æ¸²æŸ“ï¼‰å</td><td>1. å‘é€ç½‘ç»œè¯·æ±‚ã€2. DOM æ“ä½œã€<strong>å¦‚æœè¦<code>setState()</code>ï¼Œå¿…é¡»æ”¾åœ¨ä¸€ä¸ª<code>if</code>æ¡ä»¶ä¸­</strong></td></tr></tbody></table><ul><li>å¦‚æœæ²¡æœ‰åœ¨ if é‡Œé¢è°ƒç”¨ï¼Œå°±ä¼šé€ æˆé€’å½’æ›´æ–°ï¼ˆæ‰§è¡Œå¤ªå¤šæ¬¡ååœä¸‹æ¥æŠ¥é”™ï¼‰</li></ul><h3 id="å¸è½½æ—¶"><a href="#å¸è½½æ—¶" class="headerlink" title="å¸è½½æ—¶"></a>å¸è½½æ—¶</h3><table><thead><tr><th>é’©å­å‡½æ•°</th><th>è§¦å‘æ—¶æœº</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>componentWillUnmount</td><td>ç»„ä»¶å¸è½½ï¼ˆä»é¡µé¢æ¶ˆå¤±ï¼‰</td><td>æ‰§è¡Œæ¸…ç†å·¥ä½œï¼ˆå¦‚ï¼šæ¸…ç†å®šæ—¶å™¨ï¼‰</td></tr></tbody></table><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> &gt; <span class="number">3</span></span><br><span class="line">        ? <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>è±†è±†è¢«æ‰“GGäº†<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">        : <span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> <span class="attr">count</span>=<span class="string">&#123;this.state.count&#125;</span> /&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">   &lt;button onClick=&#123;<span class="variable language_">this</span>.<span class="property">handleClick</span>&#125;&gt;æ‰“è±†è±†&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .....</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è±†è±†è¢«GGï¼Œæˆ‘è¢«è§¦å‘äº†&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é«˜é˜¶ç»„ä»¶"><a href="#é«˜é˜¶ç»„ä»¶" class="headerlink" title="é«˜é˜¶ç»„ä»¶"></a>é«˜é˜¶ç»„ä»¶</h2><ul><li>ä¹Ÿæ˜¯ç”¨äºç»„ä»¶çš„å¤ç”¨ï¼ŒåŒ…è£…ç»„ä»¶ï¼Œå¢å¼ºç»„ä»¶çš„åŠŸèƒ½</li><li><code>HOC,Higher-Order Component</code>ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶è¦åŒ…è£…çš„ç»„ä»¶ï¼Œè¿”å›å¢å¼ºåçš„ç»„ä»¶</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">EnhancedComponent</span> = <span class="title function_">withHOC</span>(<span class="title class_">WrappedComponent</span>);</span><br></pre></td></tr></table></figure><p>é«˜é˜¶ç»„ä»¶å†…éƒ¨åˆ›å»ºä¸€ä¸ªç±»ç»„ä»¶ï¼Œåœ¨è¿™ä¸ªç±»ç»„ä»¶ä¸­æä¾›å¤ç”¨çš„çŠ¶æ€é€»è¾‘ä»£ç ï¼Œé€šè¿‡ prop å°†å¤ç”¨çš„çŠ¶æ€ä¼ é€’ç»™è¢«åŒ…è£…ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Mouse</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...this.state</span>&#125; /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŸºæœ¬ä½¿ç”¨-2"><a href="#åŸºæœ¬ä½¿ç”¨-2" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. åˆ›å»ºé«˜é˜¶ç»„ä»¶ï¼Œå‚æ•°è¦ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œå› ä¸ºæ˜¯è¦ä½œä¸ºè¢«æ¸²æŸ“çš„ç»„ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">withMouse</span>(<span class="params">WrappedComponent</span>) &#123;</span><br><span class="line">  <span class="comment">// 2. è¯¥ç»„ä»¶æä¾›å¤ç”¨çš„çŠ¶æ€é€»è¾‘</span></span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">Mouse</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="comment">// 2.1 é¼ æ ‡çŠ¶æ€</span></span><br><span class="line">    state = &#123;</span><br><span class="line">      <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 2.2 æ§åˆ¶é¼ æ ‡çŠ¶æ€çš„é€»è¾‘</span></span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, <span class="variable language_">this</span>.<span class="property">handleMouseMove</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, <span class="variable language_">this</span>.<span class="property">handleMouseMove</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 3. æ¸²æŸ“ç»„ä»¶å¹¶ä¸”å°†çŠ¶æ€ä½œä¸ºå‚æ•°ä¼ é€’ã€‚åŒæ ·ä¸æä¾›å…·ä½“ç•Œé¢ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™æä¾›ç•Œé¢</span></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...this.state</span>&#125; /&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Mouse</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. æµ‹è¯•é«˜é˜¶ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Position</span> = props =&gt; (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    é¼ æ ‡å½“å‰ä½ç½®ï¼š( x: &#123;props.x&#125;, y: &#123;props.y&#125; )</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="comment">// æµ‹è¯•é«˜é˜¶ç»„ä»¶2</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Cat</span> = props =&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;src&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;cat&quot;</span> /&gt;</span></span>;</span><br><span class="line"><span class="comment">// 5. è·å–å¢å¼ºåçš„ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MousePosition</span> = <span class="title function_">withMouse</span>(<span class="title class_">Position</span>);</span><br><span class="line"><span class="comment">// è·å–å¢å¼ºåçš„ç»„ä»¶2</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CatPosition</span> = <span class="title function_">withMouse</span>(<span class="title class_">Cat</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* 6. æ¸²æŸ“å¢å¼ºåçš„é«˜é˜¶ç»„ä»¶ */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MousePosition</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">CatPosition</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="displayName"><a href="#displayName" class="headerlink" title="displayName"></a>displayName</h3><ul><li>åœ¨æµè§ˆå™¨çš„ React å¼€å‘è€…å·¥å…·ä¸­ï¼Œå¤ç”¨çš„ç»„ä»¶åå­—æ˜¾ç¤ºéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¦è®¾ç½®<code>displayName</code>ï¼Œè®¾ç½®ä¸ä¸€æ ·çš„åå­—ï¼Œä¾¿äºè°ƒè¯•ï¼ˆReact Developer Toolsï¼‰</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">withMouse</span>(<span class="params">WrappedComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">Mouse</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.component</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è®¾ç½®displayName</span></span><br><span class="line">  <span class="title class_">Mouse</span>.<span class="property">displayName</span> = <span class="string">` WithMouse<span class="subst">$&#123;getDisplayName(WrappedComponent)&#125;</span> `</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Mouse</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDisplayName</span>(<span class="params">WrappedComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">WrappedComponent</span>.<span class="property">displayName</span> || <span class="title class_">WrappedComponent</span>.<span class="property">name</span> || <span class="string">&quot;Component&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¼ é€’-props"><a href="#ä¼ é€’-props" class="headerlink" title="ä¼ é€’ props"></a>ä¼ é€’ props</h3><ul><li>props ä¸¢å¤±</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Position</span> = props =&gt; &#123;</span><br><span class="line">  <span class="comment">// 2. propsä¸­æ²¡å¾—åˆ°a</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(props);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      é¼ æ ‡å½“å‰ä½ç½®ï¼š( x: &#123;props.x&#125;, y: &#123;props.y&#125; )</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// 1. åœ¨ç»„ä»¶ä¸­ä¼ é€’å‚æ•°</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MousePosition</span> <span class="attr">a</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨<code>&lt;Mosue /&gt;</code>ä¸­æ˜¯å¯ä»¥å¾—åˆ° props çš„ï¼Œä½†æ˜¯å°±æ²¡å†å¾€ä¸‹ä¼ äº†</li></ul><p>ä¿®æ”¹ï¼Œåœ¨<code>class Mouse</code>ï¼Œç»§ç»­ä¼ ä¸‹å»</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...this.state</span>&#125; &#123;<span class="attr">...this.props</span>&#125; /&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="React-åŸç†"><a href="#React-åŸç†" class="headerlink" title="React åŸç†"></a>React åŸç†</h1><blockquote><p>ç»„ä»¶æ›´æ–°æœºåˆ¶ï¼šçˆ¶ç»„ä»¶æ›´æ–°ï¼Œå…¶ä¸‹é¢çš„å­ç»„ä»¶éƒ½ä¼šæ›´æ–°ï¼Œå­ç»„ä»¶çš„å­ç»„ä»¶ä¹Ÿä¼šæ›´æ–°</p></blockquote><h2 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h2><p><em>Hooks</em> æ˜¯ä»…åœ¨ React æ˜¾ç„¶çš„æ—¶å€™å¯ç”¨çš„å‡½æ•°ï¼Œéƒ½æ˜¯ä»¥<code>use</code>å¼€å¤´çš„ï¼Œæ¯”å¦‚<code>useState</code></p><h2 id="setState-è¯´æ˜"><a href="#setState-è¯´æ˜" class="headerlink" title="setState è¯´æ˜"></a>setState è¯´æ˜</h2><p>1ï¸âƒ£ <code>setState()</code>æ•°æ®æ›´æ–°æ˜¯å¼‚æ­¥çš„</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 2. å†æ›´æ–°</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span>, <span class="comment">// 1+1</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 2.1 å¦‚æœå†æ¬¡è°ƒç”¨</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span>, <span class="comment">// 1+1</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 1. å…ˆè¾“å‡º</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;count: &quot;</span>, <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><code>setState()</code>æ˜¯å¯ä»¥è°ƒç”¨å¤šæ¬¡çš„ï¼Œå› ä¸ºæ˜¯å¼‚æ­¥çš„åŸå› ï¼Œæ‰€ä»¥åé¢<code>setState()</code>çš„æ‰§è¡Œä¸è¦ä¾èµ–å‰é¢æ‰§è¡Œçš„ç»“æœ</li><li>ä½†æ˜¯<code>render()</code>åªä¼šæ‰§è¡Œä¸€æ¬¡</li></ul><p>2ï¸âƒ£ æ¨èè¯­æ³•ï¼š<code>setState( (state, props) =&gt; &#123;&#125; )</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åŒæ ·ä¹Ÿæ˜¯å¼‚æ­¥æ›´æ–°çš„</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>, <span class="comment">// 1+1</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è°ƒç”¨ä¸¤æ¬¡çš„è¯ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ï¼Œstateæ˜¯ä¸Šä¸€ä¸ªstateçš„è¿”å›ç»“æœ</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç¬¬äºŒæ¬¡è°ƒç”¨&quot;</span>, state);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>, <span class="comment">// 2+1</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;count: &quot;</span>, <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ <code>setState()</code>çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°</p><ul><li>å¦‚æœå¸Œæœ›æ›´æ–°åæ‰§è¡Œä»€ä¹ˆæ“ä½œï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå›è°ƒå‡½æ•°</li><li>åœ¨ DOM æ¸²æŸ“åæ‰§è¡Œï¼ˆå’Œ<code>componentDidMount</code>å¯ä»¥ç›¸äº’ä½¿ç”¨ï¼‰</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(</span><br><span class="line">    <span class="function">(<span class="params">state, props</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// çŠ¶æ€æ›´æ–°ï¼Œå¹¶ä¸”ç•Œé¢é‡æ–°æ¸²æŸ“åæ‰§è¡Œ</span></span><br><span class="line">    <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;çŠ¶æ€æ›´æ–°å®Œæˆï¼&quot;</span>, <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span>);</span><br><span class="line">    &#125; <span class="comment">// 2</span></span><br><span class="line">  );</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;count: &quot;</span>, <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span>); <span class="comment">// 1</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="JSX-è¯­æ³•è½¬æ¢è¿‡ç¨‹"><a href="#JSX-è¯­æ³•è½¬æ¢è¿‡ç¨‹" class="headerlink" title="JSX è¯­æ³•è½¬æ¢è¿‡ç¨‹"></a>JSX è¯­æ³•è½¬æ¢è¿‡ç¨‹</h2><ul><li>JSX ä»…ä»…æ˜¯<code>createElement()</code>çš„è¯­æ³•ç³–ï¼ˆç®€åŒ–è¯­æ³•ï¼‰</li><li>JSX è¯­æ³•è¢«<code>@babel/preset-react</code>æ’ä»¶ç¼–è¯‘ä¸º<code>createElement()</code>æ–¹æ³•</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A(JSXè¯­æ³•) --&gt; B(createElement) --&gt; C(Reactå…ƒç´ )</span><br></pre></td></tr></table></figure><ul><li>React å…ƒç´ ï¼šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥æè¿°å¸Œæœ›åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„å†…å®¹</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JSXè¯­æ³•</span></span><br><span class="line"><span class="keyword">const</span> element = &#123;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// createElement()</span></span><br><span class="line"><span class="keyword">const</span> element = <span class="title class_">React</span>.<span class="title function_">createElement</span>(</span><br><span class="line"><span class="string">&quot;h1&quot;</span>,</span><br><span class="line">    &#123; <span class="attr">className</span>: <span class="string">&quot;app&quot;</span> &#125;,</span><br><span class="line">    <span class="string">&quot;hello&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reactå…ƒç´ ï¼ˆç®€åŒ–ç»“æ„ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> element = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;h1&quot;</span>,</span><br><span class="line">    <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">className</span>: <span class="string">&quot;app&quot;</span>,</span><br><span class="line">        <span class="attr">children</span>: <span class="string">&quot;hello&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ ES6 ä¸­ï¼Œclass å®ç°çš„ç±»å°±æ˜¯ ES5 ä¸­æ„é€ å‡½æ•°å’ŒåŸå½¢çš„è¯­æ³•ç³–ï¼Œå¯ä»¥ä½¿ç”¨<code>typeof</code>æ¥æµ‹ä¸€ä¸‹</p></blockquote><h2 id="ç»„ä»¶æ€§èƒ½ä¼˜åŒ–"><a href="#ç»„ä»¶æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="ç»„ä»¶æ€§èƒ½ä¼˜åŒ–"></a>ç»„ä»¶æ€§èƒ½ä¼˜åŒ–</h2><h3 id="å‡è½»-state"><a href="#å‡è½»-state" class="headerlink" title="å‡è½» state"></a>å‡è½» state</h3><ul><li>state ä¸­åªå­˜æ”¾è·Ÿç»„ä»¶æ¸²æŸ“ç›¸å…³çš„æ•°æ®</li><li>æ¯”å¦‚åƒå®šæ—¶å™¨ id è¿™æ ·çš„ä¸ç”¨æ”¾åœ¨ state ä¸­ï¼Œç›´æ¥æ”¾åœ¨ this ä¸­ï¼ˆ<code>this.timeId = setTimeout()</code>ï¼‰</li></ul><h3 id="é¿å…ä¸å¿…è¦çš„æ¸²æŸ“"><a href="#é¿å…ä¸å¿…è¦çš„æ¸²æŸ“" class="headerlink" title="é¿å…ä¸å¿…è¦çš„æ¸²æŸ“"></a>é¿å…ä¸å¿…è¦çš„æ¸²æŸ“</h3><p>1ï¸âƒ£ çˆ¶ç»„ä»¶æ›´æ–°å­ç»„ä»¶ä¹Ÿä¼šè·Ÿç€æ›´æ–°ï¼Œæœ‰æ—¶å€™å­ç»„ä»¶ä¼šè·Ÿç€æœ‰äº›ä¸å¿…è¦çš„æ›´æ–°</p><ul><li>ä½¿ç”¨é’©å­å‡½æ•°<code>shouldComponentUpdate(nextProps, nextState)</code>ï¼Œé€šè¿‡è¿”å›å€¼å†³å®šè¯¥ç»„ä»¶æ˜¯å¦é‡æ–°æ¸²æŸ“ã€‚<strong>true</strong>é‡æ–°ï¼Œ<strong>false</strong>ä¸é‡æ–°</li><li>é’©å­å‡½æ•°è§¦å‘æ—¶æœºï¼šç»„ä»¶é‡æ–°æ¸²æŸ“å‰æ‰§è¡Œã€‚<code>shouldComponentUpdate -&gt; render</code></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function"><span class="params">state</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">shouldComponentUpdate</span>(<span class="params">nextProps, nextState</span>) &#123;</span><br><span class="line">    <span class="comment">// è¿”å›falseï¼Œé˜»æ­¢ç»„ä»¶é‡æ–°æ¸²æŸ“</span></span><br><span class="line">    <span class="comment">// return false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å¾—æœ€æ–°çŠ¶æ€</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(nextState);</span><br><span class="line">    <span class="comment">// è·å¾—å½“å‰çŠ¶æ€</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸¾ä¸ªä¾‹å­ï¼ˆå‡è®¾è¿™é‡Œçš„countæ˜¯éšæœºçš„ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (nextState.<span class="property">count</span> === <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç»„ä»¶æ›´æ–°äº†&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>è®¡æ•°å™¨ï¼š&#123;this.state.count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="çº¯ç»„ä»¶"><a href="#çº¯ç»„ä»¶" class="headerlink" title="çº¯ç»„ä»¶"></a>çº¯ç»„ä»¶</h3><ul><li><code>PureComponent</code>ï¼Œå…¶å†…éƒ¨è‡ªåŠ¨å®ç°äº†<code>shouldComponentUpdate</code>é’©å­ï¼Œä¸éœ€è¦è¿›è¡Œæ‰‹åŠ¨æ¯”è¾ƒ</li><li>ç»„ä»¶å†…éƒ¨é€šè¿‡åˆ†åˆ«å¯¹æ¯”å‰åä¸¤æ¬¡<code>props</code>å’Œ<code>state</code>çš„å€¼ï¼Œæ¥å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ”¹ä¸ºçº¿é¢çš„å½¢å¼</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.PureComponent</span> &#123;</span><br><span class="line">  <span class="comment">// TODO</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¯ç»„ä»¶å†…éƒ¨çš„å®ç°æ–¹å¼ï¼š<code>shallow conpare</code>æµ…å±‚å¯¹æ¯”ã€‚</p><p>å¯¹äºå€¼ç±»å‹ï¼Œç›´æ¥å¤åˆ¶ï¼Œå¯¹äºå¼•ç”¨ç±»å‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•ç”¨ç±»å‹</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">number</span>: <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> newObj = obj;</span><br><span class="line">newObj.<span class="property">number</span> = <span class="number">2</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newObj === obj); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æ¥ç€ä¸Šé¢çš„å¼•ç”¨ç±»å‹ï¼Œè‹¥æœåœ¨ React ä¸­</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">state = &#123; <span class="attr">obj</span>: &#123; <span class="attr">number</span>: <span class="number">0</span> &#125; &#125;;</span><br><span class="line"><span class="comment">// é”™è¯¯åšæ³•</span></span><br><span class="line">state.<span class="property">obj</span>.<span class="property">number</span> = <span class="number">2</span>;</span><br><span class="line"><span class="title function_">setState</span>(&#123; <span class="attr">obj</span>: state.<span class="property">obj</span> &#125;);</span><br><span class="line"><span class="comment">// PureComponentå†…éƒ¨æ¯”è¾ƒï¼šç½ªè¡Œçš„state.obj===ä¸Šæ¬¡çš„state.onjï¼Œè¿”å›trueï¼Œä¸é‡æ–°æ¸²æŸ“</span></span><br></pre></td></tr></table></figure><ul><li>â— æ‰€ä»¥ï¼š<code>state</code>æˆ–<code>props</code>ä¸­å±æ€§çš„å€¼ä¸ºå¼•ç”¨ç±»å‹æ—¶ï¼Œåº”è¯¥<strong>åˆ›å»ºæ–°çš„æ•°æ®ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹åŸæ•°æ®</strong></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­£ç¡®åšæ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæ–°å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> newObj = &#123; ...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">obj</span>, <span class="attr">number</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">3</span>) &#125;;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">obj</span>: newObj &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæ˜¯æ•°ç»„ï¼Œä¸ä½¿ç”¨pushï¼Œunshiftè¿™ç§åœ¨åŸå§‹æ•°ç»„ä¸Šæ“ä½œçš„æ–¹å¼</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨concatã€sliceè¿™ç§</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">  <span class="attr">list</span>: [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">list</span>, &#123; æ–°æ•°æ® &#125;],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="è™šæ‹Ÿ-DOM-å’Œ-Diff-ç®—æ³•"><a href="#è™šæ‹Ÿ-DOM-å’Œ-Diff-ç®—æ³•" class="headerlink" title="è™šæ‹Ÿ DOM å’Œ Diff ç®—æ³•"></a>è™šæ‹Ÿ DOM å’Œ Diff ç®—æ³•</h2><ul><li>åªè¦<code>state</code>å˜åŒ–å°±é‡æ–°æ¸²æŸ“è§†å›¾ï¼Œæœ‰æ—¶å€™ä¼šæµªè´¹æ€§èƒ½ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç”¨åˆ°è™šæ‹Ÿ DOM å’Œ Diff ç®—æ³•</li><li>è™šæ‹Ÿ DOM æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œç”¨æ¥æè¿°å¸Œæœ›çœ‹åˆ°çš„å†…å®¹ã€‚ï¼ˆå®é™…ä¸Šå°±æ˜¯ jsx å¯¹è±¡ï¼‰</li></ul><h3 id="æ‰§è¡Œè¿‡ç¨‹"><a href="#æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="æ‰§è¡Œè¿‡ç¨‹"></a>æ‰§è¡Œè¿‡ç¨‹</h3><ol><li>åˆæ¬¡æ¸²æŸ“æ—¶ï¼ŒReact ä¼šæ ¹æ®åˆå§‹ Stateã€‚åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿ DOM å¯¹è±¡ï¼ˆæ ‘ï¼‰</li><li>æ ¹æ®è™šæ‹Ÿ DOM ç”ŸæˆçœŸæ­£çš„ DOM ç„¶åæ¸²æŸ“åˆ°é¡µé¢ä¸­</li><li>å½“æ•°æ®å˜åŒ–åï¼ˆsetState()ï¼‰ï¼Œé‡æ–°æ ¹æ®æ–°çš„æ•°æ®ï¼Œåˆ›å»ºæ–°çš„è™šæ‹Ÿ DOM å¯¹è±¡</li><li>ä½¿ç”¨<code>diff</code>ç®—æ³•ï¼Œæ‰¾åˆ°ä¸ä¸Šä¸€ä¸ªè™šæ‹Ÿ DOM å¯¹æ¯”ï¼Œç„¶åæ¸²æŸ“éœ€è¦æ›´æ–°çš„å†…å®¹</li><li>ç„¶å React åªæ›´æ–°ï¼ˆpatchï¼‰å˜åŒ–çš„å†…å®¹ï¼Œæ¸²æŸ“åˆ°é¡µé¢ä¸­</li></ol><p>render æ–¹æ³•çš„è°ƒç”¨å¹¶ä¸æ„å‘³ç€æµè§ˆå™¨ä¸­çš„é‡æ–°æ›´æ–°ï¼Œä»…ä»…è¯´æ˜è¦è¿›è¡Œ diff</p><blockquote><p>è™šæ‹Ÿ DOM ä¸æ˜¯çœŸæ­£çš„ DOMï¼Œåªè¦å¯ä»¥è¿è¡Œ JavaScript çš„åœ°æ–¹å°±å¯ä»¥ä½¿ç”¨ï¼Œè¿™å°±ä½¿å¾— React å¯ä»¥è„±ç¦»æµè§ˆå™¨è€Œå­˜åœ¨ï¼Œå¯ä»¥åœ¨ Android å’Œ IOS ä¸­ä½¿ç”¨</p></blockquote><h1 id="Hooks-1"><a href="#Hooks-1" class="headerlink" title="Hooks"></a>Hooks</h1><h2 id="Context-Hooks"><a href="#Context-Hooks" class="headerlink" title="Context Hooks"></a>Context Hooks</h2><ul><li>è¿œè·ç¦»ä¼ è¾“æ•°æ®ï¼Œä¸å±€é™äºçˆ¶å­ç»„ä»¶ï¼Œä¸ä½¿ç”¨ props</li></ul><h2 id="Ref-Hooks"><a href="#Ref-Hooks" class="headerlink" title="Ref Hooks"></a>Ref Hooks</h2><ul><li>ä¿å­˜ä¸€äº›åœ¨æ¸²æŸ“ä¸­ä¸ä¼šç”¨åˆ°çš„æ•°æ®ï¼Œæ¯”å¦‚ DOM èŠ‚ç‚¹å’Œè®¡æ—¶å™¨çš„ ID</li><li>æ›´æ–° ref ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶</li><li>ä¸€èˆ¬ä¼šç”¨åˆ°é React ä½“ç³»ä¸­</li></ul><h2 id="Effect-Hooks"><a href="#Effect-Hooks" class="headerlink" title="Effect Hooks"></a>Effect Hooks</h2><ul><li>è®©ç»„ä»¶è¿æ¥åˆ°å¤–éƒ¨ç³»ç»Ÿï¼Œå¹¶ä¸ä¹‹åŒæ­¥</li></ul><h1 id="è·¯ç”±åŸºç¡€"><a href="#è·¯ç”±åŸºç¡€" class="headerlink" title="è·¯ç”±åŸºç¡€"></a>è·¯ç”±åŸºç¡€</h1><p>SPAï¼šå•é¡µåº”ç”¨ç¨‹åºï¼Œå°±æ˜¯åªæœ‰ä¸€ä¸ª HTML é¡µé¢çš„åº”ç”¨ç¨‹åºã€‚ç”¨æˆ·ä½“éªŒå¥½ï¼Œå¯¹æœåŠ¡å™¨å‹åŠ›å°ã€‚<br>è·¯ç”±ï¼šå°±æ˜¯ç»„ä»¶å’Œ URL çš„å¯¹åº”å…³ç³»ï¼Œè®©ç”¨æˆ·åˆ°ä¸€ä¸ªè§†å›¾åˆ°å¦å¤–çš„è§†å›¾ä¸­ã€‚</p><h2 id="åŸºæœ¬ä½¿ç”¨-3"><a href="#åŸºæœ¬ä½¿ç”¨-3" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><p>å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install react-router-dom</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆ–è€…</span></span><br><span class="line">yarn add react-router-dom</span><br></pre></td></tr></table></figure><p>å¯¼å…¥ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span>, <span class="title class_">Route</span>, <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br></pre></td></tr></table></figure><ul><li>é™¤äº†<code>BrowserRouter</code>å¤–è¿˜æœ‰<code>HashRouter</code>ï¼Œæ›¿æ¢æ‰å°±è¡Œï¼Œä¸è¿‡æ¨èä½¿ç”¨å‰è€…ï¼ˆä½¿ç”¨çš„æ˜¯ HTML5 çš„<code>history API</code>ï¼‰</li></ul><p>ä½¿ç”¨<code>&lt;Router&gt;</code>ç»„ä»¶åŒ…è£¹æ•´ä¸ªåº”ç”¨ï¼Œç„¶åä½¿ç”¨<code>&lt;Link to=&quot;/xxx&quot;&gt;</code>æŒ‡å®šè·¯ç”±å…¥å£ï¼Œä½¿ç”¨<code>Route</code>ç»„ä»¶æŒ‡å®šè·¯ç”±å‡ºå£</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">First</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>æˆ‘æ˜¯First<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>æˆ‘æ˜¯è·¯ç”±<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/first&quot;</span>&gt;</span>é¡µé¢ä¸€<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/first&quot;</span> <span class="attr">component</span>=<span class="string">&#123;First&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><code>&lt;Link&gt;</code>æœ€ç»ˆç¼–è¯‘æˆ<code>&lt;a&gt;</code>ï¼Œto è¢«ç¼–è¯‘æˆ hrefï¼›å¯ä»¥é€šè¿‡<code>location.pathname</code>å¾—åˆ° to</li><li><code>&lt;Route&gt;</code>çš„ä½ç½®åœ¨å“ªï¼Œå°±åœ¨å“ªä¸ªä½ç½®æ¸²æŸ“</li></ul><h2 id="ç¼–ç¨‹å¼å¯¼èˆª"><a href="#ç¼–ç¨‹å¼å¯¼èˆª" class="headerlink" title="ç¼–ç¨‹å¼å¯¼èˆª"></a>ç¼–ç¨‹å¼å¯¼èˆª</h2><ul><li>å°±æ˜¯é€šè¿‡ JavaScript ä»£ç æ¥å®ç°é¡µé¢è·³è½¬</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Login</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  handleLogin = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">    <span class="comment">// push è·³è½¬åˆ°æŸä¸ªé¡µé¢</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&quot;/home&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>ç™»å½•é¡µé¢<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleLogin&#125;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = props =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleBack</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// è¿”å›ä¸Šä¸€ä¸ªé¡µé¢</span></span><br><span class="line">    props.<span class="property">history</span>.<span class="title function_">go</span>(-<span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æˆ‘æ˜¯åå°é¦–é¡µ<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleLogin&#125;</span>&gt;</span>è¿”å›ç™»å½•é¡µé¢<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç¼–ç¨‹å¼å¯¼èˆª<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span>&gt;</span>å»ç™»å½•é¡µé¢<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Login&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>é»˜è®¤è·¯ç”±</strong>ï¼šè¿›å…¥é¡µé¢æ—¶å°±ä¼šåŒ¹é…çš„è·¯ç”±ï¼Œä½¿ç”¨<code>/</code>ï¼Œåé¢ä¸åŠ å†…å®¹</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/&quot;</span>, component=&#123;<span class="title class_">Home</span>&#125;&gt;&lt;/<span class="title class_">Route</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="åŒ¹é…æ¨¡å¼"><a href="#åŒ¹é…æ¨¡å¼" class="headerlink" title="åŒ¹é…æ¨¡å¼"></a>åŒ¹é…æ¨¡å¼</h2><h3 id="æ¨¡ç³ŠåŒ¹é…æ¨¡å¼"><a href="#æ¨¡ç³ŠåŒ¹é…æ¨¡å¼" class="headerlink" title="æ¨¡ç³ŠåŒ¹é…æ¨¡å¼"></a>æ¨¡ç³ŠåŒ¹é…æ¨¡å¼</h3><ul><li>é»˜è®¤æƒ…å†µä¸‹ React ä½¿ç”¨æ¨¡ç³ŠåŒ¹é…æ¨¡å¼</li><li>æ¨¡ç³ŠåŒ¹é…è§„åˆ™ï¼šåªè¦ pathname ä»¥<code>/</code>å¼€å¤´å°±ä¼šåŒ¹é…æˆåŠŸ</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>é»˜è®¤è·¯ç”±<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span>&gt;</span>ç™»å½•é¡µé¢<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Login&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">Route</span>&gt;</span><br></pre></td></tr></table></figure><ul><li>ä¸ç®¡<code>&lt;Link&gt;</code>ä¸­çš„ to é‡Œé¢çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼ˆto=â€/aâ€ï¼Œto=â€/abcâ€ï¼‰ï¼Œ<code>&lt;Route path=&quot;/&quot;&gt;</code>éƒ½ä¼šè¢«åŒ¹é…åˆ°</li><li>åŒæ ·ï¼Œ<code>to=&quot;/login/a/b&quot;</code>ä¹Ÿèƒ½åŒ¹é…åˆ°<code>path=&quot;/first&quot;</code></li></ul><h3 id="ç²¾ç¡®æ¨¡å¼"><a href="#ç²¾ç¡®æ¨¡å¼" class="headerlink" title="ç²¾ç¡®æ¨¡å¼"></a>ç²¾ç¡®æ¨¡å¼</h3><ul><li>ç»™<code>&lt;Route&gt;</code>æ·»åŠ <code>exact</code>å±æ€§</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> exact path=<span class="string">&quot;/login&quot;</span> component=&#123;<span class="title class_">Login</span>&#125;&gt;&lt;/<span class="title class_">Route</span>&gt;</span><br></pre></td></tr></table></figure><p>æ¨èä½¿ç”¨ç²¾ç¡®æ¨¡å¼</p><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h2 id="ä¸€äº›ç½‘ç«™"><a href="#ä¸€äº›ç½‘ç«™" class="headerlink" title="ä¸€äº›ç½‘ç«™"></a>ä¸€äº›ç½‘ç«™</h2><p><strong>ç»„ä»¶</strong></p><p><a href="https://chakra-ui.com/docs/components/tabs/props">chakra UI</a></p><p><a href="https://mui.com/core/">Material UI</a></p><h2 id="ä¸€äº›åº“"><a href="#ä¸€äº›åº“" class="headerlink" title="ä¸€äº›åº“"></a>ä¸€äº›åº“</h2><p><a href="https://github.com/immerjs/use-immer"><code>immer</code></a>ï¼šä¿®æ”¹<em>state</em>çš„å¥½å¸®æ‰‹ï¼Œæ¯”å¦‚å¯¹äºåµŒå¥—å¥½æ·±çš„å¯¹è±¡</p><h2 id="NOTE"><a href="#NOTE" class="headerlink" title="NOTE"></a>NOTE</h2><ol><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé”™è¯¯éƒ½å¯ä»¥åœ¨é¡µé¢æŠ¥é”™ä¿¡æ¯ä¸­æ‰¾åˆ°</li></ol><!--<h1 style="font-size: 50px;"><span style="color: lightblue;">React</span> å¿«é€Ÿæ‰‹å†Œ </h1>--><!--<h1>ğŸŒğŸš€ğŸš€ğŸš€ğŸš€ğŸŒ•</h1>-->]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸ‰ å¸Œæœ›å¯ä»¥è®°å½•ä¸€äº›ç¬”è®°ï¼Œä¿æŒåŸæœ‰ä¹…ç¬”è®°çš„å‰æä¸‹åŠ¨æ€æ›´æ–°ï¼Œæ–¹ä¾¿å¯¹æ¯”å¤ä¹ &lt;/p&gt;
&lt;p&gt;ğŸ‘‰ å€¼å¾—å­¦ä¹ çš„ &lt;a href=&quot;https://react.dev/learn/thinking-in-react&quot;&gt;Thinking In React&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="js" scheme="https://smalljerry.cn/tags/js/"/>
    
    <category term="react" scheme="https://smalljerry.cn/tags/react/"/>
    
  </entry>
  
  <entry>
    <title>å¼‚æ­¥JavaScript</title>
    <link href="https://smalljerry.cn/2021/05/17/%E5%BC%82%E6%AD%A5JavaScript/"/>
    <id>https://smalljerry.cn/2021/05/17/%E5%BC%82%E6%AD%A5JavaScript/</id>
    <published>2021-05-17T08:19:36.000Z</published>
    <updated>2025-02-22T02:14:47.356Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸŒ å‚è€ƒï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Asynchronous">MDN-å¼‚æ­¥ JavaScript</a>ï¼Œã€Šæ·±å…¥ç†è§£ ES6ã€‹- NICHOLAS C.ZAKASï¼Œé»‘é©¬ç¨‹åºå‘˜ï¼Œç‹ç£ŠåŒå­¦<span id="more"></span></p><h1 id="åŒæ­¥å’Œå¼‚æ­¥"><a href="#åŒæ­¥å’Œå¼‚æ­¥" class="headerlink" title="åŒæ­¥å’Œå¼‚æ­¥"></a>åŒæ­¥å’Œå¼‚æ­¥</h1><h2 id="åŒæ­¥"><a href="#åŒæ­¥" class="headerlink" title="åŒæ­¥"></a>åŒæ­¥</h2><p>æŒ‰é¡ºåº<strong>ç­‰å¾…æ‰§è¡Œ</strong>ï¼Œä»£ç ä¼ å…¥è°ƒç”¨æ ˆï¼Œæ‰§è¡Œå®Œæ¯•åå†ä»è°ƒç”¨æ ˆä¸­ç§»é™¤ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;global begin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;bar task&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;foo task&quot;</span>);</span><br><span class="line">  <span class="title function_">bar</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;global end&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">global begin</span><br><span class="line">foo task</span><br><span class="line">bar task</span><br><span class="line">global end</span><br></pre></td></tr></table></figure><h2 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h2><p>ğŸ“– JavaScript å¼•æ“æ˜¯åŸºäºå•çº¿ç¨‹äº‹ä»¶å¾ªç¯çš„æ¦‚å¿µæ„å»ºçš„ï¼Œåœ¨åŒä¸€æ—¶é—´åªå…è®¸ä¸€ä¸ªä»£ç å—åœ¨è¿è¡Œã€‚å¦‚æœä¸€ä¸ªå‡½æ•°ä¾èµ–äºå¦ä¸€ä¸ªå‡½æ•°çš„ç»“æœï¼Œå®ƒåªèƒ½ç­‰å¾…é‚£ä¸ªå‡½æ•°ç»“æŸæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œè¿™æ ·å°±å®¹æ˜“é€ æˆä»£ç é˜»å¡ã€‚å¼‚æ­¥å°±æ˜¯ç”¨äºè§£å†³è¿™äº›é—®é¢˜ã€‚</p><blockquote><p>å½“å‰ä»»åŠ¡ä¸ºå¼‚æ­¥çš„è¯ï¼Œä¸ä¼šç­‰å¾…å½“å‰ä»»åŠ¡æ‰§è¡Œç»“æŸï¼Œè€Œæ˜¯ç«‹å³æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡</p></blockquote><p>åœ¨ JavaScript ä¸­å®ç°å¼‚æ­¥çš„æ–¹æ³•æœ‰è®¸å¤šç§ï¼š<code>setTimeout()</code>å’Œ<code>setInterval()</code>ã€äº‹ä»¶æ¨¡å‹ã€å›è°ƒå‡½æ•°ã€Promiseã€Fetchã€async/awaitã€axios</p><h2 id="setTimeout-ä½œä¸ºä¾‹å­"><a href="#setTimeout-ä½œä¸ºä¾‹å­" class="headerlink" title="setTimeout ä½œä¸ºä¾‹å­"></a>setTimeout ä½œä¸ºä¾‹å­</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;global begin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> <span class="title function_">timer1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer1 invoke&quot;</span>);</span><br><span class="line">&#125;, <span class="number">1800</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> <span class="title function_">timer2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;timer2 invoke&quot;</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;inner invoke&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;global end&quot;</span>);</span><br></pre></td></tr></table></figure><p>åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼šè°ƒç”¨æ ˆï¼Œä»»åŠ¡é˜Ÿåˆ—ï¼Œäº‹ä»¶å¾ªç¯ï¼Œapi ç¯å¢ƒï¼ˆæµè§ˆå™¨ã€nodejsï¼‰</p><ol><li>åŒæ­¥ä»£ç æ”¾è¿›<code>è°ƒç”¨æ ˆ</code></li><li>é‡åˆ°è®¡æ—¶å™¨ï¼Œå°†è®¡æ—¶å™¨æ”¾è¿›<code>apiç¯å¢ƒ</code>ï¼Œè®¡æ—¶å™¨å¼€å§‹è®¡æ—¶ï¼ˆå¼‚æ­¥æ“ä½œï¼Œä¸å½±å“ç¬¬<code>3</code>çš„è¿›è¡Œï¼‰</li><li>é‡åˆ°åŒæ­¥ä»£ç ï¼Œç»§ç»­æ”¾è¿›<code>è°ƒç”¨æ ˆ</code></li><li>è®¡æ—¶å™¨æ—¶é—´åˆ°ï¼Œå°†è®¡æ—¶å™¨ï¼ˆè®¡æ—¶å™¨ä¸­çš„å›è°ƒå‡½æ•°ï¼‰æ”¾è¿›<code>ä»»åŠ¡é˜Ÿåˆ—</code></li><li><code>äº‹ä»¶å¾ªç¯</code>æ£€æŸ¥<code>è°ƒç”¨æ ˆ</code>æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºåˆ™ç»§ç»­æ‰§è¡Œ<code>è°ƒç”¨æ ˆ</code>ä¸­çš„ä»£ç </li><li><code>è°ƒç”¨æ ˆ</code>ä¸ºç©ºï¼Œ<code>äº‹ä»¶å¾ªç¯</code>æ£€æŸ¥<code>ä»»åŠ¡é˜Ÿåˆ—</code>æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºåˆ™å°†<code>ä»»åŠ¡é˜Ÿåˆ—</code>ä¸­çš„ä»£ç æ”¾è¿›<code>è°ƒç”¨æ ˆ</code></li></ol><blockquote><p>JavaScript æ˜¯å•çº¿ç¨‹ï¼Œä½†æ˜¯è¿è¡Œå®ƒçš„ç¯å¢ƒå¹¶ä¸æ˜¯å•çº¿ç¨‹ã€‚å…·ä½“è¦çœ‹è¿è¡Œç¯å¢ƒæä¾›çš„ API åˆ°åº•æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥</p></blockquote><h1 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h1><blockquote><p>è¢«ä½œä¸ºå®å‚ä¼ å…¥å¦ä¸€å‡½æ•°ï¼Œå¹¶åœ¨è¯¥å¤–éƒ¨å‡½æ•°å†…è¢«è°ƒç”¨ï¼Œç”¨ä»¥æ¥å®ŒæˆæŸäº›ä»»åŠ¡çš„å‡½æ•°ï¼Œç§°ä¸ºå›è°ƒå‡½æ•°ã€‚</p></blockquote><p>æä¸€ä¸‹<strong>äº‹ä»¶æ¨¡å‹</strong>ï¼ˆonclickã€onmouseover ç­‰ç­‰ï¼‰ï¼Œå…¶å®å’Œå›è°ƒå‡½æ•°æ˜¯ç±»ä¼¼çš„ï¼Œæ¯”å¦‚æŒ‰é’®ç‚¹å‡»ï¼Œä»£ç éƒ½æ˜¯åœ¨æŒ‰é’®ç‚¹å‡»çš„æ—¶å€™æ‰§è¡Œã€‚ä¸åŒçš„æ˜¯å›è°ƒå‡½æ•°ä¸­è¢«æ‰§è¡Œçš„å‡½æ•°ä¸æ˜¯ä¸€èµ‹å€¼çš„å½¢å¼ä¼ é€’ï¼ˆ=ï¼‰ï¼Œè€Œæ˜¯ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚</p><p>å›è°ƒå‡½æ•°åœ¨<code>Node.js</code>ä¸­å¹¿æ³›åº”ç”¨ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¾‹å­ä¸­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">readFile</span>(<span class="string">&quot;example.txt&quot;</span>, <span class="function">(<span class="params">err, contents</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">throw</span> err;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(contents);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hi!&quot;</span>);</span><br></pre></td></tr></table></figure><p><code>readFile()</code>ä¼šå¼€å§‹æ‰§è¡Œï¼Œè¯»å–å‚æ•° 1 ä¸­æŒ‡å®šçš„æ–‡ä»¶ï¼Œè¯»å–ç»“æŸåæ‰§è¡Œå‚æ•° 2(å›è°ƒå‡½æ•°)ï¼Œä½†æ˜¯è¯»å–æ–‡ä»¶å¯ä»¥è¯´æ˜¯ä¸€ä¸ªé˜»å¡çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æµè§ˆå™¨æ˜¯å…ˆè¾“å‡º**Hi!**ï¼Œç„¶åå½“<code>readFile()</code>æ‰§è¡Œç»“æŸçš„æ—¶å€™ï¼Œä¼šåœ¨ä»»åŠ¡é˜Ÿåˆ—æœ«å°¾æ·»åŠ ä¸€ä¸ªæ–°ä»»åŠ¡ï¼Œç”¨äºå¤„ç†å›è°ƒå‡½æ•°é‡Œé¢çš„å†…å®¹ã€‚</p><p>å›è°ƒå‡½æ•°æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼‚æ­¥æ“ä½œï¼Œå›è°ƒå‡½æ•°åµŒå¥—å¤šçš„æ—¶å€™ï¼Œå°±ä¼šé€ æˆ<em>å›è°ƒåœ°ç‹±</em>ã€‚å¦‚æœæƒ³å®ç°å¤æ‚çš„åŠŸèƒ½ï¼Œè¿™æ ·çš„ä»£ç å¾ˆéš¾ç†è§£å…¶æ„æ€ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">readFile</span>(<span class="string">&quot;example.txt&quot;</span>, <span class="function">(<span class="params">err, contents</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">throw</span> err;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">writeFile</span>(<span class="string">&quot;example.txt&quot;</span>, <span class="function">(<span class="params">err, contents</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">throw</span> err;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">otherFunc1</span>(<span class="function">(<span class="params">err, contents</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">otherFunc2</span>(<span class="function">(<span class="params">err, contents</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="keyword">throw</span> err;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// .....</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><ul><li>CommonJS ç‡å…ˆæå‡ºï¼ŒES6 æ ‡å‡†åŒ–</li></ul><p>æ›´å¤šï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise">å…¨å±€å¯¹è±¡â€“Promise</a>ï¼Œ<a href="https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Asynchronous/Promises">å¼‚æ­¥ JavaScript</a></p><p>promise æ‰¿è¯ºåœ¨æœªæ¥çš„æŸä¸€æ—¶é—´ä¼šè¿”å›æ‰§è¡Œçš„å†…å®¹ï¼Œä½†æ˜¯ä¸ç¡®å®šåœ¨ä»€ä¹ˆæ—¶å€™ï¼Œä¸è®ºæ‰§è¡Œçš„ç»“æœæ˜¯å¯¹çš„è¿˜æ˜¯é”™çš„éƒ½ä¼šæœ‰è¿”å›ã€‚</p><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>ä½¿ç”¨ Promise()æ„é€ å‡½æ•°åˆ›å»ºè‡ªå·±çš„ promiseï¼Œè¿™ä¸ªæ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª<em>æ‰§è¡Œå™¨å‡½æ•°</em>ï¼Œè¿™ä¸ªæ‰§è¡Œå™¨å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œè¿™ä¸¤ä¸ªå‚æ•°æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«æ˜¯ï¼šå¤„ç†æˆåŠŸæ‰§è¡Œçš„ resolve()ã€å¤„ç†å¤±è´¥æ‰§è¡Œçš„ reject()</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä½ å¥½&quot;</span>);</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;ä¸–ç•Œï¼&quot;</span>);</span><br><span class="line">  <span class="comment">// æˆ–è€…å¤±è´¥</span></span><br><span class="line">  <span class="comment">// reject(&#x27;å¤±è´¥ï¼&#x27;)</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(val);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ï¼Œ&quot;</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¾æ¬¡è¾“å‡º<code>ä½ å¥½ï¼Œä¸–ç•Œï¼</code>ï¼›</p><ul><li>é¦–å…ˆå› ä¸º<em>Promise çš„æ‰§è¡Œå™¨</em>ä¸­çš„ä»£ç ä¼š<strong>ç«‹åˆ»æ‰§è¡Œ</strong>ï¼Œç„¶åå†æ‰§è¡Œå…¶ä»–çš„ä»£ç </li><li>è°ƒç”¨<code>resolve()</code>åè§¦å‘ä¸€ä¸ª<strong>å¼‚æ­¥æ“ä½œ</strong>ï¼Œä¼ å…¥<code>then</code>å’Œ<code>catch()</code>çš„å‡½æ•°ä¼šè¢«æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­å¹¶<em>å¼‚æ­¥æ‰§è¡Œ</em></li><li>è™½ç„¶ä¸Šé¢çš„<code>then()</code>åœ¨<code>console.log(&#39;ï¼Œ&#39;)</code>ä¹‹å‰ï¼Œä½†æ˜¯ä¸æ‰§è¡Œå™¨ä¸åŒçš„æ˜¯å¹¶æ²¡æœ‰ç«‹å³æ‰§è¡Œï¼Œè¿™æ˜¯å› ä¸ºå®Œæˆå¤„ç†ç¨‹åºå’Œæ‹’ç»å¤„ç†ç¨‹åºæ€»æ˜¯åœ¨æ‰§è¡Œå™¨å®Œæˆåè¢«æ·»åŠ åˆ°<em>ä»»åŠ¡é˜Ÿåˆ—çš„æœ«å°¾</em>ã€‚</li></ul><p>promise ä¸­å¯ä»¥ä½¿ç”¨ promise çš„ <em>åŸå½¢</em> å’Œ _é™æ€æ–¹æ³•_ã€‚ğŸ‘‰ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise">æ›´å¤š</a></p><p><code>promise.prototype.then()</code>ï¼šå¤„ç†æˆåŠŸæ‰§è¡Œ</p><p><code>promise.prototype.catch()</code>ï¼šå¤„ç†å¤±è´¥æ‰§è¡Œ</p><p><code>promise.prototype.finally()</code>ï¼šä¸ç®¡æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½æ‰§è¡Œ</p><p>promise.then()ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰ï¼Œè¿™ä¸¤ä¸ªå‚æ•°æ˜¯å¤„ç†å‡½æ•°ï¼Œå‚æ•° 1 æ˜¯æˆåŠŸæ‰§è¡Œçš„å¤„ç†å‡½æ•°ï¼Œå‚æ•° 2 æ˜¯å¤±è´¥çš„å¤„ç†å‡½æ•°ï¼Œæ‰€ä»¥<code>then(null, func) å’Œ catch()</code>çš„ä½œç”¨æ˜¯ä¸€æ ·çš„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">promise.<span class="title function_">then</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// valueæ˜¯ä¸Šé¢æˆåŠŸæ‰§è¡Œæ—¶resolve()ä¼ è¿‡æ¥çš„å‚æ•°</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// æˆåŠŸï¼</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="literal">null</span>, <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// å¤±è´¥ï¼</span></span><br><span class="line">&#125;);</span><br><span class="line">promise.<span class="title function_">catch</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// å¤±è´¥</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">finally</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;finish.&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>Promise å¯¹è±¡çš„<code>then()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥é“¾å¼è°ƒç”¨</li><li>åé¢çš„<code>then()</code>å°±æ˜¯ä¸ºä¸Šä¸€ä¸ª<code>then()</code>çš„è¿”å›çš„ Promise æ·»åŠ å¤„ç†å‡½æ•°</li><li>å‰é¢çš„<code>then()</code>è¿”å›çš„å€¼ä¼šä½œä¸ºåé¢<code>then()</code>çš„å‚æ•°<ul><li>å¦‚æœè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ª Promise å®ä¾‹ï¼Œé‚£ä¹ˆåé¢çš„<code>then()</code>ä¼šç­‰å¾…è¿™ä¸ª Promise å®ä¾‹æ‰§è¡Œå®Œæ¯•</li></ul></li></ul><p>â–¶ï¸ ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ä½œä¸º<code>catch()</code>è€Œä¸æ˜¯ä½¿ç”¨é“¾å¼<code>catch()</code>ï¼ŒåŒºåˆ«æ˜¯ç¬¬äºŒä¸ªå‚æ•°åªæ•è·å½“å‰çš„é”™è¯¯ï¼Œè€Œä¸æ˜¯æ•´æ¡é“¾çš„ã€‚æœ‰åˆ©æœ‰å¼Šï¼š</p><ul><li>ä¼˜ç‚¹ï¼šå¯ä»¥åœ¨é“¾ä¸­çš„ä»»ä½•ä½ç½®å¤„ç†é”™è¯¯ï¼Œæˆ–è€…è¯´å¹¶ä¸”å®¹æ˜“æ‰¾å‡ºé”™è¯¯å‘ç”Ÿçš„ä½ç½®</li><li>ç¼ºç‚¹ï¼šå¦‚æœåœ¨é“¾ä¸­çš„å¤šä¸ªä½ç½®éƒ½éœ€è¦å¤„ç†é”™è¯¯ï¼Œå°±éœ€è¦å¤šæ¬¡è°ƒç”¨<code>catch()</code>ï¼Œè¿™æ ·å°±ä¼šé€ æˆä»£ç å†—ä½™</li></ul><p>é™¤äº†ä½¿ç”¨é“¾æ¡æœ€åçš„<code>catch()</code>æ•è·æ•´æ¡é“¾çš„é”™è¯¯ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>unhandledrejection</code>äº‹ä»¶æ•è·æ•´æ¡é“¾çš„é”™è¯¯</p><p><strong>web</strong>ç¯å¢ƒä¸­ï¼ˆå…¨å°å†™å‘½åï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;unhandledrejection&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(event.<span class="property">reason</span>); <span class="comment">// å¤±è´¥åŸå› ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªé”™è¯¯å¯¹è±¡</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(event.<span class="property">promise</span>); <span class="comment">// å¤±è´¥çš„ Promise å®ä¾‹</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>node</strong>ç¯å¢ƒä¸­ï¼ˆé©¼å³°å¼å‘½åï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">process.<span class="title function_">on</span>(<span class="string">&quot;unhandledRejection&quot;</span>, <span class="function">(<span class="params">reason, promise</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(reason); <span class="comment">// å¤±è´¥åŸå› ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªé”™è¯¯å¯¹è±¡</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(promise); <span class="comment">// å¤±è´¥çš„ Promise å®ä¾‹</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>åŠ è½½å›¾ç‰‡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadImage</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> image = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">    image.<span class="property">src</span> = url;</span><br><span class="line">    image.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(image);</span><br><span class="line">    &#125;;</span><br><span class="line">    image.<span class="property">onerror</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">reject</span>(<span class="string">&quot;åŠ è½½å›¾ç‰‡å‡ºé”™ï¼&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">loadImage</span>(<span class="string">&quot;coffee.jpg&quot;</span>).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(result);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h2><p><code>Promise.resolve()</code>ï¼šè¿”å›ä¸€ä¸ª<strong>é€šè¿‡</strong>çš„ promise</p><p>ğŸ˜… å¦‚æœé‡Œé¢ä¼ å…¥äº†ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢åˆåˆšå¥½æœ‰<code>then()</code>æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±ä¼šè¢«å½“ä½œä¸€ä¸ª promise å®ä¾‹ï¼Œç„¶åè¿”å›è¿™ä¸ªå¯¹è±¡ï¼ˆthenableï¼‰</p><ul><li>Promise ä¸ºæ™®åŠçš„æ—¶å€™ï¼Œå…¶ä»–åº“å¯èƒ½ä¼šæœ‰è‡ªå·±çš„ promise å®ç°ï¼Œè¿™äº›å®ç°å¯èƒ½ä¸ä¼šéµå¾ª Promise/A+ è§„èŒƒï¼Œä½†æ˜¯ä¼šæœ‰<code>then()</code>æ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨<code>Promise.resolve()</code>å°†å…¶è½¬æ¢ä¸º Promise å®ä¾‹</li></ul><p><code>Promise.reject()</code>ï¼šè¿”å›ä¸€ä¸ª<strong>æ‹’ç»</strong>çš„ promise</p><p>ğŸ‡ ä»¥ä¸‹é™æ€æ–¹æ³•å‚æ•°æ¥æ”¶ä¸€ä¸ª <em>æ•°ç»„</em> ä½œä¸ºå‚æ•°ï¼Œæ•°ç»„é‡Œé¢çš„æ˜¯ promise å®ä¾‹ï¼ˆ<code>Array&lt;Promise&gt;</code>ï¼‰</p><ul><li>è¿”å›å€¼æ˜¯ä¸€ä¸ª promise å®ä¾‹</li></ul><p><code>Promise.all()</code>ï¼šåªè¦æœ‰ä¸€ä¸ª<strong>æ‹’ç»</strong>ï¼Œå°±æ˜¯æ‹’ç»ã€‚</p><p><code>Promise.race()</code>ï¼šåªè¦æœ‰ä¸€ä¸ª<strong>é€šè¿‡</strong>ï¼Œå°±æ˜¯é€šè¿‡</p><p><code>Promise.allSettled()</code>ï¼šä¸ç®¡æ˜¯<strong>æ‹’ç»</strong>è¿˜æ˜¯<strong>é€šè¿‡</strong>ï¼Œéƒ½ä¼šæ‰§è¡Œ</p><h3 id="ä¾‹å­-1"><a href="#ä¾‹å­-1" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>ajax è¯·æ±‚è¶…æ—¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="title function_">ajax</span>(<span class="string">&quot;api/xxx&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> timeout = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;è¯·æ±‚è¶…æ—¶&quot;</span>)), <span class="number">5000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>([request, timeout])</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>node.js ä¸­çš„è¯»å–æ–‡ä»¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">readFile</span>(<span class="params">filename</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    fs.<span class="title function_">readFile</span>(filename, &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span> &#125;, <span class="function">(<span class="params">err, contents</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="title function_">reject</span>(err);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">resolve</span>(contents);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> promise = <span class="title function_">readFile</span>(<span class="string">&quot;example.txt&quot;</span>);</span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">(<span class="params">contents</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(contents);</span><br><span class="line">&#125;);</span><br><span class="line">promise.<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line">promise.<span class="title function_">then</span>(</span><br><span class="line">  <span class="function">(<span class="params">contents</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(contents);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="title function_">readFile</span>(<span class="string">&quot;happy.txt&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="title function_">readFile</span>(<span class="string">&quot;happyok.txt&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> p3 = <span class="title function_">readFile</span>(<span class="string">&quot;happyno.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([p1, p2, p3]).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>([p1, p2, p3]).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ç”±äºp1æ‰§è¡Œè¾ƒå¿«ï¼ŒPromiseçš„then()å°†è·å¾—ç»“æœ&#x27;P1&#x27;ã€‚p2,p3ä»åœ¨ç»§ç»­æ‰§è¡Œï¼Œä½†æ‰§è¡Œç»“æœå°†è¢«ä¸¢å¼ƒã€‚</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="async-å’Œ-await"><a href="#async-å’Œ-await" class="headerlink" title="async å’Œ await"></a>async å’Œ await</h1><blockquote><p>å¯¹æ¯”ç”Ÿæˆå™¨ï¼Œ<code>*</code>å»æ‰ï¼Œæ¢æˆ<code>async</code>ï¼Œ<code>yield</code>æ¢æˆ<code>await</code>ï¼Œä¸éœ€è¦æ‰§è¡Œå™¨å‡½æ•°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª promise å®ä¾‹</p></blockquote><blockquote><p><code>async</code>å’Œ<code>await</code>å…³é”®å­—è®©æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼å†™å‡ºåŸºäº<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a>çš„å¼‚æ­¥è¡Œä¸ºï¼Œè€Œæ— éœ€åˆ»æ„åœ°é“¾å¼è°ƒç”¨<code>promise</code>ã€‚</p></blockquote><h2 id="async"><a href="#async" class="headerlink" title="async"></a>async</h2><p>ä½¿ç”¨ <code>async</code> å…³é”®å­—ï¼ŒæŠŠå®ƒæ”¾åœ¨å‡½æ•°å£°æ˜ä¹‹å‰ï¼Œä½¿å…¶æˆä¸º <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">async function</a></p><ul><li>async å‡½æ•°æ˜¯ä½¿ç”¨<code>async</code>å…³é”®å­—å£°æ˜çš„å‡½æ•°ï¼Œå…¶ä¸­å…è®¸ä½¿ç”¨<code>await</code>å…³é”®å­—ã€‚</li></ul><p>å°† <code>async</code> å…³é”®å­—åŠ åˆ°å‡½æ•°ç”³æ˜ä¸­ï¼Œå¯ä»¥å‘Šè¯‰å®ƒä»¬è¿”å›çš„æ˜¯ promiseï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›å€¼ã€‚</p><h2 id="await"><a href="#await" class="headerlink" title="await"></a>await</h2><ul><li>åŸç”Ÿ Promiseï¼Œç­‰å¾…</li><li>thenable å¯¹è±¡ï¼Œæ„é€ æˆæ–°çš„ Promise</li><li>ä¸æ˜¯ thenable å¯¹è±¡ï¼ŒåŒ…è£…æˆ <code>Promise.resolve()</code></li></ul><p><del>await åªåœ¨å¼‚æ­¥å‡½æ•°é‡Œé¢æ‰èµ·ä½œç”¨</del>ã€‚å®ƒå¯ä»¥æ”¾åœ¨ä»»ä½•å¼‚æ­¥çš„ï¼ŒåŸºäº promise çš„å‡½æ•°ä¹‹å‰ã€‚</p><blockquote><p><code>nodejs 14.8.0</code> es æ¨¡å—æ”¯æŒé¡¶çº§<code>await</code>; æµè§ˆå™¨ç¯å¢ƒï¼Œä¹Ÿæ˜¯åœ¨æ¨¡å—é¡¶çº§å¯ç”¨</p></blockquote><p>å®ƒä¼šæš‚åœä»£ç åœ¨è¯¥è¡Œä¸Šï¼Œç›´åˆ° promise å®Œæˆï¼Œç„¶åè¿”å›ç»“æœå€¼ã€‚åœ¨æš‚åœçš„åŒæ—¶ï¼Œå…¶ä»–æ­£åœ¨ç­‰å¾…æ‰§è¡Œçš„ä»£ç å°±æœ‰æœºä¼šæ‰§è¡Œäº†ã€‚(è¿™æ ·çš„å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç )</p><h2 id="ä¾‹å­-2"><a href="#ä¾‹å­-2" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><p>å°†ä¸Šé¢çš„ promise æ”¹ä¸º async æ¨¡å¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">load</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> image = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">  image.<span class="property">src</span> = url;</span><br><span class="line">  <span class="keyword">return</span> image;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">append</span>(<span class="params">image</span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(image);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loadImage</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> image = <span class="keyword">await</span> <span class="title function_">load</span>(url);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">append</span>(image);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">loadImage</span>(<span class="string">&quot;coffee.jpg&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç»“åˆ axios ä½¿ç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.  async åŸºç¡€ç”¨æ³•</span></span><br><span class="line"><span class="comment">// 1.1 asyncä½œä¸ºä¸€ä¸ªå…³é”®å­—æ”¾åˆ°å‡½æ•°å‰é¢</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">queryData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 1.2 awaitå…³é”®å­—åªèƒ½åœ¨ä½¿ç”¨asyncå®šä¹‰çš„å‡½æ•°ä¸­ä½¿ç”¨      awaitåé¢å¯ä»¥ç›´æ¥è·Ÿä¸€ä¸ª Promiseå®ä¾‹å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">var</span> ret = <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(<span class="string">&quot;nihao&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// console.log(ret.data)</span></span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1.3 ä»»ä½•ä¸€ä¸ªasyncå‡½æ•°éƒ½ä¼šéšå¼è¿”å›ä¸€ä¸ªpromise   æˆ‘ä»¬å¯ä»¥ä½¿ç”¨then è¿›è¡Œé“¾å¼ç¼–ç¨‹</span></span><br><span class="line"><span class="title function_">queryData</span>().<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.  async    å‡½æ•°å¤„ç†å¤šä¸ªå¼‚æ­¥å‡½æ•°</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&quot;http://localhost:3000&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">queryData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 2.1  æ·»åŠ awaitä¹‹å å½“å‰çš„await è¿”å›ç»“æœä¹‹åæ‰ä¼šæ‰§è¡Œåé¢çš„ä»£ç </span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> info = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;async1&quot;</span>);</span><br><span class="line">  <span class="comment">//2.2  è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥ã€è¡¨ç°èµ·æ¥æ›´åƒåŒæ­¥ä»£ç </span></span><br><span class="line">  <span class="keyword">var</span> ret = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;async2?info=&quot;</span> + info.<span class="property">data</span>);</span><br><span class="line">  <span class="keyword">return</span> ret.<span class="property">data</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">queryData</span>().<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡"><a href="#å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡" class="headerlink" title="å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡"></a>å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡</h1><p>å®ä»»åŠ¡ï¼Œé‡æ–°å›åˆ°ä»»åŠ¡é˜Ÿåˆ—çš„æœ«å°¾ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯ï¼›è€Œå¾®ä»»åŠ¡ï¼Œä¼šåœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œç»“æŸåç«‹å³æ‰§è¡Œã€‚</p><h1 id="ç”Ÿæˆå™¨"><a href="#ç”Ÿæˆå™¨" class="headerlink" title="ç”Ÿæˆå™¨"></a>ç”Ÿæˆå™¨</h1><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>çŸ¥è¯†ç‚¹ï¼š<code>yeild</code>å…³é”®å­—ï¼Œ<code>generator.next()</code>ï¼Œ<code>gernerator.throw()</code>ï¼Œ<code>generator.return()</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆæ¬¡è°ƒç”¨ï¼Œé‡Œé¢å†…å®¹å°šæœªæ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">const</span> generator = <span class="title function_">foo</span>();</span><br><span class="line"><span class="comment">// åªæœ‰è°ƒç”¨next()æ‰ä¼šæ‰§è¡Œ</span></span><br><span class="line">generator.<span class="title function_">next</span>();</span><br></pre></td></tr></table></figure><p>åœ¨é‡Œé¢æ·»åŠ <code>yield</code>å…³é”®å­—ï¼Œå¯ä»¥è®©å‡½æ•°æš‚åœæ‰§è¡Œï¼Œç„¶åè¿”å›ä¸€ä¸ªå€¼</p><ul><li>è¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸¤ä¸ªå±æ€§ï¼š<code>value</code>å’Œ<code>done</code>ï¼Œ<code>value</code>æ˜¯<code>yield</code>åé¢çš„å€¼ï¼Œ<code>done</code>æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰§è¡Œå®Œæ¯•ã€‚</li><li>å’Œ<code>return</code>ä¸åŒï¼Œ<code>yield</code>ä¸ä¼šç«‹å³ç»“æŸå‡½æ•°çš„æ‰§è¡Œï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå€¼ï¼Œç„¶åæš‚åœæ‰§è¡Œï¼Œç­‰åˆ°ä¸‹ä¸€æ¬¡è°ƒç”¨<code>next()</code>çš„æ—¶å€™ï¼Œå†ç»§ç»­æ‰§è¡Œã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;end&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generator = <span class="title function_">foo</span>();</span><br><span class="line">generator.<span class="title function_">next</span>(); <span class="comment">// start</span></span><br><span class="line">generator.<span class="title function_">next</span>(); <span class="comment">// end</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè°ƒç”¨<code>next()</code>çš„æ—¶å€™ä¼ å…¥äº†å‚æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ä¼šä½œä¸ºä¸Šä¸€æ¬¡<code>yield</code>çš„è¿”å›å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> val = <span class="keyword">yield</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(val);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;end&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generator = <span class="title function_">foo</span>();</span><br><span class="line">generator.<span class="title function_">next</span>(); <span class="comment">// start</span></span><br><span class="line">generator.<span class="title function_">next</span>(<span class="string">&quot;world&quot;</span>); <span class="comment">// world end</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè°ƒç”¨<code>gernerator.throw()</code>ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯åœ¨<em>ç”Ÿæˆå™¨å‡½æ•°</em>å†…éƒ¨æŠ›å‡ºï¼Œå¯ä½¿ç”¨<code>try...catch</code>æ•è·</p><h2 id="ç®¡ç†å¼‚æ­¥"><a href="#ç®¡ç†å¼‚æ­¥" class="headerlink" title="ç®¡ç†å¼‚æ­¥"></a>ç®¡ç†å¼‚æ­¥</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> users = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&quot;api/users.json&quot;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(users);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> posts = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&quot;api/posts.json&quot;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(posts);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generator = <span class="title function_">main</span>();</span><br><span class="line"><span class="keyword">const</span> result1 = generator.<span class="title function_">next</span>();</span><br><span class="line">result1.<span class="property">value</span>.<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> result2 = generator.<span class="title function_">next</span>(data);</span><br><span class="line">  <span class="keyword">if</span> (result2.<span class="property">done</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  result2.<span class="property">value</span>.<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    generator.<span class="title function_">next</span>(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ”¹ä¸ºé€’å½’çš„æ–¹å¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> users = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&quot;api/users.json&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(users);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> posts = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&quot;api/posts.json&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(posts);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleResult</span>(<span class="params">result</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (result.<span class="property">done</span>) <span class="keyword">return</span>;</span><br><span class="line">  result.<span class="property">value</span></span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">handleResult</span>(generator.<span class="title function_">next</span>(data));</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// æŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨ç”Ÿæˆå™¨å‡½æ•°main()ä¸­ä½¿ç”¨try...catchæ•è·</span></span><br><span class="line">      generator.<span class="keyword">throw</span>(err);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generator = <span class="title function_">main</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">handleResult</span>(generator.<span class="title function_">next</span>());</span><br></pre></td></tr></table></figure><p>å°è£…æˆæ‰§è¡Œå™¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">generator</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> iterator = <span class="title function_">generator</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleResult</span>(<span class="params">result</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (result.<span class="property">done</span>) <span class="keyword">return</span>;</span><br><span class="line">    result.<span class="property">value</span></span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">handleResult</span>(iterator.<span class="title function_">next</span>(data));</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        iterator.<span class="keyword">throw</span>(err);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleResult</span>(iterator.<span class="title function_">next</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">run</span>(main);</span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªä¸“é—¨çš„åº“å¯ä»¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š<a href="https://github.com/tj/co" target="_blank">co</a></p><p>ä¸è¿‡åæ¥å‡ºç°äº†<code>async</code>å’Œ<code>await</code>ï¼Œæ‰€ä»¥è¿™ä¸ªåº“ç”¨å¾—å°±å°‘äº†ã€‚</p><!-- <span style="font-size: 70px; color: black; background-color: yellow;padding: 20px">å¼‚æ­¥JavaScript</span> --><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸŒ å‚è€ƒï¼š&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Asynchronous&quot;&gt;MDN-å¼‚æ­¥ JavaScript&lt;/a&gt;ï¼Œã€Šæ·±å…¥ç†è§£ ES6ã€‹- NICHOLAS C.ZAKASï¼Œé»‘é©¬ç¨‹åºå‘˜ï¼Œç‹ç£ŠåŒå­¦</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="js" scheme="https://smalljerry.cn/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>ç½‘ç»œè¯·æ±‚</title>
    <link href="https://smalljerry.cn/2021/05/08/ajax%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
    <id>https://smalljerry.cn/2021/05/08/ajax%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</id>
    <published>2021-05-08T09:01:24.000Z</published>
    <updated>2025-02-22T02:14:47.345Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸŒ åˆ—ä¸¾ JavaScript ä¸­ç½‘ç»œè¯·æ±‚çš„æ–¹å¼</p><p>ğŸ“¦ ajax, jqeury.ajax, fetch, axios, got</p><span id="more"></span><h1 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h1><blockquote><p>ç¯å¢ƒ: æµè§ˆå™¨</p></blockquote><p>å…¨ç§°ï¼šå¼‚æ­¥ JavaScript å’Œ XMLï¼ˆAsynchronous JavaScript and XMLï¼‰</p><ul><li>ä¸æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œè€Œæ˜¯ä¸€ç§å°†ç°æœ‰æŠ€æœ¯ç»“åˆèµ·æ¥çš„ä½¿ç”¨æ–¹æ³•ã€‚ğŸŒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/AJAX">mdn ajax æ–‡æ¡£</a></li><li>è™½ç„¶å…¶ä¸­ X ä»£è¡¨ <em>XML_ï¼Œä½†æ˜¯ _JSON</em> æ˜¯é¦–é€‰ç±»å‹</li></ul><p>ä½¿ç”¨ AJAX å‘é€çš„è¯·æ±‚å’Œä¼ ç»Ÿçš„è¡¨å• (<code>&lt;form&gt;</code>æ ‡ç­¾) çš„è¯·æ±‚æ–¹å¼ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨æŒ‰é’®ï¼Œå…¶å±æ€§ç±»å‹ä¸ç”¨è®¾ç½®ä¸º<code>submit</code>ï¼Œ<code>name</code>å±æ€§ä¹Ÿä¸ç”¨å†™å‡ºæ¥</p><h2 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. åˆ›å»ºajaxå¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"><span class="comment">// 2. è¯·æ±‚çš„æ–¹å¼å’Œè¯·æ±‚åœ°å€ã€‚ç¬¬ä¸‰ä¸ªå‚æ•° boolean æŒ‡å®šæ˜¯å¦ä¸ºå¼‚æ­¥</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;get&quot;</span>, <span class="string">&quot;http:localhost/test&quot;</span>);</span><br><span class="line"><span class="comment">// 3. å‘é€è¯·æ±‚ã€‚å‚æ•°å¯ä¼ é€’ä»»ä½•æƒ³ä¼ åˆ°æœåŠ¡å™¨çš„å†…å®¹</span></span><br><span class="line">xhr.<span class="title function_">send</span>();</span><br><span class="line"><span class="comment">// 4. è·å–æœåŠ¡å™¨ç«¯å“åº”çš„å†…å®¹</span></span><br><span class="line">xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢ç¬¬ 4 ç‚¹ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>xhr.onreadystatechange</code>äº‹ä»¶ï¼Œä¸åŒçš„æ˜¯ä½¿ç”¨è¿™ä¸ªæ–¹æ³•éœ€è¦å¯¹å“åº”çŠ¶æ€è¿›è¡Œåˆ¤æ–­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">onreadystatechange</span>() = <span class="keyword">function</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿™ä¸ªæ–¹æ³•å…¼å®¹ä½ç‰ˆæœ¬ IE æµè§ˆå™¨ï¼Œ<code>xhr.onload</code>ä¸å…¼å®¹ä½ç‰ˆæœ¬ IE æµè§ˆå™¨</li><li>è¿™ä¸ªæ–¹æ³•ä¼šè¢«è°ƒç”¨å¤šæ¬¡ï¼Œ<code>xhr.onload</code>åªè°ƒç”¨ä¸€æ¬¡</li><li>è¿™ä¸ªæ–¹æ³•éœ€è¦å¯¹å“åº”çŠ¶æ€ç åˆ¤æ–­ï¼Œ<code>xhr.onload</code>ä¸ç”¨</li></ul><blockquote><p>åœ¨ä¸Šé¢ä¸­å¾—åˆ°çš„å“åº”æ•°æ®æ˜¯<code>String</code>ç±»å‹ï¼Œè¦å°†å…¶è½¬æ¢å¯ä»¥ä½¿ç”¨<code>JSON.parse(xhr.responseText)</code></p></blockquote><h2 id="è¯·æ±‚å‚æ•°çš„ä¼ é€’"><a href="#è¯·æ±‚å‚æ•°çš„ä¼ é€’" class="headerlink" title="è¯·æ±‚å‚æ•°çš„ä¼ é€’"></a>è¯·æ±‚å‚æ•°çš„ä¼ é€’</h2><p>ä¾‹å¦‚æœ‰è¿™æ ·çš„ä¸€ä¸ªé¡µé¢</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> /&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;age&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id="GET-è¯·æ±‚"><a href="#GET-è¯·æ±‚" class="headerlink" title="GET è¯·æ±‚"></a>GET è¯·æ±‚</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"><span class="comment">// é…ç½®è¯·æ±‚å‚æ•°</span></span><br><span class="line"><span class="keyword">let</span> userName = username.<span class="property">value</span>;</span><br><span class="line"><span class="keyword">let</span> userAge = age.<span class="property">value</span>;</span><br><span class="line"><span class="keyword">let</span> params = <span class="string">&quot;username=&quot;</span> + userName + <span class="string">&quot;&amp;age=&quot;</span> + userAge;</span><br><span class="line"><span class="comment">// å‚æ•°åœ¨è¯·æ±‚çš„urlä¸­</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;get&quot;</span>, <span class="string">&quot;http:localhost/get?&quot;</span> + params);</span><br><span class="line">xhr.<span class="title function_">send</span>();</span><br><span class="line">xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>è¯·æ±‚åœ°å€ä¸å‚æ•°ä¹‹é—´ä½¿ç”¨ <code>?</code> éš”å¼€ï¼Œå‚æ•°ä¸å‚æ•°ä¹‹é—´ä½¿ç”¨ <code>&amp;</code> éš”å¼€</li></ul><h3 id="POST-è¯·æ±‚"><a href="#POST-è¯·æ±‚" class="headerlink" title="POST è¯·æ±‚"></a>POST è¯·æ±‚</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> userName = username.<span class="property">value</span>;</span><br><span class="line"><span class="keyword">let</span> userAge = age.<span class="property">value</span>;</span><br><span class="line"><span class="keyword">let</span> params = <span class="string">&quot;username=&quot;</span> + userName + <span class="string">&quot;&amp;age=&quot;</span> + userAge;</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;get&quot;</span>, <span class="string">&quot;http:localhost/post&quot;</span>);</span><br><span class="line"><span class="comment">// postè¯·æ±‚éœ€è¦è®¾ç½®è¯·æ±‚å‚æ•°çš„ç±»å‹</span></span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line"><span class="comment">// å‘é€è¯·æ±‚æ—¶éœ€è¦ä¼ é€’å‚æ•°</span></span><br><span class="line">xhr.<span class="title function_">send</span>(params);</span><br><span class="line">xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ±‚å‚æ•°çš„ç±»å‹æœ‰ï¼š</p><ul><li><code>application/x-www-form-urlencoded</code>çš„å½¢å¼ï¼šname=zs&amp;age=20</li><li><code>application/json</code>çš„å½¢å¼ï¼š{ name: â€˜zsâ€™, age: 20 }</li></ul><p>åœ¨è¯·æ±‚å¤´ä¸­æŒ‡å®š <em>Content-Type</em> å±æ€§çš„å€¼æ˜¯ <em>application/json</em> çš„æ—¶å€™å°±æ˜¯å‘Šè¯‰æœåŠ¡å™¨å½“å‰è¯·æ±‚çš„æ ¼å¼æ˜¯ json</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ˜¯ç”¨ <em>json</em> æ ¼å¼å‘é€è¯·æ±‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line"><span class="comment">// ç„¶åéœ€è¦å°†jsonå¯¹è±¡è½¬æ¢æˆjsonå­—ç¬¦ä¸²</span></span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;zs&quot;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;));</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨çš„æ˜¯ Node.jsï¼Œå°±åœ¨å…¥å£æ–‡ä»¶ä¸­é…ç½®ï¼Œæ¥å†³å®šè¯·æ±‚çš„å‚æ•°ç±»å‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>());</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br></pre></td></tr></table></figure><blockquote><p>ä¼ ç»Ÿçš„è¡¨å•æäº¤å’Œ GET è¯·æ±‚éƒ½<strong>ä¸æ”¯æŒ</strong>æäº¤ json ç±»å‹çš„æ•°æ®</p></blockquote><h2 id="å“åº”çŠ¶æ€"><a href="#å“åº”çŠ¶æ€" class="headerlink" title="å“åº”çŠ¶æ€"></a>å“åº”çŠ¶æ€</h2><h3 id="ajax-çŠ¶æ€ç "><a href="#ajax-çŠ¶æ€ç " class="headerlink" title="ajax çŠ¶æ€ç "></a>ajax çŠ¶æ€ç </h3><p>åœ¨åˆ›å»º ajax å¯¹è±¡ã€é…ç½®ã€å‘é€è¯·æ±‚ã€æ¥æ”¶æœåŠ¡ç«¯è¿”å›çš„å†…å®¹çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¿™å°±æ˜¯ ajax çŠ¶æ€ç ï¼Œä½¿ç”¨<code>xhr.readyState</code>è·å¾—ã€‚</p><ul><li>0ï¼šè¯·æ±‚æ²¡æœ‰åˆå§‹åŒ–</li><li>1ï¼šæœåŠ¡è¿æ¥å·²ç»å»ºç«‹ï¼Œä½†è¿˜æ²¡è°ƒç”¨ send()</li><li>2ï¼šå·²ç»åŠ è½½å®Œæˆ</li><li>3ï¼šæ­£åœ¨å¤„ç†è¯·æ±‚ï¼ˆè¿™æ—¶å€™æœ‰ä¸€éƒ¨åˆ†çš„å“åº”æ•°æ®æ˜¯å¯ä»¥ä½¿ç”¨çš„äº†ï¼‰</li><li>4ï¼šå“åº”å®Œæˆ</li></ul><p>æ•°å€¼å¯é€šè¿‡<code>XMLHttpRequest.åç§°è·å¾—</code>ï¼šæœ‰<code>DONE</code>,<code>OPENED</code>,<code>HEADERS_RECEIVED</code>,<code>LOADING</code>,<code>DONE</code></p><h3 id="http-çŠ¶æ€ç "><a href="#http-çŠ¶æ€ç " class="headerlink" title="http çŠ¶æ€ç "></a>http çŠ¶æ€ç </h3><ol><li>ç½‘ç»œæ­£å¸¸ï¼ŒæœåŠ¡å™¨æ¥æ”¶è¯·æ±‚ä¹‹åè¿”å›çš„æ•°æ®ä¸æ˜¯é¢„æœŸçš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨<code>xhr.status</code>è·å–æœåŠ¡å™¨è¿”å›çš„ http çŠ¶æ€ç æ¥åˆ¤æ–­ï¼ˆ_æœåŠ¡å™¨çŠ¶æ€ç å’Œ ajax çŠ¶æ€ç ä¸ä¸€æ ·_ï¼‰</li><li>ç½‘ç»œæ­£å¸¸ï¼ŒæœåŠ¡ç«¯è¿”å›äº† <em>404</em> çŠ¶æ€ç ï¼Œå¯èƒ½æ˜¯è¯·æ±‚çš„åœ°å€æœ‰é”™</li><li>ç½‘ç»œæ­£å¸¸ï¼ŒæœåŠ¡å™¨è¿”å›äº† <em>505</em> çŠ¶æ€ç ï¼ŒæœåŠ¡å™¨å‡ºäº†é—®é¢˜</li><li>ç½‘ç»œæ–­äº†ï¼Œä½¿ç”¨ <code>xhr.onerror()</code>æ¥å¤„ç†é”™è¯¯</li></ol><blockquote><p>åŒºåˆ† ajax çŠ¶æ€ç å’Œ http çŠ¶æ€ç </p><ul><li><p>ajax çŠ¶æ€ç ï¼šè¡¨ç¤º ajax çš„è¯·æ±‚è¿‡ç¨‹çŠ¶æ€ï¼Œæ˜¯ ajax å¯¹è±¡è¿”å›çš„</p></li><li><p>http çŠ¶æ€ç ï¼šè¡¨ç¤ºè¯·æ±‚çš„ç»“æœï¼Œæ˜¯æœåŠ¡å™¨è¿”å›çš„</p></li></ul></blockquote><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><h4 id="ä½ç‰ˆæœ¬-IE-æµè§ˆå™¨ç¼“å­˜"><a href="#ä½ç‰ˆæœ¬-IE-æµè§ˆå™¨ç¼“å­˜" class="headerlink" title="ä½ç‰ˆæœ¬ IE æµè§ˆå™¨ç¼“å­˜"></a>ä½ç‰ˆæœ¬ IE æµè§ˆå™¨ç¼“å­˜</h4><p>åœ¨ä½ç‰ˆæœ¬çš„ IE æµè§ˆå™¨ä¸­ï¼Œè¯·æ±‚çš„å†…å®¹åªåŸºäºç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œå³æ˜¯è¯·æ±‚çš„æ–‡ä»¶é‡Œé¢çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–ï¼Œå®¢æˆ·ç«¯ä¾ç„¶ä½¿ç”¨æ—§çš„æ•°æ®ã€‚</p><p>è§£å†³æ–¹æ³•ï¼Œä½¿å¾—æ¯æ¬¡è¯·æ±‚çš„å‚æ•°ä¸ä¸€æ ·ï¼ˆä½†æ˜¯ä¸èƒ½å’Œç°æœ‰çš„å‚æ•°ç›¸åŒï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;get&quot;</span>, <span class="string">&quot;http://test.com?page=&quot;</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br></pre></td></tr></table></figure><h4 id="ajax-å¼‚æ­¥"><a href="#ajax-å¼‚æ­¥" class="headerlink" title="ajax å¼‚æ­¥"></a>ajax å¼‚æ­¥</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;1&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>å…ˆè¾“å‡º 1ï¼Œå†è¾“å‡º 2</li></ul><h1 id="jQuery-ajax"><a href="#jQuery-ajax" class="headerlink" title="jQuery.ajax"></a>jQuery.ajax</h1><p>ä½¿ç”¨å¤§è‡´åˆ†ä¸ºä¸¤ç§ï¼š</p><ul><li>æµè§ˆå™¨ç¯å¢ƒ<code>&lt;script&gt;</code>æ ‡ç­¾å¼•å…¥ï¼Œå¼•å…¥ä»å®˜ç½‘ä¸‹è½½çš„<a href="https://jquery.com/download/">jqeury</a>ï¼Œæˆ–è€…é€šè¿‡ CDN</li><li>node ç¯å¢ƒ npm åŒ…</li></ul><p><strong>æµè§ˆå™¨ç¯å¢ƒ</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;jquery-3.7.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>BTN<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  $(<span class="string">&quot;#btn&quot;</span>).<span class="title function_">on</span>(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    $.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">url</span>: <span class="string">&quot;xxx&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">succuess</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">error</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>node ç¯å¢ƒä½¿ç”¨</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jquery --save</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; ajax &#125; = <span class="built_in">require</span>(<span class="string">&quot;jqeury&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">ajax</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">success</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">  <span class="attr">error</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h1><blockquote><p>ç¯å¢ƒ: æµè§ˆå™¨ï¼Œnodejs v17.5.0, v16.15.0 å¼€å§‹æ”¯æŒ fetch</p></blockquote><p>å’Œ <em>jquery.ajax()</em> ä¸åŒæœ‰ï¼š</p><ul><li>è¿”å›çš„<code>Promise</code>ä¸ä¼šå› ä¸º HTTP é”™è¯¯çŠ¶æ€è€Œè¢«æ‹’ç»ï¼ˆ404ã€500ï¼‰ï¼Œæ­£å¸¸ resolveï¼Œåªä¸è¿‡ <em>ok</em> çŠ¶æ€è®¾ç½®æˆäº† _false_ã€‚ç½‘ç»œæ•…éšœæˆ–è€…æƒ…è¶£é˜»æ­¢æ—¶æ‰ä¼š reject</li><li>é»˜è®¤ä¸å‘é€è·¨æº cookie</li></ul><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;http://example.com/movies.json&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data));</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡<code>response.ok</code>æ¥åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸï¼ˆå€¼æ˜¯ boolean ç±»å‹ï¼‰ã€‚<code>true</code>çš„æ—¶å€™ï¼ŒçŠ¶æ€ç èŒƒå›´æ˜¯ <code>200-299</code></li><li><code>response.status</code>ï¼ŒçŠ¶æ€ç ï¼Œé»˜è®¤å€¼æ˜¯ <code>200</code></li><li><code>response.statusText</code>ï¼šé»˜è®¤å€¼æ˜¯ <code>&quot;&quot;</code>ã€‚<ul><li>OK -&gt; 200</li><li>Continue -&gt; 100</li><li>Not Found -&gt; 404</li></ul></li></ul><p>ç¬¬äºŒä¸ªå‚æ•°è®¾ç½®é…ç½®å¯¹è±¡(init å¯¹è±¡)ï¼Œå¸¸ç”¨çš„æœ‰</p><ul><li>methodï¼šè¯·æ±‚æ–¹æ³•</li><li>modeï¼šno-cors, *cors, same-origin</li><li>headers: { â€œContent-Typeâ€: â€œapplication/jsonâ€ },</li><li>body: JSON.stringify(data)</li></ul><p>è¯·æ±‚ä½“å¯ä»¥é…åˆ <code>FormData</code>ä½¿ç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line"><span class="keyword">const</span> fileField = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input[type=&quot;file&quot;]&#x27;</span>);</span><br><span class="line"></span><br><span class="line">formData.<span class="title function_">append</span>(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;abc123&quot;</span>);</span><br><span class="line">formData.<span class="title function_">append</span>(<span class="string">&quot;avatar&quot;</span>, fileField.<span class="property">files</span>[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;https://example.com/profile/avatar&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">  <span class="attr">body</span>: formData,</span><br><span class="line">&#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Success:&quot;</span>, result);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error:&quot;</span>, error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰è¯·æ±‚å¯¹è±¡"><a href="#è‡ªå®šä¹‰è¯·æ±‚å¯¹è±¡" class="headerlink" title="è‡ªå®šä¹‰è¯·æ±‚å¯¹è±¡"></a>è‡ªå®šä¹‰è¯·æ±‚å¯¹è±¡</h2><p>é€šè¿‡<code>new Request</code>åˆ›å»ºä¸€ä¸ªè¯·æ±‚å¯¹è±¡ï¼ˆå’Œ<code>fetch</code>æ¥æ”¶çš„å‚æ•°ç›¸åŒï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myHeaders = <span class="keyword">new</span> <span class="title class_">Headers</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myRequest = <span class="keyword">new</span> <span class="title class_">Request</span>(<span class="string">&quot;flowers.jpg&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">  <span class="attr">headers</span>: myHeaders,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;cors&quot;</span>,</span><br><span class="line">  <span class="attr">cache</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(myRequest)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">blob</span>())</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">myBlob</span>) =&gt;</span> &#123;</span><br><span class="line">    myImage.<span class="property">src</span> = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(myBlob);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>æˆ–è®¸åœ¨è¦å¤ç”¨æŸäº›ä»£ç çš„æ—¶å€™ï¼Œè¿™ä¼šå¾ˆå¥½ç”¨</p><h1 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h1><blockquote><p>ç¯å¢ƒ: æµè§ˆå™¨ï¼Œnodejs</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure><p>CDN:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="è¯·æ±‚"><a href="#è¯·æ±‚" class="headerlink" title="è¯·æ±‚"></a>è¯·æ±‚</h2><p>æ™®é€šè¯·æ±‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// getè¯·æ±‚ï¼ˆé»˜è®¤æ–¹å¼ï¼‰</span></span><br><span class="line"><span class="title function_">axios</span>(<span class="string">&quot;/user/12345&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// postè¯·æ±‚</span></span><br><span class="line"><span class="title function_">axios</span>(&#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;/user/12345&quot;</span>,</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">firstName</span>: <span class="string">&quot;Fred&quot;</span>,</span><br><span class="line">    <span class="attr">lastName</span>: <span class="string">&quot;Flintstone&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¯·æ±‚ stream ç±»å‹æ•°æ®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ node.js ç”¨GETè¯·æ±‚è·å–è¿œç¨‹å›¾ç‰‡</span></span><br><span class="line"><span class="title function_">axios</span>(&#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;get&quot;</span>,</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;http://bit.ly/2mTM3nY&quot;</span>,</span><br><span class="line">  <span class="attr">responseType</span>: <span class="string">&quot;stream&quot;</span>,</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">  response.<span class="property">data</span>.<span class="title function_">pipe</span>(fs.<span class="title function_">createWriteStream</span>(<span class="string">&quot;ada_lovelace.jpg&quot;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="å“åº”ç»“æ„"><a href="#å“åº”ç»“æ„" class="headerlink" title="å“åº”ç»“æ„"></a>å“åº”ç»“æ„</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// `data` ç”±æœåŠ¡å™¨æä¾›çš„å“åº”</span></span><br><span class="line">  <span class="attr">data</span>: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `status` æ¥è‡ªæœåŠ¡å™¨å“åº”çš„ HTTP çŠ¶æ€ç </span></span><br><span class="line">  <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `statusText` æ¥è‡ªæœåŠ¡å™¨å“åº”çš„ HTTP çŠ¶æ€ä¿¡æ¯</span></span><br><span class="line">  <span class="attr">statusText</span>: <span class="string">&#x27;OK&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `headers` æ˜¯æœåŠ¡å™¨å“åº”å¤´</span></span><br><span class="line">  <span class="comment">// æ‰€æœ‰çš„ header åç§°éƒ½æ˜¯å°å†™ï¼Œè€Œä¸”å¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·è¯­æ³•è®¿é—®</span></span><br><span class="line">  <span class="comment">// ä¾‹å¦‚: `response.headers[&#x27;content-type&#x27;]`</span></span><br><span class="line">  <span class="attr">headers</span>: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `config` æ˜¯ `axios` è¯·æ±‚çš„é…ç½®ä¿¡æ¯</span></span><br><span class="line">  <span class="attr">config</span>: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `request` æ˜¯ç”Ÿæˆæ­¤å“åº”çš„è¯·æ±‚</span></span><br><span class="line">  <span class="comment">// åœ¨node.jsä¸­å®ƒæ˜¯æœ€åä¸€ä¸ªClientRequestå®ä¾‹ (in redirects)ï¼Œ</span></span><br><span class="line">  <span class="comment">// åœ¨æµè§ˆå™¨ä¸­åˆ™æ˜¯ XMLHttpRequest å®ä¾‹</span></span><br><span class="line">  <span class="attr">request</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="got"><a href="#got" class="headerlink" title="got"></a>got</h1><blockquote><p>ç¯å¢ƒ: nodejs</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install got</span><br></pre></td></tr></table></figure><p>å‚è€ƒç½‘ç«™ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript">MDN</a></p><!-- <br/><br/><br/><div style="text-align: center"><span style="font-size: 80px">å‘é€<span style="color: red;">HTTP</span>è¯·æ±‚</span><br /><span style="font-size: 50px">ğŸ’»ğŸ”ğŸŒ</span></div><br/><br/><br/><br/> -->]]></content>
    
    
    <summary type="html">&lt;p&gt;ğŸŒ åˆ—ä¸¾ JavaScript ä¸­ç½‘ç»œè¯·æ±‚çš„æ–¹å¼&lt;/p&gt;
&lt;p&gt;ğŸ“¦ ajax, jqeury.ajax, fetch, axios, got&lt;/p&gt;</summary>
    
    
    
    <category term="å‰ç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="js" scheme="https://smalljerry.cn/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>gitåŸºç¡€ä½¿ç”¨æµç¨‹</title>
    <link href="https://smalljerry.cn/2021/04/21/git%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B/"/>
    <id>https://smalljerry.cn/2021/04/21/git%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B/</id>
    <published>2021-04-21T11:44:42.000Z</published>
    <updated>2025-02-22T02:14:47.356Z</updated>
    
    <content type="html"><![CDATA[<p>ç®€å•è®°å½•<span style="color: orange;">git</span>å’Œ<span style="color: purple;">github</span>çš„ä½¿ç”¨</p><p>æ“ä½œç³»ç»Ÿï¼šWindows</p><span id="more"></span><h1 id="å®‰è£…å’Œé…ç½®"><a href="#å®‰è£…å’Œé…ç½®" class="headerlink" title="å®‰è£…å’Œé…ç½®"></a>å®‰è£…å’Œé…ç½®</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>ğŸ‘‰ <a href="https://git-scm.com/downloads">Gitä¸‹è½½åœ°å€</a></p><p>ä¸‹è½½åå®‰è£…çš„æ—¶å€™ä¸€ç›´ç‚¹ä¸‹ä¸€æ­¥å°±è¡Œ</p><p>å®‰è£…æˆåŠŸåå¯ä»¥å¾—åˆ°3ä¸ªä¸œè¥¿ï¼šgit bashã€git cmdã€git guiã€‚</p><p><img src="https://z3.ax1x.com/2021/04/21/cqkbFA.png" alt="git install successfully"></p><p>git bash å’Œ git cmd åœ¨åŸºæœ¬ä¸Šæ˜¯æ²¡ä»€ä¹ˆåŒºåˆ«çš„ï¼Œæ·±å…¥çš„ç°åœ¨å…ˆä¸ç®¡ã€‚git gui å°±æ˜¯å›¾å½¢ç•Œé¢ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å‘½ä»¤è¡Œæ¨¡å¼å°±è¡Œäº†ã€‚</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>é…ç½®æäº¤äººçš„åå­—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name ä½ çš„åå­—</span><br></pre></td></tr></table></figure><p>é…ç½®æäº¤äººçš„é‚®ç®±</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.email ä½ çš„é‚®ç®±</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç°æœ‰çš„é…ç½®ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --list</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦é‡æ–°é…ç½®è¿™äº›ä¿¡æ¯ï¼Œé‡å†™å°±è¡Œã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶é…ç½®ï¼Œåœ¨<em>å½“å‰ç”¨æˆ·ç›®å½•ä¸‹çš„ <code>.gitconfig</code></em> æ–‡ä»¶ä¸­ã€‚</p><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>ä»‹ç»æœ¬åœ°gitä»“åº“çš„åŸºæœ¬ä½¿ç”¨å’Œè¿œç¨‹ä»“åº“githubçš„åŸºæœ¬ä½¿ç”¨</p><h2 id="gitä½¿ç”¨"><a href="#gitä½¿ç”¨" class="headerlink" title="gitä½¿ç”¨"></a>gitä½¿ç”¨</h2><p>åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œï¼Œgit bashã€git cmdã€cmdã€powershell éšä¾¿å“ªä¸ªéƒ½è¡Œ</p><h3 id="åŸºæœ¬å·¥ä½œæµç¨‹"><a href="#åŸºæœ¬å·¥ä½œæµç¨‹" class="headerlink" title="åŸºæœ¬å·¥ä½œæµç¨‹"></a>åŸºæœ¬å·¥ä½œæµç¨‹</h3><ol><li><code>git init</code>ï¼šåˆå§‹åŒ– git ä»“åº“</li><li><code>git status</code>ï¼šæŸ¥çœ‹æ–‡ä»¶çŠ¶æ€ï¼ˆè¢«gitç®¡ç†çš„æ–‡ä»¶å’Œæ²¡è¢«gitç®¡ç†çš„æ–‡ä»¶ï¼‰</li><li><code>git add æ–‡ä»¶</code>ï¼šå°†æ–‡ä»¶äº¤ç»™gitç®¡ç†ï¼ˆä¸€èˆ¬ç›´æ¥<code>git add .</code>ï¼ŒæŠŠæ•´ä¸ªç›®å½•ç®¡ç†ï¼‰</li><li><code>git commit -m &quot;è¦å†™çš„å¤‡æ³¨ä¿¡æ¯&quot;</code>ï¼šå‘ä»“åº“æäº¤å†…å®¹ï¼Œ<code>-m</code>æ˜¯messagesçš„ç¼©å†™</li><li><code>git log</code>ï¼šæŸ¥çœ‹æäº¤è®°å½•</li></ol><p>å›¾ç‰‡è¿‡ç¨‹</p><p><img src="https://z3.ax1x.com/2021/04/21/cqZOAg.png" alt="åˆå§‹åŒ–gitä»“åº“"></p><p><img src="https://z3.ax1x.com/2021/04/21/cqepj0.png" alt="æŸ¥çœ‹å½“å‰çŠ¶æ€ï¼Œçº¢è‰²ä»£è¡¨è¿˜æœªè¢«ç®¡ç†çš„æ–‡ä»¶"></p><p><img src="https://z3.ax1x.com/2021/04/21/cqenjx.png" alt="å°†æ–‡ä»¶äº¤ç»™gitç®¡ç†ï¼Œç„¶åæŸ¥çœ‹çŠ¶æ€ï¼Œç»¿è‰²å°±okäº†"></p><p><img src="https://z3.ax1x.com/2021/04/21/cqeQHO.png" alt="å°†å†…å®¹æäº¤åˆ°æœ¬åœ°ä»“åº“"></p><p><img src="https://z3.ax1x.com/2021/04/21/cqeBVS.png" alt="å†æ¬¡ä½¿ç”¨ git status æŸ¥çœ‹æƒ…å†µï¼Œå·²ç»ç©ºäº†"></p><p><img src="https://z3.ax1x.com/2021/04/21/cqe5aF.png" alt="æŸ¥çœ‹æäº¤è®°å½•"></p><h3 id="æ’¤é”€"><a href="#æ’¤é”€" class="headerlink" title="æ’¤é”€"></a>æ’¤é”€</h3><p>ä½¿ç”¨ <code>git commit</code> æäº¤çš„æ—¶å€™é™¤äº†æäº¤åˆ°æœ¬åœ°ä»“åº“ï¼Œè¿˜ä¼šå­˜åœ¨<em>æš‚å­˜åŒº</em> ä¸­ã€‚</p><p>ç”¨æš‚å­˜åŒºçš„æ–‡ä»¶è¦†ç›–æœ¬åœ°å·¥ä½œç›®å½•ä¸‹çš„æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>å°†æ–‡ä»¶ä»æš‚å­˜åŒºä¸­åˆ é™¤ï¼ˆä¸ä¼šåˆ é™¤å·¥ä½œç›®å½•ä¸­çš„æ–‡ä»¶ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">rm</span> --cached æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>å°†ä»“åº“ä¸­æŒ‡å®šçš„è®°å½•æ¢å¤å‡ºæ¥ï¼ˆè¿™ä¸ªIDå¯ä»¥ä½¿ç”¨<code>git log</code>æŸ¥çœ‹ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rest --hard commitID</span><br></pre></td></tr></table></figure><blockquote><p><strong>ä½¿ç”¨æƒ…å†µï¼š</strong></p><p>æœ‰ <strong>A â†’ B â†’ C â†’ D</strong> å››ä¸ªè®°å½•ï¼Œå½“å‰å·¥ä½œç›®å½•å‡ºç°äº†é—®é¢˜ï¼Œæƒ³å›åˆ° <strong>B</strong>ï¼Œåœ¨å›åˆ° <strong>B</strong> çš„æ—¶å€™ï¼Œå·¥ä½œç›®å½•æ”¹å˜ï¼Œ<strong>C</strong>ã€<strong>D</strong> è®°å½•ä¹Ÿä¼šè¢«åˆ é™¤</p></blockquote><h3 id="åˆ†æ”¯"><a href="#åˆ†æ”¯" class="headerlink" title="åˆ†æ”¯"></a>åˆ†æ”¯</h3><p>æ„æ€å°±æ˜¯å¯ä»¥åœ¨ä¸€ä¸ªæ–°çš„åˆ†æ”¯ä¸Šå¼€å‘æ–°çš„åŠŸèƒ½ï¼Œå¦å¤–åˆ†æ”¯åšå…¶ä»–äº‹æƒ…</p><p>ğŸ‘‰ <strong>æ¯”å¦‚</strong>ï¼š</p><p>ä¸»åˆ†æ”¯ï¼ˆmasterï¼‰ï¼šç¬¬ä¸€æ¬¡æäº¤æ—¶è‡ªåŠ¨åˆ›å»ºçš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šåœ¨ä¸»åˆ†æ”¯ä¸Šç›´æ¥è¿›è¡Œå¼€å‘</p><p>å¼€å‘åˆ†æ”¯ï¼šä»ä¸»åˆ†æ”¯ä¸­åˆ†å‡ºï¼Œç”¨äºå¼€å‘ï¼Œåœ¨å¼€å‘å®Œæˆä¹‹åå†å¹¶å…¥ä¸»åˆ†æ”¯</p><p>åŠŸèƒ½åˆ†æ”¯ï¼šåŸºäºå¼€å‘åˆ†æ”¯ä¸­åˆ†å‡ºï¼Œå¦‚å¼€å‘ä¸€ä¸ªç‹¬ç«‹åŠŸèƒ½ï¼ŒåŠŸèƒ½å¼€å‘å®Œä¹‹åå†å¹¶å…¥å¼€å‘åˆ†æ”¯ï¼Œç„¶ååˆ æ‰è¿™ä¸ªåŠŸèƒ½åˆ†æ”¯ä»¥ä¿æŒè¿™ä¸ªåˆ†æ”¯çš„å¹²å‡€</p><p>bugåˆ†æ”¯ç­‰ç­‰å®ç°å…¶ä»–åŠŸèƒ½çš„åˆ†æ”¯</p><ol><li><p><code>git branch</code>ï¼šæŸ¥çœ‹åˆ†æ”¯ï¼ˆåœ¨åˆ†æ”¯åç§°å‰é¢æœ‰<code>*</code>ï¼Œä»£è¡¨å½“å‰é€‰ä¸­çš„åˆ†æ”¯ï¼‰</p><p><img src="https://z3.ax1x.com/2021/04/21/cqJpvD.png" alt="åˆ†æ”¯"></p></li><li><p><code>git branch åˆ†æ”¯å</code>ï¼šåˆ›å»ºåˆ†åŒºã€‚åœ¨å“ªä¸ªåˆ†æ”¯ä¸­æ“ä½œï¼Œå°±æ˜¯åŸºäºå“ªä¸ªåˆ†æ”¯åˆ›å»ºã€‚</p><p><img src="https://z3.ax1x.com/2021/04/21/cqJJP0.png" alt="åˆ›å»ºåˆ†æ”¯"></p></li><li><p><code>git checkout åˆ†æ”¯å</code>ï¼šåˆ‡æ¢åˆ†æ”¯</p><p><img src="https://z3.ax1x.com/2021/04/21/cqJwqJ.png" alt="åˆ‡æ¢åˆ†æ”¯"></p></li><li><p><code>git merge æ¥æºåˆ†æ”¯</code>ï¼šåˆå¹¶åˆ†åŒºã€‚å¦‚ï¼šå°†å¼€å‘åˆ†æ”¯åˆå¹¶åˆ°ä¸»åˆ†æ”¯ï¼Œ<span style="color: red;">è¦å…ˆå°†å½“å‰åˆ†æ”¯åˆ‡æ¢åˆ°ä¸»åˆ†æ”¯</span>ï¼Œå› ä¸ºè¢«åˆå¹¶çš„æ˜¯å¼€å‘åˆ†æ”¯</p><p><img src="https://z3.ax1x.com/2021/04/21/cqJfqH.png" alt="åˆå¹¶åˆ†æ”¯"></p></li><li><p><code>git branch -d åˆ†æ”¯åç§°</code>ï¼šåˆ é™¤åˆ†æ”¯ã€‚åˆ†æ”¯æ²¡æœ‰è¢«åˆå¹¶ä¹‹å‰æ˜¯ä¸ä¼šè¢«åˆ é™¤çš„ï¼Œå¦‚æœæƒ³å¼ºåˆ¶åˆ é™¤ï¼Œå°†<code>-d</code>æ”¹ä¸º<code>-D</code>ã€‚åœ¨å½“å‰åˆ†æ”¯åˆ é™¤å½“å‰åˆ†æ”¯ä¹Ÿæ˜¯ä¸è¡Œçš„</p><p><img src="https://z3.ax1x.com/2021/04/21/cqYom4.png" alt="åˆ é™¤åˆ†æ”¯"></p></li></ol><h3 id="æš‚æ—¶ä¿å­˜ä¿®æ”¹"><a href="#æš‚æ—¶ä¿å­˜ä¿®æ”¹" class="headerlink" title="æš‚æ—¶ä¿å­˜ä¿®æ”¹"></a>æš‚æ—¶ä¿å­˜ä¿®æ”¹</h3><p>å‡ºç°æƒ…å†µï¼šå½“å‰å·¥ä½œè¿˜æ²¡å®Œæˆï¼Œä¸´æ—¶æœ‰å…¶ä»–å·¥ä½œè¦åšï¼Œä½†æ˜¯åˆè¿˜ä¸æƒ³ä½¿ç”¨<code>git commit</code>æäº¤ï¼Œåˆ†æ”¯åœ¨æ²¡<code>commit</code>ä¹‹å‰æ˜¯ä¸å¯åˆ‡æ¢çš„ã€‚å¯ä»¥ä½¿ç”¨ä¸´æ—¶ä¿å­˜ï¼ˆåˆ†æ”¯ä¸´æ—¶åˆ‡æ¢ï¼‰</p><ol><li><code>git stash</code>ï¼šå­˜å‚¨ä¸´æ—¶æ”¹åŠ¨</li><li><code>git stash pop</code>ï¼šæ¢å¤æ”¹åŠ¨</li></ol><blockquote><p>è¿™ä¸¤ä¸ªå‘½ä»¤æ˜¯ç‹¬ç«‹äºåˆ†æ”¯çš„ï¼Œåœ¨å…¶ä»–åˆ†æ”¯ä¸Šæ‰§è¡Œä¹Ÿä¼šäº§ç”Ÿç»“æœï¼Œæ‰€ä»¥è¦æ³¨æ„å½“å‰åˆ†æ”¯ã€‚</p></blockquote><h2 id="githubä½¿ç”¨"><a href="#githubä½¿ç”¨" class="headerlink" title="githubä½¿ç”¨"></a>githubä½¿ç”¨</h2><h3 id="å¤šäººå·¥ä½œçš„æµç¨‹"><a href="#å¤šäººå·¥ä½œçš„æµç¨‹" class="headerlink" title="å¤šäººå·¥ä½œçš„æµç¨‹"></a>å¤šäººå·¥ä½œçš„æµç¨‹</h3><ol><li>å°æ˜åœ¨æœ¬åœ°åˆ›å»ºä»“åº“ï¼Œç„¶å<code>push</code>åˆ°è¿œç¨‹ä»“åº“</li><li>å°æç­‰å…¶ä»–äººï¼Œå°†è¿œç¨‹çš„ä»£ç <code>clone</code>ä¸‹æ¥ï¼ˆè¿™äº›äººä¸éœ€è¦åˆ›å»ºæœ¬åœ°ä»“åº“ï¼‰</li><li>å°æç­‰äººå®Œæˆå·¥ä½œåï¼Œå°†ä»£ç <code>push</code>ä¸Šè¿œç¨‹ä»“åº“</li><li>å°æ˜å°†è¿œç¨‹ä»£ç <code>pull</code>å›æ¥ï¼Œå°±å¾—åˆ°æ¥å°æç­‰äººåˆä½œå†™å¥½çš„ä»£ç </li></ol><h3 id="é¦–æ¬¡è¿æ¥github"><a href="#é¦–æ¬¡è¿æ¥github" class="headerlink" title="é¦–æ¬¡è¿æ¥github"></a>é¦–æ¬¡è¿æ¥github</h3><p>ğŸ‘‰<a href="https://github.com/">githubå®˜ç½‘</a></p><p>ç™»å½•ä¹‹åï¼Œç‚¹å‡»å³ä¸Šè§’çš„â•ï¼Œç‚¹<code>new repository</code>æ–°å»ºä¸€ä¸ªä»“åº“</p><p>å¡«ä¸Šä»“åº“çš„åå­—ï¼Œç‚¹å‡»å…¬å¼€ï¼ˆpublicï¼‰æˆ–è€…ä¸å…¬å¼€ï¼ˆprivateï¼‰éƒ½è¡Œï¼Œå…¶ä»–çš„é€‰é¡¹å¯ä»¥å…ˆä¸è¦ç®¡ã€‚ç‚¹å‡»ç»¿è‰²æŒ‰é’®ï¼ˆcreate repositoryï¼‰å³å¯åˆ›å»º</p><p><img src="https://z3.ax1x.com/2021/04/21/cqtHKS.png" alt="åˆ›å»ºæ–°ä»“åº“"></p><p>è¿›å…¥é‡Œé¢åæœ‰æ•™ä½ æ“ä½œçš„æç¤ºï¼Œåˆ†ä¸ºä¸‰éƒ¨åˆ†ã€‚è¿™é‡Œå·²ç»æœ‰äº†æœ¬åœ°ä»“åº“ï¼Œæ‰€ä»¥æŒ‰ç…§ç¬¬äºŒç§æ“ä½œå°±è¡Œ</p><p><img src="https://z3.ax1x.com/2021/04/21/cqNYGt.png" alt="è¿æ¥è¿œç¨‹ä»“åº“"></p><p>å¤åˆ¶ä»“åº“çš„ HTTPS æˆ–è€… SSH é“¾æ¥ (è¿™é‡Œä»¥ä¸Šé¢çš„é“¾æ¥ä¸ºä¾‹)ï¼Œ<strong>åœ¨åˆšæ‰æ“ä½œgitçš„ç›®å½•ä¸­</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https://github.com/dsjerry/testGitHub.git</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -M main</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure><ul><li> <code>origin</code>ï¼šç”¨äºä»£æ›¿è¿™ä¸€é•¿ä¸²httpsæˆ–sshçš„åˆ«å</li><li> <code>-M</code>ï¼šä¿®æ”¹åˆ†æ”¯çš„åå­—ã€‚ï¼ˆgitè‡ªåŠ¨ç”Ÿæˆçš„æ˜¯masteråˆ†æ”¯ï¼Œä¸è¿‡ä¼ åˆ°githubçš„æ—¶å€™ï¼Œgithubæ¨èçš„æ˜¯å°†masteræ”¹ä¸ºmainï¼‰å› æ­¤ä¸æ˜¯å¿…é¡»çš„ã€‚</li><li> <strong>ç¬¬ä¸€æ¬¡</strong>è¦è¿™ä¹ˆé•¿ï¼Œä»¥åç›´æ¥ <strong><code>git push</code></strong> å°±è¡Œã€‚</li></ul><p>ä»¥ä¸Šæ“ä½œå°±å¯ä»¥å®ç°è¿æ¥è¿œç¨‹çš„ä»“åº“ï¼Œè¿æ¥çš„æ“ä½œå·²ç»å®Œæˆäº†</p><blockquote><p>å…¶å®ç¬¬ä¸€æ¡å‘½ä»¤å¯ä»¥è¯´æ˜¯å¤åˆå‘½ä»¤ï¼Œä¸‹é¢åˆ†è§£å…·ä½“æ­¥éª¤ï¼Œå½“ç„¶ç°å®ä¸­å°±éšä¾¿æ€ä¹ˆé€‰éƒ½è¡Œï¼Œå¦‚æœä½ ä¸æƒ³äº†è§£ï¼Œç›´æ¥è·³è¿‡å°±è¡Œ</p></blockquote><p>å›åˆ°å¼€å§‹çš„è¯</p><p>é¦–å…ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push https://github.com/dsjerry/testGitHub.git master</span><br></pre></td></tr></table></figure><p>åæ¥å› ä¸ºè¿™ä¸²HTTPSæˆ–è€…SSHæ˜¯åœ¨å¤ªé•¿ï¼Œæ‰€ä»¥è¦ç»™è¿™ä¸²ä¸œè¥¿å–ä¸ªåˆ«åï¼ˆ<strong>origin</strong>å°±æ˜¯åˆ«åï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https://github.com/dsjerry/testGitHub.git</span><br></pre></td></tr></table></figure><p>ä»¥åä½¿ç”¨ä¸€ä¸‹å‘½ä»¤å°±è¡Œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬ä¸€æ¬¡æäº¤è¦å¡«å¯†ç ï¼Œä»¥åå°±ä¸ç”¨äº†ã€‚å¯†ç åœ¨è¿™é‡Œçœ‹å¾—åˆ°ï¼šæ§åˆ¶é¢æ¿ â†’ å‡­æ®ç®¡ç†å™¨ â†’ Windowså‡­æ®</p></blockquote><p>ä½¿ç”¨<code>-u</code>è®°ä½ä»“åº“åœ°å€ã€åˆ«åå’Œåˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><p>ä»¥åç›´æ¥ä½¿ç”¨<code>git push</code>å°±è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯åˆ†è§£çš„æ­¥éª¤ã€‚</p><h3 id="å…‹éš†-æ¨é€-æ‹‰å–"><a href="#å…‹éš†-æ¨é€-æ‹‰å–" class="headerlink" title="å…‹éš† æ¨é€ æ‹‰å–"></a>å…‹éš† æ¨é€ æ‹‰å–</h3><h4 id="å…‹éš†-clone"><a href="#å…‹éš†-clone" class="headerlink" title="å…‹éš†(clone)"></a>å…‹éš†(clone)</h4><p>å…‹éš†ï¼ˆcloneï¼‰åˆ°æœ¬åœ°ï¼ˆå°æå…‹éš†å°æ˜çš„ï¼Œåˆ«åä¹Ÿä¼šä¸€èµ·å…‹éš†ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/dsjerry/testGitHub.git</span><br></pre></td></tr></table></figure><h4 id="æ¨é€-push"><a href="#æ¨é€-push" class="headerlink" title="æ¨é€(push)"></a>æ¨é€(push)</h4><p>å°æå°†æœ¬åœ°ä»£ç æ¨é€ï¼ˆpushï¼‰åˆ°å°æ˜çš„è¿œç¨‹ä»“åº“ã€‚åœ¨æ¨é€å‰ï¼Œå°æç­‰äººæ˜¯æ²¡æœ‰æƒé™æ¨é€åˆ°å°æ˜çš„ä»“åº“çš„ã€‚éœ€è¦å°æ˜é‚€è¯·å°æã€‚</p><p>æ‰“å¼€å½“å‰githubä»“åº“é¡µé¢ï¼Œæ‰¾åˆ°<strong>settings</strong>ï¼Œé€‰ä¸­<strong>Manage access</strong>ï¼Œç‚¹å‡»<strong>Invite a collaborator</strong>ç„¶åæŠŠå°æçš„githubè´¦å·æ·»åŠ ä¸Šå»å°±è¡Œ</p><p><img src="https://z3.ax1x.com/2021/04/21/cqwgk4.png" alt="ä»“åº“æˆæƒ"></p><p>å°æåœ¨æ¥æ”¶åˆ°é‚€è¯·é‚®ä»¶åï¼ŒåŒæ„é‚€è¯·å°±è¡Œäº†ã€‚</p><p><img src="https://z3.ax1x.com/2021/04/21/cqwqtH.png" alt="åŒæ„é‚€è¯·"></p><h4 id="æ‹‰å–-pull"><a href="#æ‹‰å–-pull" class="headerlink" title="æ‹‰å–(pull)"></a>æ‹‰å–(pull)</h4><p>ç»è¿‡ä¸€è½®å¼€å‘åï¼Œå°æ˜å°±å¯ä»¥æŠŠå¤§å®¶çš„æˆæœæ‹‰å»åˆ°è‡ªå·±æœ¬åœ°å•¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull https://github.com/dsjerry/testGitHub.git master</span><br></pre></td></tr></table></figure><ul><li>æ‹‰å–å±äº<em>è¯»</em> æ“ä½œï¼Œä¸éœ€è¦å¯†ç éªŒè¯</li></ul><h4 id="å¯èƒ½çš„å†²çª"><a href="#å¯èƒ½çš„å†²çª" class="headerlink" title="å¯èƒ½çš„å†²çª"></a>å¯èƒ½çš„å†²çª</h4><p>ä¸¤ä¸ªäººä¿®æ”¹åŒä¸€ä¸ªæ–‡ä»¶æ—¶å¯èƒ½ä¼šé‡åˆ°å†²çªï¼Œå°æ˜å‘äº†æ–°çš„ç‰ˆæœ¬ï¼Œå°æçš„æ—§ç‰ˆæœ¬æ¨ä¸ä¸Šã€‚</p><p>å°æå¯ä»¥å…ˆæŠŠå°æ˜çš„æ–°ç‰ˆ <code>pull</code> ä¸‹æ¥ï¼Œç„¶ååœ¨ç»ˆç«¯ä¸­ä¼šæœ‰ <code>&lt;&lt;&lt;......&gt;&gt;&gt;</code>è¿™æ ·å‡ºç°ï¼ŒæŒ‡å‡ºäº†å†²çªçš„åœ°æ–¹ï¼Œç„¶åä»¥ <code>=====</code>å°†ä¸åŒçš„å†²çªåˆ†éš”å¼€</p><h3 id="Fork"><a href="#Fork" class="headerlink" title="Fork"></a>Fork</h3><p>å³ä½¿ä¸æ˜¯æœ¬åœ°æˆå‘˜ï¼Œä¹Ÿå¯ä»¥åƒä»“åº“æäº¤ä»£ç ï¼Œå‰ææ˜¯è¿™äº›ä»£ç è¦ç»è¿‡å®¡æ ¸æ‰èƒ½å¹¶å…¥ä¸»è¦ä»£ç ã€‚</p><p><strong>æ“ä½œæ–¹æ³•</strong></p><p>è®¿é—®åˆ«äººçš„ä»“åº“ï¼Œç„¶åç‚¹å‡»<strong>Fork</strong>ï¼Œç›¸å½“äºå¤åˆ¶åˆ«äººçš„ï¼›ç„¶å<code>clone</code>åˆ°æœ¬åœ°ä¿®æ”¹ï¼Œä¿®æ”¹å®Œæˆå<code>push</code>ä¸Šå»</p><p><img src="https://z3.ax1x.com/2021/04/22/cqriND.png" alt="Fork"></p><p>å¯¹äºä»“åº“çš„ç®¡ç†äººå‘˜ï¼Œè¦æ¥å—å¤–æ¥çš„æ¨é€ï¼Œåœ¨ä»“åº“é¡µé¢ä¸­ç‚¹<strong>Pull request</strong> â†’ <strong>New pull request</strong> â†’ <strong>Create pull request</strong></p><p><img src="https://z3.ax1x.com/2021/04/22/cqrtuq.png" alt="æ¨é€è¯·æ±‚"></p><p>éšåï¼Œç‚¹å‡»<strong>commits</strong>ï¼Œä¼šçœ‹åˆ°ä¿®æ”¹çš„å†…å®¹ï¼Œç‚¹<strong>file changed</strong>å¯ä»¥æŸ¥çœ‹åˆ°æ–‡ä»¶çš„æ”¹å˜ã€‚ä»“åº“çš„ç®¡ç†äººå‘˜ç‚¹å‡»<strong>comfirm merge</strong>å°±å¯ä»¥æ¥å—åˆå¹¶ã€‚</p><h3 id="SSHå…ç™»é™†"><a href="#SSHå…ç™»é™†" class="headerlink" title="SSHå…ç™»é™†"></a>SSHå…ç™»é™†</h3><p>é€šè¿‡æœ¬æœºçš„ç§é’¥å’ŒæœåŠ¡å™¨ç«¯çš„å…¬é’¥è¿›è¡Œè¿æ¥è®¤è¯ï¼Œè®¤è¯é€šè¿‡ä¹‹åå°±è¡Œ</p><p><strong>ç”Ÿæˆç§é’¥</strong></p><p>è¾“å…¥å‘½ä»¤ï¼Œç„¶åä¸€ç›´å›è½¦ã€‚ç”Ÿæˆçš„æ–‡ä»¶ä¼šåœ¨ç³»ç»Ÿç›®å½•ä¸‹çš„ç”¨æˆ·ç›®å½•ä¸‹çš„ <strong>.ssh</strong> æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure><ul><li>id_rsaï¼šç§é’¥ï¼Œå­˜åœ¨æœ¬åœ°çš„</li><li>id_rsa.pubï¼šå…¬é’¥ï¼Œæ”¾åœ¨githubä¸Šçš„</li></ul><p>è®¾ç½®å…¬é’¥ï¼Œåœ¨githubé¡µé¢ï¼Œç‚¹å‡»è‡ªå·±çš„<strong>å¤´åƒ</strong>ï¼Œç‚¹ <strong>settings</strong> â†’ <strong>SSH and GPG keys</strong>ï¼Œé€‰ä¸­ <strong>New SSH key</strong>æ·»åŠ è‡ªå·±çš„å…¬é’¥</p><p>ä»¥åå†ä½¿ç”¨ <code>git push</code>çš„æ—¶å€™ï¼Œä½¿ç”¨ SSH é“¾æ¥çš„æ—¶å€™å°±å¯ä»¥ä¸ç”¨è¾“å…¥å¯†ç </p><h3 id="gitæ–‡ä»¶å¿½ç•¥"><a href="#gitæ–‡ä»¶å¿½ç•¥" class="headerlink" title="gitæ–‡ä»¶å¿½ç•¥"></a>gitæ–‡ä»¶å¿½ç•¥</h3><p>æœ‰äº›æ–‡ä»¶æ˜¯ä¸éœ€è¦æ¨é€åˆ°è¿œç¨‹ä»“åº“çš„ï¼Œæ¯”å¦‚é€šè¿‡<strong>NPM</strong>ä¸‹è½½çš„åŒ…ï¼Œåªè¦ä¿å­˜<strong>package.json</strong>æ–‡ä»¶å°±è¡Œ</p><p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶ <code>.gitignore</code>ï¼Œä¸æƒ³è¦ä¼ ä»€ä¹ˆå†…å®¹ï¼Œç›´æ¥å¸è½½è¿™ä¸ªæ–‡ä»¶é‡Œé¢ï¼ˆä¸€é¡¹å ä¸€è¡Œï¼‰ï¼Œå¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node_modules</span><br><span class="line">image</span><br><span class="line">test.html</span><br></pre></td></tr></table></figure><!-- <span style="color: #f44d27; font-size: 150px">git</span>      <span style="font-size: 50px">å’ŒÂ Â </span><span style="color: #5f2781; font-size: 150px">github</span>--><p>â€‹    <!-- <span style="font-size: 50px">åŸºæœ¬ä½¿ç”¨</span>--></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç®€å•è®°å½•&lt;span style=&quot;color: orange;&quot;&gt;git&lt;/span&gt;å’Œ&lt;span style=&quot;color: purple;&quot;&gt;github&lt;/span&gt;çš„ä½¿ç”¨&lt;/p&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿï¼šWindows&lt;/p&gt;</summary>
    
    
    
    <category term="éƒ¨ç½²è¿ç»´" scheme="https://smalljerry.cn/categories/%E9%83%A8%E7%BD%B2%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="git" scheme="https://smalljerry.cn/tags/git/"/>
    
    <category term="github" scheme="https://smalljerry.cn/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>MongoDBåŸºæœ¬ä½¿ç”¨</title>
    <link href="https://smalljerry.cn/2021/04/16/MongoDB%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
    <id>https://smalljerry.cn/2021/04/16/MongoDB%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</id>
    <published>2021-04-16T07:13:44.000Z</published>
    <updated>2025-02-22T02:14:47.324Z</updated>
    
    <content type="html"><![CDATA[<p>ç®€å•è®°å½•<span style="color: purple;">å‘½ä»¤è¡Œ</span>ã€<span style="color: green">Node.js</span>æ“ä½œ<span style="color: lightgreen">MongoDB</span></p><p>ä½¿ç”¨ç‰ˆæœ¬ ï¼šç¤¾åŒºç‰ˆ<code>4.2.6</code></p><span id="more"></span><p>MongoDBå±äºéå…³ç³»å‹æ•°æ®åº“ï¼Œæ•°æ®çš„å­˜å‚¨ç±»ä¼¼äº <em>JSONå¯¹è±¡</em></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    name<span class="punctuation">:</span> &#x27;lisi&#x27;<span class="punctuation">,</span></span><br><span class="line">    age<span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">    hobbies<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;åƒé¥­&#x27;<span class="punctuation">,</span> &#x27;ç¡è§‰&#x27;<span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><h2 id="MongoDBå®‰è£…"><a href="#MongoDBå®‰è£…" class="headerlink" title="MongoDBå®‰è£…"></a>MongoDBå®‰è£…</h2><p>ğŸ‘‰ <a href="https://www.mongodb.com/try/download/community">MongoDBä¸‹è½½åœ°å€</a></p><p>ä¸‹è½½çš„æ˜¯msiç‰ˆæœ¬ï¼Œç‚¹å‡»å®‰è£…ï¼Œé€‰æ‹©<strong>custom</strong>è‡ªå®šä¹‰å®‰è£…</p><p><img src="https://z3.ax1x.com/2021/04/16/cfSZOe.png" alt="è‡ªå®šä¹‰å®‰è£…"></p><p>ä¸‹ä¸€æ­¥ã€ä¸‹ä¸€æ­¥ï¼Œåœ¨ <em>Install MongoDB Compass</em> å¤„å–æ¶ˆæ‰“é’©ï¼Œå…ˆä¸å®‰è£…è¿™ä¸ª</p><p><img src="https://z3.ax1x.com/2021/04/16/cfSrlT.png" alt="å–æ¶ˆæ‰“é’©"></p><p>MongoDB Compass æ˜¯ MongoDB çš„ä¸€æ¬¾å›¾å½¢åŒ–ç®¡ç†å·¥å…·ï¼Œé™¤æ­¤å¤–è¿˜æœ‰åˆ«çš„å·¥å…·ã€‚è¿™é‡Œä¸ä¸‹è½½æ˜¯å› ä¸ºä¸‹è½½å¾ˆæ…¢ï¼Œå¯èƒ½ä¼šå¯¼è‡´ MongoDB å®‰è£…ä¸æˆåŠŸï¼›å¯ä»¥è‡ªå·±åœ¨æµè§ˆå™¨ä¸‹è½½ï¼Œè¿™æ ·å¿«å¾ˆå¤šã€‚</p><p>ğŸ‘‰ <a href="https://www.mongodb.com/try/download/compass">MongoDB Compassä¸‹è½½åœ°å€</a></p><h2 id="mongooseå®‰è£…"><a href="#mongooseå®‰è£…" class="headerlink" title="mongooseå®‰è£…"></a>mongooseå®‰è£…</h2><p><span style="color: green">Node.js</span>æ“ä½œMongoDBï¼Œéœ€è¦ä¸‹è½½æ’ä»¶ <em>mongoose</em></p><p>ä¸‹è½½ï¼š**<code>npm install mongoose</code>**</p><h1 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h1><h2 id="å¯åŠ¨-1"><a href="#å¯åŠ¨-1" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h2><p><strong>å‘½ä»¤è¡Œå¯åŠ¨</strong></p><p>é¦–å…ˆè¿›å…¥MongoDBç›®å½•é‡Œçš„ <em>bin</em> ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”é€‰æ‹©è¦æ‰§è¡Œçš„ä½ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod --dbpath ç›˜ç¬¦:\ç›®å½•\</span><br></pre></td></tr></table></figure><p><strong>è¿æ¥</strong></p><p>åœ¨ <em>bin</em> ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤å³å¯å¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo.exe</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨ã€å…³é—­æœåŠ¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net start MongoDB</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net stop MongoDB</span><br></pre></td></tr></table></figure><p><strong>ç§»é™¤æœåŠ¡</strong></p><p>åœ¨MongoDBç›®å½•ä¸‹çš„ bin é‡Œé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod.exe --remove</span><br></pre></td></tr></table></figure><p><strong>ä»»åŠ¡ç®¡ç†å¯åŠ¨</strong></p><p>å¯¹äº <em>Windows</em>ï¼Œæ‰“å¼€ä»»åŠ¡ç®¡ç†ï¼Œç‚¹å‡» <em>æœåŠ¡</em>ï¼Œ<em>æ‰“å¼€æœåŠ¡</em>ï¼Œåœ¨æœåŠ¡çª—å£å°±å¯ä»¥æ‰¾åˆ°MongoDBå¹¶ä¸”å¯åŠ¨</p><h2 id="æ·»åŠ ç¯å¢ƒå˜é‡"><a href="#æ·»åŠ ç¯å¢ƒå˜é‡" class="headerlink" title="æ·»åŠ ç¯å¢ƒå˜é‡"></a>æ·»åŠ ç¯å¢ƒå˜é‡</h2><p>ç›´æ¥åœ¨ç³»ç»Ÿå˜é‡çš„<code>path</code>ä¸­åŠ ä¸Šä¸€æ¡MongoDBç›®å½•çš„ bin ç›®å½•å³å¯ã€‚</p><p><img src="https://z3.ax1x.com/2021/04/16/chKMmd.png" alt="ç¯å¢ƒå˜é‡"></p><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>åˆ†ä¸ºå‘½ä»¤è¡Œã€å¯è§†åŒ–å·¥å…·ã€Node.js</p><h2 id="å›¾å½¢ç•Œé¢ä½¿ç”¨"><a href="#å›¾å½¢ç•Œé¢ä½¿ç”¨" class="headerlink" title="å›¾å½¢ç•Œé¢ä½¿ç”¨"></a>å›¾å½¢ç•Œé¢ä½¿ç”¨</h2><p><img src="https://z3.ax1x.com/2021/04/16/chndgg.png" alt="å›¾å½¢ç•Œé¢è¿æ¥"></p><p>è¿™ä¸²ä¸œè¥¿åœ¨å‘½ä»¤è¡Œè¿è¡Œ <code>mongo</code> çš„æ—¶å€™ä¼šå‡ºç°ã€‚</p><h2 id="å‘½ä»¤è¡Œä½¿ç”¨"><a href="#å‘½ä»¤è¡Œä½¿ç”¨" class="headerlink" title="å‘½ä»¤è¡Œä½¿ç”¨"></a>å‘½ä»¤è¡Œä½¿ç”¨</h2><p>åœ¨å‘½ä»¤è¡Œç›´æ¥ä½¿ç”¨å°±å¯è¿ä¸Šï¼Œç”¨æˆ·åå’Œå¯†ç æ˜¯å¯é€‰çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³ç”¨ç”¨æˆ·åå¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongodb://admin:123456@localhost/</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿˜æƒ³æŒ‡å®šæ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongodb://admin:123456@localhost/test</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h3><p><strong>ä½¿ç”¨</strong>æ•°æ®åº“ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»ºè¿™ä¸ªæ•°æ®åº“ (åˆšåˆ›å»ºçš„æ•°æ®åº“æ˜¯çœ‹ä¸è§çš„ï¼Œè¦æ’å…¥å†…å®¹æ‰èƒ½çœ‹è§)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use æ•°æ®åº“å</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰æ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show dbs</span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤</strong>æ•°æ®åº“ï¼Œä½¿ç”¨ <code>use</code> é€‰ä¸­è¦åˆ é™¤çš„æ•°æ®åº“ï¼Œç„¶åæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.dropDatabase()</span><br></pre></td></tr></table></figure><p><strong>å¯¼å…¥æ•°æ®åº“</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongoimport -d æ•°æ®åº“åç§° -c é›†åˆåç§° --file è¦å¯¼å…¥çš„æ•°æ®æ–‡ä»¶</span><br></pre></td></tr></table></figure><ul><li>å…ˆè¦å°†å…¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡</li></ul><h3 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h3><p><strong>åˆ›å»ºé›†åˆ</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection(name, options)</span><br></pre></td></tr></table></figure><p>optionsé€‰é¡¹ï¼Œå½“ä½¿ç”¨æ—¶ï¼Œä»¥å¯¹è±¡çš„å½¢å¼ä½¿ç”¨</p><table><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>capped</td><td>å¸ƒå°”å€¼</td><td>å½“ä¸º true çš„æ—¶å€™ï¼ŒæŒ‡åˆ›å»ºå›ºå®šå¤§å°çš„é›†åˆï¼Œå¿…é¡»æŒ‡å®š size çš„å€¼ï¼Œè¶…è¿‡æ—¶ä¼šè¦†ç›–æœ€æ—©çš„å€¼</td></tr><tr><td>sise</td><td>æ•°å€¼</td><td>æŒ‡å®šé›†åˆçš„æœ€å¤§å€¼</td></tr><tr><td>max</td><td>æ•°å€¼</td><td>æŒ‡å®šé›†åˆä¸­æ–‡æ¡£çš„æœ€å¤§æ•°é‡</td></tr></tbody></table><p><strong>åˆ é™¤é›†åˆ</strong></p><p>åœ¨è¦åˆ é™¤é›†åˆæ‰€å¤„çš„æ•°æ®åº“ä¸­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.drop()</span><br></pre></td></tr></table></figure><h3 id="æ–‡æ¡£-å¢åˆ æ”¹æŸ¥"><a href="#æ–‡æ¡£-å¢åˆ æ”¹æŸ¥" class="headerlink" title="æ–‡æ¡£ - å¢åˆ æ”¹æŸ¥"></a>æ–‡æ¡£ - å¢åˆ æ”¹æŸ¥</h3><h4 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.é›†åˆåå­—.insert(document)</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœæ’å…¥çš„æ•°æ®ä¸»é”®å·²ç»å­˜åœ¨ï¼ŒæŠ¥é”™</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.é›†åˆåå­—.save(document)</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœä¸»é”®å­˜åœ¨ï¼Œåˆ™æ›´æ–°æ•°æ®ï¼›å¦‚æœä¸å­˜åœ¨åˆ™æ’å…¥æ•°æ®ï¼ˆé€æ¸ä¸ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼‰</li></ul><p>æ’å…¥ä¸€æ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">db.document.insertOne(</span><br><span class="line">&lt;document&gt;,</span><br><span class="line">&#123;</span><br><span class="line">writeConcern: &lt;document&gt;</span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æ’å…¥å¤šæ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.document.insertMany(</span><br><span class="line">[ &lt;document 1&gt;, &lt;document 2&gt; ],</span><br><span class="line">&#123;</span><br><span class="line">writeConcern: &lt;document&gt;,</span><br><span class="line">ordered: &lt;boolean&gt;</span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šç”¨åˆ°çš„å‚æ•°</p><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>document</td><td>è¦æ’å…¥çš„æ–‡æ¡£</td></tr><tr><td>writeConcern</td><td>å†™å…¥ç­–ç•¥ï¼Œé»˜è®¤1ï¼Œè¦æ±‚ç¡®è®¤å†™æ“ä½œï¼Œä¸è¦å°±0</td></tr><tr><td>ordered</td><td>æŒ‡å®šæ˜¯å¦é¡ºåºå†™å…¥ï¼Œé»˜è®¤true</td></tr></tbody></table><h4 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.collection.remove(</span><br><span class="line">   &lt;query&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">     justOne: &lt;boolean&gt;,</span><br><span class="line">     writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>query</td><td>å¯é€‰ï¼Œåˆ é™¤çš„æ¡ä»¶</td></tr><tr><td>justOne</td><td>å¦‚æœä¸º 1 æˆ– trueï¼Œåªåˆ é™¤ä¸€æ¡ï¼Œå¦‚æœä¸è®¾ç½®ï¼Œåˆ é™¤åŒ¹é…çš„</td></tr><tr><td>writeConcern</td><td>æŠ›å‡ºå¼‚å¸¸çš„çº§åˆ«</td></tr></tbody></table><h4 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">db.collection.update(</span><br><span class="line">&lt;query&gt;,</span><br><span class="line">&lt;update&gt;,</span><br><span class="line">&#123;</span><br><span class="line">upsert: &lt;boolean&gt;,</span><br><span class="line">multi:&lt;boolean&gt;,</span><br><span class="line">writeConcern: &lt;document&gt;</span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>query</td><td>æ›´æ–°çš„æŸ¥è¯¢æ¡ä»¶</td></tr><tr><td>update</td><td>è¦æ›´æ–°çš„å¯¹è±¡ï¼Œç±»ä¼¼äºsqlä¸­çš„ set xxx</td></tr><tr><td>upsert</td><td>å¯é€‰ï¼Œå¦‚æœä¸å­˜åœ¨updateçš„è®°å½•ï¼Œæ˜¯å¦æ’å…¥objNewï¼Œé»˜è®¤æ˜¯falseï¼Œä¸æ’å…¥ã€‚</td></tr><tr><td>multi</td><td>å¯é€‰ï¼Œåªæ›´æ–°æ‰¾åˆ°çš„ç¬¬ä¸€æ¡æ•°æ®ã€‚é»˜è®¤ false</td></tr><tr><td>writeConcern</td><td>å¯é€‰ï¼ŒæŠ›å‡ºå¼‚å¸¸çš„çº§åˆ«</td></tr></tbody></table><h4 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(query, projection)</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>query</td><td>æŸ¥è¯¢æ¡ä»¶</td></tr><tr><td>projection</td><td>æŒ‡å®šè¦è¿”å›çš„æ–‡æœ¬çš„é”®ï¼Œå¦‚æœè¿”å›æ‰€æœ‰ï¼Œä¸ç”¨å†™è¿™ä¸ªå‚æ•°</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.col.find().pretty()</span><br></pre></td></tr></table></figure><ul><li>æ ¼å¼åŒ–è¾“å‡ºçš„å†…å®¹</li></ul><p>ğŸ‘‰ <strong><a href="https://www.runoob.com/mongodb/mongodb-operators.html" style="color: green;">å»èœé¸Ÿæ•™ç¨‹çœ‹æ·±å…¥å†…å®¹</a></strong></p><h2 id="Node-js-æ“ä½œ"><a href="#Node-js-æ“ä½œ" class="headerlink" title="Node.js æ“ä½œ"></a>Node.js æ“ä½œ</h2><h3 id="è¿æ¥"><a href="#è¿æ¥" class="headerlink" title="è¿æ¥"></a>è¿æ¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mongoose</span><br><span class="line">  .connect(&#x27;mongodb://localhost/mongotest&#x27;, &#123; useNewUrlParser: true &#125;)</span><br><span class="line">  .then(() =&gt; &#123;</span><br><span class="line">    console.log(&#x27;è¿æ¥æˆåŠŸ&#x27;)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch((err) =&gt; &#123;</span><br><span class="line">    console.log(&#x27;è¿æ¥å¤±è´¥&#x27;, err)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœæŒ‡å®šçš„æ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ï¼ˆåˆ›å»ºäº†ä¸æ’å…¥æ•°æ®ï¼Œåœ¨åˆ—è¡¨ä¸­æ˜¯æ‰¾ä¸åˆ°çš„ï¼‰</li><li><code>&#123; useNewUrlParser: true &#125;</code>ï¼šæ–°ç‰ˆçš„MongoDBä¼šæœ‰è¿™æ ·çš„æç¤ºï¼Œä¸ç”¨ç‰¹åˆ«å»è®°ï¼Œå¦‚æœä¸åŠ ä¸Šç³»ç»Ÿä¼šæœ‰æç¤ºçš„</li></ul><h3 id="å¢åˆ æ”¹æŸ¥"><a href="#å¢åˆ æ”¹æŸ¥" class="headerlink" title="å¢åˆ æ”¹æŸ¥"></a>å¢åˆ æ”¹æŸ¥</h3><h4 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h4><p><strong>åˆ›å»ºé›†åˆ</strong>ï¼ˆæ•°æ®è¡¨ï¼‰ï¼šåˆ†ä¸ºä¸¤æ­¥</p><ol><li>è®¾ç½®é›†åˆçš„è§„åˆ™</li><li>åˆ›å»ºé›†åˆ</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¾å®šé›†åˆè§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> courseSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">author</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">isPublished</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">    <span class="attr">tags</span>: [<span class="title class_">String</span>]</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// åˆ›å»ºé›†åˆå¹¶åº”ç”¨è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Course</span> = mongoose.<span class="title function_">model</span>(<span class="string">&#x27;Course&#x27;</span>, courseSchema);</span><br></pre></td></tr></table></figure><ul><li><code>model</code>ï¼šé‡Œé¢çš„é›†åˆåç§°é¦–å­—æ¯è¦å¤§å†™ï¼Œç”Ÿæˆçš„åç§°ä¼šæ˜¯å°å†™ï¼Œç„¶åæ˜¯å¤æ•°å½¢å¼ï¼Œå¦‚ä¸Šçš„<em>courses</em>ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª<strong>æ„é€ å‡½æ•°</strong>ï¼Œç”¨äºæ“ä½œæ•°æ®</li></ul><p><strong>åˆ›å»ºæ–‡æ¡£</strong>ï¼ˆæ¯ä¸€æ¡æ•°æ®ï¼‰ï¼šåˆ†ä¸ºä¸¤æ­¥</p><ol><li>åˆ›å»ºé›†åˆå®ä¾‹</li><li>è°ƒç”¨å®ä¾‹å¯¹è±¡ä¸‹çš„saveæ–¹æ³•å°†æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ä¸­</li></ol><p>åˆ›å»ºçš„æ—¶å€™ä¼šè‡ªåŠ¨ä¸ºæ¯ä¸€æ¡æ•°æ®ç”Ÿæˆä¸€ä¸ªidï¼Œ<code>_id</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> course = <span class="keyword">new</span> <span class="title class_">Course</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;node.js&#x27;</span>,</span><br><span class="line">  <span class="attr">author</span>: <span class="string">&#x27;æ²³é©¬ç¨‹åºå‘˜&#x27;</span>,</span><br><span class="line">  <span class="attr">isPublised</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">price</span>: <span class="string">&#x27;20&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line">course.<span class="title function_">save</span>()</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œä½¿ç”¨ <code>create()</code> æ–¹æ³•ï¼Œè¿™ä¸ç”¨è°ƒç”¨ save()</p><ul><li>ä¹Ÿåˆ†ä¸ºä¸¤ç§å½¢å¼ï¼Œå›è°ƒå½¢å¼å’ŒPromiseå½¢å¼</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">create</span>(</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;JavaScript&#x27;</span>, <span class="attr">author</span>: <span class="string">&#x27;æ²³é©¬æœ‰ç”¨&#x27;</span>, <span class="attr">isPublised</span>: <span class="literal">false</span>, <span class="attr">price</span>: <span class="number">44</span> &#125;,</span><br><span class="line">  <span class="function">(<span class="params">err, result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>Promiseå½¢å¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Pythoné¢&#x27;</span>,</span><br><span class="line">  <span class="attr">author</span>: <span class="string">&#x27;é»‘å…”ç¨‹åºå‘˜&#x27;</span>,</span><br><span class="line">  <span class="attr">isPublised</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">price</span>: <span class="number">49</span>,</span><br><span class="line">  <span class="attr">tag</span>: [<span class="string">&#x27;ç¨‹åºå‘˜&#x27;</span>, <span class="string">&#x27;python&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err))</span><br></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢-1"><a href="#æŸ¥è¯¢-1" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h4><p>åŸºç¡€æŸ¥è¯¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">find</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br><span class="line"><span class="comment">// åŠ å…¥ç­›é€‰æ¡ä»¶ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡;è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line"><span class="title class_">Course</span>.<span class="title function_">find</span>(&#123; <span class="attr">author</span>: <span class="string">&#x27;ç™½é©¬ç¨‹åºå‘˜&#x27;</span> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;findè¿”å›æ•°ç»„&#x27;</span>, result)</span><br><span class="line">)</span><br><span class="line"><span class="comment">// åªè¿”å›ä¸€æ¡,é»˜è®¤è¿”å›ç¬¬ä¸€æ¡</span></span><br><span class="line"><span class="title class_">Course</span>.<span class="title function_">findOne</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;findOneåªè¿”å›ä¸€æ¡&#x27;</span>, result))</span><br></pre></td></tr></table></figure><p>èŒƒå›´æŸ¥è¯¢</p><ul><li>$gtï¼šå¤§äºï¼Œ $ltï¼šå°äº</li><li>$inï¼šåŒ…å«</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">find</span>(&#123; <span class="attr">price</span>: &#123; <span class="attr">$gt</span>: <span class="number">20</span>, <span class="attr">$lt</span>: <span class="number">30</span> &#125; &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;èŒƒå›´æŸ¥è¯¢&#x27;</span>, result)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">find</span>(&#123; <span class="attr">tag</span>: &#123; <span class="attr">$in</span>: [<span class="string">&#x27;js&#x27;</span>] &#125; &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;åŒ…å«&#x27;</span>, result)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å­—æ®µæŸ¥è¯¢</p><ul><li>å­—æ®µï¼šé€‰æ‹©è¦æŸ¥è¯¢è¾“å‡ºçš„å­—æ®µï¼Œåœ¨find()åé¢é“¾å¼è°ƒç”¨select(),å¤šä¸ªå­—æ®µç”¨ç©ºæ ¼éš”å¼€</li><li>ä¸æƒ³æŸ¥è¯¢è°ï¼Œåœ¨å‰é¢åŠ ä¸Š â€œ-â€ï¼Œå¦‚ï¼š-id</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">find</span>()</span><br><span class="line">  .<span class="title function_">select</span>(<span class="string">&#x27;name author -id&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å­—æ®µæŸ¥è¯¢&#x27;</span>, result))</span><br></pre></td></tr></table></figure><p>æ’åº</p><ul><li>åœ¨find()åé¢é“¾å¼è°ƒç”¨sort()</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">find</span>()</span><br><span class="line">  .<span class="title function_">sort</span>(<span class="string">&#x27;price&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ’åº&#x27;</span>, result))</span><br></pre></td></tr></table></figure><p>è·³è¿‡ã€é™åˆ¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">find</span>()</span><br><span class="line">  .<span class="title function_">skip</span>(<span class="number">2</span>)</span><br><span class="line">  .<span class="title function_">limit</span>(<span class="number">3</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤-1"><a href="#åˆ é™¤-1" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h4><p>åˆ é™¤ä¸€æ¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">findOneAndDelete</span>(&#123; <span class="attr">_id</span>: <span class="string">&#x27;606c49904798cf25005e0cd6&#x27;</span> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span></span><br><span class="line">  <span class="comment">// è¿”å›çš„å°±æ˜¯åˆ é™¤çš„é‚£æ¡ï¼Œå¦‚æœåŒ¹é…äº†å¤šæ¡ï¼Œä¼šåˆ é™¤ç¬¬ä¸€æ¡</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>åˆ é™¤å¤šæ¡</p><ul><li>ï¼ï¼å¦‚æœä¼ äº†ç©ºå¯¹è±¡{}ï¼Œä¼šåˆ é™¤æ‰€æœ‰ã€‚è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒOKå’Œnï¼Œokä¸º1ä»£è¡¨æˆåŠŸï¼Œnä»£è¡¨åˆ é™¤çš„æ¡ç›®</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">deleteMany</span>(&#123;&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br></pre></td></tr></table></figure><h4 id="æ›´æ–°-1"><a href="#æ›´æ–°-1" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h4><p>æ›´æ–°ä¸€æ¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">updateOne</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Pythoné¢&#x27;</span> &#125;, &#123; <span class="attr">name</span>: <span class="string">&#x27;Pythonå­¦ä¹ &#x27;</span> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æ›´æ–°å¤šæ¡</p><ul><li>å¦‚æœä¼ é€’ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå³æ˜¯æ›´æ–°æ‰€æœ‰</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Course</span>.<span class="title function_">updateOne</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Pythoné¢&#x27;</span> &#125;, &#123; <span class="attr">name</span>: <span class="string">&#x27;Pythonå­¦ä¹ &#x27;</span> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="mongooseéªŒè¯"><a href="#mongooseéªŒè¯" class="headerlink" title="mongooseéªŒè¯"></a>mongooseéªŒè¯</h3><p>åœ¨åˆ›å»ºéªŒè¯è§„åˆ™çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®å½“å‰å­—æ®µçš„éªŒè¯è§„åˆ™ï¼ŒéªŒè¯å¤±è´¥å°±è¾“å…¥æ’å…¥å¤±è´¥</p><ul><li>require: true å¿…ä¼ å­—æ®µã€‚å¦‚ä¸‹ï¼Œå¦‚æœtitleæ²¡ä¼ å°±ä¼šæŠ¥é”™</li><li>require: [true, â€˜è¯·ä¼ å…¥æ ‡é¢˜â€™]ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„</li><li>minlengthç±»å‹å¯¹äºå­—ç¬¦ä¸²ï¼Œminç±»å‹å¯¹äºæ•°å€¼</li></ul><p>è¿™æ ·</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> postSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">minlength</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">maxlength</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">trim</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æˆ–è€…è¿™æ ·</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> postSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">required</span>: [<span class="literal">true</span>, <span class="string">&#x27;è¯·ä¼ å…¥æ–‡ç« æ ‡é¢˜&#x27;</span>],</span><br><span class="line">    <span class="attr">minlength</span>: [<span class="number">2</span>, <span class="string">&#x27;æ ‡é¢˜æœ€å°ä¸èƒ½å°äº2ä½&#x27;</span>],</span><br><span class="line">    <span class="attr">maxlength</span>: [<span class="number">5</span>, <span class="string">&#x27;æ ‡é¢˜æœ€å°ä¸èƒ½å°äº5ä½&#x27;</span>],</span><br><span class="line">    <span class="attr">trim</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">age</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">min</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">max</span>: <span class="number">60</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">publishDate</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Date</span>,</span><br><span class="line">    <span class="comment">// defaultçš„å¯ä»¥ä¸ä¼ </span></span><br><span class="line">    <span class="attr">default</span>: <span class="title class_">Date</span>.<span class="property">now</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">category</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="comment">// enumæŒ‡å®šè¦ä¼ çš„å€¼ï¼Œä¸æ˜¯æŒ‡å®šçš„å€¼ä¸èƒ½ä¼ </span></span><br><span class="line">    <span class="attr">enum</span>: [<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;css&#x27;</span>, <span class="string">&#x27;js&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰éªŒè¯</span></span><br><span class="line">  <span class="attr">author</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">validate</span>: &#123;</span><br><span class="line">      <span class="attr">validator</span>: <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// è¿”å›å¸ƒå°”å€¼ï¼Œvalæ˜¯è¦éªŒè¯çš„å€¼</span></span><br><span class="line">        <span class="keyword">return</span> val &amp;&amp; val.<span class="property">length</span> &gt; <span class="number">4</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// è‡ªå®šä¹‰æ¶ˆæ¯</span></span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;ä¼ å…¥çš„å€¼ä¸ç¬¦åˆéªŒè¯è§„åˆ™&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Post</span> = mongoose.<span class="title function_">model</span>(<span class="string">&#x27;Post&#x27;</span>, postSchema)</span><br><span class="line"><span class="title class_">Post</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;å¼€å¿ƒ&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">21</span>,</span><br><span class="line">  <span class="attr">category</span>: <span class="string">&#x27;html&#x27;</span>,</span><br><span class="line">  <span class="attr">author</span>: <span class="string">&#x27;asd&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(error))</span><br></pre></td></tr></table></figure><h3 id="é›†åˆå…³è”"><a href="#é›†åˆå…³è”" class="headerlink" title="é›†åˆå…³è”"></a>é›†åˆå…³è”</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨æˆ·è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> userSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ä¹¦æœ¬è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> bookSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">author</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;User&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ç”¨æˆ·é›†åˆ</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = mongoose.<span class="title function_">model</span>(<span class="string">&#x27;User&#x27;</span>, userSchema)</span><br><span class="line"><span class="comment">// ä¹¦æœ¬é›†åˆ</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Book</span> = mongoose.<span class="title function_">model</span>(<span class="string">&#x27;Book&#x27;</span>, bookSchema)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç”¨æˆ·</span></span><br><span class="line"><span class="title class_">User</span>.<span class="title function_">create</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;é“œé”£æ¹¾æ‰fitäºº&#x27;</span> &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br><span class="line"><span class="comment">// åˆ›å»ºä¹¦æœ¬</span></span><br><span class="line"><span class="title class_">Book</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;å¦‚ä½•åšæ´ªå…´å¤§ä½¬&#x27;</span>,</span><br><span class="line">  <span class="attr">author</span>: <span class="string">&#x27;606daa780bd6c1573c703c48&#x27;</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ¡æŸ¥å‡ºçš„æ˜¯ä¹¦æœ¬ä¿¡æ¯ï¼Œä½†æ˜¯ä½œè€…æ˜¯å½“å‰ä½œè€…çš„id</span></span><br><span class="line"><span class="comment">// Book.find().then()</span></span><br><span class="line"><span class="title class_">Book</span>.<span class="title function_">find</span>()</span><br><span class="line">  .<span class="title function_">populate</span>(<span class="string">&#x27;author&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br></pre></td></tr></table></figure><p>å¯èƒ½å¢è¡¥ã€ä¿®æ”¹â€¦â€¦</p><!-- <span style="color: green; font-size: 100px; text-shadow: 2px 2px 1px gold ">mongoDB</span> --><!-- <b style="color: gold; font-size: 30px">Â  ğŸ“„&nbsp;åŸºæœ¬ä½¿ç”¨</b>     <span style="color: orange; font-size: 25px">AND</span>     <span style="color: green; font-size: 45px;text-shadow: 2px 2px 1px lightgreen">Node.js</span> -->]]></content>
    
    
    <summary type="html">&lt;p&gt;ç®€å•è®°å½•&lt;span style=&quot;color: purple;&quot;&gt;å‘½ä»¤è¡Œ&lt;/span&gt;ã€&lt;span style=&quot;color: green&quot;&gt;Node.js&lt;/span&gt;æ“ä½œ&lt;span style=&quot;color: lightgreen&quot;&gt;MongoDB&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ç‰ˆæœ¬ ï¼šç¤¾åŒºç‰ˆ&lt;code&gt;4.2.6&lt;/code&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="åç«¯å­¦ä¹ " scheme="https://smalljerry.cn/categories/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ•°æ®åº“" scheme="https://smalljerry.cn/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
</feed>
